(this.webpackJsonpemilus=this.webpackJsonpemilus||[]).push([[2],{100:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(0),a=n(6),l=n(135),r=n(167),o=n(221),s=n(95),d=n(69),c=n(1);const u=(e,t,n,u,v,j,h)=>{const[p,b]=Object(i.useState)(!1),O=null===t||void 0===t?void 0:t.map((e=>{const t=null===v||void 0===v?void 0:v.find((t=>(null===t||void 0===t?void 0:t.id)===e)),n=null===h||void 0===h?void 0:h.find((e=>(null===t||void 0===t?void 0:t.organizationId)===(null===e||void 0===e?void 0:e.organizationId)));return{title:(null!==t&&void 0!==t&&t.displayName?(null===t||void 0===t?void 0:t.displayName)+" ":"")+(null!==t&&void 0!==t&&t.registry?null===t||void 0===t?void 0:t.registry:"")||(null===t||void 0===t?void 0:t.id),org:null===n||void 0===n?void 0:n.fullName,id:null===t||void 0===t?void 0:t.id,style:null===t||void 0===t?void 0:t.style,benefitType:null===t||void 0===t?void 0:t.benefitType,isTracker:null===t||void 0===t?void 0:t.isTracker}})),m=null===n||void 0===n?void 0:n.map((e=>({title:e,id:null===e||void 0===e?void 0:e.id}))),g=null===u||void 0===u?void 0:u.map((e=>{const t=null===j||void 0===j?void 0:j.find((t=>(null===t||void 0===t?void 0:t.userId)===e)),n=null===h||void 0===h?void 0:h.find((e=>(null===t||void 0===t?void 0:t.organizationId)===(null===e||void 0===e?void 0:e.organizationId)));return{title:null===t||void 0===t?void 0:t.displayName,org:null===n||void 0===n?void 0:n.fullName,id:null===t||void 0===t?void 0:t.id}}));const f=O||m||g,x=(function(e){const t=(null===e||void 0===e?void 0:e.length)||0;if(t>5){const n=t-5,i=e.slice(0,5).map((e=>(null===e||void 0===e?void 0:e.title)||(null===e||void 0===e?void 0:e.id)));return"".concat(i.join("\n"),"\n(+").concat(n," mer)")}e.map((e=>(null===e||void 0===e?void 0:e.title)||(null===e||void 0===e?void 0:e.id))).join("\n")}(f),Object.entries(a.c).map((e=>{let[t,n]=e;const i=null===f||void 0===f?void 0:f.filter((e=>e.benefitType===n.TYPE&&!(null!==e&&void 0!==e&&e.isTracker)));return(null===i||void 0===i?void 0:i.length)<1?null:Object(c.jsx)(r.b,{itemLayout:"horizontal",dataSource:i,header:n.TYPE_DISPLAY_TEXT,renderItem:e=>{var t,n;return Object(c.jsx)(r.b.Item,{children:Object(c.jsx)(r.b.Item.Meta,{avatar:Object(c.jsx)(o.a,{style:{backgroundColor:null===e||void 0===e||null===(t=e.style)||void 0===t?void 0:t.color},children:Object(c.jsx)(d.Icon,{icon:l.a[null===e||void 0===e||null===(n=e.style)||void 0===n?void 0:n.marker]})}),title:null===e||void 0===e?void 0:e.title,description:null===e||void 0===e?void 0:e.org})},null===e||void 0===e?void 0:e.id)}})}))),y=null===f||void 0===f?void 0:f.filter((e=>e.isTracker));(null===y||void 0===y?void 0:y.length)>0&&x.push(Object(c.jsx)(r.b,{itemLayout:"horizontal",dataSource:y,header:"Utrustning",renderItem:e=>{var t,n;return Object(c.jsx)(r.b.Item,{children:Object(c.jsx)(r.b.Item.Meta,{avatar:Object(c.jsx)(o.a,{style:{backgroundColor:null===e||void 0===e||null===(t=e.style)||void 0===t?void 0:t.color},children:Object(c.jsx)(d.Icon,{icon:l.a[null===e||void 0===e||null===(n=e.style)||void 0===n?void 0:n.marker]})}),title:null===e||void 0===e?void 0:e.title,description:null===e||void 0===e?void 0:e.org})},null===e||void 0===e?void 0:e.id)}}));const E=Object(c.jsx)(r.b,{itemLayout:"horizontal",dataSource:f,header:e.TYPE_DISPLAY_TEXT,renderItem:e=>Object(c.jsx)(r.b.Item,{children:Object(c.jsx)(r.b.Item.Meta,{title:null===e||void 0===e?void 0:e.title,description:null===e||void 0===e?void 0:e.org})},null===e||void 0===e?void 0:e.id)});console.log(x);const I=O?x:E;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(s.a,{visible:p,title:e,icon:!1,onCancel:()=>b(!1),onOk:()=>b(!1),footer:null,bodyStyle:{overflowY:"auto",maxHeight:"calc(100vh - 200px)"},children:(S=I,Object(c.jsx)("div",{id:"scrollableDiv",children:S}))}),Object(c.jsx)("a",{onClick:()=>b(!0),children:e})]});var S}},103:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));const i={DEVICE_ALREADY_INSTALLED:"Enhet redan kopplad",DEVICE_FORBIDDEN:"Enhet f\xf6rbjuden att utf\xf6ra \xe5tg\xe4rd",DEVICE_INCOMPLETE:"Enhet ej fullst\xe4ndig",DEVICE_MISSING:"Enhet saknas",DEVICE_MISSING_VEHICLE:"Enhet saknar fordon",DEVICE_NOT_INSTALLED:"Enhet \xe4r inte installerad",DEVICE_RETIRED:"Enheten \xe4r redan pensionerad",DIFFERENT_ORGANIZATIONS:"Enhet, fordon eller anv\xe4ndare \xe4r inte inom samma organisation",DRIVER_NOT_PERMITTED_VEHICLE:"F\xf6rare har inte tillst\xe5nd att placeras i detta fordon",EMAIL_ALREADY_EXIST:"E-post finns redan",ICCID_ALREADY_EXIST:"ICCID-nummer finns redan",ICCID_LENGTH:"Fel l\xe4ngd p\xe5 ICCID-nummer. Ska vara 18-22 siffror i l\xe4ngd.",ID_MISMATCH:"ID \xe4r felaktigt",IMEI_ALREADY_EXIST:"IMEI-nummer finns redan",IMEI_LENGTH:"Fel l\xe4ngd p\xe5 IMEI-nummer. Ska vara 14-16 siffror i l\xe4ngd.",JOURNAL_MISSING:"Journal saknas",MISFORMATTED_FIELDS:"Ett eller flera f\xe4lt \xe4r felformaterade, se \xf6ver s\xe5 att stavningen \xe4r korrekt",MISSING_CLEARANCE:"Du saknar r\xe4ttigheter f\xf6r att utf\xf6ra denna \xe5tg\xe4rd",MISSING_FIELDS:"Din f\xf6rfr\xe5gan saknar obligatoriska v\xe4rden",MISSING_TOKEN:"Felaktig l\xe4nk",NO_HISTORICAL_ODOMETER_REFERENCE:"Ingen referens till historik m\xe4tarst\xe4llning kunde hittas",NO_ODOMETER_REFERENCE:"Ingen referens till m\xe4tarst\xe4llning kunde hittas",NO_USER_CHECKED_IN:"Ingen anv\xe4ndare in-checkad",OLD_PASSWORD_MISSING:"Gammalt l\xf6senord saknas",ONLY_DIGITS:"Detta v\xe4rde f\xe5r endast inneh\xe5lla nummer",ORGANIZATION_FORBIDDEN:"Organisation f\xf6rbjuden att utf\xf6ra denna \xe5tg\xe4rd",ORGANIZATION_MISSING:"Organisation saknas",PASSWORD_MISMATCH:"Felaktigt l\xf6senord",PASSWORD_SHORT:"L\xf6senordet \xe4r f\xf6r kort",PHONE_ALREADY_EXIST:"Telefon-nummer finns redan",PHONE_LENGTH:"Fel l\xe4ngd p\xe5 Telefon-nummer.Minst 14 siffror i l\xe4ngd.",PRIVATE_TRIP_DIFFERENT_USER:"Du har inte beh\xf6righet att \xe4ndra andras privata resor",REGISTRY_ALREADY_EXIST:"Registreringsnummer finns redan registrerat",REGISTRY_ALREADY_SET:"Registreringsnummer \xe4r redan registrerat",ROOT_OR_ADMIN_REQUIRED:"Root eller admin-\xe5tkomst kr\xe4vs",ROOT_REQUIRED:"Root-\xe5tkomst kr\xe4vs",SAME_PASSWORD:"Samma l\xf6senord",TRIPS_NOT_CONNECTED:"Resor \xe4r inte kopplade",USER_FORBIDDEN:"Anv\xe4ndare f\xf6rbjuden att utf\xf6ra \xe5tg\xe4rd",USER_MISSING:"Anv\xe4ndare saknas",USERNAME_MISSING:"Anv\xe4ndarnamn saknas",VEHICLE_FORBIDDEN:"Fordon f\xf6rbjuden att utf\xf6ra \xe5tg\xe4rd",VEHICLE_HAS_DEVICE:"Fordon har enhet kopplad",VEHICLE_MISSING:"Fordon saknas",VEHICLE_MISSING_DEVICE:"Fordon saknar enhet",WEEKDAYSELECTION_ALREADY_EXIST:"Veckodagsmarkering finns redan",WEEKDAYSELECTION_MISSING:"Veckodagsmarkering saknas",ZONE_MISSING:"Zon saknas",ZONES_MISSING:"Zoner saknas",SOMETHING_GONE_WRONG:"N\xe5got gick fel",TOKEN_EXPIRED:"Denna l\xe4nk har upph\xf6rt att g\xe4lla",TOKEN_USED:"Denna l\xe4nk har redan anv\xe4nds en g\xe5ng",TRY_AGAIN:"F\xf6rs\xf6k igen.",YES_CANCEL:"Ja, avbryt",NO_CONTINUE:"Nej, forts\xe4tt",WE_CAN_NOT_FIND_DATA_FOR_THIS_PERIOD:"Vi kunde inte hitta data f\xf6r denna period",DATE_TO:"Till",ARE_YOU_SURE_TO_CANCEL:"\xc4r du s\xe4ker p\xe5 att avbryta?",FORBIDDEN_DURING_TRIP:"Denna \xe4ndring \xe4r inte till\xe5ten under resan",ODOMETER_TOO_LARGE:"M\xe4tarst\xe4llning \xe4r f\xf6r stor. Ange i km",REPORT_SCHEDULE_MISSING:"Rapport schema saknas",MISSING_SUMMARIES:"Rapport f\xf6r denna period saknas",MISSING_JOURNALS:"Rapport f\xf6r denna period saknas",GEO_ZONE_ALARM_MISSING:"GeoFence zonen saknas",GEO_ZONE_ALARM_FORBIDDEN:"GeoFence zonen f\xf6rbjuden",ACTIVE_IN_OUT_SAME:"Aktiv vid inresa och utresa f\xe5r inte vara samma",NUMBERS_ONLY:"Endast ciffror till\xe5tna",BAD_ZONE_ID:"Kan inte hitta tidszon",ALARM_EVENTS_MISSING:"Det finns inga larm f\xf6r valda parametrar",EMPTY_FORBIDDEN:"Ej till\xe5tet utan n\xe5got val",PASSAGE_MISSING:"Passagen saknas",DIFFERENT_TRIP_TYPES:"Resor har olika typer",DIFFERENT_DRIVERS:"Resor har olika f\xf6rare",DIFFERENT_VEHICLES:"Resor har olika fordon",ADMIN_ALREADY_APPROVED:"Journalen \xe4r redan godk\xe4nd",TRIP_ATTESTED:"Resan \xe4r redan attesterad",BAD_ROLES:"Felaktig roll",BAD_REG:"Registreringsskylt uppfyller inte Trafikverkets regler",ISO_COUNTRY_CODE_MISSING:"Fordonet saknar accepterad landsflagga",INCOMPATIBLE_PURPOSES:"Vi har uppt\xe4ckt att du f\xf6rs\xf6kt sl\xe5 ihop resor av olika typ. F\xf6r att v\xe4rna om din integritet har vi klassat dessa resor som privat. Du kan enkelt \xe4ndra detta i k\xf6rjournalen nedan om du vill klassa vissa ihopslagna resor som Tj\xe4nst.",IMEI_STATUS_MISSING:"Vi har inte \xe4n f\xe5tt n\xe5gon data fr\xe5n enheten/fordonet",DAYS_MISSING_TRIPS_ZERO:"Ogiltigt v\xe4rde, minsta till\xe5tna v\xe4rde \xe4r 1.",HOURS_MISSING_CONTACT_ZERO:"Ogiltigt v\xe4rde, minsta till\xe5tna v\xe4rde \xe4r 1.",VEHICLE_TRAVELLED_FARTHER:"Fordonets sammanlagd k\xf6rstr\xe4cka \xe4r l\xe4ngre \xe4n angiven m\xe4tarst\xe4llning.",ICCID_MISSING:"ICCID hittas inte hos v\xe5ra leverant\xf6rer",TRUE_PHONE_UNAUTHORIZED:"Truephone credentials g\xe4ller inte"};function a(e){console.log(" ~ file: httpErrorMessages.js ~ line 51 ~ getErrorMessage ~ HTTP_MESSAGE_RESPONSE",e);let t=i[e]?i[e]:"No default message has been set/found.";return console.log(" ~ file: httpErrorMessages.js ~ line 56 ~ getErrorMessage ~ message",t),t}},108:function(e,t,n){"use strict";n.d(t,"i",(function(){return O})),n.d(t,"h",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return f})),n.d(t,"f",(function(){return x})),n.d(t,"e",(function(){return y})),n.d(t,"d",(function(){return E})),n.d(t,"b",(function(){return I})),n.d(t,"g",(function(){return S}));var i=n(91),a=n(57),l=n(69),r=n(60),o=n(197),s=(n(179),n(62),n(6)),d=n(1);const{Option:c}=r.a,u=n(181);u.registerLocale(n(182));const v=u.getNames("sv",{select:"alias"}),j=Object.entries(v).map((e=>{let[t,n]=e;return{key:t,label:n}})).sort(((e,t)=>e.label.localeCompare(t.label))),h=j.filter((e=>"SE"===e.key||"FI"===e.key||"NO"===e.key||"DK"===e.key)),p=j.find((e=>"SE"===e.key)),b=h.findIndex((e=>"SE"===e.key));h.splice(b,1),h.unshift(p);const O={superVehicles:"Fordon",account:"Konto",organizations:"Organisationer",users:"Anv\xe4ndare",superdevices:"Enheter","triptax-analyzer":"Tr\xe4ngselskatt"},m={androidCar:i.androidCar,androidContact:i.androidContact,bus:a.bus,home:a.home,road:a.road,glass:a.glass,briefcase:a.briefcase,wrench:a.wrench,shoppingCart:a.shoppingCart,truck:a.truck,bolt:a.bolt,cutlery:a.cutlery,lightbulbO:a.lightbulbO,ambulance:a.ambulance,bank:a.bank,plug:a.plug,paintBrush:a.paintBrush,androidDrafts:i.androidDrafts,androidHome:i.androidHome,androidGlobe:i.androidGlobe,androidAlert:i.androidAlert,PB:i.androidGlobe},g="https://flagcdn.com/",f=e=>{let{marker:t}=e;return Object(d.jsx)(l.Icon,{icon:t,size:24})},x=(e,t,n)=>{var i,a,l,r;const s=null!==t.fuel1?"".concat(null===t||void 0===t||null===(i=t.fuel1)||void 0===i?void 0:i.svName,","):"",c=null!==t.fuel2?"".concat(null===t||void 0===t||null===(a=t.fuel2)||void 0===a?void 0:a.svName,","):"",u=null!==(null===n||void 0===n?void 0:n.consumption1)?"".concat(n.consumption1):"",v=null!==(null===n||void 0===n?void 0:n.consumption2)?"".concat(n.consumption2):"",j=null!==(null===t||void 0===t?void 0:t.fuel1)?"".concat(null===(l=t.fuel1)||void 0===l?void 0:l.consumptionUnit):"",h=null!==(null===t||void 0===t?void 0:t.fuel2)?"".concat(null===(r=t.fuel2)||void 0===r?void 0:r.consumptionUnit):"";return e&&null!==(null===t||void 0===t?void 0:t.fuel1)&&null!==(null===t||void 0===t?void 0:t.fuel2)?Object(d.jsxs)(o.b,{direction:"vertical",children:[Object(d.jsx)("span",{children:"".concat(s," ").concat(u," ").concat(j)}),Object(d.jsx)("span",{children:"".concat(c," ").concat(v," ").concat(h)})]}):Object(d.jsx)("span",{children:"".concat(s," ").concat(u," ").concat(j)})},y=(e,t)=>{const n=null!==t.co2GKm1&&0!==t.co2GKm1?"".concat(t.co2GKm1,"g / km"):"",i=null!==t.co2GKm2&&0!==t.co2GKm2?"".concat(t.co2GKm2,"g / km"):"";return e&&null!==t.co2GKm1&&null!==t.co2GKm2?Object(d.jsxs)(o.b,{direction:"vertical",children:[Object(d.jsx)("span",{children:n}),Object(d.jsx)("span",{children:i})]}):Object(d.jsx)("span",{children:n})},E=e=>{let t=[null===e||void 0===e?void 0:e.streetAndNum,null===e||void 0===e?void 0:e.zip,null===e||void 0===e?void 0:e.city,null===e||void 0===e?void 0:e.state,null===e||void 0===e?void 0:e.country];return t=t.filter((e=>void 0!==e&&null!==e&&""!==e)),Object(d.jsx)(d.Fragment,{children:t.join(", ")})},I=e=>e>=120?s.b.RED:e<120&&e>80?s.b.YELLOW:s.b.GREEN,S=e=>{let t=s.b.RED;return t=e>=30?s.b.YELLOW:t,t=e>=55?s.b.BLUE:t,t=e>=80?s.b.GREEN:t,t}},11:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return j}));var i=n(115),a=n(85),l=n(489),r=n.n(l),o=n(18),s=n(103);const d={token:"beepboop"},c=[{id:1,meta:{reg:"NS4957",type:"CAR",color:"#Df626B",status:"STOPPED",gps_quality:1,gsm_quality:1},last_seen_ms:1618925929e3,speed_kph:0,speed_kmh:0,report_rate_s:300,battery_percentage:100,position:{latitude:59.84209056411892,longitude:17.625054561388687},driver:{user_id:123,display_name:"Lisa"}},{id:2,meta:{reg:"AEB557",type:"CAR",color:"#FA8C17",status:"MOVING",gps_quality:1,gsm_quality:1},last_seen_ms:1618925929e3,speed_kph:30,speed_kmh:30,report_rate_s:300,battery_percentage:100,position:{latitude:59.69749597758973,longitude:18.11574738600702},driver:{user_id:123,display_name:"Lisa"}},{id:3,meta:{reg:"ABC256",type:"CAR",color:"#FA8C17",status:"STOPPED",gps_quality:1,gsm_quality:1},last_seen_ms:1618832329e3,speed_kph:30,speed_kmh:30,report_rate_s:300,battery_percentage:18,position:{latitude:59.95653247721158,longitude:17.502039056502117},driver:{user_id:123,display_name:"Lisa"}}],u=[{journal_id:144,vehicle:{reg:"ABC123",type:"CAR"},driver:{user_id:123,display_name:"Lisa"},trip:{timestamp_start_ms:1618970798e3,timestamp_stop_ms:1619003198e3,odometer_start:1e4,odometer_stop:15e3,odometer_max:1e7,purpose:"WORK",description:"Description",coords:[{latitude:59.84209056411892,longitude:17.625054561388687},{latitude:59.69749597758973,longitude:18.11574738600702}]}},{journal_id:155,vehicle:{reg:"DWD513",type:"CAR"},driver:{user_id:124,display_name:"Bob"},trip:{timestamp_start_ms:1616037238e3,timestamp_stop_ms:1616044438e3,odometer_start:3e4,odometer_stop:4e4,odometer_max:1e7,purpose:"PRIVATE",description:"Description",coords:[{latitude:59.85057342114571,longitude:17.57739705761025},{latitude:59.86938106342094,longitude:17.597583382174143}]}}];if(o.f){const e=new r.a(a.a,{delayResponse:0});e.onGet("/overview").reply(200,c),e.onGet("/journal").reply(200,u),e.onPut("/journal/144").reply(200),e.onPut("/journal/155").reply(200),e.onPost("/auth").reply(200,d)}const v=new class{constructor(){this.instance=a.a}getCurrentUser(){return this.instance.get("/auth",undefined)}patchNewPassword(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={password:t.password,oldPassword:t.oldPassword};return this.instance.patch("/user/".concat(e),n).then((e=>{i.b.success("L\xf6senord \xe4ndrades")})).catch((e=>{const t=s.b[e.response.data];console.log("Failed:",t),i.b.error(t+" F\xf6rs\xf6k igen")}))}postRegister(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={full_name:e.fullName,title:e.title,account:{username:e.username,password_raw:e.password},organization:{organization_id:1}};return this.instance.post("/register",t)}postResetPassword(){const e={url:"/reset-password",method:"post",headers:{"public-request":"true"},data:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};return this.instance(e)}patchResetPassword(){const e={url:"auth/reset-password",method:"patch",headers:{"public-request":"true"},data:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};return this.instance(e)}postContactTrackson(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.instance.post("/contact-trackson",e)}postReportTrackson(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.instance.post("/report-error",e)}postReportTrackson2OldFunction(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={subject:e.subject,body:e.body,addrFrom:e.addrFrom};let n="Felanm\xe4lan Trackson\n";return n+="Telefonnummer: "+e.phone+"\n",n+="E-post: "+e.addrFrom+"\n",t.body=n+t.body,this.instance.post("/contact-trackson",t)}postValidatePasswordToken(e,t){const n={url:"auth/validate-password-token"+("?token="+e),method:"post",headers:{"public-request":"true"},data:t};return this.instance(n)}},j=new class{constructor(){this.instance=a.a}getVehicleInfo(e){return this.instance.get("/vehicleinfo/fetch?regNo="+e)}patchTrackerUpdateFrequency(e,t){let n=t.split("-");return this.instance.patch("/vehicles/".concat(e,"/response-time?period=").concat(n[0],"&unit=").concat(n[1]))}getTrackersReport(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.instance.get("/report/trackers?vehicleIds="+(null===e||void 0===e?void 0:e.toString())).then((e=>{const n=document.createElement("a");n.href="data:application/pdf;base64,"+e,n.download="trackerrapport_".concat(t,".pdf"),n.dispatchEvent(new MouseEvent("click")),i.b.destroy()})).catch((e=>{i.b.destroy()}))}getOverview(){return this.instance.get("/overview")}getOverviewForVehicleId(e){return this.instance.get("/overview/vehicle/".concat(e))}putJournalMerge(e,t,n){const i={journal_ids:[e,t],description:n};return this.instance.put("/journal/merge",i)}putJournalUnmerge(e){const t={journal_ids:e};return this.instance.put("/journal/unmerge",t)}getJournals(e,t,n,i,a,l){let r;return e&&t?(r=l?"/"+l:"",r+="?from_ts="+e+"&to_ts="+t,r+="&size=99999999",r+=(null===n||void 0===n?void 0:n.length)>0?"&vehicleIds="+n:"",r+=(null===i||void 0===i?void 0:i.length)>0?"&driverIds="+i:"",r+=a?"&fetchCoordinates="+a:"",this.instance.get("/journal"+r,{params:{}})):Promise.reject("Bad timestamp")}getJournalsByIds(e,t){return this.instance.get("/journal/by-ids?journalIds=".concat(e,"&coords=").concat(t))}getJournalsCSV(e,t,n,a,l,r){let o;return e&&t?(o="?from_ts="+e+"&to_ts="+t,o+="&size=99999999",o+=(null===n||void 0===n?void 0:n.length)>0?"&vehicleIds="+n:"",o+=(null===l||void 0===l?void 0:l.length)>0?"&driverIds="+l:"",o+=(null===r||void 0===r?void 0:r.length)>0?"&organizationIds="+r:"",this.instance.get("/journal-csv"+o,{params:{responseType:"blob"}}).then((e=>{const t=document.createElement("a");t.href="data:text/csv;charset=iso-8859-1,"+escape(e),t.download=a?a.replace(/\s+/g,"-"):"csv.csv",t.dispatchEvent(new MouseEvent("click")),i.b.destroy()})).catch((e=>{i.b.destroy()}))):Promise.reject("Bad timestamp")}getJournalsPDF(e,t,n,a,l,r,o){let s;return console.log("komigenorg",o),s="?tsFrom="+e+"&tsTo="+t,s+=(null===n||void 0===n?void 0:n.length)>0?"&vehicleIds="+n:"",s+=(null===r||void 0===r?void 0:r.length)>0?"&driverIds="+r:"",s+=l?"&zoneId="+l:"",s+=(null===o||void 0===o?void 0:o.length)>0?"&organizationIds="+o:"",this.instance.get("/report/journal/pdf"+s,{params:{responseType:"blob"}}).then((e=>{const t=document.createElement("a");t.href="data:application/pdf;base64,"+e,t.download=a?a.replace(/\s+/g,"-"):"pdf.pdf",t.dispatchEvent(new MouseEvent("click")),i.b.destroy()})).catch((e=>{i.b.destroy()}))}getSummaryVehicleReports(e,t,n,a,l,r,o,s){let d;return e&&t?(d="?tsFrom="+e+"&tsTo="+t,d+="&zoneId="+l,d+=n?"&vehicleIds="+n:"",d+=r?"&allVehicles=true":"",d+=o?"&driverIds="+o:"",d+=(null===s||void 0===s?void 0:s.length)>0?"&organizationIds="+s:"",console.log("orgggggggggggggggg",s),this.instance.get("/report/summary-vehicle/pdf"+d,{params:{responseType:"blob"}}).then((e=>{const t=document.createElement("a");t.href="data:application/pdf;base64,"+e,t.download=a?a.replace(/\s+/g,"-"):"pdf.pdf",t.dispatchEvent(new MouseEvent("click")),i.b.destroy()})).catch((e=>{i.b.destroy()}))):Promise.reject("Bad timestamp")}getSummaryDriverReports(e,t,n,a,l,r,o,s){let d;return e&&t?(d="?tsFrom="+e+"&tsTo="+t,d+="&zoneId="+l,d+=n?"&vehicleIds="+n:"",d+=r?"&allVehicles=true":"",d+=o?"&driverIds="+o:"",d+=(null===s||void 0===s?void 0:s.length)>0?"&organizationIds="+s:"",this.instance.get("/report/summary-driver/pdf"+d,{params:{responseType:"blob"}}).then((e=>{const t=document.createElement("a");t.href="data:application/pdf;base64,"+e,t.download=a?a.replace(/\s+/g,"-"):"pdf.pdf",t.dispatchEvent(new MouseEvent("click")),i.b.destroy()})).catch((e=>{i.b.destroy()}))):Promise.reject("Bad timestamp")}getSalaryReports(e,t,n,a,l,r,o,s){let d;return e&&t?(d="?tsFrom="+e+"&tsTo="+t,d+="&zoneId="+l,d+=n?"&vehicleIds="+n:"",d+=r?"&allVehicles=true":"",d+=o?"&driverIds="+o:"",d+=(null===s||void 0===s?void 0:s.length)>0?"&organizationIds="+s:"",this.instance.get("/report/salary/pdf"+d,{params:{responseType:"blob"}}).then((e=>{const t=document.createElement("a");t.href="data:application/pdf;base64,"+e,t.download=a?a.replace(/\s+/g,"-"):"pdf.pdf",t.dispatchEvent(new MouseEvent("click")),i.b.destroy()})).catch((e=>{i.b.destroy()}))):Promise.reject("Bad timestamp")}getPurposeReports(e,t,n,a,l,r,o,s){let d;return e&&t?(d="?tsFrom="+e+"&tsTo="+t,d+="&zoneId="+l,d+=n?"&vehicleIds="+n:"",d+=r?"&allVehicles=true":"",d+=o?"&driverIds="+o:"",d+=(null===s||void 0===s?void 0:s.length)>0?"&organizationIds="+s:"",this.instance.get("/report/purpose/pdf"+d,{params:{responseType:"blob"}}).then((e=>{const t=document.createElement("a");t.href="data:application/pdf;base64,"+e,t.download=a?a.replace(/\s+/g,"-"):"pdf.pdf",t.dispatchEvent(new MouseEvent("click")),i.b.destroy()})).catch((e=>{i.b.destroy()}))):Promise.reject("Bad timestamp")}putJournal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{purpose:n,user_id:i,description:a,driver:l,override_start:r,override_stop:o,passages:s,lightAttested:d,correctedByDriver:c,attested:u,congestionTaxSekOverride:v,adminComment:j,status:h,devComment:p,infraTaxSekOverride:b}=t,O={};return n&&(O.purpose=n),null!==a&&(O.description=a),null!==j&&(O.adminComment=j),i&&(O.user_id=i),l&&(O.driver=l),r&&(O.override_start=r),o&&(O.override_stop=o),s&&(O.passages=s),null!==d&&(O.lightAttested=d),null!==c&&(O.correctedByDriver=c),null!==u&&(O.attested=u),null!==v&&(O.congestionTaxSekOverride=v),null!==v&&(O.infraTaxSekOverride=b),p&&(O.devComment=p),this.instance.put("/journal/".concat(e),O)}getZones(e){return this.instance.get("/user/".concat(e,"/zone"),undefined)}getZoneById(e,t){return this.instance.get("/user/".concat(e,"/zone/").concat(t),undefined)}postZone(){let e=arguments.length>1?arguments[1]:void 0;const t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.instance.post("/user/".concat(e,"/zone"),t)}putZone(e,t){const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.instance.patch("/user/".concat(e,"/zone/").concat(t),n)}deleteZone(e,t){return this.instance.delete("/user/".concat(e,"/zone/").concat(t))}putCheckCurrentDriver(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return console.log(t),this.instance.put("/vehicles/".concat(e,"/current-driver"),t)}getWeekdaySelection(e){return this.instance.get("/user/".concat(e,"/weekday"))}postWeekdaySelection(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instance.post("/user/".concat(e,"/weekday"),t)}patchWeekdaySelection(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instance.patch("/user/".concat(e,"/weekday"),t)}deleteWeekdaySelection(e){return this.instance.delete("/user/".concat(e,"/weekday"))}getEcoScore(e,t,n){let i;return e&&t?(i="?fromMs="+e+"&toMs="+t,this.instance.get("/vehicles/".concat(n,"/ecoscore")+i,{params:{responseType:"blob"}})):Promise.reject("Bad timestamp")}getEcoScoreWeek(e){return this.instance.get("/vehicles/".concat(e,"/ecoscore"),{params:{responseType:"blob"}})}getEcoReport(e,t,n,i){let a;return a="?tsFrom="+e+"&tsTo="+t,a+="&zoneId="+n,a+=(null===i||void 0===i?void 0:i.length)>0?"&organizationIds="+i:"",this.instance.get("report/eco-score"+a)}getOrganizations(){return this.instance.get("/auth").then((e=>e.organizations.map((e=>({...e,organization_id:e.organizationId,full_name:e.fullName})))))}putUpdateOdometer(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instance.put("/vehicles/".concat(e,"/odometer"),t)}patchUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instance.patch("/user/".concat(e),t)}postInviteUser(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return console.log("invite user",e),this.instance.post("/invite-user",e)}getVehicles(e){let t;return t=e?"?showArchived="+e:"",this.instance.get("/vehicles"+t)}getVehiclesSimple(){return this.instance.get("/vehicles/simple",undefined)}getAllOrganizationsForSuperadmin(){return this.instance.get("/admin/organization",undefined).then((e=>null===e||void 0===e?void 0:e.map((e=>({...e,organization_id:e.organizationId,full_name:e.fullName})))))}getOrganizationsSimple(){return this.instance.get("/organization-simple",undefined).then((e=>null===e||void 0===e?void 0:e.map((e=>({...e,organization_id:e.organizationId,full_name:e.fullName})))))}patchVehicle(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instance.patch("/vehicles/".concat(e),t)}postSuperVehicle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={url:"/vehicles",method:"post",data:e};return console.log(t),this.instance.post("/vehicles",e)}patchChangeOrgVehicle(e){const t={url:"/vehicles/"+e,method:"patch",data:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}};return this.instance(t)}patchChangeOrgUser(e){const t={url:"/user/"+e,method:"patch",data:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}};return this.instance(t)}postVehicle(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.instance.post("/vehicles",e)}postVehiclesResetFuelAndCO2(e){return this.instance.post("/vehicles/".concat(e,"/reset-fuel-co2"))}getEmailRecipients(e){return this.instance.get("/organization/".concat(e)).then((e=>e.imeiFlagEmails))}setEmailRecipients(e,t){return this.instance.patch("/organization/".concat(e),{imeiFlagEmails:t})}getOrganization(e){return this.instance.get("/organization/".concat(e))}patchOrganizationAccount(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instance.patch("/organization/".concat(e),t)}postOrganization(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.instance.post("/admin/organization",e)}patchOrganization(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return console.log(t),this.instance.patch("/admin/organization/".concat(e),t)}getPhoneFromJasper(e){return this.instance.get("/external/phone?iccid=".concat(e))}getDeviceById(e){return this.instance.get("/admin/devices/".concat(e))}patchAdminDevices(e,t){const n=t;return this.instance.patch("/admin/devices/".concat(e),n)}getConfigFromFota(e){return this.instance.get("/external/fota/device?imei=".concat(e))}patchDevices(e,t){const n={installedVehicle:t};return console.log(n),this.instance.patch("/devices/".concat(e),n)}postVehicleTracking(e){return this.instance.post("/vehicles/".concat(e,"/tracking"))}deleteOrganization(e){return this.instance.delete("/admin/organization/".concat(e))}deleteAdminDevicesInstalled(e){return this.instance.delete("/admin/devices/".concat(e,"/installed-vehicle"))}deleteDevicesInstalled(e){return this.instance.delete("/devices/".concat(e,"/installed-vehicle"))}postVehiclesWebConnect(e){return this.instance.post("/vehicles/".concat(e,"/web-connect"))}getUsers(e){let t;return t=e?"?showArchived="+e:"",this.instance.get("/user"+t)}getUserById(e){return this.instance.get("/user/".concat(e))}getUsersSimple(){return this.instance.get("/user/simple")}getDevices(){return this.instance.get("/devices")}deleteUser(e){return this.instance.delete("/user/"+e)}postNewUser(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.instance.post("/user",e)}getAVLLogFromTo(e,t){return this.instance.get("/admin/avl/log?imei=".concat(e.imei,"&tsFromMs=").concat(e.start,"&tsToMs=").concat(e.stop)).then((e=>{console.log("get logg");const n=document.createElement("a");n.href="data:text/csv;charset=iso-8859-1,"+escape(e),n.download=t||"csv.csv",n.dispatchEvent(new MouseEvent("click"))}))}getLoggAVLFileId(e,t){return this.instance.get("/admin/avl/log/files/".concat(e)).then((e=>{const n=document.createElement("a");n.href="data:text/csv;charset=iso-8859-1,"+escape(e),n.download=t||"csv.csv",n.dispatchEvent(new MouseEvent("click"))}))}getLoggAVLForImei(e){return this.instance.get("/admin/avl//log/files?imei=".concat(e))}getReports(e){return this.instance.get("/report/schedule")}getReportsOrganization(e){return this.instance.get("/report/schedule/organization/".concat(e))}postReport(e){return this.instance.post("/report/schedule",e)}deleteReport(e){return this.instance.delete("/report/schedule/".concat(e))}deleteVehicle(e){return this.instance.delete("/vehicles/".concat(e))}deleteGeoAlarm(e){return this.instance.delete("/geo-larm/".concat(e))}postGeoAlarm(e){return this.instance.post("/geo-larm",e)}getGeoAlarm(e){return this.instance.get("/geo-larm")}getGeoAlarmById(e){return this.instance.get("/geo-larm/".concat(e))}patchGeoAlarm(e,t){return this.instance.patch("/geo-larm/".concat(t),e)}getAlarmPeriod(e,t){let n;return n="?fromTs="+e+"&toTs="+t,this.instance.get("/alarm-period"+n)}getAlarmPeriodCurrent(){return this.instance.get("/alarm-period/current")}patchAlarmPeriod(e,t,n){let i;return i="?comment="+n,this.instance.patch("/alarm-period/".concat(t)+i,e)}getAlarmEventsReport(e,t,n,a,l,r,o,s,d){let c;return c="?tsFrom="+e+"&tsTo="+t,c+=(null===n||void 0===n?void 0:n.length)>0?"&driverIds="+n:"",c+=(null===a||void 0===a?void 0:a.length)>0?"&vehicleIds="+a:"",c+=(null===l||void 0===l?void 0:l.length)>0?"&organizationIds="+l:"",c+=r?"&zoneId="+r:"",c+=(null===o||void 0===o?void 0:o.length)>0?"&alarmType="+o:"",c+=(null===s||void 0===s?void 0:s.length)>0?"&alarmName="+s:"",this.instance.get("/report/discrepancy"+c,{params:{responseType:"blob"}}).then((e=>{const t=document.createElement("a");t.href="data:application/pdf;base64,"+e,t.download=d?d.replace(/\s+/g,"-"):"Avvikelserapport.pdf",t.dispatchEvent(new MouseEvent("click")),i.b.destroy()})).catch((e=>{i.b.destroy()}))}patchJournalPassage(e,t){return this.instance.patch("/journal/passage/".concat(e),t)}putJournalRestorePassages(e,t,n){let i="";return i+=t?"?infra=true":"",i+=n?"?congestion=true":"",this.instance.put("/journal/".concat(e,"/restore-passages")+i)}getAttestCheck(e,t,n){return this.instance.get("/attest/check?month=".concat(e,"&year=").concat(t,"&vehicleId=").concat(n))}patchAttestUser(e,t,n){return this.instance.patch("/attest/user?month=".concat(e,"&year=").concat(t,"&vehicleId=").concat(n))}patchAttestUserUnlock(e,t,n){return this.instance.patch("/attest/user/".concat(e,"/unlock?month=").concat(t,"&year=").concat(n))}patchJournalUnattest(e){return this.instance.patch("/journal/".concat(e,"/unattest"))}patchJournalDevCommentOff(e){return this.instance.put("/journal/".concat(e,"/remove-dev-comment"))}getReportDriver(e,t){return this.instance.get("/report/driver?month=".concat(e,"&year=").concat(t))}putAttestRefuse(e,t,n,i,a,l,r){let o={message:e};return this.instance.put("/attest/refuse?month=".concat(t,"&year=").concat(n,"&zoneId=").concat(i,"&driverId=").concat(a,"&vehicleId=").concat(l,"&badTrips=").concat(r),o)}putUnapprove(e,t,n,i,a,l){let r={message:e};return this.instance.put("/attest/unlock?month=".concat(t,"&year=").concat(n,"&driverId=").concat(i,"&vehicleId=").concat(a,"&badTrips=").concat(l),r)}putAttestConfirm(e,t,n,i,a,l){let r={message:e};return this.instance.put("/attest/confirm?month=".concat(t,"&year=").concat(n,"&zoneId=").concat(i,"&driverId=").concat(a,"&vehicleId=").concat(l),r)}putAttestReminder(e,t){let n=[t];return this.instance.put("/attest/remind?month=".concat(e),n)}getAlarmSettings(){return this.instance.get("/alarm-settings")}postAlarmSettings(e){return this.instance.post("/alarm-settings",e)}getAlarmSettingsById(e){return this.instance.get("/alarm-settings/".concat(e))}patchAlarmSettings(e,t){return this.instance.patch("/alarm-settings/".concat(e),t)}deleteAlarmSettings(e){return this.instance.delete("/alarm-settings/".concat(e))}getAttestCkeckLite(e,t,n){return this.instance.get("/attest/check-lite?month=".concat(e,"&year=").concat(t,"&vehicleId=").concat(n))}postVehicleSetFlag(){const e={vehicleIds:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],isoCountryCode:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null};return this.instance.post("/vehicles/set-flag",e)}deleteVehicleHistory(e){return this.instance.delete("/vehicleinfo/history/".concat(e))}patchArchiveVehicle(e){return this.instance.patch("/vehicles/".concat(e,"/archive"))}patchActivateVehicle(e){return this.instance.patch("/vehicles/".concat(e,"/activate"))}patchArchiveUser(e){return this.instance.patch("/user/".concat(e,"/archive"))}patchActivateUser(e){return this.instance.patch("/user/".concat(e,"/activate"))}vehicleCpuReset(e,t){return Object(a.a)({url:"".concat(o.a,"/vehicles/").concat(t,"/cpureset"),method:"POST",headers:{"X-Trackson-Organization":e,Accept:"application/json","Content-Type":"application/json"}})}getVehicleDevice(e){return this.instance.get("/device-vehicle/vehicle/".concat(e))}getVehicleById(e){return this.instance.get("/vehicles/".concat(e))}separateStartConfig(e,t){let n=t?"&specifiedTimeOfDay="+t:"";return this.instance.post("/queclink/separate-start-config?deviceId=".concat(e)+n)}getOnomondoSMS(e){return this.instance.get("/onomondo/sms/device/".concat(e))}getCheckQueclinkHistory(e){return this.instance.get("/queclink/device/".concat(e,"/history?groupByLatest=true"))}}},12:function(e,t,n){"use strict";n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return p})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return O})),n.d(t,"p",(function(){return m})),n.d(t,"q",(function(){return g})),n.d(t,"n",(function(){return f})),n.d(t,"o",(function(){return x})),n.d(t,"r",(function(){return y})),n.d(t,"s",(function(){return E})),n.d(t,"v",(function(){return T})),n.d(t,"w",(function(){return k})),n.d(t,"x",(function(){return C})),n.d(t,"y",(function(){return _})),n.d(t,"c",(function(){return A})),n.d(t,"d",(function(){return N})),n.d(t,"h",(function(){return R})),n.d(t,"i",(function(){return D})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return L})),n.d(t,"t",(function(){return P})),n.d(t,"u",(function(){return V})),n.d(t,"l",(function(){return M})),n.d(t,"z",(function(){return F})),n.d(t,"e",(function(){return z})),n.d(t,"m",(function(){return U}));var i=n(85),a=n(0),l=n.n(a),r=n(41),o=n.n(r),s=(n(130),n(246),n(374),n(2)),d=(n(11),n(18)),c=n(1);const u=(e,t)=>{const n=l.a.createContext(e);return[n,e=>t({context:n,...e})]},v=(e,t)=>{const n=u(e,t);return{context:n[0],provider:n[1]}},j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return u({},(l=>{const[r,o]=Object(a.useState)(null);return Object(a.useEffect)((()=>{const a=new URLSearchParams(window.location.search);n=n||a.get("showArchived");const l=n?"".concat(e,"?showArchived=true"):e;let r=i.a.get(l).then((e=>{o(e)}));t&&r.then(t)}),[]),Object(c.jsx)(l.context.Provider,{value:r,children:l.children})}))},[h,p]=u({},(e=>{const[t,n]=Object(a.useState)([]);return Object(a.useEffect)((()=>{i.a.get("/organization-simple").then((e=>e?e.map((e=>({...e,organization_id:e.organizationId,full_name:e.fullName}))):[])).then(n)}),[]),Object(c.jsx)(e.context.Provider,{value:t,children:e.children})})),[b,O]=u({},(e=>{const[t,n]=Object(a.useState)(d.g);return Object(a.useEffect)((()=>{i.a.get("/organization/no-map-view").then((e=>{console.log(e);const t=null!==e&&void 0!==e&&e.orgIds?null===e||void 0===e?void 0:e.orgIds:[];n(t)}))}),[]),Object(c.jsx)(e.context.Provider,{value:t,children:e.children})})),[m,g]=j("/user/simple"),[f,x]=j("/user"),[y,E]=j("/user",null,!0),[I,S]=j("/vehicles/simple"),[T,k]=j("/vehicles"),[C,_]=j("/vehicles",null,!0),[A,N]=j("/devices"),[R,D]=j("/organization"),[w,L]=j("/auth"),P=l.a.createContext({idByReg:null}),V=e=>{let{...t}=e;const[n,l]=Object(a.useState)(null),[r,o]=Object(a.useState)({}),[s,d]=Object(a.useState)({}),u=async function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];try{const t=await i.a.get("/devices");let n=[];n=t.filter((e=>e.isTracker)).map((e=>e.installedVehicle));const a=new URLSearchParams(window.location.search).get("showArchived"),l=await i.a.get("/vehicles/simple"+(a?"?showArchived=true":""));return l.filter((t=>e?!n.includes(t.id):n.includes(t.id)))}catch(t){return console.error("Error ",t),[]}};return Object(a.useEffect)((()=>{u().then((e=>{l(e),o(Object.fromEntries(e.map((e=>[e.id,e])))),d(Object.fromEntries(e.map((e=>[e.registry,e.id]))))}))}),[]),Object(c.jsx)(P.Provider,{value:{idByReg:s,index:r,raw:n,getTrackers:()=>{u(!1).then((e=>e))},getVehiclesSimple:u},children:t.children})},M=v(null,(e=>{const t=Object(a.useContext)(w),n=Object(a.useContext)(P).raw,[i,l]=Object(a.useState)(null);return Object(a.useEffect)((()=>{if(!t)return;if(!n)return;let e=null===n||void 0===n?void 0:n.filter((e=>(null===t||void 0===t?void 0:t.defaultVehicles[0])===(null===e||void 0===e?void 0:e.id))),i=null===n||void 0===n?void 0:n.filter((e=>(null===t||void 0===t?void 0:t.currentVehicle[0])===(null===e||void 0===e?void 0:e.id))),a=null===n||void 0===n?void 0:n.filter((e=>{var n,i;return(null===t||void 0===t||null===(n=t.permittedVehicles)||void 0===n?void 0:n.length)>0?(null===t||void 0===t||null===(i=t.permittedVehicles[0])||void 0===i?void 0:i.id)===(null===e||void 0===e?void 0:e.id):null}));const r=e.concat(i).concat(a)[0];var o;void 0===r&&(null===n||void 0===n?void 0:n.length)>0?l(null===(o=n[0])||void 0===o?void 0:o.id):l((null===r||void 0===r?void 0:r.id)||void 0)}),[t,n]),Object(c.jsx)(e.context.Provider,{value:i,children:e.children})})),F=v(null,(e=>{const t=Object(a.useContext)(w),[n,i]=Object(a.useState)();return Object(a.useEffect)((()=>{var e,n;i((null===t||void 0===t||null===(e=t.organizations)||void 0===e?void 0:e.length)<2&&(null===t||void 0===t||null===(n=t.roles)||void 0===n?void 0:n.includes(s.f.ROOT)))}),[t]),Object(c.jsx)(e.context.Provider,{value:n,children:e.children})})),z=v(null,(e=>{const[t,n]=Object(a.useState)();Object(a.useEffect)((()=>{i()}),[]);const i=()=>{const e=o()().subtract(1,"month"),t=e.format("M"),i=e.format("YYYY");n(i+"/"+t)};return Object(c.jsx)(e.context.Provider,{value:t,children:e.children})})),U=l.a.createContext({state:null,dispatch:null})},120:function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return d}));var i=n(0),a=n(11),l=n(85),r=n(18),o=n(103),s=n(1);const d=Object(i.createContext)({requestUpdateDeviceById:null,requestFetchVehicles:null}),c={LOADING:!1,LOADED:!1,RESULT:[],RESULT_VEHICLES_BY_ORG:null,RESULT_USERS_BY_ORG:null,MESSAGE:"SUPERDEVICE_REQ_DEFAULT",MESSAGE_NEW_DEVICE:null,MESSAGE_VEHICLES_BY_ORG:"",MESSAGE_USERS_BY_ORG:"",MESSAGE_DEVICE_CONNECT:"",MESSAGE_DEVICE_UPDATE:null,ERROR:void 0},u={LOADING:!1,LOADED:!1,RESULT:[],MESSAGE_NEW_ORG:"",MESSAGE:""},v={LOADING:!1,LOADED:!1,RESULT:null,RESULT_BY_ID:null,MESSAGE:null,MESSAGE_POST:"VEHICLE_REQUEST_REQ_POST_DEFAULT",RESULT_POST:null},j=e=>{let{children:t}=e;const[n,j]=Object(i.useState)(c),[h,p]=Object(i.useState)(u),[b,O]=Object(i.useState)(v);console.log("devices",n);const m=Object(i.useCallback)((()=>{j(c),p(u),O(v)}),[]);return Object(s.jsx)(d.Provider,{value:{devices:n,orgs:h,vehicles:b,resetState:m,requestConnectDevice:e=>{const t=async function(e){let{orgNew:t,vehicleNew:n,driverNew:i,dataOrg:l,dataVehicle:r,dataDriver:o,userEmailInvite:s,selectedDeviceId:d}=e;const c=n,u=i,v=l,j=r,h=o;let p,b,O=null,m=null;if(p=t?await a.a.postOrganization(v):{organizationId:v.organizationId},null!==j){var g;if(c)j.organizationId=null===(g=p)||void 0===g?void 0:g.organizationId,O={vehicleId:(await a.a.postSuperVehicle(j,p.organizationId)).id};else O={vehicleId:j.vehicleId};if(null!==h){if(u){var f;Object.assign(h,{permittedVehicles:[{id:O.vehicleId}],defaultVehicles:[O.vehicleId]}),h.organizationId=null===(f=p)||void 0===f?void 0:f.organizationId,h.roles=["DRIVER"],m=await a.a.postNewUser(h,p.organizationId)}else{m=h;const e={permittedVehicles:[{id:O.vehicleId}],defaultVehicles:[O.vehicleId]};await a.a.patchUser(m.userId,e);const t={permittedDrivers:[{id:m.userId,displayName:m.displayName?m.displayName:""}]};await a.a.patchVehicle(O.vehicleId,t)}const e={userId:m.userId};await a.a.putCheckCurrentDriver(O.vehicleId,e)}}return b=null!==O?{organizationId:p.organizationId,installedVehicle:O.vehicleId,physicalLocation:"Somewhere"}:{organizationId:p.organizationId,physicalLocation:"Somewhere"},await a.a.patchAdminDevices(d,b),a.a.getDeviceById(d)}(e);return console.debug("MODAL CONNECT PROMISE",t),t.then((e=>{console.log("requestConnectDevice",e),j({...n,RESULT:n.RESULT.map((t=>t.deviceId===e.deviceId?{...t,...e}:t)),MESSAGE_DEVICE_CONNECT:{message:"Koppling lyckades!",type:"SUCCESS"}})})).catch((e=>{let t=Object(o.a)(e.response.data);console.log(t),j({...n,ERROR:"Koppling misslyckades!"})}))},requestCreateNewDevice:e=>function(e){console.log("SuperAdminSagas.js ","createNewDevice ",JSON.stringify(e));let t=null!==e&&void 0!==e&&e.specifiedTimeOfDay?"?specifiedTimeOfDay="+(null===e||void 0===e?void 0:e.specifiedTimeOfDay):"";return Object(l.a)({url:"".concat(r.a,"/admin/devices")+t,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:e})}(e).then((e=>{a.a.getDeviceById(e).then((e=>{j({...n,LOADING:!1,LOADED:!0,MESSAGE_NEW_DEVICE:{message:"Enhet tillagd!",type:"SUCCESS"},RESULT:[...n.RESULT,e]})}))})).catch((e=>{j({LOADING:!1,LOADED:!1,ERROR:Object(o.a)(e.response.data)})})),requestFetchDevices:()=>(j({...n,LOADING:!0,LOADED:!1}),Object(l.a)({url:"".concat(r.a,"/admin/devices"),method:"GET"}).then((e=>{j({...n,MESSAGE:"Alla enheter h\xe4mtade",LOADING:!1,LOADED:!0,RESULT:e})})).catch((e=>{j({...n,MESSAGE:"SUPERDEVICE_REQ_FAILED",LOADING:!1,RESULT:null})}))),requestUpdateDeviceById:e=>{let{selectedDeviceId:t,deviceUpdateData:i}=e;return a.a.patchAdminDevices(t,i).then((()=>{const e={...n,RESULT:n.RESULT.map((e=>e.deviceId===t?{...e,...i}:e))};j(e)})).catch((e=>{let t=Object(o.a)(e.response.data);console.log(t),j({...n,MESSAGE_DEVICE_UPDATE:{message:t,type:"ERROR"}})}))},requestVehicleCpuReset:e=>{let{organizationId:t,selectedDeviceId:i}=e;return a.a.vehicleCpuReset(t,i).then((e=>{console.log("cpu reset data onsuccess:",e),j({...n,MESSAGE_DEVICE_UPDATE:{message:"Lyckad omstart av enheten",type:"SUCCESS"}})})).catch((e=>{let t=Object(o.a)(e.response.data);console.log(t),j({...n,MESSAGE_DEVICE_UPDATE:{message:t,type:"ERROR"}})}))},requestVehiclesAndUsersByOrgId:e=>{let{organizationId:t}=e;const i=(a=t,Object(l.a)({url:"".concat(r.a,"/vehicles"),method:"GET",headers:{"X-Trackson-Organization":a}}));var a;const o=function(e){return Object(l.a)({url:"".concat(r.a,"/user"),method:"GET",headers:{"X-Trackson-Organization":e}})}(t);return Promise.all([i,o]).then((e=>{let[t,i]=e;j({...n,RESULT_VEHICLES_BY_ORG:t,RESULT_USERS_BY_ORG:i})})).catch((e=>{j({...n,MESSAGE:"FAILED MESSAGE"})}))},requestFetchOrganizations:()=>(j({...n,LOADING:!0,LOADED:!1}),Object(l.a)({url:"".concat(r.a,"/admin/organization"),method:"GET"}).then((e=>{p({...h,LOADING:!1,LOADED:!0,RESULT:e})})).catch((e=>{Object(o.a)(e.response.data);j({...n,LOADING:!1,LOADED:!0})}))),requestFetchVehicles:()=>(O({...b,LOADING:!0,LOADED:!1,MESSAGE:"VEHICLE_REQ_LOADING"}),Object(l.a)({url:"".concat(r.a,"/vehicles"),method:"get"}).then((e=>{O({...b,RESULT:e,LOADING:!1,LOADED:!0,MESSAGE:"VEHICLE_REQ_SUCCESS"})})).catch((e=>{O({...b,RESULT:null,LOADING:!1,LOADED:!1,MESSAGE:"VEHICLE_REQ_FAILED"})})))},children:t})}},122:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var i=n(171),a=n(248),l=n(932),r=n(933),o=n(0),s=n(6),d=n(1);const c=e=>{let{content:t,showAlertArchived:n,setShowAlertArchived:a}=e;const[r,c]=Object(o.useState)("1");return Object(d.jsxs)(i.a,{onTabClick:e=>{"3"===e?a(!n):c(e)},activeKey:r,defaultActiveKey:"1",children:[t,Object(d.jsx)(i.a.TabPane,{tab:Object(d.jsx)(l.a,{style:{fontSize:18,color:s.b.SWITCH_BUSINESS}})},"3")]})},u=e=>{let{message:t}=e;const n=Object(d.jsxs)(d.Fragment,{children:["Arkiverade fordon och anv\xe4ndare kommer inte att vara synliga i \xf6vriga vyer. Du kan \xe4ndra ditt val under Mitt konto ",Object(d.jsx)(r.a,{})," h\xf6gst upp till h\xf6ger."]});return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(a.a,{message:n,type:"info",showIcon:!0}),Object(d.jsx)("br",{})]})}},126:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const i={API_ENDPOINT_URL:"https://app.trackson.se/api2",DEBUG_ENDPOINT_URL:"https://app.trackson.se/api-debug",SHOW_DEV:!1},a=(console.log("Using PROD environment:",i),i)},130:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var i=n(0),a=n(11),l=n(1);const r=Object(i.createContext)({}),o=e=>{let{children:t}=e;const[n,o]=Object(i.useState)(!1),[s,d]=Object(i.useState)([]),[c,u]=Object(i.useState)([]);return Object(i.useEffect)((()=>{(async()=>{o(!0),a.a.getVehicles().then((e=>{o(!1),d(e)})).catch((e=>{o(!1)}))})()}),[]),Object(l.jsx)(r.Provider,{value:{vehicles:s,loadingVehicles:n,selectedVehicles:c,setSelectedVehicles:u,updateVehicle:async(e,t)=>a.a.patchVehicle(e,t).then((e=>{const t=e;if(t){let e=[...s];const n=s.findIndex((e=>e.id===t.id));n>-1&&(e[n]=t,d(e))}return!0})).catch((e=>(console.log(e),!1))),addVehicle:async e=>a.a.postVehicle(e).then((e=>(console.log(e),!0))).catch((e=>(console.log(e),!1))),deleteVehicle:async e=>{const t=s.findIndex((t=>t.id===e)),n=c.findIndex((t=>t.key===e));a.a.deleteVehicle(e).then((e=>{if(console.log(e),t>-1&&n>-1)return s.splice(t,1),c.splice(n,1),!0})).catch((e=>(console.error(e),!1)))},changeVehicleOrg:async(e,t)=>{await a.a.patchVehicle(e.key,{organizationId:t}).then((e=>{console.log(e)})).catch((e=>console.error(e)))},updateUserCertificate:async(e,t,n)=>{a.a.patchAttestUser(e,t,n).then((e=>console.log(e))).catch((e=>console.error(e)))},updateVehicleFrequencyUpdate:async(e,t)=>{await a.a.patchTrackerUpdateFrequency(e,t).then((e=>console.log("Update Successfully!"))).catch((e=>console.error(e)))},updateVehicleCurrentPosition:async e=>{await a.a.postVehicleTracking(e).then((e=>console.log("Update Successfully!"))).catch((e=>console.error(e)))}},children:t})}},131:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var i=n(0),a=n(11),l=n(1);const r=Object(i.createContext)({}),o=e=>{let{children:t}=e;const[n,o]=Object(i.useState)([]),[s,d]=Object(i.useState)(),[c,u]=Object(i.useState)([]);return Object(i.useEffect)((()=>{(async()=>{a.a.getUsers().then((e=>{o(e)})).catch((e=>console.log(e)))})(),(async()=>{await a.b.getCurrentUser().then((e=>d(e))).catch((e=>console.error(e)))})()}),[]),Object(l.jsx)(r.Provider,{value:{users:n,selectedUsers:c,currentUser:s,setSelectedUsers:u,createNewUser:async e=>{console.log(e),a.a.postNewUser(e).then((e=>(console.log(e),!0))).then((e=>(console.error(e),!1)))},updateUser:async(e,t)=>{console.log(e,t),a.a.patchUser(e,t).then((e=>(console.log(e),!0))).catch((e=>(console.error(e),!1)))},deleteUser:async e=>{const t=n.findIndex((t=>t.userId===e)),i=c.findIndex((t=>t.key===e));a.a.deleteUser(e).then((e=>{if(console.log(e),i>-1&&i>-1)return n.splice(t,1),c.splice(i,1),!0})).catch((e=>(console.error(e),!1)))},changeUserOrg:async(e,t)=>{await a.a.patchUser(e.key,{organizationId:t}).then((e=>{console.log(e)})).catch((e=>console.error(e)))}},children:t})}},135:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(91),a=n(57);n(0);const l={androidCar:i.androidCar,androidContact:i.androidContact,bus:a.bus,home:a.home,road:a.road,glass:a.glass,briefcase:a.briefcase,wrench:a.wrench,shoppingCart:a.shoppingCart,truck:a.truck,bolt:a.bolt,cutlery:a.cutlery,lightbulbO:a.lightbulbO,ambulance:a.ambulance,bank:a.bank,plug:a.plug,paintBrush:a.paintBrush,androidDrafts:i.androidDrafts,androidHome:i.androidHome,androidGlobe:i.androidGlobe,androidAlert:i.androidAlert}},138:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var i=n(11),a=n(66),l=n.n(a),r=n(95),o=n(1);const s=(e,t,n)=>{let a,r=l.a.tz.guess(),o={};o={valueKm:t.valueKm,recordedTimeMs:t.applyRetroactive?1e3*l.a.tz(null===t||void 0===t?void 0:t.recordedTimeMs,r).unix():null,fromTimeMs:null,applyRetroactive:t.applyRetroactive},i.a.putUpdateOdometer(e,o).then((i=>{a=(null===i||void 0===i?void 0:i.odometer)/1e3,d(),n&&a&&(n(t,e,a),console.log(a))}))},d=()=>{r.a.success({content:Object(o.jsxs)("div",{children:[Object(o.jsx)("p",{children:"M\xe4tarst\xe4llning uppdaterad."}),Object(o.jsx)("p",{children:"Det kan dr\xf6ja n\xe5gra minuter innan ditt fordon visar det uppdaterade v\xe4rdet."})]})})},c=e=>{var t,n,i;return null!==e&&void 0!==e&&null!==(t=e.odometer)&&void 0!==t&&t.valueKm?(null===e||void 0===e||null===(n=e.odometer)||void 0===n||null===(i=n.valueKm)||void 0===i?void 0:i.toLocaleString())+" km":"Info saknas"}},147:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n(0);var i=n(141),a=n(1);const l=e=>Object(a.jsx)(i.a,{image:i.a.PRESENTED_IMAGE_SIMPLE,description:e})},159:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return c}));var i=n(19);const a=e=>({type:i.j,payload:e}),l=e=>({type:i.a,token:e}),r=()=>(console.log("Sign out action"),{type:i.o,payload:"signout-please"}),o=()=>({type:i.p}),s=e=>({type:i.h,message:e}),d=()=>({type:i.c}),c=()=>({type:i.i})},168:function(e,t,n){"use strict";var i=n(55);t.a=i.a},18:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"h",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"i",(function(){return v})),n.d(t,"g",(function(){return j}));var i=n(90),a=n(126);const l="Trackson",r="AIzaSyCbkUCf4MxGQaKOo92M-0I7yQx9QKAuG_g",o={key:r,libraries:"places"},s=a.a.API_ENDPOINT_URL,d="/app",c="/auth",u=!1,v={navCollapsed:!1,sideNavTheme:i.e,navType:i.a,topNavColor:"#3e82f7",headerNavColor:"",mobileNav:!1,currentTheme:"dark",locale:"sv",darkMapStyle:!0},j=[41465,41186,30714,45768,23033]},184:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ut})),n.d(t,"b",(function(){return $t}));var i=n(0),a=n.n(i),l=n(973),r=n(927),o=n(932),s=n(962),d=n(938),c=n(939),u=n(972),v=n(965),j=n(951),h=n(394),p=n(954),b=n(926),O=n(974),m=n(36),g=n(120),f=n(54),x=n(95),y=n(63),E=n(93),I=n(101),S=n(166),T=n(382),k=n(379),C=n(110),_=n(60),A=n(125),N=n(966),R=n(955),D=n(967),w=n(968),L=n(937),P=n(969),V=n(542),M=n(970),F=n(944),z=n(543),U=n(396),B=n(104),G=n.n(B),H=n(45),Y=(n(72),n(2)),W=n(6),K=n(20),q=n(1);const J="existing_driver_id",Q="existing_organization_organizationId",Z="existing_vehicle_id",X="new_driver_display_name",$="new_driver_email",ee="new_driver_roll",te="new_org_bussiness_name",ne="new_org_country",ie="new_org_county",ae="new_org_email",le="new_org_num",re="new_org_phone",oe="new_org_postal_code",se="new_org_street_address",de="new_org_password",ce="new_vehicle_alias",ue="new_vehicle_regnum",ve="new_vehicle_default_trip_type",je="new_vehicle_benefit_type",he="sendInvite",pe="country_code",be=1,Oe=12,me={existing_vehicle_id:null,existing_driver_id:null,new_vehicle_regnum:null,new_vehicle_benefitType:W.c[2].TYPE,new_vehicle_defaultTripType:W.d[1].TYPE,dataVehicle:null,dataDriver:null,existing_organization_organizationId:null,country_code:null,new_driver_roll:"DRIVER"},ge=n(181);ge.registerLocale(n(182));const fe=ge.getNames("sv",{select:"alias"}),xe=Object.entries(fe).map((e=>{let[t,n]=e;return{key:t,label:n}})).sort(((e,t)=>e.label.localeCompare(t.label))),ye=e=>{let{vehicleKnownNew:t,onVehicleChangeNew:n,orgNotKnown:i}=e;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,0],children:Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(T.a,{style:{backgroundColor:t?W.b.SWITCH_PRIVATE:W.b.SWITCH_BUSINESS,minWidth:100},checkedChildren:Y.f.NEW_VEHICLE,unCheckedChildren:Y.f.LIST_VEHICLES,onChange:i?null:n,checked:t})})})})},Ee=e=>{let{driverKnownNew:t,onDriverChangeNew:n,useNewOrganization:i}=e;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,0],children:Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(T.a,{style:{backgroundColor:t?W.b.SWITCH_PRIVATE:W.b.SWITCH_BUSINESS,minWidth:100},checkedChildren:Y.f.NEW_DRIVER,unCheckedChildren:Y.f.LIST_DRIVERS,onChange:i?null:n,checked:t})})})})},Ie=e=>{let{vehicleKnown:t,onVehicleChange:n,formValues:i,useNewOrganization:l}=e;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,15],children:Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(T.a,{style:{backgroundColor:t?W.b.SWITCH_PRIVATE:W.b.SWITCH_BUSINESS,minWidth:100},disabled:!l&&!i.existing_organization_organizationId,checkedChildren:Y.f.KNOWN,unCheckedChildren:Y.f.UNKNOWN,onChange:n,checked:t})})})})},Se=e=>{let{driverKnown:t,onDriverChange:n,vehicleKnown:i}=e;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,15],children:Object(q.jsx)(I.a,{span:8,children:Object(q.jsx)(T.a,{style:{backgroundColor:t?W.b.SWITCH_PRIVATE:W.b.SWITCH_BUSINESS,minWidth:100},disabled:!i,checkedChildren:Y.f.KNOWN,unCheckedChildren:Y.f.UNKNOWN,onChange:n,checked:t})})})})},Te=e=>{let{newOrExistingOrg:t,onOrgSwitchChange:n}=e;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,15],children:Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(T.a,{style:{backgroundColor:t?W.b.SWITCH_PRIVATE:W.b.SWITCH_BUSINESS,minWidth:100},checkedChildren:Y.f.NEW_ORG_SHORT,unCheckedChildren:Y.f.EXISTING,onChange:n,checked:t})})})})},ke=e=>{let{resetOnOrgChanges:t,setFormValues:n,formValues:l,org:r,orgTreeData:o}=e;const s=Object(i.useContext)(g.a);return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,0],justify:"left",children:Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(f.a.Item,{name:[Q],rules:[{required:!0,message:Y.f.SELECT_AN_EXISTING_ORGANISATION}],children:Object(q.jsx)(k.a,{suffixIcon:Object(q.jsx)(v.a,{style:{marginRight:3}}),style:{width:"100%"},value:r,showSearch:!0,autoComplete:!1,filterOption:(e,t)=>{var n;return null===t||void 0===t||null===(n=t.title)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:o,placeholder:Y.f.CHOOSE_AN_ORG,treeDefaultExpandAll:!0,onChange:e=>{t(e),s.requestVehiclesAndUsersByOrgId({organizationId:e})}})})})})})},Ce=e=>{let{formValues:t,setFormValues:n}=e;return Object(q.jsxs)(a.a.Fragment,{children:[Object(q.jsxs)(E.a,{gutter:[5,0],justify:"left",children:[Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[le],rules:[{required:!1,message:Y.f.SUPPLY_A_NEW_ORG}],children:Object(q.jsx)(C.a,{minLength:be,maxLength:Oe,type:"number",placeholder:Y.f.SUPPLY_A_NEW_ORG,prefix:Object(q.jsx)(N.a,{style:{marginRight:3}}),onChange:e=>n({...t,new_organization_number:e.target.value})})})}),Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[te],rules:[{required:!0,message:Y.f.SUPPLY_A_NEW_BUSINESS_NAME}],children:Object(q.jsx)(C.a,{style:{width:"100%"},type:"text",prefix:Object(q.jsx)(R.a,{style:{marginRight:3}}),placeholder:Y.f.SUPPLY_A_NEW_BUSINESS_NAME,onChange:e=>n({...t,new_org_business_name:e.target.value})})})})]}),Object(q.jsxs)(E.a,{gutter:[5,0],justify:"left",children:[Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[re],rules:[{required:!1,message:Y.f.SUPPLY_A_NEW_ORG_PHONE}],children:Object(q.jsx)(C.a,{style:{width:"100%"},type:"tel",prefix:Object(q.jsx)(D.a,{style:{marginRight:3}}),placeholder:Y.f.SUPPLY_A_NEW_ORG_PHONE,onChange:e=>n({...t,new_org_phone:e.target.value})})})}),Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[ae],rules:[{required:!1,message:Y.f.SUPPLY_A_NEW_ORG_EMAIL}],children:Object(q.jsx)(C.a,{style:{width:"100%"},type:"email",autoComplete:"new-password",prefix:Object(q.jsx)(w.a,{style:{marginRight:3}}),placeholder:Y.f.SUPPLY_A_NEW_ORG_EMAIL,onChange:e=>n({...t,new_org_email:e.target.value})})})})]}),Object(q.jsx)(E.a,{gutter:[5,0],justify:"right",children:Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[de],rules:[{required:!1,message:Y.f.SUPPLY_A_NEW_ORG_PASSWORD}],children:Object(q.jsx)(C.a.Password,{style:{width:"100%"},minLength:1,autoComplete:"new-password",prefix:Object(q.jsx)(L.a,{style:{marginRight:3}}),placeholder:Y.f.SUPPLY_A_NEW_ORG_PASSWORD,onChange:e=>n({...t,new_org_password:e.target.value})})})})}),Object(q.jsxs)(E.a,{gutter:[5,0],justify:"left",children:[Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[se],rules:[{message:Y.f.SUPPLY_A_NEW_ORG_STREET_ADDRESS}],children:Object(q.jsx)(C.a,{style:{width:"100%"},type:"text",prefix:Object(q.jsx)(P.a,{style:{marginRight:3}}),placeholder:Y.f.SUPPLY_A_NEW_ORG_STREET_ADDRESS,onChange:e=>n({...t,new_org_street_address:e.target.value})})})}),Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[oe],rules:[{message:Y.f.SUPPLY_A_NEW_ORG_POSTAL_CODE}],children:Object(q.jsx)(C.a,{style:{width:"100%"},type:"number",placeholder:Y.f.SUPPLY_A_NEW_ORG_POSTAL_CODE,onChange:e=>n({...t,new_org_postal_code:e.target.value})})})})]}),Object(q.jsxs)(E.a,{gutter:[5,0],justify:"left",children:[Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[ie],rules:[{message:Y.f.SUPPLY_A_NEW_ORG_COUNTY}],children:Object(q.jsx)(C.a,{style:{width:"100%"},type:"text",placeholder:Y.f.SUPPLY_A_NEW_ORG_COUNTY,onChange:e=>n({...t,new_org_county:e.target.value})})})}),Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[ne],rules:[{message:Y.f.SUPPLY_A_NEW_ORG_COUNTRY}],children:Object(q.jsx)(C.a,{style:{width:"100%"},placeholder:Y.f.SUPPLY_A_NEW_ORG_COUNTRY,onChange:e=>n({...t,new_org_country:e.target.value})})})})]})]})},_e=e=>{let{formValues:t,setFormValues:n,selectedDevice:i}=e;return Object(q.jsxs)(a.a.Fragment,{children:[Object(q.jsxs)(E.a,{gutter:[16,0],justify:"left",children:[Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[ue],rules:[{message:Y.f.SUPPLY_A_REG_NUM}],children:Object(q.jsx)(C.a,{prefix:Object(q.jsx)(b.a,{style:{marginRight:3}}),onChange:e=>n({...t,new_vehicle_regnum:e.target.value}),placeholder:Y.f.SUPPLY_A_REG_NUM})})}),Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[ce],rules:[{required:!(null!==t&&void 0!==t&&t.new_vehicle_regnum),message:Y.f.SUPPLY_AN_ALIAS}],children:Object(q.jsx)(C.a,{prefix:Object(q.jsx)(V.a,{style:{marginRight:3}}),onChange:e=>n({...t,new_vehicle_displayName:e.target.value}),placeholder:Y.f.SUPPLY_AN_ALIAS})})})]}),Object(q.jsxs)(E.a,{gutter:[16,0],justify:"left",children:[Object(q.jsx)(I.a,{span:8,children:Object(q.jsx)(f.a.Item,{name:[je],initialValue:W.c[2].TYPE,rules:[{required:!0,message:Y.f.SUPPLY_A_BENEFIT_TYPE}],children:Object(q.jsx)(_.a,{suffixIcon:Object(q.jsx)(M.a,{style:{marginRight:3}}),onChange:e=>n({...t,new_vehicle_benefitType:e}),style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:Y.f.SUPPLY_A_BENEFIT_TYPE,defaultValue:W.c[2].TYPE,children:W.c.map((e=>Object(q.jsx)(_.a.Option,{value:e.TYPE,children:"".concat(e.TYPE_DISPLAY_TEXT)},"opt_".concat(e.TYPE))))})})}),Object(q.jsx)(I.a,{span:8,children:Object(q.jsx)(f.a.Item,{name:[ve],initialValue:W.d[1].TYPE,rules:[{required:!0,message:Y.f.SUPPLY_A_DEFAULT_TRIP_TYPE}],children:Object(q.jsx)(_.a,{suffixIcon:Object(q.jsx)(F.a,{style:{marginRight:3}}),onChange:e=>n({...t,new_vehicle_defaultTripType:e}),style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:Y.f.SUPPLY_A_DEFAULT_TRIP_TYPE,defaultValue:W.d[1].TYPE,children:W.d.map((e=>Object(q.jsx)(_.a.Option,{value:e.TYPE,children:"".concat(e.TYPE_DISPLAY_TEXT)},"opt_".concat(e.TYPE))))})})}),Object(q.jsx)(I.a,{span:8,children:Object(q.jsx)(f.a.Item,{name:[pe],noStyle:!0,children:Object(q.jsx)(_.a,{allowClear:!0,showSearch:!0,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.children))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},name:"isoCountryCode",onChange:e=>n({...t,country_code:e}),placeholder:"Ange landskod",style:{width:"100%"},children:xe.map((e=>Object(q.jsxs)(_.a.Option,{value:e.key,children:[e.label," (",e.key,")"]})))})})})]})]})},Ae=e=>{let{formValues:t,setFormValues:n}=e;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[16,0],justify:"left",children:Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(f.a.Item,{name:[ce],rules:[{required:!(null!==t&&void 0!==t&&t.new_vehicle_regnum),message:Y.f.SUPPLY_AN_ALIAS}],children:Object(q.jsx)(C.a,{prefix:Object(q.jsx)(V.a,{style:{marginRight:3}}),onChange:e=>n({...t,new_vehicle_displayName:e.target.value}),placeholder:Y.f.SUPPLY_AN_ALIAS})})})})})},Ne=e=>{let{formValues:t,setFormValues:n,selectData:i,placeholder:l}=e;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,0],justify:"left",children:Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(f.a.Item,{name:[Z],rules:[{required:!0,message:Y.f.SELECT_AN_EXISTING_VEHICLE}],children:Object(q.jsx)(_.a,{allowClear:!0,showSearch:!0,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.children))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},suffixIcon:Object(q.jsx)(b.a,{style:{marginRight:3}}),onChange:e=>n({...t,existing_vehicle_id:e}),value:t.existing_vehicle_id,style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:l,children:i.map((e=>Object(q.jsxs)(_.a.Option,{value:e.id,children:["".concat(e.registry," - ").concat(e.displayName," ")," "]},"opt_".concat(e))))})})})})})},Re=e=>{let{formValues:t,setFormValues:n}=e;const[l,r]=Object(i.useState)(!1);return Object(q.jsxs)(a.a.Fragment,{children:[Object(q.jsxs)(E.a,{gutter:[15,0],justify:"left",children:[Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[X],rules:[{required:!0,message:Y.f.SUPPLY_A_FIRST_LAST_NAME}],children:Object(q.jsx)(C.a,{prefix:Object(q.jsx)(z.a,{style:{marginRight:3}}),onChange:e=>n({...t,new_driver_display_name:e.target.value}),placeholder:Y.f.SUPPLY_A_FIRST_LAST_NAME})})}),Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(f.a.Item,{name:[$],rules:[{required:!0,message:Y.f.SUPPLY_AN_EMAIL_ADDRESS}],children:Object(q.jsx)(C.a,{prefix:Object(q.jsx)(U.a,{style:{marginRight:3}}),type:"email",onChange:e=>n({...t,new_driver_email:e.target.value}),placeholder:Y.f.SUPPLY_AN_EMAIL_ADDRESS})})})]}),Object(q.jsxs)(E.a,{gutter:[15,0],justify:"right",children:[Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(f.a.Item,{name:[ee],children:Object(q.jsxs)(_.a,{allowClear:!0,showSearch:!0,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.children))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},mode:"multiple",placeholder:"V\xe4lj roll",onChange:e=>n({...t,new_driver_roll:e}),children:[Object(q.jsx)(Option,{value:W.k.ADMIN,children:"F\xf6retagsadmin"}),",",Object(q.jsx)(Option,{value:W.k.DRIVER,children:"F\xf6rare"})]})})}),Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(f.a.Item,{initialValue:!1,name:[he],rules:[{type:"boolean"}],children:Object(q.jsx)(A.a,{onChange:()=>{r(!l),n({...t,new_driver_send_invite:!l})},children:Y.f.SEND_INVITE})})})]})]})},De=e=>{let{formValues:t,setFormValues:n,selectData:i,placeholder:l}=e;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,20],justify:"left",children:Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(f.a.Item,{name:[J],rules:[{required:!0,message:Y.f.SELECT_AN_EXISTING_DRIVER}],children:Object(q.jsx)(_.a,{allowClear:!0,showSearch:!0,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.children))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},suffixIcon:Object(q.jsx)(v.a,{style:{marginRight:3}}),onChange:e=>n({...t,existing_driver_id:e}),style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:l,children:null===i||void 0===i?void 0:i.map((e=>Object(q.jsxs)(_.a.Option,{value:e.userId,children:["".concat(e.displayName," - ").concat(e.displayEmail)," "]},"opt_".concat(e))))})})})})})};var we=e=>{var t,n,a,l;let{visible:r,handleAdd:o,handleClose:s,selectedDevice:d,orgData:c}=e;const[u]=f.a.useForm(),[,v]=Object(i.useState)({}),[j,h]=Object(i.useState)(me),p=Object(i.useContext)(g.a),b=p.devices.RESULT_VEHICLES_BY_ORG,O=p.devices.RESULT_USERS_BY_ORG,[T,k]=Object(i.useState)(!1),[C,_]=Object(i.useState)(!1),[A,N]=Object(i.useState)(!1),[R,D]=Object(i.useState)(!1),[w,L]=Object(i.useState)(!1),P=e=>{var t;k(null===d||void 0===d||null===(t=d.device)||void 0===t?void 0:t.isTracker),_(!1),N(!1),D(!1),j.existing_vehicle_id=null,j.existing_driver_id=null,j.existing_organization_organizationId=e||null,j.dataDriver=null,j.dataVehicle=null,j.country_code=null,h({existing_organization_organizationId:e})};console.log("selectedDevice",d);const V=Object(H.m)(c),M=Object(H.f)(b||[],j.existing_organization_organizationId),F=O?O.filter((e=>e.organizationId===j.existing_organization_organizationId)):[],z=d.device.imei?d.device.imei:"-",U=d.device.deviceType?d.device.deviceType:"-";Object(i.useEffect)((()=>{v({})}),[]);const B=()=>{let e=null,t=null,n=null,i=!1,a=null,l=!1,r=!1,o=!1,s=!1;if(w?(e=H.c.createNewOrgObject(j.new_org_business_name?j.new_org_business_name:"",j.new_org_email?j.new_org_email:null,j.new_org_password?j.new_org_password:null,j.new_organization_number?j.new_organization_number:"",j.new_org_email?j.new_org_email:null,j.new_org_phone?j.new_org_phone:"",{streetAndNum:j.new_org_street_address?j.new_org_street_address:"",zip:j.new_org_postal_code?parseInt(j.new_org_postal_code):11111,city:"",state:j.new_org_county?j.new_org_county:"",country:j.new_org_country?j.new_org_country:""},{streetAndNum:"",zip:11111,city:"",state:"",country:""}),i=!0,a=1):(e=H.c.createExistingOrgObject(j.existing_organization_organizationId),i=!1),T)if(T&&!C)t=H.c.createExistingVehicleObject(j.existing_vehicle_id?j.existing_vehicle_id:null),l=!1,o=!0;else{var c,u;t=H.c.createNewVehicleObject("CAR",j.new_vehicle_regnum?j.new_vehicle_regnum:null,j.new_vehicle_displayName?j.new_vehicle_displayName:"",{color:Object(K.i)(),marker:null!==d&&void 0!==d&&null!==(c=d.device)&&void 0!==c&&c.isTracker?"wrench":"androidCar"},[],null,j.new_vehicle_defaultTripType?j.new_vehicle_defaultTripType:W.a.BUSINESS,j.new_vehicle_benefitType?j.new_vehicle_benefitType:null!==d&&void 0!==d&&null!==(u=d.device)&&void 0!==u&&u.isTracker?W.c[3].TYPE:W.c[2].TYPE,!1,a||null,j.country_code),l=!0,o=!1}else l=!1,o=!1;A?A&&!R?(n=H.c.createExistingDriverObject(j.existing_driver_id?j.existing_driver_id:null),r=!1,s=!0):(n=H.c.createNewDriverObject(j.new_driver_display_name?j.new_driver_display_name:"",j.new_driver_email?j.new_driver_email:"",j.new_driver_roll?j.new_driver_roll:["DRIVER"],j.new_driver_send_invite||!1,a||null),r=!0,s=!1):(r=!1,s=!1),p.requestConnectDevice({orgNew:i,orgNewId:a,vehicleNew:l,driverNew:r,vehicleExisting:o,driverExisting:s,dataOrg:e,dataVehicle:t,dataDriver:n,userEmailInvite:j.new_driver_send_invite,selectedDeviceId:d.device.deviceId})};return Object(q.jsx)(x.a,{title:Y.g.CONNECT_TO_ORG,visible:r,onCancel:()=>s(),footer:[Object(q.jsx)(y.a,{onClick:()=>s(),children:Y.f.BTN_ABORT},"back"),Object(q.jsx)(y.a,{type:"primary",onClick:()=>{console.log(u.validateFields()),u.validateFields().then((()=>{console.log("No error - Run onFinish"),B(),s()})).catch((e=>{console.log(" ~ file: ModalFormDeviceConnect.jsx ~ line 161 ~ validateFieldsAndSubmit ~ error",e),console.log("Error: ",e)}))},children:Y.f.BTN_CONNECT},"submit")],width:640,children:Object(q.jsxs)(f.a,{form:u,layout:"vertical",labelCol:{span:8},wrapperCol:{span:24},name:"device_connect_form",children:[Object(q.jsx)(E.a,{gutter:[0,0],justify:"left",children:Object(q.jsxs)(I.a,{children:[Object(q.jsxs)(G.a,{level:4,children:[U," "]}),Object(q.jsxs)(m.a,{level:5,children:[z," "]})]})}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsx)(E.a,{gutter:[0,5],children:Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(G.a,{level:4,children:Y.f.ORG})})}),Object(q.jsx)(E.a,{gutter:[0,5],justify:"left",children:Object(q.jsx)(Te,{newOrExistingOrg:w,onOrgSwitchChange:()=>{L(!w),u.resetFields(),j.existing_vehicle_id=null,j.existing_driver_id=null,j.existing_organization_organizationId=null,j.dataDriver=null,j.dataVehicle=null,j.country_code=null,P()}})}),w?Object(q.jsx)(Ce,{formValues:j,setFormValues:h}):Object(q.jsx)(ke,{formValues:j,initialState:me,setFormValues:h,resetOnOrgChanges:P,orgTreeData:V}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsx)(E.a,{gutter:[0,0],children:Object(q.jsxs)(I.a,{span:24,children:[Object(q.jsx)(E.a,{gutter:[0,5],children:Object(q.jsx)(I.a,{span:24,children:null!==d&&void 0!==d&&null!==(t=d.device)&&void 0!==t&&t.isTracker?Object(q.jsx)(G.a,{level:4,children:"Utrustning"}):Object(q.jsx)(G.a,{level:4,children:Y.f.VEHICLE})})}),Object(q.jsxs)(E.a,{gutter:[0,0],children:[Object(q.jsx)(I.a,{span:6,children:Object(q.jsx)(Ie,{vehicleKnown:T,onVehicleChange:!(null!==d&&void 0!==d&&null!==(n=d.device)&&void 0!==n&&n.isTracker)&&(()=>{k(!T),N(!1),D(!1),w&&_(!0)}),useNewOrganization:w,formValues:j})}),T?Object(q.jsx)(I.a,{span:6,children:Object(q.jsx)(ye,{vehicleKnownNew:C,onVehicleChangeNew:()=>{_(!C)},orgNotKnown:w})}):null]}),T&&!C?Object(q.jsx)(Ne,{formValues:j,setFormValues:h,selectData:M,placeholder:Y.f.SELECT_AN_EXISTING_VEHICLE}):T&&C?null!==d&&void 0!==d&&null!==(a=d.device)&&void 0!==a&&a.isTracker?Object(q.jsx)(Ae,{formValues:j,setFormValues:h}):Object(q.jsx)(_e,{formValues:j,setFormValues:h}):null]})}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsx)(E.a,{gutter:[0,0],children:Object(q.jsxs)(I.a,{span:24,children:[Object(q.jsx)(E.a,{gutter:[0,5],children:Object(q.jsx)(I.a,{span:6,children:null!==d&&void 0!==d&&null!==(l=d.device)&&void 0!==l&&l.isTracker?Object(q.jsx)(G.a,{level:4,children:"Anv\xe4ndare"}):Object(q.jsx)(G.a,{level:4,children:Y.f.DRIVER})})}),Object(q.jsxs)(E.a,{gutter:[0,0],children:[Object(q.jsx)(I.a,{span:6,children:Object(q.jsx)(Se,{driverKnown:A,onDriverChange:()=>{N(!A),w&&D(!0)},vehicleKnown:T})}),A?Object(q.jsx)(I.a,{span:6,children:Object(q.jsx)(Ee,{driverKnownNew:R,onDriverChangeNew:()=>{D(!R)},useNewOrganization:w})}):null]}),A&&!R?Object(q.jsx)(De,{formValues:j,setFormValues:h,selectData:F,placeholder:Y.f.SELECT_AN_EXISTING_DRIVER}):A&&R?Object(q.jsx)(Re,{formValues:j,setFormValues:h}):null]})})]})})},Le=n(325),Pe=n(38),Ve=n(92),Me=n(62);var Fe=e=>{var t,n,a,l,r,o,s,d,c,u,v,j,h,p,b,O;let{visible:m,handleAdd:g,handleClose:I,selectedDevice:T}=e;const[k,_]=Object(i.useState)(!1),A=T.device.imei?T.device.imei:"-",N=T.device.iccid?T.device.iccid:"-",R=null!==T&&void 0!==T&&null!==(t=T.device)&&void 0!==t&&null!==(n=t.organizationId)&&void 0!==n&&n.fullName?T.device.organizationId.fullName:"-",D=T.device.phone?T.device.phone:"-";let w="-",L="-";null!==T.device.status&&(w=T.device.status.latestBatteryLevel?T.device.status.latestBatteryLevel:"-",L=T.device.status.timestampMs?Object(q.jsx)(Me.a,{value:T.device.status.timestampMs}):"-");null===T||void 0===T||null===(a=T.device)||void 0===a||null===(l=a.installedVehicle)||void 0===l||l.state;let P=null!==T&&void 0!==T&&null!==(r=T.device)&&void 0!==r&&null!==(o=r.installedVehicle)&&void 0!==o&&null!==(s=o.state)&&void 0!==s&&s.odometer?T.device.installedVehicle.state.odometer+" km":"-";const V=null!==T&&void 0!==T&&null!==(d=T.device)&&void 0!==d&&null!==(c=d.installedVehicle)&&void 0!==c&&c.registry?T.device.installedVehicle.registry.toUpperCase():"-",M=null!==T&&void 0!==T&&null!==(u=T.device)&&void 0!==u&&u.configName?T.device.configName:"-",F=null!==T&&void 0!==T&&null!==(v=T.device)&&void 0!==v&&v.firmware?T.device.firmware:"-",z=null!==T&&void 0!==T&&null!==(j=T.device)&&void 0!==j&&j.obd?T.device.obd:"-",U=null!==(h=T.device.installedVehicle)&&void 0!==h&&h.id?null===(p=T.device)||void 0===p?void 0:p.installedVehicle:"-",B=null!==(b=T.device.installedVehicle)&&void 0!==b&&b.displayName?null===(O=T.device.installedVehicle)||void 0===O?void 0:O.displayName:"-",G=T.device.installedVehicle?T.device.installedVehicle.displayName:"-",H=T.device.dataUsed?T.device.dataUsed:"-",W=()=>{_(!k)};return console.log("Seldevice",T),Object(q.jsxs)(x.a,{title:Y.g.DISPLAY_UNIT,visible:m,onOk:()=>{I()},onCancel:()=>I(),children:[Object(q.jsx)(Pe.h,{level:3,title:U.registry}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsxs)(E.a,{gutter:[0,20],children:[Object(q.jsx)(Pe.k,{span:20,title:Y.f.CONFIG,text:M}),Object(q.jsx)(Pe.k,{span:8,title:Y.f.IMEI,text:A}),Object(q.jsx)(Pe.k,{span:8,title:Y.f.FIRMWARE,text:F})]}),Object(q.jsxs)(E.a,{gutter:[0,20],children:[Object(q.jsx)(Pe.k,{span:8,title:Y.f.ICCID,text:N}),Object(q.jsx)(Pe.k,{span:8,title:Y.f.PHONE_NUMBER,text:D}),Object(q.jsx)(Pe.k,{span:8,title:Y.f.DATA_BLOCK,text:H})]}),Object(q.jsxs)(E.a,{gutter:[0,20],children:[Object(q.jsx)(Pe.k,{span:8,title:Y.f.ORG,text:R}),Object(q.jsx)(Pe.k,{span:8,title:Y.f.DRIVER,text:G}),Object(q.jsx)(Pe.k,{span:8,title:Y.f.REG_NUM_SHORT,text:V+" "+B})]}),Object(q.jsxs)(E.a,{gutter:[0,0],children:[Object(q.jsx)(Pe.i,{span:8,title:Y.f.HEART_BEAT,icon:L||null}),Object(q.jsx)(Pe.i,{span:8,title:Y.f.BATTERY,icon:w?Object(q.jsx)(Le.a,{batteryLevel:w}):Object(q.jsx)(Le.a,{batteryLevel:50})}),Object(q.jsx)(Pe.i,{span:8,title:Y.f.OBD,icon:z?Object(q.jsx)(Pe.b,{obd:!0}):Object(q.jsx)(Pe.b,{obd:!1})})]}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsx)(E.a,{gutter:[0,10],align:"middle",children:Object(q.jsx)(Pe.g,{level:4,span:8,title:Y.f.MILEAGE_FULL})}),Object(q.jsxs)(E.a,{gutter:[15,0],children:[Object(q.jsx)(Ve.a,{span:12,children:Object(q.jsxs)(f.a.Item,{style:{minWidth:300},name:["setmilage"],rules:[{}],children:[Object(q.jsx)(C.a,{disabled:!0,placeholder:P,value:P}),Object(q.jsx)(K.f,{onCancel:W,record:U,visible:k,updateOdometer:(e,t,n)=>{P=n}})]})}),Object(q.jsx)(Ve.a,{span:12,children:Object(q.jsxs)(y.a,{disabled:!(null!==U&&void 0!==U&&U.id),type:"secondary",onClick:W,children:[Y.f.BTN_CALIBRATE," "]})})]})]})},ze=n(220),Ue=n(73),Be=n(196),Ge=n(393),He=n(86),Ye=n.n(He),We=n(11),Ke=n(971),qe=n(115),Je=n(144),Qe=n(312);n(66);const Ze={hardware:W.j[0],imei:null,phone:null,iccid:null,err_iccid:"",err_hardware:null,err_imei:"Min 14 max 16 tecken",err_phone:"",timestampStartOfUse:null,specifiedTimeOfDay:null},Xe="V\xe4lj h\xe5rdvara",$e="Ange ICCID",et="Ange IMEI",tt="Ange telefonnr.",nt=e=>{let{onHardWareClickChange:t}=e;return Object(q.jsx)(f.a.Item,{rules:[{required:!0,message:Xe}],children:Object(q.jsx)(_.a,{onChange:t,style:{width:"100%"},defaultValue:W.j[0],placeholder:Xe,children:W.j.map((e=>Object(q.jsx)(_.a.Option,{value:e,children:e},"opt_".concat(e))))})})},it=e=>{let{formValues:t,onHandleIccidChange:n,hasFocus:i,iccidValidate:a}=e;const l=t.isTracker;return Object(q.jsx)(f.a.Item,{disabled:l,name:Y.f.ICCID,validateStatus:null,valuePropName:t.iccid,help:t.err_iccid,rules:[{required:t.isTracker,message:$e,type:"number"}],children:Object(q.jsx)(C.a,{disabled:l,allowClear:!0,style:{width:"100%"},autoFocus:i,onPressEnter:()=>null,onChange:e=>n(e),placeholder:$e,value:t.iccid})})},at=e=>{let{formValues:t,onHandleImeiChange:n,hasFocus:i}=e;return Object(q.jsx)(f.a.Item,{name:Y.f.IMEI,rules:[{required:!0,message:et},{min:14,message:"Min 14 tecken"},{max:16,message:"Max 16 tecken"}],children:Object(q.jsx)(C.a,{allowClear:!0,inputMode:"tel",ref:i,onPressEnter:e=>null,onChange:e=>n(e),placeholder:et})})},lt=e=>{var t;let{formValues:n,onHandlePhoneChange:i,onHandlePhoneRequest:a}=e;const l=9===(null===(t=n.phone)||void 0===t?void 0:t.length)?"success":"warning";return Object(q.jsx)(f.a.Item,{name:Y.f.PHONE_NUMBER,inputMode:"numeric",valuePropName:n.phone,validateStatus:null!==n&&void 0!==n&&n.isTracker?l:"",help:(null===n||void 0===n?void 0:n.isTracker)&&"9 tecken",children:Object(q.jsx)(C.a,{allowClear:!0,minLength:14,inputMode:"tel",onPressEnter:e=>null,suffix:Object(q.jsx)(Ue.a,{title:"H\xe4mta Telefonnummer",children:Object(q.jsx)("a",{style:{width:"100%",height:"100%"},onClick:a,children:Object(q.jsx)(u.a,{style:{fontSize:"18px"}})})}),style:{width:"100%"},onChange:e=>i(e),placeholder:tt,value:n.phone})})};function rt(e){let{onHandleTimestampStartOfUseChange:t}=e;return Object(q.jsx)(f.a.Item,{name:W.k.timestampStartOfUse,rules:[{required:!1}],children:Object(q.jsx)(ze.a,{style:{width:"100%"},onChange:e=>t(null===e||void 0===e?void 0:e.unix())})})}function ot(e){let{onHandleSpecifiedTimeOfDay:t,formValues:n}=e;const i=!n.isTracker;return Object(q.jsx)(f.a.Item,{disabled:i,name:"specifiedTimeOfDay",rules:[{required:!1}],children:Object(q.jsx)(ze.a.TimePicker,{disabled:i,style:{width:"100%"},format:"HH:mm",onChange:(e,n)=>t(e,n)})})}var st=()=>{const[e]=f.a.useForm(),[t,n]=Object(i.useState)(Ze),[l,r]=Object(i.useState)(500),o=Object(i.useRef)(null),s=Object(i.useRef)(null),[d,c]=Object(i.useState)(),[u,v]=Object(i.useState)(!1),[j,h]=Object(i.useState)(null),p=Object(i.useContext)(g.a),b=p.devices.MESSAGE_NEW_DEVICE,O=p.devices.MESSAGE_DEVICE_CONNECT;Object(i.useEffect)((()=>{o.current&&o.current.iccid.focus()}),[o]),Object(i.useEffect)((()=>{t.isTracker&&(n({...t,iccid:Ze.iccid}),s.current.focus())}),[t.isTracker]),Object(i.useEffect)((()=>{b&&("SUCCESS"===b.type?qe.b.success(b.message):"ERROR"===b.type&&qe.b.error(b.message))}),[b]);Object(i.useEffect)((()=>{O&&("SUCCESS"===O.type?qe.b.success(O.message):"ERROR"===O.type&&qe.b.error(O.message))}),[O]);Object(i.useEffect)((()=>{null===t.iccid&&!t.isTracker||null===t.phone||null===t.imei?h(!1):h(!0)}),[t]),Object(i.useEffect)((()=>{const e=setTimeout((()=>{u&&t.iccid&&We.a.getPhoneFromJasper(t.iccid).then((e=>{console.log(t.iccid),s.current.focus(),e&&h(!0),c(e),m(e)})).catch((e=>{console.log(e)}))}),1e3);return()=>clearTimeout(e)}),[t.iccid,u]);const m=e=>{n({...t,phone:e,err_phone:""})},x=i=>{let a=[null!==i.hardware,null!=i.imei,null!=i.phone].every((e=>!0===e));console.log(t,i),a?(p.requestCreateNewDevice({iccid:t.iccid,imei:t.imei,phone:t.phone,deviceType:"".concat(t.hardware),organizationId:null,timestampStartOfUse:t.timestampStartOfUse,specifiedTimeOfDay:t.specifiedTimeOfDay}),e.resetFields(),h(null),n(Ze)):(qe.b.info("Ett eller flera f\xe4lt saknar korrekt v\xe4rde!"),console.log("Formvals",t))};return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(f.a,{form:e,onFinish:x,onFinishFailed:e=>console.log(e),style:{width:"100%",margin:"auto"},layout:{labelCol:{span:8},wrapperCol:{span:16}},name:"add_unit_form",children:Object(q.jsxs)(E.a,{gutter:[15,20],align:"top",children:[Object(q.jsxs)(I.a,{span:[3],children:[Object(q.jsx)(Je.a.Text,{children:Y.f.HARDWARE}),Object(q.jsx)(nt,{onHardWareClickChange:e=>{n({...t,hardware:e,isTracker:e.includes(["GL530MG"])})}})]}),Object(q.jsxs)(I.a,{span:[4],children:[Object(q.jsx)(Je.a.Text,{children:Y.f.ICCID}),Object(q.jsx)(it,{formValues:t,onHandleIccidChange:e=>{const i=e.target.value;console.log("value: ",i);H.o.isValidIccid(i),i.length;v(!0),n({...t,iccid:i,err_iccid:""})},hasFocus:o,iccidValidate:j})]}),Object(q.jsxs)(I.a,{span:[4],children:[Object(q.jsx)(Je.a.Text,{children:Y.f.IMEI}),Object(q.jsx)(at,{formValues:t,onHandleImeiChange:e=>{const i=e.target.value;H.o.isValidImei(i),i.length;n({...t,imei:i,err_imei:""})},hasFocus:s})]}),Object(q.jsxs)(I.a,{span:[4],children:[Object(q.jsx)(Je.a.Text,{children:t.isTracker?"SIM-ID":Y.f.PHONE_NUMBER}),Object(q.jsx)(lt,{phoneFill:d,formValues:t,onHandlePhoneChange:e=>{const i=e.target.value;H.o.isValidPhone(i),i.length;n({...t,phone:i,err_phone:""})},onHandlePhoneRequest:()=>{if(u)try{We.a.getPhoneFromJasper(t.iccid).then((e=>{console.log(t.iccid),console.log("phone: ",e),c(e),e&&h(!0)})),n({...t,phone:d})}catch(e){h(!1),e.response&&404===e.response.status?qe.b.error("MISSING_ICCID"):qe.b.error("UNEXPECTED ERROR")}else qe.b.error("ICCID INTE KORREKT!"),n({...t,phone:null})}})]}),Object(q.jsxs)(I.a,{span:[3],children:[Object(q.jsx)(Je.a.Text,{children:Y.f.START_OF_USE}),Object(q.jsx)(rt,{formValues:t,onHandleTimestampStartOfUseChange:e=>{n({...t,timestampStartOfUse:e})}})]}),Object(q.jsxs)(I.a,{span:[3],children:[Object(q.jsx)(Je.a.Text,{children:"Tidpunkt f\xf6r uppdatering"}),Object(q.jsx)(ot,{formValues:t,onHandleSpecifiedTimeOfDay:(e,i)=>{const a=null===e||void 0===e?void 0:e.toISOString(),l=new Date(a),r=l.getUTCHours().toString().padStart(2,"0")+l.getUTCMinutes().toString().padStart(2,"0");n({...t,specifiedTimeOfDay:r})}})]}),Object(q.jsxs)(I.a,{span:[3],children:[Object(q.jsx)(Je.a.Text,{style:{opacity:0},children:"REMOVE THIS"}),Object(q.jsx)(f.a.Item,{children:t.isTracker?Object(q.jsx)(Qe.a,{title:"Sl\xe5 p\xe5 enheten innan du trycker p\xe5 OK",onConfirm:()=>{x(t)},okText:"OK",cancelText:"Avbryt",disabled:!j,children:Object(q.jsx)(y.a,{style:{width:150},type:"primary",icon:Object(q.jsx)(Ke.a,{}),disabled:!j,children:Y.f.BTN_ADD_UNIT})}):Object(q.jsx)(y.a,{style:{width:150},type:"primary",icon:Object(q.jsx)(Ke.a,{}),onClick:()=>{x(t)},disabled:!j,children:Y.f.BTN_ADD_UNIT})}),"                    "]})]})})})};const{RangePicker:dt}=ze.a,ct=e=>{let{span:t,title:n,text:i}=e;return Object(q.jsxs)(I.a,{span:t,children:[Object(q.jsx)(E.a,{gutter:[0,0],justify:"left",children:Object(q.jsxs)(G.a,{level:4,children:[n," "]})}),Object(q.jsx)(E.a,{gutter:[0,0],justify:"left",children:Object(q.jsxs)(Ye.a,{children:[i," "]})})]})},ut=e=>{let{span:t,title:n,text:i}=e;return Object(q.jsxs)(I.a,{span:t,children:[Object(q.jsx)(E.a,{gutter:[0,0],justify:"left",children:Object(q.jsxs)(G.a,{level:5,children:[n," "]})}),Object(q.jsx)(E.a,{style:{overflowWrap:"break-word",wordWrap:"break-word"},gutter:[0,0],justify:"left",children:Object(q.jsxs)(Ye.a,{style:{overflowWrap:"break-word",wordWrap:"break-word"},children:[i," "]})})]})},vt=e=>{let{logg:t}=e;const n=Object(i.useState)({bordered:!1,loading:!1,pagination:{position:"topRight"},size:"small",title:()=>"Logg",showHeader:!0,rowSelection:!1,scroll:void 0,hasData:!0,tableLayout:void 0,top:"none",bottom:"bottomRight"});let l={};const r=t.map((e=>(l={fileId:e.fileId?e.fileId:"ID",imei:e.imei?e.imei:"IMEI",tsFromMs:e.tsFromMs?e.tsFromMs:"From YYYY-MM-DD",tsToMs:e.tsToMs?e.tsToMs:"To YYYY-MM-DD",date:e.date?e.date:"YYYY-MM-DD"},l)));function o(e){We.a.getLoggAVLFileId(e)}console.log(r);const s=[{key:W.f.FIELD_ID,dataIndex:W.f.FIELD_ID,title:Y.d.FIELD_ID,render:e=>e?Object(q.jsx)(Ue.a,{title:Y.f.BTN_DOWNLOAD_SEL,children:Object(q.jsx)("a",{onClick:()=>o(e),children:e})}):Object(q.jsxs)(Ye.a,{children:[" ","-"," "]})},{key:W.f.DATE_FROM,dataIndex:W.f.DATE_FROM,title:Y.d.DATE_FROM,render:e=>e?Object(q.jsx)(Me.a,{value:e,typ:"map"}):Object(q.jsxs)(Ye.a,{children:[" ","-"," "]})},{key:W.f.DATE_TO,dataIndex:W.f.DATE_TO,title:Y.d.DATE_TO,render:e=>e?Object(q.jsx)(Me.a,{value:e,typ:"map"}):Object(q.jsxs)(Ye.a,{children:[" ","-"," "]})},{key:W.f.FIELD_ID,dataIndex:W.f.FIELD_ID,render:e=>e?Object(q.jsx)(Ue.a,{title:Y.f.BTN_DOWNLOAD_SEL,children:Object(q.jsx)("a",{onClick:()=>o(e),children:Object(q.jsx)(u.a,{style:{fontSize:"18px"}})})}):Object(q.jsxs)(Ye.a,{children:[" ","-"," "]})}];return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,0],justify:"left",children:Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(Be.a,{...n[0],dataSource:r,columns:s,pagination:{position:["topRight"],pageSize:[3]},bordered:!1})})})})},jt=e=>{let{visible:t,onSaveDevice:n,onCancel:i,device:a}=e;const[l]=f.a.useForm(),r="V\xe4lj h\xe5rdvara",o="Ange ICCID",s="Ange telefonnr.";return Object(q.jsx)(x.a,{visible:t,title:Y.f.EDIT_DEVICE+" IMEI "+a.imei,okText:Y.f.BTN_SAVE,cancelText:Y.f.BTN_ABORT,onCancel:i,onOk:()=>{l.validateFields().then((e=>{l.resetFields(),n(e),console.log(e)})).catch((e=>{console.log("Validate Failed:",e)}))},children:Object(q.jsxs)(f.a,{form:l,layout:"vertical",name:"form_in_modal",initialValues:a,children:[Object(q.jsx)(f.a.Item,{name:W.k.deviceType,label:Y.f.HARDWARE,rules:[{required:!1,message:r}],children:Object(q.jsx)(_.a,{style:{width:"100%"},defaultValue:W.j[0],placeholder:r,children:W.j.map((e=>Object(q.jsx)(_.a.Option,{value:e,children:e},"opt_".concat(e))))})}),Object(q.jsx)(f.a.Item,{name:W.k.iccid,label:Y.f.ICCID,rules:[{required:!1,message:o}],children:Object(q.jsx)(C.a,{allowClear:!0,style:{width:"100%"},onPressEnter:()=>null,minLength:18,maxLength:22,placeholder:o})}),Object(q.jsx)(f.a.Item,{name:W.k.phone,label:Y.f.PHONE_NUMBER,inputMode:"numeric",rules:[{required:!1,message:s}],children:Object(q.jsx)(C.a,{allowClear:!0,minLength:14,inputMode:"tel",onPressEnter:e=>null,style:{width:"100%"},placeholder:s})})]})})};var ht=e=>{var t,n,a,l,r,o,s,d,c;let{visible:u,handleAdd:v,handleClose:j,selectedDevice:h,setSelectedDevice:p,requestFetchDevices:b}=e;const[,O]=Object(i.useState)({}),[m,T]=Object(i.useState)(null),[k,C]=Object(i.useState)(null),[_,A]=Object(i.useState)([]),[N]=f.a.useForm(),R=Object(i.useContext)(g.a),D=h.device.imei?h.device.imei:"-",w=null!==h&&void 0!==h&&null!==(t=h.device)&&void 0!==t&&null!==(n=t.organizationId)&&void 0!==n&&n.fullName?h.device.organizationId.fullName:"-",L=h.device.installedVehicle?Y.k[h.device.installedVehicle.benefitType]:"-",P=(h.device.mileAge&&h.device.mileAge,null!==(a=h.device.installedVehicle)&&void 0!==a&&a.registry?null===(l=h.device.installedVehicle)||void 0===l?void 0:l.registry:"-"),V=null!==(r=h.device.installedVehicle)&&void 0!==r&&r.displayName?null===(o=h.device.installedVehicle)||void 0===o?void 0:o.displayName:"-",M=h.device.configName?h.device.configName:"-",F=h.device.iccid?h.device.iccid:"-",z=h.device.deviceType?h.device.deviceType:"-",U=h.device.phone?h.device.phone:"-",B=h.device.firmware?h.device.firmware:"-",H=(h.device.obd&&h.device.obd,h.device.vehicle&&h.device.vehicle,null!==(s=h.device)&&void 0!==s&&s.deviceId?null===(d=h.device)||void 0===d?void 0:d.deviceId:"-"),W=(h.device.installedVehicle&&h.device.installedVehicle.displayName,h.device.dataBlock&&h.device.dataBlock,h.device.installedVehicle?null===(c=h.device.installedVehicle.defaultDriver)||void 0===c?void 0:c.displayName:"-");h.device.dateTime&&h.device.dateTime,h.device.dateTime&&h.device.dateTime;function K(){We.a.getLoggAVLForImei(D||null).then((e=>{A(e),console.log(e)}))}console.log("MODAL AVL",h,h.device.deviceId,H),Object(i.useEffect)((()=>{O({})}),[]),Object(i.useEffect)((()=>{K()}),[]);return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(x.a,{title:Y.g.AVL,visible:u,onOk:()=>{},onCancel:j(),footer:[Object(q.jsx)(y.a,{type:"primary",onClick:j(),children:Y.f.BTN_CLOSE},"submit")],children:Object(q.jsxs)(f.a,{form:N,layout:"vertical",labelCol:{span:8},wrapperCol:{span:24},onFinish:e=>{console.log(e),j()},name:"device_info_form",children:[Object(q.jsxs)(E.a,{gutter:[0,10],justify:"left",children:[Object(q.jsx)(ct,{span:10,title:Y.f.IMEI,text:D}),Object(q.jsx)(ct,{span:8,title:Y.f.HARDWARE,text:z}),Object(q.jsx)(Ue.a,{title:Y.f.BTN_CHANGE,children:Object(q.jsx)(y.a,{type:Ut,icon:Object(q.jsx)(Ge.a,{}),onClick:()=>(console.log(h.device),void C(!0)),children:Y.f.BTN_CHANGE})})]}),Object(q.jsxs)(E.a,{gutter:[0,10],justify:"left",children:[Object(q.jsx)(ct,{span:10,title:Y.f.ICCID,text:F}),Object(q.jsx)(ct,{span:10,title:Y.f.PHONE_NUMBER,text:U})]}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsxs)(E.a,{gutter:[0,10],justify:"left",children:[Object(q.jsx)(ut,{span:8,title:Y.f.ORG,text:w}),Object(q.jsx)(ut,{span:8,title:Y.f.PRIMARY_DRIVER,text:W}),Object(q.jsx)(ut,{span:8,title:Y.f.BENEFIT_TYPE,text:L})]}),Object(q.jsxs)(E.a,{gutter:[0,10],justify:"left",children:[Object(q.jsx)(ut,{span:8,title:Y.f.REG_NUM,text:P}),Object(q.jsx)(ut,{span:8,title:Y.f.ALIAS,text:V}),Object(q.jsx)(ut,{span:8,title:Y.f.FIRMWARE_SHORT,text:B})]}),Object(q.jsxs)(G.a,{level:5,children:[Y.f.CONFIG_SHORT," "]}),Object(q.jsxs)(Ye.a,{style:{overflowWrap:"break-word",wordWrap:"break-word"},children:[M," "]}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsxs)(E.a,{gutter:[0,0],justify:"space-between",children:[Object(q.jsx)(I.a,{span:12,children:Object(q.jsx)(G.a,{span:6,level:4,children:"Skapa AVL logg"})}),Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),Object(q.jsx)(E.a,{gutter:[0,0],justify:"left",children:Object(q.jsx)(dt,{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",placeholder:["Start Time","End Time"],onChange:function(e,t){console.log("Selected Time: ",e),console.log("Formatted Selected Time: ",t)},onOk:function(e){console.log("onOk: ",e),T(e)}})}),Object(q.jsx)(E.a,{gutter:[0,0],align:"middle",children:Object(q.jsx)(I.a,{span:4,children:Object(q.jsxs)(y.a,{type:"primary",onClick:()=>(()=>{if((null===m||void 0===m?void 0:m.length)>0){console.log("AVL date for ",D,1e3*m[0].unix(),m[1].valueOf());const e={imei:D,start:m[0].valueOf(),stop:m[1].valueOf()},t="AVL "+D;We.a.getAVLLogFromTo(e,t).then((e=>{K(),console.log("get logg")}))}})(),children:["H\xe4mta"," "]})})})]}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsx)(vt,{logg:_})]})}),Object(q.jsx)(jt,{visible:k,onSaveDevice:e=>{console.log("MODAL SAVE DEVICE",H,e),R.requestUpdateDeviceById({selectedDeviceId:H,deviceUpdateData:e}).then((()=>{C(!1)}))},device:h.device,onCancel:()=>{C(!1)}})]})},pt=n(258);const bt=e=>{let{handleDownloadClick:t}=e;return Object(q.jsx)(Ve.a,{span:8,children:Object(q.jsx)(y.a,{type:"secondary",onClick:t,children:Y.f.BTN_DOWNLOAD_SEL})})},Ot=e=>{let{logg:t}=e;const n=Object(i.useState)({bordered:!1,loading:!1,pagination:{position:"top"},size:"small",title:!1,showHeader:!0,rowSelection:!1,scroll:void 0,hasData:!0,tableLayout:void 0,top:"none",bottom:"bottomRight"});let l={};const r=t.map((e=>(l={date:e.date?e.date:"YYYY-MM-DD",tsFromMs:e.tsFromMs?e.tsFromMs:"From YYYY-MM-DD",tsToMs:e.tsToMs?e.tsToMs:"To YYYY-MM-DD"},l))),o=[{key:"download",dataIndex:"download",title:Object(q.jsx)(u.a,{style:{padding:5}}),render:()=>Object(q.jsx)(A.a,{})},{key:W.f.DATE,dataIndex:W.f.DATE,title:Y.d.DATE,sorter:(e,t)=>e.value-t.value,render:e=>e?Object(q.jsx)(Ye.a,{children:e}):Object(q.jsxs)(Ye.a,{children:[" ","-"," "]})},{key:W.f.DATE_FROM,dataIndex:W.f.DATE_FROM,title:Y.d.DATE_FROM,render:e=>e?Object(q.jsx)(Ye.a,{children:e}):Object(q.jsxs)(Ye.a,{children:[" ","-"," "]})},{key:W.f.DATE_TO,dataIndex:W.f.DATE_TO,title:Y.d.DATE_TO,render:e=>e?Object(q.jsx)(Ye.a,{children:e}):Object(q.jsxs)(Ye.a,{children:[" ","-"," "]})}];return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(Ve.a,{span:24,children:Object(q.jsx)(Be.a,{...n[0],dataSource:r,columns:o,pagination:{position:["topRight"],pageSize:[8]}})})})};var mt=e=>{let{visible:t,handleClose:n,selectedDevice:a}=e;const[,l]=Object(i.useState)({}),[r]=f.a.useForm(),o=a.device.imei?a.device.imei:"-";Object(i.useEffect)((()=>{l({})}),[]);return Object(q.jsx)(x.a,{title:Y.g.LOGG,visible:t,onOk:()=>{},onCancel:n(),footer:[Object(q.jsx)(y.a,{type:"primary",onClick:n(),children:Y.f.BTN_CLOSE},"submit")],children:Object(q.jsxs)(f.a,{form:r,layout:"vertical",labelCol:{span:8},wrapperCol:{span:24},onFinish:()=>{},name:"device_info_form",children:[Object(q.jsx)(E.a,{gutter:[0,0],children:Object(q.jsx)(Ve.a,{span:24,children:Object(q.jsx)(Pe.j,{title:Y.f.IMEI,text:o})})}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsx)(E.a,{gutter:[0,20],children:Object(q.jsx)(Ot,{logg:pt.a})}),Object(q.jsx)(E.a,{gutter:[0,20],justify:"end",children:Object(q.jsx)(bt,{handleDownloadClick:()=>{}})})]})})},gt=n(473);const ft=e=>{let{src:t}=e;return Object(q.jsx)(gt.a,{width:200,height:200,src:t||"error",fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3PTWBSGcbGzM6GCKqlIBRV0dHRJFarQ0eUT8LH4BnRU0NHR0UEFVdIlFRV7TzRksomPY8uykTk/zewQfKw/9znv4yvJynLv4uLiV2dBoDiBf4qP3/ARuCRABEFAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghgg0Aj8i0JO4OzsrPv69Wv+hi2qPHr0qNvf39+iI97soRIh4f3z58/u7du3SXX7Xt7Z2enevHmzfQe+oSN2apSAPj09TSrb+XKI/f379+08+A0cNRE2ANkupk+ACNPvkSPcAAEibACyXUyfABGm3yNHuAECRNgAZLuYPgEirKlHu7u7XdyytGwHAd8jjNyng4OD7vnz51dbPT8/7z58+NB9+/bt6jU/TI+AGWHEnrx48eJ/EsSmHzx40L18+fLyzxF3ZVMjEyDCiEDjMYZZS5wiPXnyZFbJaxMhQIQRGzHvWR7XCyOCXsOmiDAi1HmPMMQjDpbpEiDCiL358eNHurW/5SnWdIBbXiDCiA38/Pnzrce2YyZ4//59F3ePLNMl4PbpiL2J0L979+7yDtHDhw8vtzzvdGnEXdvUigSIsCLAWavHp/+qM0BcXMd/q25n1vF57TYBp0a3mUzilePj4+7k5KSLb6gt6ydAhPUzXnoPR0dHl79WGTNCfBnn1uvSCJdegQhLI1vvCk+fPu2ePXt2tZOYEV6/fn31dz+shwAR1sP1cqvLntbEN9MxA9xcYjsxS1jWR4AIa2Ibzx0tc44fYX/16lV6NDFLXH+YL32jwiACRBiEbf5KcXoTIsQSpzXx4N28Ja4BQoK7rgXiydbHjx/P25TaQAJEGAguWy0+2Q8PD6/Ki4R8EVl+bzBOnZY95fq9rj9zAkTI2SxdidBHqG9+skdw43borCXO/ZcJdraPWdv22uIEiLA4q7nvvCug8WTqzQveOH26fodo7g6uFe/a17W3+nFBAkRYENRdb1vkkz1CH9cPsVy/jrhr27PqMYvENYNlHAIesRiBYwRy0V+8iXP8+/fvX11Mr7L7ECueb/r48eMqm7FuI2BGWDEG8cm+7G3NEOfmdcTQw4h9/55lhm7DekRYKQPZF2ArbXTAyu4kDYB2YxUzwg0gi/41ztHnfQG26HbGel/crVrm7tNY+/1btkOEAZ2M05r4FB7r9GbAIdxaZYrHdOsgJ/wCEQY0J74TmOKnbxxT9n3FgGGWWsVdowHtjt9Nnvf7yQM2aZU/TIAIAxrw6dOnAWtZZcoEnBpNuTuObWMEiLAx1HY0ZQJEmHJ3HNvGCBBhY6jtaMoEiJB0Z29vL6ls58vxPcO8/zfrdo5qvKO+d3Fx8Wu8zf1dW4p/cPzLly/dtv9Ts/EbcvGAHhHyfBIhZ6NSiIBTo0LNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiEC/wGgKKC4YMA4TAAAAABJRU5ErkJggg=="})};var xt=e=>{let{visible:t,handleClose:n,selectedDevice:a}=e;const[,l]=Object(i.useState)({}),[r]=f.a.useForm(),o=a.device.installedVehicle?a.device.installedVehicle.benefitType:"-",s=a.device.carYear?a.device.carYear:"-",d=a.device.imgSrc?a.device.imgSrc:"-",c=a.device.voltageRange?a.device.voltageRange:"-",u=a.device.model?a.device.model:"-",v=(a.device.mileAge&&a.device.mileAge,a.device.installedVehicle?a.device.installedVehicle.registry:"ABC123");a.device.imei&&a.device.imei,a.device.firmware&&a.device.firmware,!!a.device.obd&&a.device.obd,a.device.vehicle&&a.device.vehicle,a.device.driver&&a.device.driver,a.device.dataBlock&&a.device.dataBlock;Object(i.useEffect)((()=>{l({})}),[]);return Object(q.jsx)(x.a,{title:Y.g.VEHICLE,visible:t,onOk:()=>{},onCancel:n(),footer:[Object(q.jsx)(y.a,{type:"primary",onClick:n(),children:"St\xe4ng"},"submit")],children:Object(q.jsxs)(f.a,{form:r,layout:"vertical",labelCol:{span:8},wrapperCol:{span:24},onFinish:()=>{},name:"device_vehicle_form",children:[Object(q.jsx)(E.a,{gutter:[0,10],align:"middle",justify:"center",children:Object(q.jsx)(Ve.a,{span:24,children:Object(q.jsx)(ft,{src:d})})}),Object(q.jsx)(E.a,{gutter:[0,20],align:"middle",justify:"center",children:Object(q.jsx)(Ve.a,{span:24,children:Object(q.jsx)(y.a,{type:"ghost",block:!0,style:{color:W.b.GREEN},onClick:()=>{qe.b.info("H\xe4mta from biluppgifter.se - OnClick f\xf6r "+v)},children:Y.f.BTN_FETCH_VEHICLE_INFO})})}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsxs)(E.a,{gutter:[0,0],children:[Object(q.jsx)(Pe.k,{span:6,title:Y.f.CAR_TYPE,text:o}),Object(q.jsx)(Pe.k,{span:6,title:Y.f.YEAR,text:s}),Object(q.jsx)(Pe.i,{span:6,title:Y.f.REG_NUM,icon:Object(q.jsx)(Pe.a,{text:v})}),Object(q.jsx)(Pe.k,{span:6,title:Y.f.Model,text:u})]}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsxs)(E.a,{gutter:[0,20],justify:"left",children:[Object(q.jsx)(Pe.k,{span:8,title:Y.f.VOLTAGE_RANGE,text:c}),Object(q.jsx)(Pe.k,{span:8,title:Y.f.PLACE_HOLDER_TITLE,text:Y.f.PLACE_HOLDER_TEXT})]})]})})};const yt="SKICKA",Et=e=>{let{logg:t}=e;const n=Object(i.useState)({bordered:!1,loading:!1,pagination:{position:"top"},size:"small",title:()=>Y.f.LOG,showHeader:!1,rowSelection:!1,scroll:void 0,hasData:!0,tableLayout:void 0,top:"none",bottom:"bottomRight"});let l={};const r=t.map((e=>(l={date_time:e.date_time?e.date_time:"Missing date-time",new_value:e.new_value?e.new_value:"Missing new value"},l))),o=[{key:W.h.DATE_TIME,dataIndex:W.h.DATE_TIME,title:Y.e.DATE_TIME,sorter:(e,t)=>e.value-t.value,render:e=>e?Object(q.jsx)(Ye.a,{children:e}):Object(q.jsxs)(Ye.a,{children:[" ","-"," "]})},{key:W.h.NEW_VALUE,dataIndex:W.h.NEW_VALUE,title:Y.e.NEW_VALUE,render:e=>e?Object(q.jsx)(Ye.a,{children:e}):Object(q.jsxs)(Ye.a,{children:[" ","-"," "]})}];return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(Be.a,{...n[0],dataSource:r,columns:o,pagination:{position:["topRight"],pageSize:[5]}})})})};var It=e=>{var t,n,a,l,r,o,s;let{visible:d,handleAdd:c,handleClose:u,selectedDevice:v}=e;const[j]=f.a.useForm(),[,h]=Object(i.useState)({}),[p,b]=Object(i.useState)(""),O=v.device.imei?v.device.imei:"-",m=null!==v&&void 0!==v&&null!==(t=v.device)&&void 0!==t&&null!==(n=t.organizationId)&&void 0!==n&&n.fullName?v.device.organizationId.fullName:"-",g=null!==v&&void 0!==v&&null!==(a=v.device)&&void 0!==a&&null!==(l=a.installedVehicle)&&void 0!==l&&l.defaultTripType?v.device.installedVehicle.defaultTripType:"-",T=null!==v&&void 0!==v&&null!==(r=v.device)&&void 0!==r&&null!==(o=r.installedVehicle)&&void 0!==o&&null!==(s=o.defaultDriver)&&void 0!==s&&s.displayName?v.device.installedVehicle.defaultDriver.displayName:"-";Object(i.useEffect)((()=>{h({})}),[]),Object(i.useEffect)((()=>{h({})}),[]);return Object(q.jsx)(x.a,{title:Y.g.C12SMS,visible:d,onOk:()=>{},onCancel:u(),children:Object(q.jsxs)(f.a,{form:j,layout:"vertical",labelCol:{span:8},wrapperCol:{span:24},onFinish:()=>{},name:"device_sms_form",children:[Object(q.jsx)(E.a,{gutter:[0,10],children:Object(q.jsx)(I.a,{span:24,children:Object(q.jsx)(Pe.j,{title:Y.f.IMEI,text:O})})}),Object(q.jsxs)(E.a,{gutter:[0,0],children:[Object(q.jsx)(Pe.k,{span:8,title:Y.f.ORG,text:m}),Object(q.jsx)(Pe.k,{span:8,title:Y.f.PRIMARY_DRIVER,text:T}),Object(q.jsx)(Pe.k,{span:8,title:Y.f.CAR_TYPE,text:g})]}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsx)(E.a,{gutter:[15,0],children:Object(q.jsx)(f.a.Item,{style:{width:"100%"},name:["command-dropdown"],children:Object(q.jsx)(Pe.e,{array:W.g,placeholder:Y.f.CHOOSE_QUICK_COMMAND,onChangeFunc:e=>{const t=e;b(t),j.setFieldsValue({getinfo:t})}})})}),Object(q.jsxs)(E.a,{gutter:[15,0],children:[Object(q.jsx)(I.a,{span:16,children:Object(q.jsx)(f.a.Item,{style:{width:"100%"},name:["getinfo"],rules:[{}],children:Object(q.jsx)(C.a,{type:"text",placeholder:Y.f.GET_INFO})})}),Object(q.jsx)(I.a,{span:8,children:Object(q.jsx)(y.a,{type:"secondary",style:{width:"100%"},onClick:()=>{qe.b.info("ModalFormDeviceSMS: ","SKICKA onClick!")},children:yt})})]}),Object(q.jsx)(E.a,{gutter:[0,20],children:Object(q.jsx)(Et,{logg:pt.b})})]})})};n(377),n(85);const St=Y.g.ADD_AN_UNIT;var Tt=e=>{let{visible:t,handleAdd:n,handleClose:i}=e;const[a]=f.a.useForm();return Object(q.jsx)(x.a,{title:St,visible:t,onOk:e=>{a.submit()},onCancel:i(),children:Object(q.jsxs)(f.a,{form:a,onFinish:e=>{console.log(e),console.log("FIX DEVICE POST"),i()},layout:"vertical",name:"userForm",children:[Object(q.jsx)(f.a.Item,{name:"imei",label:"IMEI",rules:[{required:!0,message:"Ange IMEI nr!"}],children:Object(q.jsx)(C.a,{placeholder:"1234567898765432"})}),Object(q.jsx)(f.a.Item,{name:"deviceType",label:"Typ av enhet",rules:[{required:!0,message:"V\xe4lj typ av enhet!"}],children:Object(q.jsx)(_.a,{children:"selectDevices"})}),Object(q.jsx)(f.a.Item,{name:"iccid",label:"ICCID",rules:[{required:!0,message:"Ange ICCID nr!"}],children:Object(q.jsx)(C.a,{placeholder:"1234567898765432"})}),Object(q.jsx)(f.a.Item,{name:"phone",label:"Telefonnummer",rules:[{required:!0,message:"Ange telefonnummer!"}],children:Object(q.jsx)(C.a,{placeholder:"1234567898765432"})}),Object(q.jsx)(f.a.Item,{name:"installedVehicle",label:"Ansluten till bilen",rules:[{required:!1}],children:Object(q.jsx)(_.a,{children:"selectVehicle"})})]})})},kt=n(171),Ct=n(464),_t=n(185),At=n(210),Nt=n(19);const Rt="selected_org_id",Dt={selected_org_id:null},wt=e=>{let{formValues:t,setFormValues:n,org:i,orgTreeData:l}=e;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(E.a,{gutter:[0,0],justify:"left",children:Object(q.jsx)(Ve.a,{span:24,children:Object(q.jsx)(f.a.Item,{name:[Rt],rules:[{required:!0,message:Y.f.SELECT_AN_EXISTING_ORGANISATION}],children:Object(q.jsx)(k.a,{suffixIcon:Object(q.jsx)(v.a,{style:{marginRight:3}}),style:{width:"100%"},defaultValue:i,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:l,placeholder:Y.f.CHOOSE_AN_ORG,treeDefaultExpandAll:!0,onChange:e=>{n({...t,selected_org_id:e})}})})})})})};var Lt=e=>{let{visible:t,handleClose:n,handleOrg:a,selectedDevice:l,orgData:r}=e;const[o]=f.a.useForm(),[s,d]=Object(i.useState)(Dt),c=Object(H.m)(r),u=l.device?l.device.imei:"-",v=l.device,j=v.organizationId.organizationId;return console.log("FORMVALUES::::",s),console.log("FORMVALUES::ORGANIZATION_ID::",s.selected_org_id),Object(q.jsx)(x.a,{title:Y.g.CHANGE_ORG,visible:t,onOk:()=>a(v,s.selected_org_id),onCancel:n(),children:Object(q.jsxs)(f.a,{form:o,layout:"vertical",labelCol:{span:8},wrapperCol:{span:24},name:"device_change_org_form",children:[Object(q.jsx)(Pe.k,{span:24,title:"Avser IMEI",text:u}),Object(q.jsx)(S.a,{dashed:!0}),Object(q.jsx)(E.a,{gutter:[0,0],children:Object(q.jsx)(Ve.a,{span:24,children:Object(q.jsx)(wt,{formValues:s,setFormValues:d,orgTreeData:c,org:j})})})]})})},Pt=n(51),Vt=n(82),Mt=n(168),Ft=n(214);const zt=kt.a.TabPane,Ut="link",Bt=e=>{let{devices:t,vehicles:n,orgData:a,getOnomondoSMS:v,getCheckQueclinkHistory:j,getNewConfig:h,openUserModal:p,setWarningsCount:b,onHandleFwConfigReq:O,showModalWithConfig:f,searchText:E,selectedOrganizations:I}=e;const S=Object(i.useContext)(g.a);let T={};const k=t?Object(H.i)(t):[],C=n||[],_=[...k].map((e=>(T={deviceId:e.deviceId?e.deviceId:null,imei:e.imei?e.imei:null,organizationId:e.organizationId?Object(H.j)(e.organizationId,a):null,iccid:e.iccid?e.iccid:null,phone:e.phone?H.l.phoneNumber(e.phone):null,deviceType:e.deviceType?e.deviceType:null,firmware:e.firmware?e.firmware:"-",configName:e.configName?e.configName:"-",installedVehicle:e.installedVehicle?Object(H.k)(e.installedVehicle,C):null,physicalInstallTimestamp:e.physicalInstallTimestamp?H.l.millisToDate(e.physicalInstallTimestamp):null,physicalLocation:e.physicalLocation?e.physicalLocation:null,retired:e.retired?e.retired:null,isTracker:e.isTracker,smsControl:e.smsControl,status:e.status?{timestampMs:e.status.timestampMs?e.status.timestampMs:null,uplinkLoss:e.status.uplinkLoss?e.status.uplinkLoss:null,latestBatteryLevel:e.status.latestBatteryLevel?e.status.latestBatteryLevel:null,latestSeenPositiveSpeed:e.status.latestSeenPositiveSpeed?e.status.latestSeenPositiveSpeed:null}:null},T))),A=Object(H.a)(_,E,I),N=100,R=150,D=150,w=100,L=150,P=100,V=100,M=100,F=100,z=100,U=120,B=[{key:W.k.typeError,dataIndex:W.k.typeError,title:Y.f.TYPE_ERROR,width:N,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.phone,dataIndex:W.k.phone,title:Y.f.PHONE_NUMBER,width:R,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.imei,dataIndex:W.k.imei,title:Y.f.IMEI,width:D,fixed:"",render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.firmware,dataIndex:W.k.firmware,title:Y.f.FIRMWARE_SHORT,width:w,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.config,dataIndex:W.k.config,title:Y.f.CONFIG,width:L,ellipsis:!0,render:(e,t)=>e?Object(q.jsx)("a",{onClick:()=>f(t),children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.obd,dataIndex:W.k.obd,title:Y.f.OBD,width:P,render:e=>e?Object(q.jsx)(Pe.b,{obd:!0}):Object(q.jsx)(Pe.b,{obd:!1})},{key:W.k.status,dataIndex:W.k.status,title:Y.f.BATTERY,width:V,render:e=>null!==e&&void 0!==e&&e.latestBatteryLevel?Object(q.jsx)(qt,{batteryLevel:e.latestBatteryLevel}):Object(q.jsx)(m.a,{children:"-"})},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:Y.f.VEHICLE,width:M,filters:W.c.map((e=>({value:e.TYPE,text:e.TYPE_DISPLAY_TEXT}))),onFilter:(e,t)=>{var n,i;return 0===(null===(n=t[W.k.installedVehicle])||void 0===n||null===(i=n.benefitType)||void 0===i?void 0:i.indexOf(e))},render:e=>null===e?"-":Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(Pe.a,{text:null===e||void 0===e?void 0:e.registry}),Object(q.jsx)(m.a,{style:{textAlign:"left"},disabled:!0,children:null===e||void 0===e?void 0:e.displayName})]})},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:Y.f.DRIVER,width:F,render:e=>{var t,n;return null!==e&&void 0!==e&&null!==(t=e.defaultDriver)&&void 0!==t&&t.displayName?Object(q.jsx)(m.a,{children:null===e||void 0===e||null===(n=e.defaultDriver)||void 0===n?void 0:n.displayName}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})}},{key:W.k.status,dataIndex:W.k.status,title:Y.f.HEART_BEAT,width:z,render:(e,t)=>null!==e&&void 0!==e&&e.timestampMs?Object(q.jsx)(Me.a,{value:e.timestampMs,typ:"map",isTracker:t.isTracker}):null},{key:"openAVL",dataIndex:"openAVL",title:"",width:U,sticky:!0,render:(e,t,n)=>Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(l.a,{}),onClick:()=>p(W.l.AVL,t),children:Y.f.BTN_AVL})},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:"",width:U,ellipsis:!0,render:(e,t,n)=>e?Object(q.jsx)(Pe.c,{title:Y.f.POP_CONFIRM_QUESTION_CPU_RESET,setOkText:Y.f.BTN_RESET,setCancelText:Y.f.BTN_ABORT,onConfirmFunc:()=>(e=>{console.log("On CPU reset click");const t=e.installedVehicle.id;console.log("-> sDeviceVehicleId",t);const n=e.organizationId.organizationId;console.log("-> sDeviceOrgId",n),S.requestVehicleCpuReset({organizationId:n||null,selectedDeviceId:t})})(t),buttonProps:{type:Ut,icon:Object(q.jsx)(r.a,{}),text:Y.f.BTN_CPU_RESET}}):null},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:"",width:U,ellipsis:!0,render:(e,t,n)=>e?Object(q.jsx)(Pe.c,{title:Y.f.POP_CONFIRM_QUESTION_WEB_CONNECCT,setOkText:Y.f.BTN_RESET,setCancelText:Y.f.BTN_ABORT,onConfirmFunc:()=>(e=>{console.log("On CPU reset click");const t=e.installedVehicle.id;console.log("-> sDeviceVehicleId",t);const n=e.organizationId.organizationId;console.log("-> sDeviceOrgId",n),We.a.postVehiclesWebConnect(t).then((e=>{console.log(e),qe.b.success("Lyckad web-connection")}))})(t),buttonProps:{type:Ut,icon:Object(q.jsx)(r.a,{}),text:Y.f.BTN_WEB_CONNECT}}):null},{key:"openGetInfo",dataIndex:"openGetInfo",title:"",width:U,ellipsis:!0,render:(e,t,n)=>Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(o.a,{}),onClick:()=>{p(W.l.C12SMS,t)},children:Y.f.BTN_GET_INFO})},{key:"openGetInfo",dataIndex:"separateStartConfig",title:"",width:160,ellipsis:!0,render:(e,t,n)=>{let i=null;const a=e=>{const t=null===e||void 0===e?void 0:e.toISOString(),n=new Date(t),a=n.getUTCHours().toString().padStart(2,"0"),l=n.getUTCMinutes().toString().padStart(2,"0");i=a+l};return(null===t||void 0===t?void 0:t.isTracker)&&Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(s.a,{}),onClick:()=>{x.a.confirm({title:"H\xe4mta grundconfig f\xf6r "+t.imei,content:Object(q.jsxs)("div",{children:[Object(q.jsx)("p",{children:"\xc4r du s\xe4ker att du vill h\xe4mta grundconfig p\xe5 nytt f\xf6r denna enhet?"}),Object(q.jsx)("p",{children:"Vill du \xe4ndra tidspunkt f\xf6r uppdatering? V\xe4lj tid eller l\xe4mna den tom:"}),Object(q.jsx)(Ct.a,{format:"HH:mm",onChange:a})]}),onOk:()=>{h(t.deviceId,i)}})},children:"H\xe4mta grundconfig p\xe5 nytt"})}},{key:"smsControl",dataIndex:"smsControl",title:"",width:200,ellipsis:!0,render:(e,t,n)=>{if(null===t||void 0===t||!t.isTracker)return;let i=t.smsControl?Object(q.jsx)(d.a,{style:{color:W.b.GREEN}}):Object(q.jsx)(c.a,{style:{color:W.b.RED}});return Object(q.jsxs)(Ft.a,{alignItems:"center",children:[Object(q.jsx)(y.a,{style:{},type:Ut,icon:Object(q.jsx)(s.a,{}),onClick:()=>{j(t.deviceId),console.log(t)},children:"Kontrollera SMS"}),void 0!==t.smsControl?i:t.smsControl]})}},{key:"separateStartConfig",dataIndex:"separateStartConfig",title:"",width:160,ellipsis:!0,render:(e,t,n)=>(null===t||void 0===t?void 0:t.isTracker)&&Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(s.a,{}),onClick:()=>{v(t.deviceId)},children:"Skicka SMS onomondo"})},{title:"",width:U,render:e=>!e.isTracker&&Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(u.a,{}),onClick:()=>O(e),children:Y.f.CONFIG})}];return Object(i.useEffect)((()=>{b(A.length)}),[A.length]),console.debug("Rendering warning device tab with data: ",A),Object(q.jsx)(Kt,{dataSource:A,columns:B})},Gt=e=>{let{devices:t,vehicles:n,orgData:a,openUserModal:l,setInStockCount:r,handleRetireClick:o,onHandleFwConfigReq:s,showModalWithConfig:d,searchText:c,selectedOrganizations:h}=e,p={};const b=t?Object(H.e)(t):[],O=n||[];let g=[...b].map((e=>(p={deviceId:e.deviceId?e.deviceId:null,imei:e.imei?e.imei:"-",organizationId:e.organizationId?Object(H.j)(e.organizationId,a):"-",iccid:e.iccid?e.iccid:"-",timestampStartOfUse:e.timestampStartOfUse?e.timestampStartOfUse:null,phone:e.phone?H.l.phoneNumber(e.phone):"-",deviceType:e.deviceType?e.deviceType:null,firmware:e.firmware?e.firmware:"-",configName:e.configName?e.configName:"-",installedVehicle:e.installedVehicle?Object(H.k)(e.installedVehicle,O):"-",physicalInstallTimestamp:e.physicalInstallTimestamp?H.l.millisToDate(e.physicalInstallTimestamp):"-",physicalLocation:e.physicalLocation?e.physicalLocation:"-",retired:e.retired?e.retired:null,isTracker:e.isTracker,status:e.status?{timestampMs:e.status.timestampMs?e.status.timestampMs:null,uplinkLoss:e.status.uplinkLoss?e.status.uplinkLoss:null,latestBatteryLevel:e.status.latestBatteryLevel?e.status.latestBatteryLevel:null,latestSeenPositiveSpeed:e.status.latestSeenPositiveSpeed?e.status.latestSeenPositiveSpeed:null}:null},p)));const[f,x]=Object(i.useState)(),[E,I]=Object(i.useState)(),S=Object(H.a)(g,c,h),T=50,k=100,C=150,_=100,N=50,R=150,D=110,w=[{key:W.k.selected,dataIndex:W.k.selected,title:Y.f.CHOOSE,width:T,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsx)(A.a,{})},{key:W.k.deviceType,dataIndex:W.k.deviceType,title:Y.f.TYPE,width:k,filters:W.e,onFilter:(e,t)=>{var n;return 0===(null===(n=t[W.k.deviceType])||void 0===n?void 0:n.indexOf(e))},render:e=>e?Object(q.jsx)(m.a,{children:e}):"-"},{key:W.k.imei,dataIndex:W.k.imei,title:Y.f.IMEI,width:C,render:e=>e?Object(q.jsx)(m.a,{children:e}):"-"},{key:W.k.iccid,dataIndex:W.k.iccid,title:Y.f.ICCID,width:C,render:e=>e?Object(q.jsx)(m.a,{children:e}):"-"},{key:W.k.phone,dataIndex:W.k.phone,title:Y.f.PHONE_NUMBER,width:_,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.timestampStartOfUse,dataIndex:W.k.timestampStartOfUse,title:Y.f.START_OF_USE,width:_,render:e=>e?Object(Vt.a)(e,"YYYY-MM-DD",!0):"-"},{key:W.k.firmware,dataIndex:W.k.firmware,title:Y.f.FIRMWARE_SHORT,width:N,render:e=>e?Object(q.jsx)(m.a,{children:e}):"-"},{key:W.k.config,dataIndex:W.k.config,title:Y.f.CONFIG,width:R,ellipsis:!0,render:(e,t)=>e?Object(q.jsx)("a",{onClick:()=>d(t),children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.btn_connect_customer,dataIndex:W.k.btn_connect_customer,title:"",width:D,fixed:"right",render:(e,t,n)=>Object(q.jsx)(y.a,{type:"link",style:{width:"100%",color:W.b.GREEN},icon:Object(q.jsx)(v.a,{}),onClick:()=>l(W.l.CONNECT,t),children:Y.f.BTN_CONNECT_TO_CUSTOMER})},{key:W.k.btn_retire,dataIndex:W.k.btn_retire,title:"",width:D,fixed:"right",render:(e,t,n)=>Object(q.jsx)(Pe.d,{title:Y.f.POP_CONFIRM_QUESTION_RETIRE_UNIT,setOkText:Y.f.BTN_RETIRE,setCancelText:Y.f.BTN_ABORT,onConfirmFunc:()=>o(t),buttonProps:{type:Ut,icon:Object(q.jsx)(j.a,{}),text:Y.f.BTN_RETIRE}})},{title:"",width:D,fixed:"right",render:e=>!e.isTracker&&Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(u.a,{}),onClick:()=>s(e),children:Y.f.CONFIG})}];return Object(i.useEffect)((()=>{r(S.length)}),[S.length]),Object(q.jsx)(Kt,{dataSource:S,columns:w})},Ht=e=>{let{devices:t,vehicles:n,orgData:a,openUserModal:l,handleOrg:r,showModalWithConfig:o,onHandleFwConfigReq:s,setOnTheWayCount:d,handleRetireClick:c,searchText:v,selectedOrganizations:p}=e,b={};const O=t?Object(H.g)(t):[],g=n||[],f=[...O].map((e=>(b={deviceId:e.deviceId?e.deviceId:null,imei:e.imei?e.imei:null,organizationId:e.organizationId?Object(H.j)(e.organizationId,a):null,iccid:e.iccid?e.iccid:null,phone:e.phone?H.l.phoneNumber(e.phone):null,deviceType:e.deviceType?e.deviceType:null,firmware:e.firmware?e.firmware:"-",configName:e.configName?e.configName:"-",installedVehicle:e.installedVehicle?Object(H.k)(e.installedVehicle,g):null,physicalInstallTimestamp:e.physicalInstallTimestamp?H.l.millisToDate(e.physicalInstallTimestamp):null,physicalLocation:e.physicalLocation?e.physicalLocation:null,isTracker:e.isTracker,status:e.status?{timestampMs:e.status.timestampMs?e.status.timestampMs:null,uplinkLoss:e.status.uplinkLoss?e.status.uplinkLoss:null,latestBatteryLevel:e.status.latestBatteryLevel?e.status.latestBatteryLevel:null,latestSeenPositiveSpeed:e.status.latestSeenPositiveSpeed?e.status.latestSeenPositiveSpeed:null}:null},b))),x=Object(H.a)(f,v,p),E=100,I=50,S=100,T=50,k=75,C=50,_=75,A=100,N=100,R=[{key:W.k.org,dataIndex:W.k.org,title:Y.f.ORG,width:E,filters:null===a||void 0===a?void 0:a.map((e=>({value:e.fullName,text:e.fullName}))),onFilter:(e,t)=>{var n,i;return 0===(null===(n=t[W.k.org])||void 0===n||null===(i=n.fullName)||void 0===i?void 0:i.indexOf(e))},render:e=>null!==e&&void 0!==e&&e.organizationId?Object(q.jsx)(m.a,{children:e.fullName}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.deviceType,dataIndex:W.k.deviceType,title:Y.f.TYPE,width:I,filters:W.e,onFilter:(e,t)=>{var n;return 0===(null===(n=t.deviceType)||void 0===n?void 0:n.indexOf(e))},render:e=>e?Object(q.jsx)(m.a,{children:e}):""},{key:W.k.imei,dataIndex:W.k.imei,title:Y.f.IMEI,width:S,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.firmware,dataIndex:W.k.firmware,title:Y.f.FIRMWARE_SHORT,width:A,render:e=>e?Object(q.jsx)(m.a,{children:e}):"-"},{key:W.k.config,dataIndex:W.k.config,title:Y.f.CONFIG,width:N,ellipsis:!0,render:(e,t)=>e?Object(q.jsx)("a",{onClick:()=>o(t),children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:Y.f.VEHICLE,width:T,render:e=>e?null!==e&&void 0!==e&&e.registry?Object(q.jsxs)("div",{children:[Object(q.jsx)(Pe.a,{text:null===e||void 0===e?void 0:e.registry}),e.displayName]}):Object(q.jsxs)(m.a,{children:[" ",null===e||void 0===e?void 0:e.displayName," "]}):Object(q.jsx)(m.a,{children:"-"})},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:Y.f.DRIVER,width:k,render:e=>{var t,n;return null!==e&&void 0!==e&&null!==(t=e.defaultDriver)&&void 0!==t&&t.displayName?Object(q.jsx)(m.a,{children:null===e||void 0===e||null===(n=e.defaultDriver)||void 0===n?void 0:n.displayName}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})}},{key:W.k.connected,dataIndex:W.k.connected,title:Y.f.CONNECTED,width:C,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.org,dataIndex:W.k.org,title:"",width:_,fixed:"right",render:(e,t,n)=>e?Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(h.a,{}),onClick:()=>l(W.l.CHANGE_ORG,t),children:Y.f.BTN_CHANGE_ORG}):null},{key:W.k.btn_retire,dataIndex:W.k.btn_retire,title:"",width:_,fixed:"right",render:(e,t,n)=>Object(q.jsx)(Pe.d,{title:Y.f.POP_CONFIRM_QUESTION_RETIRE_UNIT,setOkText:Y.f.BTN_RETIRE,setCancelText:Y.f.BTN_ABORT,onConfirmFunc:()=>c(t),buttonProps:{type:Ut,icon:Object(q.jsx)(j.a,{}),text:Y.f.BTN_RETIRE}})},{title:"",width:_,fixed:"right",render:e=>!e.isTracker&&Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(u.a,{}),onClick:()=>s(e),children:Y.f.CONFIG})}];return Object(i.useEffect)((()=>{d(x.length)}),[x.length]),Object(q.jsx)(Kt,{dataSource:x,columns:R})},Yt=e=>{let{devices:t,vehicles:n,orgData:a,openUserModal:r,setInDriveCount:o,handleRetireClick:s,onHandleFwConfigReq:d,searchText:c,selectedOrganizations:v}=e,h={};const O=t?Object(H.d)(t):[],g=n||[],f=[...O].map((e=>(h={deviceId:e.deviceId?e.deviceId:null,imei:e.imei?e.imei:null,organizationId:e.organizationId?Object(H.j)(e.organizationId,a):null,iccid:e.iccid?e.iccid:null,phone:e.phone?H.l.phoneNumber(e.phone):null,deviceType:e.deviceType?e.deviceType:null,firmware:e.firmware?e.firmware:"-",configName:e.configName?e.configName:"-",dataUsed:e.dataUsed?e.dataUsed:"-",installedVehicle:e.installedVehicle?Object(H.k)(e.installedVehicle,g):null,physicalInstallTimestamp:e.physicalInstallTimestamp?H.l.millisToDate(e.physicalInstallTimestamp):null,physicalLocation:e.physicalLocation?e.physicalLocation:null,retired:e.retired?e.retired:null,isTracker:e.isTracker,status:e.status?{timestampMs:e.status.timestampMs?e.status.timestampMs:null,uplinkLoss:e.status.uplinkLoss?e.status.uplinkLoss:null,latestBatteryLevel:e.status.latestBatteryLevel?e.status.latestBatteryLevel:null,latestSeenPositiveSpeed:e.status.latestSeenPositiveSpeed?e.status.latestSeenPositiveSpeed:null}:null},h))),x=Object(H.a)(f,c,v),E=75,I=100,S=100,T=150,k=75,C=100,_=100,A=125,N=50,R=120;console.debug("Superadmin devices in drive, orgData =",a);const D=[{key:W.k.operationalAt,dataIndex:W.k.operationalAt,title:Y.f.OPERATIONAL_AT,width:E,render:e=>e?Object(q.jsx)(m.a,{children:e}):"-"},{key:W.k.org,dataIndex:W.k.org,title:Y.f.ORG,width:I,filters:null===a||void 0===a?void 0:a.map((e=>({value:e.fullName,text:e.fullName}))),onFilter:(e,t)=>{var n,i;return 0===(null===(n=t[W.k.org])||void 0===n||null===(i=n.fullName)||void 0===i?void 0:i.indexOf(e))},render:e=>null!==e&&void 0!==e&&e.fullName?Object(q.jsx)(m.a,{children:e.fullName}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.deviceType,dataIndex:W.k.deviceType,title:Y.f.TYPE,width:S,filters:W.e,onFilter:(e,t)=>{var n;return 0===(null===(n=t[W.k.deviceType])||void 0===n?void 0:n.indexOf(e))},render:e=>e?Object(q.jsx)(m.a,{children:e}):"-"},{key:W.k.imei,dataIndex:W.k.imei,title:Y.f.IMEI,width:T,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.status,dataIndex:W.k.status,title:Y.f.HEART_BEAT,width:k,render:(e,t)=>null!==e&&void 0!==e&&e.timestampMs?Object(q.jsx)(Me.a,{value:e.timestampMs,typ:"map",isTracker:t.isTracker}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:Y.f.VEHICLE,width:C,render:e=>e?null!==e&&void 0!==e&&e.registry?Object(q.jsxs)("div",{children:[Object(q.jsx)(Pe.a,{text:null===e||void 0===e?void 0:e.registry}),e.displayName]}):Object(q.jsxs)(m.a,{children:[" ",null===e||void 0===e?void 0:e.displayName," "]}):Object(q.jsx)(m.a,{children:"-"})},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:Y.f.MILE_AGE,width:_,render:e=>{var t;return null!==e&&void 0!==e&&null!==(t=e.state)&&void 0!==t&&t.odometer?Object(q.jsx)(m.a,{children:"".concat(e.state.odometer," km")}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})}},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:Y.f.DRIVER,width:A,render:e=>{var t,n;return null!==e&&void 0!==e&&null!==(t=e.defaultDriver)&&void 0!==t&&t.displayName?Object(q.jsx)(m.a,{children:null===e||void 0===e||null===(n=e.defaultDriver)||void 0===n?void 0:n.displayName}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})}},{key:W.k.travels,dataIndex:W.k.travels,title:Y.f.TRAVELS,width:N,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:"openAVL",dataIndex:"openAVL",title:"",width:R,fixed:"right",sticky:!0,render:(e,t,n)=>Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(l.a,{}),onClick:()=>r(W.l.AVL,t),children:Y.f.BTN_AVL})},{key:W.k.btn_display_unit,dataIndex:W.k.btn_display_unit,title:"",width:R,fixed:"right",render:(e,t,n)=>Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(p.a,{}),onClick:()=>r(W.l.DISPLAY_UNIT,t),children:Y.f.BTN_DISPLAY_UNIT})},{key:W.k.btn_display_vehicle,dataIndex:W.k.btn_display_vehicle,title:"",width:R,fixed:"right",render:(e,t,n)=>Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(b.a,{}),onClick:()=>r(W.l.VEHICLE,t),children:Y.f.BTN_DISPLAY_VEHICLE})},{key:W.k.btn_retire,dataIndex:W.k.btn_retire,title:"",width:R,fixed:"right",render:(e,t,n)=>Object(q.jsx)(Pe.d,{title:Y.f.POP_CONFIRM_QUESTION_RETIRE_UNIT,setOkText:Y.f.BTN_RETIRE,setCancelText:Y.f.BTN_ABORT,onConfirmFunc:()=>s(t),buttonProps:{type:Ut,icon:Object(q.jsx)(j.a,{}),text:Y.f.BTN_RETIRE}})},{title:"",width:R,fixed:"right",render:e=>!e.isTracker&&Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(u.a,{}),onClick:()=>d(e),children:Y.f.CONFIG})}];return Object(i.useEffect)((()=>{o(x.length)}),[x.length]),Object(q.jsx)(Kt,{dataSource:x,columns:D})},Wt=e=>{let{devices:t,vehicles:n,orgData:a,openUserModal:r,setRetiredCount:o,searchText:s,selectedOrganizations:d}=e;const c=Object(i.useContext)(g.a);let u={};const v=t?Object(H.h)(t):[],j=n||[],h=[...v].map((e=>(u={deviceId:e.deviceId?e.deviceId:null,imei:e.imei?e.imei:null,organizationId:e.organizationId?Object(H.j)(e.organizationId,a):null,iccid:e.iccid?e.iccid:null,phone:e.phone?H.l.phoneNumber(e.phone):null,deviceType:e.deviceType?e.deviceType:null,installedVehicle:e.installedVehicle?Object(H.k)(e.installedVehicle,j):null,physicalInstallTimestamp:e.physicalInstallTimestamp?H.l.millisToDate(e.physicalInstallTimestamp):null,physicalLocation:e.physicalLocation?e.physicalLocation:null,retired:e.retired?e.retired:null,status:e.status?{timestampMs:e.status.timestampMs?e.status.timestampMs:null,uplinkLoss:e.status.uplinkLoss?e.status.uplinkLoss:null,latestBatteryLevel:e.status.latestBatteryLevel?e.status.latestBatteryLevel:null,latestSeenPositiveSpeed:e.status.latestSeenPositiveSpeed?e.status.latestSeenPositiveSpeed:null}:null},u))),p=Object(H.a)(h,s,d),b="15%",f="15%",x="15%",E=100,I=50,S=[{key:W.k.phone,dataIndex:W.k.phone,title:Y.f.PHONE_NUMBER,width:b,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.imei,dataIndex:W.k.imei,title:Y.f.IMEI,width:f,render:e=>e?Object(q.jsx)(m.a,{children:e}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:Y.f.VEHICLE,width:x,filters:W.c.map((e=>({value:e.TYPE,text:e.TYPE_DISPLAY_TEXT}))),onFilter:(e,t)=>{var n,i;return 0===(null===(n=t[W.k.installedVehicle])||void 0===n||null===(i=n.benefitType)||void 0===i?void 0:i.indexOf(e))},render:e=>null!==e&&void 0!==e&&e.benefitType?Object(q.jsx)(m.a,{children:e.benefitType}):Object(q.jsx)(m.a,{children:"-"})},{key:W.k.installedVehicle,dataIndex:W.k.installedVehicle,title:Y.f.DRIVER,width:E,render:e=>{var t;return null!==e&&void 0!==e&&null!==(t=e.currentDriver)&&void 0!==t&&t.displayName?Object(q.jsx)(m.a,{children:e.currentDriver.displayName}):Object(q.jsxs)(m.a,{children:[" ","-"," "]})}},{key:"openAVL",dataIndex:"openAVL",title:"",width:I,fixed:"right",sticky:!0,render:(e,t,n)=>Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(l.a,{}),onClick:()=>r(W.l.AVL,t),children:Y.f.BTN_AVL})},{key:W.k.btn_display_vehicle,dataIndex:W.k.btn_display_vehicle,title:"",width:I,fixed:"right",render:(e,t,n)=>Object(q.jsx)(y.a,{style:{width:"100%"},type:Ut,icon:Object(q.jsx)(O.a,{}),onClick:()=>(e=>{const t=e.deviceId,n=e.organizationId.organizationId;c.requestUpdateDeviceById({organizationId:n||null,selectedDeviceId:t,deviceUpdateData:{retired:!1}})})(t),children:Y.f.BTN_UN_RETIRE})}];return Object(i.useEffect)((()=>{o(p.length)}),[p.length]),Object(q.jsx)(Kt,{dataSource:p,columns:S})},Kt=e=>{let{dataSource:t,columns:n}=e;const a=Object(q.jsx)(_t.a,{pageSize:20,onChange:function(e,t){console.log("pageSize: ",e,t)},defaultPageSize:20,defaultCurrent:20}),l=Object(i.useState)({bordered:!1,loading:!1,pagination:a,size:"middle",title:!1,showSizeChanger:!1,showHeader:!0,rowSelection:!1,scroll:{x:1300},hasData:!0,tableLayout:void 0,top:"none",bottom:"bottomRight"});return Object(q.jsx)(Be.a,{...l[0],sticky:!0,...K.n,dataSource:t,columns:n})},qt=e=>{let{batteryLevel:t}=e;return Object(q.jsx)("div",{children:Object(q.jsx)(At.a,{type:"dashboard",percent:t,width:30,strokeColor:H.b.determineBatteryColor(t)})})},Jt=()=>{const[e,t]=Object(i.useState)([]),[n,l]=Object(i.useState)({}),[r,o]=Object(i.useState)(!1),[s,d]=Object(i.useState)(null),[c,u]=Object(i.useState)(""),[v,j]=Object(i.useState)(),[h,p]=Object(i.useState)(0),[b,O]=Object(i.useState)(0),[f,y]=Object(i.useState)(0),[E,I]=Object(i.useState)(0),[S,T]=Object(i.useState)(0),k=Object(i.useContext)(g.a),C=k.orgs.LOADED,_=k.orgs.RESULT,A=(k.devices.LOADED,k.devices.RESULT),N=k.devices.MESSAGE_DEVICE_UPDATE;console.debug("Superadmin context in tabtable: ",k);const R=k.vehicles.LOADED,D=k.vehicles.RESULT,w=Object(q.jsx)(m.a,{style:{color:W.i.RETIRED},children:Y.h.RETIRED});Object(i.useEffect)((()=>{if((null===A||void 0===A?void 0:A.length)>0){var e,t,n,i,a;const l=Object(H.a)(A,c,v);p(null===(e=Object(H.i)(l))||void 0===e?void 0:e.length),O(null===(t=Object(H.e)(l))||void 0===t?void 0:t.length),y(null===(n=Object(H.g)(l))||void 0===n?void 0:n.length),I(null===(i=Object(H.d)(l))||void 0===i?void 0:i.length),T(null===(a=Object(H.h)(l))||void 0===a?void 0:a.length)}}),[A,c,v]),Object(i.useEffect)((()=>{C&&console.log("ORGDATA",_)}),[]),Object(i.useEffect)((()=>{})),Object(i.useEffect)((()=>{R&&console.log("VEHICLEDATA",D)}),[]),Object(i.useEffect)((()=>{N&&("SUCCESS"===N.type?qe.b.success(N.message):"ERROR"===N.type&&qe.b.error(N.message))}),[N]),Object(i.useEffect)((()=>{console.log("CURRENT::SEARCH::TEXT",c)}),[c]),Object(i.useEffect)((()=>{const e=localStorage.getItem(Nt.f);e&&(u(e.toLowerCase()),localStorage.removeItem(Nt.f))}),[]);const L=e=>{We.a.getConfigFromFota(e.imei).then((t=>{console.log("row IMEI is: ",e.imei),console.log("row TEL is: ",e.phone),console.log("responce payload: ",t),console.log("Firmware: ",t.current_firmware),console.log("Configuration: ",t.current_configuration);t.current_firmware,t.current_configuration;k.requestFetchDevices()}))};function P(e){console.log(e),x.a.info({title:"Config f\xf6r IMEI "+(null===e||void 0===e?void 0:e.imei),content:null===e||void 0===e?void 0:e.configName,onOk(){}})}const V=(n,i)=>{t({...e,device:i}),d(n),o(!0)},M=()=>{console.log("Trying to close modal..."),o(!1),d(null)},F=()=>{throw new Error("use redux")},z=e=>{const t=e.deviceId,n=e.organizationId.organizationId;console.log("Retire device with deviceId => ",t),console.log("Retire device with deviceOrgId => ",n),k.requestUpdateDeviceById({organizationId:n||null,selectedDeviceId:t,deviceUpdateData:{retired:!0}})},U=(e,t)=>{console.debug("STATE MOVE DEVICE",e,k.devices),console.debug("STATE MOVE, CHANGED ORG",e,k.devices);const n=e.deviceId,i=e.organizationId.organizationId;console.log("Retire device with deviceId => ",n),console.log("Retire device with deviceOrgId => ",i),console.log("Retire device with orgId => ",t),console.log(t),console.debug("STATE MOVE, PRE REQ",e,k.devices),k.requestUpdateDeviceById({selectedDeviceId:n,deviceUpdateData:{organizationId:t}}).then((()=>{qe.b.success("Enhet flyttades till en annan organisation.")})),console.debug("STATE MOVE, POST REQ",e,k.devices),M()};return console.debug("Rendering Superadmin Tab Pane with data: ",A),Object(q.jsxs)(a.a.Fragment,{children:[Object(q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(q.jsx)(Je.a.Title,{children:"Enheter"}),Object(q.jsxs)("div",{style:{display:"flex",gap:15,flexWrap:"wrap"},children:[Object(q.jsx)(Pt.a,{data:(null===_||void 0===_?void 0:_.length)>1?_:[],onChange:e=>{j(e),console.log(e)},selectedOrganization:v,isMultiple:!0}),Object(q.jsx)(Zt,{updateSearchedText:e=>{u(e||"")}})]})]}),A&&D&&_?Object(q.jsxs)(kt.a,{children:[Object(q.jsx)(zt,{tab:Object(q.jsx)(Pe.f,{text:Y.h.WARNINGS,count:h,color:W.i.WARNINGS}),children:Object(q.jsx)(Bt,{devices:A,vehicles:D,openUserModal:V,orgData:_,selectedOrganizations:v,showModalWithConfig:P,onHandleFwConfigReq:L,setWarningsCount:p,searchText:c,getNewConfig:(e,t)=>{We.a.separateStartConfig(e,t).then((e=>qe.b.success("Din f\xf6rfr\xe5gan skickades")))},getOnomondoSMS:e=>{We.a.getOnomondoSMS(e).then((e=>qe.b.success("Din SMS f\xf6rfr\xe5gan skickades")))},getCheckQueclinkHistory:e=>{We.a.getCheckQueclinkHistory(e).then((t=>{var n,i;const a=null===t||void 0===t||null===(n=t.filter((e=>!0===(null===e||void 0===e?void 0:e.smsAck))))||void 0===n?void 0:n.length,l=null===t||void 0===t||null===(i=t.filter((e=>!0===(null===e||void 0===e?void 0:e.ack))))||void 0===i?void 0:i.length,r=a>=4&&l>=2;k.requestUpdateDeviceById({selectedDeviceId:e,deviceUpdateData:{smsControl:r}}),qe.b.success("Din SMS f\xf6rfr\xe5gan skickades")})).catch((()=>{k.requestUpdateDeviceById({selectedDeviceId:e,deviceUpdateData:{smsControl:!1}})}))}})},"1"),Object(q.jsxs)(zt,{tab:Object(q.jsx)(Pe.f,{text:Y.h.STOCK,count:b,color:W.i.STOCK}),children:[Object(q.jsx)("div",{style:{paddingTop:25,paddingBottom:15,justifyContent:"center"},children:Object(q.jsx)(st,{})}),Object(q.jsx)(Gt,{devices:A,vehicles:D,openUserModal:V,orgData:_,selectedOrganizations:v,onHandleFwConfigReq:L,showModalWithConfig:P,setInStockCount:O,handleRetireClick:z,searchText:c})]},"2"),Object(q.jsx)(zt,{tab:Object(q.jsx)(Pe.f,{text:Y.h.ON_THE_WAY,count:f,color:W.i.ON_THE_WAY}),children:Object(q.jsx)(Ht,{devices:A,vehicles:D,openUserModal:V,orgData:_,selectedOrganizations:v,showModalWithConfig:P,setOnTheWayCount:y,onHandleFwConfigReq:L,handleRetireClick:z,searchText:c,handleOrg:U})},"3"),Object(q.jsx)(zt,{tab:Object(q.jsx)(Pe.f,{text:Y.h.IN_DRIVE,count:E,color:W.i.IN_DRIVE}),children:Object(q.jsx)(Yt,{devices:A,vehicles:D,openUserModal:V,orgData:_,selectedOrganizations:v,onHandleFwConfigReq:L,setInDriveCount:I,handleRetireClick:z,searchText:c})},"4"),Object(q.jsx)(zt,{tab:Object(q.jsx)(Pe.f,{text:w,count:S,color:W.b.NOT_IMPLEMENTED_YET}),children:Object(q.jsx)(Wt,{devices:A,vehicles:D,selectedOrganizations:v,openUserModal:V,orgData:_,setRetiredCount:T,searchText:c})},"5")]}):Object(q.jsx)(Mt.a,{}),Object(q.jsx)(Qt,{modalType:W.l.AVL,visible:r,handleAdd:()=>F,selectedDevice:e,setSelectedDevice:t,handleClose:M,useModal:s,orgData:_,vehicles:D,handleOrg:U})]})},Qt=e=>{let{visible:t,handleAdd:n,selectedDevice:i,handleOrg:l,handleClose:r,useModal:o,orgData:s,vehicles:d,setSelectedDevice:c}=e,u=null;switch(o){case W.l.AVL:u=Object(q.jsx)(ht,{visible:t,handleAdd:()=>n,selectedDevice:i,setSelectedDevice:c,handleClose:()=>r,vehicles:d});break;case W.l.LOGG:u=Object(q.jsx)(mt,{visible:t,handleAdd:()=>n,selectedDevice:i,handleClose:()=>r});break;case W.l.ADD:u=Object(q.jsx)(Tt,{visible:t,handleAdd:()=>n(),handleClose:()=>r});break;case W.l.DISPLAY_UNIT:u=Object(q.jsx)(Fe,{visible:t,selectedDevice:i,handleAdd:()=>n(),handleClose:r});break;case W.l.CONNECT:u=Object(q.jsx)(we,{visible:t,handleAdd:()=>n,selectedDevice:i,handleClose:r,orgData:s});break;case W.l.VEHICLE:u=Object(q.jsx)(xt,{visible:t,selectedDevice:i,handleClose:()=>r});break;case W.l.C12SMS:u=Object(q.jsx)(It,{visible:t,selectedDevice:i,handleAdd:()=>n(),handleClose:()=>r});break;case W.l.CHANGE_ORG:u=Object(q.jsx)(Lt,{visible:t,selectedDevice:i,handleClose:()=>r,handleOrg:l,orgData:s});break;default:u=null}return null!=o?Object(q.jsx)(a.a.Fragment,{children:u}):null},Zt=e=>{let{updateSearchedText:t}=e;const{Search:n}=C.a;return Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(n,{style:{width:300},placeholder:Y.f.INPUT_SEARCH_IN_TABLE,allowClear:!0,enterButton:!0,onChange:e=>{t(e.target.value)}})})};const Xt=()=>{const[e,t]=Object(i.useState)(!0),n=Object(i.useContext)(g.a);return Object(i.useEffect)((()=>{console.debug("STATE USEEFFECT SUPERADMIN DEVICES CONTROLLER"),n.resetState(),Promise.all([n.requestFetchVehicles(),n.requestFetchDevices(),n.requestFetchOrganizations()]).then((()=>{t(!1)}))}),[]),console.debug("Rendering superadmin controller, devices: ",n.devices,"orgs: ",n.orgs),Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(Jt,{})})};function $t(){return Object(q.jsx)(g.b,{children:Object(q.jsx)(Xt,{})})}},19:function(e,t,n){"use strict";n.d(t,"j",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"o",(function(){return l})),n.d(t,"p",(function(){return r})),n.d(t,"q",(function(){return o})),n.d(t,"r",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"b",(function(){return v})),n.d(t,"m",(function(){return j})),n.d(t,"n",(function(){return h})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return b})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"d",(function(){return f})),n.d(t,"s",(function(){return x})),n.d(t,"t",(function(){return y}));const i="SIGNIN",a="AUTHENTICATED",l="SIGNOUT",r="SIGNOUT_SUCCESS",o="SIGNUP",s="SIGNUP_SUCCESS",d="SHOW_AUTH_MESSAGE",c="HIDE_AUTH_MESSAGE",u="SHOW_LOADING",v="auth_token",j="SIGNIN_WITH_GOOGLE",h="SIGNIN_WITH_GOOGLE_AUTHENTICATED",p="SIGNIN_WITH_FACEBOOK",b="SIGNIN_WITH_FACEBOOK_AUTHENTICATED",O="ORGANIZATION_ID",m="SEARCH_TERM",g="X-Trackson-Show-Archived",f="MAP_TYPE",x="USER_ID",y="USER"},190:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var i=n(0),a=(n(94),n(72),n(12)),l=(n(131),n(259),n(11)),r=n(1);const o=Object(i.createContext)({}),s=e=>{let{children:t}=e;const n=Object(i.useContext)(a.p),s=Object(i.useContext)(a.v),d=Object(i.useContext)(a.f),[c,u]=Object(i.useState)(),[v,j]=Object(i.useState)(!0),[h,p]=Object(i.useState)();Object(i.useEffect)((()=>{l.a.getReports().then((e=>{u(e)}))}),[]),Object(i.useEffect)((()=>{s&&c&&d&&j(!1)}),[d,c,s]);return Object(r.jsx)(o.Provider,{value:{knownUsers:n,knownVehicles:s,knownOrganizations:d,knownReports:c,loading:v,selectedOrganization:h,organizationSelectOnChange:e=>{p(e)},setKnownReports:u},children:t})}},2:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"m",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return j})),n.d(t,"j",(function(){return h})),n.d(t,"n",(function(){return p})),n.d(t,"l",(function(){return b}));const i={ALIAS:"Alias",BATTERY:"Batteri",BTN_ABORT:"Avbryt",BTN_ADD_UNIT:"L\xe4gg till enhet",BTN_ADD_UNIT_TRACKER:"L\xe4gg till T",BTN_AVL:"AVL",BTN_CALIBRATE:"Kalibrera",BTN_CLOSE:"St\xe4ng",BTN_CONNECT_TO_CUSTOMER:"Koppla",BTN_CONNECT:"Koppla",BTN_CPU_RESET:"CPU \xe5ters.",BTN_WEB_CONNECT:"Web-connect.",BTN_RESET:"\xc5terst\xe4ll",BTN_DISPLAY_UNIT:"Enhet",BTN_DISPLAY_VEHICLE:"Fordon",BTN_DOWNLOAD_SEL:"Ladda ner valda",BTN_FETCH_VEHICLE_INFO:"H\xe4mta uppgifter fr\xe5n biluppgifter.se",BTN_GET_INFO:"H\xe4mta\ninfo",BTN_LOGG:"Logg",BTN_NEW_ORG:"Ny organisation",BTN_RETIRE:"Pensionera",BTN_SHOW:"Visa",BTN_SAVE:"Spara",BTN_TO_STORAGE:"Till lager",BTN_CHANGE_ORG:"\xc4ndra org.",BTN_CHANGE:"\xc4ndra",BTN_UPDATE:"Uppdatera",CAR_TYPE:"Biltyp",CHOOSE_A_DRIVER:"V\xe4lj en f\xf6rare",CHOOSE_DRIVERS:"V\xe4lj f\xf6rare",CHOOSE_A_VEHICLE:"V\xe4lj ett fordon",CHOOSE_VEHICLES:"V\xe4lj fordon",CHOOSE_AN_ORG:"V\xe4lj en organisation",CHOOSE_QUICK_COMMAND:"V\xe4lj kommando",CHOOSE:"V\xe4lj",CONFIG_SHORT:"CFG",CONFIG:"Config",CONNECTED:"Kopplad",CURRENT_DRIVER:"Incheckad f\xf6rare",DATA_BLOCK:"Datam\xe4ngd",DESCRIPTION:"Syfte",DISPLAY_UNIT:"Visa enhet",DISPLAY_VEHICLE:"Visa fordon",DRIVER:"F\xf6rare",DELETE:"Ta bort",EXISTING:"Befintlig",FIRMWARE_SHORT:"FW",FIRMWARE:"Firmware",FIRMWARE_AND_CONFIG:"FW & Config",FROM:"Fr\xe5n",GET_INFO:"H\xe4mta info",HARDWARE:"H\xe5rdvara",HEART_BEAT:"S\xe5gs senast",ICCID:"ICCID",IMEI:"IMEI",KNOWN:"K\xe4nd",LIST_DRIVERS:"Lista f\xf6rare",LIST_VEHICLES:"Lista fordon",LOG:"Kvitterade",MILE_AGE:"M\xe4tars.",MILEAGE_FULL:"M\xe4tarst\xe4llning",Model:"Modell",MOVE_TO_ANOTHER_VEHICLE:"Flytta enhet till annat fordon",MOVE_DEVICE:"Flytta enhet",MOVE_VEHICLE:"Flytta fordon",NEW_DRIVER:"Ny f\xf6rare",NEW_ORG_SHORT:"Ny org.",NEW_VEHICLE:"Nytt fordon",NO:"Nej",NO_DRIVER:"Ingen f\xf6rare",OBD:"OBD",OPERATIONAL_AT:"Kopplad",ORG:"Organisation",OWNER:"\xc4gare",PHONE_NUMBER:"Telnr",START_OF_USE:"Enhet tas i bruk",PLACE_HOLDER_TEXT:"PLACE_HOLDER_TEXT",PLACE_HOLDER_TITLE:"PLACE_HOLDER_TITLE",PRIMARY_DRIVER:"F\xf6rvald f\xf6rare",PERMITTED_DRIVERS:"Beh\xf6riga f\xf6rare",REG_NUM_SHORT:"Regnr",REG_NUM:"Regnr",SAVE:"Spara",SEND_INVITE:"Skicka inbjudan",START:"Start",STOP:"Stop",SUPPLY:"Ange ",SUPPLY_A_FIRST_LAST_NAME:"Ange f\xf6rnamn & efternamn",SUPPLY_A_FIRST_NAME:"Ange ett f\xf6rnamn",SUPPLY_A_LAST_NAME:"Ange ett efternamn",SUPPLY_A_NEW_BUSINESS_NAME:"Ange nytt f\xf6retagsnamn",SUPPLY_A_NEW_PASSWORD:"Ange nytt l\xf6senord",SUPPLY_A_OLD_PASSWORD:"Ange ditt l\xf6senord",SUPPLY_A_NEW_ORG_COUNTRY:"Ange ett land",SUPPLY_A_NEW_ORG_COUNTY:"Ange ett l\xe4n",SUPPLY_A_NEW_ORG_EMAIL:"Ange en e-post",SUPPLY_A_NEW_ORG_PHONE:"Ange ett mobilnummer",SUPPLY_A_NEW_ORG_POSTAL_CODE:"Ange ett postnummer.",SUPPLY_A_NEW_ORG_STREET_ADDRESS:"Ange en gatuadress",SUPPLY_A_NEW_ORG_PASSWORD:"Ange ett l\xf6senord",SUPPLY_A_NEW_ORG:"Ange nytt organisationsnr.",SUPPLY_A_REG_NUM:"Ange ett regnr",SUPPLY_AN_ALIAS:"Ange ett alias",SUPPLY_A_BENEFIT_TYPE:"Ange f\xf6rm\xe5nstyp",SUPPLY_A_DEFAULT_TRIP_TYPE:"Ange restyp",SELECT_AN_EXISTING_ORGANISATION:"V\xe4lj en befintlig organisation",SELECT_AN_EXISTING_DRIVER:"V\xe4lj en befintlig f\xf6rare",SELECT_AN_EXISTING_VEHICLE:"V\xe4lj ett befintligt fordon",SUPPLY_AN_EMAIL_ADDRESS:"Ange en e-post",SUPPLY_PURPOSE:"Ange syfte...",SYNC_FROM_CAR_INFO:"Synka fr\xe5n biluppgifter",SYNC_NOW:"Synka nu",TO:"Till",TRAVELS:"Resor",TYPE_ERROR:"Typ/Fel",TYPE:"Typ",BENEFIT_TYPE:"Fordons-typ",UNKNOWN:"Ok\xe4nd",VEHICLE:"Fordon",TRACKER:"Utrustning",VOLTAGE_RANGE:"Voltage range",WARN_WARN_WARN:"Varning varning varning",YEAR:"\xc5rtal",YES:"Ja",POP_CONFIRM_QUESTION_RETIRE_UNIT:"Vill du verkligen pensionera enheten?",POP_CONFIRM_QUESTION_CPU_RESET:"Vill du verkligen starta om enheten?",POP_CONFIRM_QUESTION_WEB_CONNECCT:"Vill du verkligen skicka web-connect?",BTN_UN_RETIRE:"Avpensionera",INPUT_SEARCH_IN_TABLE:"S\xf6ker efter IMEI, telnr, regnr, f\xf6rare",BTN_SEARCH:"S\xf6k",ICON:"Ikon",DEFAULT:"F\xf6rvald typ av resa",EDIT_DEVICE:"\xc4ndra",GO_TO_JOURNEY:"G\xe5 till K\xf6rjournalen",DBCLICK_ON_MAP_TO_CHOOSE_LOCATION:"Dubbelklicka f\xf6r att v\xe4lja en plats p\xe5 kartan",CURRENT_LOCATION_UPPDATED:"Senaste position uppdaterad",STYLE:"M\xe4rkning",BTN_SHOW_ON_THE_MAP:"Visa p\xe5 karta",SHOW_WHERE_ALARM_TRIGGERED:"Visa var larmet utl\xf6stes",LAST_SEEN:"S\xe5gs senast",SPEED:"Hastighet",NO_INFO:"Info saknas",PARKED:"Parkerad",IN_MOVING:"I r\xf6relse",UPDATE_LAST_POSITION:"Uppdatera aktuell position",DO_NOT_FOLLOW:"Sluta sp\xe5ra fordonet",CAN_NOT_FOLLOW:"Fordonet kan inte sp\xe5ras",FOLLOW_ON_THE_MAP:"F\xf6lj fordonet",FILTER_BY_VEHICLE:"Filtrera efter fordon",YOUR_CHANGED_SAVED:"Dina \xe4ndringar har sparats",NEW_ORG_CREATED:"Ny organisation skapades",COMPANY_ADMIN:"F\xf6retags Admin",COMPANY_DELETED:"Organisation har tagits bort",ORG_NAME:"F\xf6retagsnamn",PARENT:"F\xf6r\xe4lder",MAIL:"E-post",ORG_NUM:"Organisationsnr",POSTAL_ADDRESS:"Postadress",DELETE_ORG:"Ta bort organisation?",SEARCH_ORG:"S\xf6k efter organisation",ADD_NEW_ORG:"L\xe4gg till ny organisation",ADD:"L\xe4gg till",SUPPLY_ADMINS_EMAIL:"F\xf6retagsadmins e-postadress (Fyll i om du vill skapa en ny anv\xe4ndare)",ADMINS_PASSWORD:"F\xf6retagsadmins l\xf6senord",INVOICE_ADDRESS:"Fakturaadress",USERS:"Anv\xe4ndare",DEVICES:"Enheter",ORGANIZATION:"Organisation",ORGANIZATIONS:"Organisationer",LAST_SEEN_DRIVING:"S\xe5gs senast k\xf6rning",CHECKED:"Incheckad",INSTALL:"Installed",RETIRED:"Pensionerad",STREET_ADDRESS:"Gatuadress",POSTAL_CODE:"Postnummer",CITY:"Postort",COUNTY:"L\xe4n",COUNTRY:"Land",SUPERADMIN:"Superadmin",ADD_NEW_ZONE:"L\xe4gg till ny plats",NAME:"Namn",INTERVAL:"Intervall",CURRENT_SCHEDULES:"Aktuella scheman",SCHEDULING:"Schemal\xe4ggning",CHOOSE_ALL:"V\xe4lj alla",THIS:"Den",EVERY_MONTH:"varje m\xe5nad",TIMEPOINT:"Tidpunkt",MONTHLY_REPORT:"M\xe5nadsrapport",REPORTS_TYPE:"Typ av rapport",CREATE_NEW_SCHEDULE:"Spara",SEND_REPORT:"Rapport skickas",MAIL_RECIPIENTS:"Mottagare",REPORT:"rapport",REPORT_SCHEDULING:"rapportschemal\xe4ggning",REMOVE_REPORT:"Ta bort scheman?",REPORT_DELETED:"Scheman har tagits bort",REPORT_CREATED:"Ett nytt schema skapades",EXPORT_AS:"Exportera filen som...",ALL_VEHICLES:"Alla fordon",ALL_ORG:"Alla organisationer",ALL_DRIVERS:"Alla f\xf6rare",LIGHT_MAP:"Ljus karta",LIGHT:"Ljus",DARK:"M\xf6rk",START_TYPING_TO_SEARCH:"B\xf6rja skriva f\xf6r att s\xf6ka",UPDATE:"Uppdatera senaste position",UPDATE_PURPOSE:"Syften uppdaterades",DO_YOU_WANT_TO_DOWNLOAD_REPORTS_FOR_ALL_VEHICLES:"Vill du ladda ner k\xf6rjournalrapport f\xf6r alla valda fordon?",DESCRIBE_CASE:"Beskriv ditt \xe4rende...",SUPPLY_TITLE:"Ange titel",TITLE:"Titel",SENT_INVITE:"Inbjudan skickad",BTN_CHANGE_ORG_FOR_VEHICLE:"Flytta fordonet till en annan organisation",MOVE_TO_ORG:"Flytta till annan organisation",JOURNEY:"K\xf6rjournal",FOLLOW:"Sp\xe5ra fordon",UPDATE_ODOMETER:"Uppdatera m\xe4tarst\xe4llning",CHOOSE_ORGS:"V\xe4lj organisation",FILTER_BY_ORG:"Filtrera efter organisation",FILTER_BY_BENEFIT_TYPE:"Filtrera efter typ",SCHEDULE_PRESELECTION:"F\xf6rval f\xf6r schema:",TOO_LARGE_DATA_LIMIT_PLEASE_SELECT_ORGANIZATION:"F\xf6r stort urval. V\xe4lj en organisation f\xf6r att kunna se k\xf6rjournalen.",REPORT_IS_CREATED:"Rapporten skapas...",ZONENAME:"titel",ADD_NEW_PURPOSE:"L\xe4gg till ett nytt resesyfte",SAVED_PURPOSE:"Dina sparade resesyften",DESCRIPTIONS:"Resesyften",SEARCH_DRIVER:"Filtrera efter f\xf6rare",ALARM_PLACES:"Geozon - larm",ALARM:"larm",PLACE:"Plats",ACKNOWLEDGED:"Kvitterat",SCHEDULE:"Schema",NEW_PLACE:"Ny plats",RADIUS:"Radie",ZONE_NAME:"Plats namn",NEW_ZONE:"Ny plats",RADIUS_MS:"Fr\xe5n",ZONES_DELETED:"Platsen har tagits bort",ADDRESS:"Adress",COORDINATE:"Koordinat",DESCRIPTION_GOAL:"Syfte",TRIP_TYPE:"Typ av resa",ENTRY_EXIT_TRIP:"Inresa/Utresa",DO_YOU_WANT_TO_DELETE_THIS_ZONE:'"Ta bort platsen?"',DATE_TO:"Till",ENTRY:"Inresa",EXIT:"Utresa",INSIDE:"Inom",OUTSIDE:"Utanf\xf6r",DISTORTION:"K\xe4nslighet",WHEN:"N\xe4r",WHERE:"Var",WHO:"Vem",WHICH:"Vilka",GEO_LARM_MESSAGE_INFO:"Dubbelklicka p\xe5 kartan eller ange adress f\xf6r att v\xe4lja en punkt. Str\xe4ck sedan ut omr\xe5det f\xf6r att markera det.",CHOOSE_MIN_3:"Du beh\xf6ver v\xe4lja minst 3 punkter p\xe5 kartan",REPEAT_AFTER:"Upprepa larmet",NOTIFICATION:"Notiser",SHOW_LARM:"Visa larmets detaljer",ACTUALLY:"Ej kvitterade",ONGOING:"P\xe5g\xe5ende...",TAX:"Tr\xe4ngselskatt",DEVICE:"Enhet",EXPORT_RAPPORT:"Exportera rapport",ALARM_TYPE:"Typ",ALARM_NAME:"Namn",HIGH:"H\xf6g",LOW:"L\xe5g",TRIGGERED_LARM:"Utl\xf6sta larm",STATUS:"Status",RESTORED:"\xc5terst\xe4llt",ACTIVATE_ALARM_WHEN:"Aktivera larmet om fordon befinner sig ... valt omr\xe5de",GET_NOTIFICATION:"F\xe5 notifikation om fordon befinner sig",AREA:"area",ENDED:"Avslutad",SEARCH_VEHICLE:"S\xf6k efter fordon, f\xf6rare...",GEO_ZONE:"Geozon",ACTIVE:"Aktivera",ARCHIVE:"Arkivera",ARCHIVED:"Arkiverad",SHOW_ARCHIVED:"Visa arkiverade fordon och anv\xe4ndare.",CANCEL:"Avbryt",messageArchivedAlert:"Arkiverade fordon kommer inte att inkluderas i appen. Du kan \xe4ndra ditt val fr\xe5n Mitt konto under Inst\xe4llningar",UNINSTALL_DEVICE:"Avinstallera enheten",RETIRE_DEVICE:"Pensionera enheten",MOVE_VEHICLE_TO_OTHER_ORGANIZATION:"Flytta fordonet till en annan organisation",REMOVE_VEHICLES_INFO:"Radera biluppgiftershistorik",REMOVE_VEHICLE:"Ta bort fordon",ROOT:"ROOT",SHOW_GEO_ZONE:"Visa geozon",CHECK_IN_DRIVER:"Incheckad f\xf6rare"},a={VEHICLE_REGNR:"Ange fordonets reg.nr",VEHICLE_ALIAS:"Ange ett fordons-alias",PERSON_FIRST_NAME:"Ange personens f\xf6rnamn",PERSON_LAST_NAME:"Ange personens efternamn",PERSON_EMAIL:"Ange personens e-post",PERSON_WRONG_EMAIL:"Ange en giltig e-postadress",PURPOSE:"Ange nytt syfte",PERSON_WRONG_PHONE:"Ange en giltig mobilnummer"},l={WARNINGS:"Varningar",STOCK:"I Lager",ON_THE_WAY:"P\xe5 v\xe4g",IN_DRIVE:"I drift",RETIRED:"Pensionerad"},r={ADD_AN_UNIT:"L\xe4gg till enhet",CONNECT_TO_ORG:"Koppla till organisation",AVL:"AVL",DISPLAY_UNIT:"Enhet",LOGG:"Logg",C12SMS:"C12 / SMS-Kommunikation",VEHICLE:"Fordon",CHANGE_ORG:"\xc4ndra organisation f\xf6r enhet"},o={DATE:"Datum",DATE_FROM:"Fr\xe5n",DATE_TO:"Till",FIELD_ID:"ID"},s={DATE_TIME:"Datum - Tid",NEW_VALUE:"Nytt v\xe4rde"},d={POOL:"Poolbil",PRIVATE:"Privat",BENEFIT:"F\xf6rm\xe5nsbil",WORK:"Arbetsfordon",TRACKER:"Tracker"},c={PRIVATE:"Privat",BUSINESS:"Tj\xe4nst"},u={NEW_PLACE:"Ny plats",NAME:"Namn",RADIUS:"Radie",ZONE_NAME:"Plats namn",NEW_ZONE:"Ny plats",RADIUS_MS:"Fr\xe5n",ZONES_DELETED:"Platsen har tagits bort",ADDRESS:"Adress",COORDINATE:"Koordinat",DESCRIPTION_GOAL:"Syfte",TRIP_TYPE:"Typ av resa",ENTRY_EXIT_TRIP:"Inresa/Utresa",DO_YOU_WANT_TO_DELETE_THIS_ZONE:"Ta bort platsen?",DATE_TO:"Till"},v={CHOOSE_VEHICLE:"V\xe4lj fordon",AVERAGE_AV_ECOSCORE_FOR_PERIOD:"Genomsnittlig EcoScore f\xf6r perioden",TOTAL_AVERAGE:"Total: Genomsnitt",CURVE_TAKING:"Kurvtagning",BAD_CURVE_TAKING_REDUCES_YOUR_ECOSCORE:"Skarp kurvtagning minskar din EcoScore",LIMIT_CURVE_TAKING:" Gr\xe4nsv\xe4rde 2,4 rad/s",RAPID_ACCELERATION_REDUCES_YOUR_ECOSCORE:"Hastig acceleration minskar din EcoScore",LIMIT_ACCELERATION:"Gr\xe4nsv\xe4rde 2,5 m/s2",LIMIT_BRAKING:"Gr\xe4nsv\xe4rde 2,7 m/s2",STARK_BRAKING_REDUCES_YOUR_ECOSCORE:"Kraftig inbromsning minskar din EcoScore",BRAKING:"Inbromsning",ACCELERATION:"Acceleration"},j={SOMETHING_GONE_WRONG_TRY_AGAIN:"N\xe5got gick fel. F\xf6rs\xf6k igen.",YES_CANCEL:"Ja, avbryt",NO_CONTINUE:"Nej, forts\xe4tt",WE_CAN_NOT_FIND_DATA_FOR_THIS_PERIOD:"Vi kunde inte hitta data f\xf6r vald period.",DATE_TO:"Till",ARE_YOU_SURE_TO_CANCEL:"\xc4r du s\xe4ker p\xe5 att du vill avbryta?",YOU_HAVE_ACTIVATE_THE:"Du har aktiverat ",YOU_HAVE_ARCHIVED_THE:"Du har arkiverat "},h={ENTRY:"Inresa",EXIT:"Utresa",BOTH:"Inresa & utresa"},p={ROOT:"Superadmin",DRIVER:"F\xf6rare",ADMIN:"F\xf6retagsadmin"},b={JOURNAL:"K\xf6rjournalrapport",SUMMARY_VEHICLE:"Sammanst\xe4lld fordonsrapport",SUMMARY_DRIVER:"Sammanst\xe4lld f\xf6rarrapport",SALARY:"Sammanst\xe4lld l\xf6nerapport",DISCREPANCY:"Avvikelserapport",PURPOSE:"Syftesrapport"}},20:function(e,t,n){"use strict";n.d(t,"b",(function(){return P})),n.d(t,"h",(function(){return V})),n.d(t,"g",(function(){return M})),n.d(t,"i",(function(){return F})),n.d(t,"a",(function(){return z})),n.d(t,"n",(function(){return U})),n.d(t,"m",(function(){return B})),n.d(t,"f",(function(){return G})),n.d(t,"d",(function(){return H})),n.d(t,"l",(function(){return Y})),n.d(t,"c",(function(){return W})),n.d(t,"j",(function(){return K})),n.d(t,"k",(function(){return q})),n.d(t,"p",(function(){return J})),n.d(t,"o",(function(){return Q})),n.d(t,"e",(function(){return Z}));var i=n(51),a=n(381),l=n(248),r=n(63),o=n(60),s=n(174),d=n(54),c=n(95),u=n(249),v=n(125),j=n(220),h=n(166),p=n(144),b=n(221),O=n(73),m=n(179),g=(n(65),n(152)),f=n(19),x=n(2),y=n(935),E=(n(936),n(0)),I=n(138),S=n(41),T=n.n(S),k=n(214),C=n(69),_=n(38),A=n(6),N=n(135),R=n(313),D=n(91),w=n(11),L=n(1);const P=e=>{let{knownOrganizations:t,organizationSelectOnChange:n,selectedOrganization:o}=e;return Object(L.jsxs)(a.a,{style:{margin:"auto",display:"flex",justifyContent:"center",alignItems:"center",maxWidth:"40%",minHeight:300},children:[Object(L.jsx)(l.a,{message:x.f.CHOOSE_ORGS,description:x.f.TOO_LARGE_DATA_LIMIT_PLEASE_SELECT_ORGANIZATION,type:"error"}),Object(L.jsx)("br",{}),Object(L.jsx)(i.a,{data:t,onChange:n,width:"100%",selectedOrganization:o,isMultiple:!1}),Object(L.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:20},children:Object(L.jsx)(r.a,{type:"primary",onClick:()=>{return e=o,localStorage.setItem(f.e,e),void window.location.reload(!1);var e},children:"Spara"})})]})},V={1:"M\xe5n",2:"Tis",3:"Ons",4:"Tor",5:"Fre",6:"L\xf6r",7:"S\xf6n"},M=e=>{let{onChange:t}=e;return Object(L.jsx)("div",{children:Object(L.jsxs)(o.a,{style:{width:200},placeholder:x.f.FILTER_BY_BENEFIT_TYPE,allowClear:!0,onChange:t,children:[Object(L.jsx)(o.a.Option,{value:"",children:"Alla"}),Object(L.jsx)(o.a.Option,{value:"TRACKER",children:"Utrustning"}),Object(L.jsx)(o.a.Option,{value:"VEHICLE",children:"Fordon"})]})})},F=()=>"#"+Math.random().toString(16).substr(-6),z=e=>{let{menu:t}=e;return Object(L.jsx)(s.a,{trigger:["click"],overlay:t,children:Object(L.jsx)(r.a,{style:{float:"right"},icon:Object(L.jsx)(y.a,{})})})},U={sticky:{offsetHeader:70},pagination:{showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," av ").concat(e," objekt"),showSizeChanger:!0}},B=e=>null===e||void 0===e?void 0:e.map((e=>({...e,ellipsis:!0}))),G=e=>{var t;let{visible:n,onCancel:i,updateOdometer:a,record:l}=e;const[r]=d.a.useForm(),o=Object(E.useRef)(),s=T()();Object(E.useEffect)((()=>{o.current=n}),[n]);const h=o.current;Object(E.useEffect)((()=>{!n&&h&&r.resetFields()}),[n]);const p=async e=>{e.valueKm=b,e.applyRetroactive=m,Object(I.b)(null===l||void 0===l?void 0:l.id,e,a),r.resetFields(),i()},[b,O]=Object(E.useState)(null===l||void 0===l||null===(t=l.odometer)||void 0===t?void 0:t.valueKm),[m,g]=Object(E.useState)(!1);return Object(L.jsx)(c.a,{title:"Uppdatera m\xe4tarst\xe4llning",visible:n,onOk:()=>{r.submit()},onCancel:i,children:Object(L.jsxs)(d.a,{form:r,layout:"vertical",onFinish:e=>{b>9e5?function(e,t){const n=new Intl.NumberFormat("sv-SE",{style:"decimal",currency:"SEK"});c.a.confirm({title:"Ovanligt h\xf6g m\xe4tarst\xe4llning",content:"Hoppsan, du verkar ha angett en ovanligt h\xf6g m\xe4tarst\xe4llning.\n\xc4r du s\xe4ker att du vill kalibrera till "+n.format(e)+" kilometer?",onOk:()=>p(t),cancelText:"Avbryt",okText:"Kalibrera"})}(b,e):p(e)},name:"userForm",children:[Object(L.jsxs)(d.a.Item,{name:"valueKm",label:"M\xe4tarst\xe4llning",rules:[{required:!1}],children:[Object(L.jsx)(u.a,{min:0,max:15e5,onChange:e=>{O(e)},defaultValue:b,style:{width:"50%"},suffix:"km"})," ","km"]}),Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(v.a,{onChange:e=>{g(e.target.checked)},checked:m,style:{marginLeft:"5px"},children:"Kalibrera fr.o.m. tidpunkt"}),Object(L.jsx)(d.a.Item,{name:"fromTimeMs",label:"Avl\xe4sningstidpunkt",rules:[{required:!1}],children:Object(L.jsx)(j.a,{disabled:!m,showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",defaultValue:s,placeholder:"V\xe4lj tidpunkt",style:{width:"50%"},onChange:()=>g(!0)})})]})]})})};function H(e){var t;let{record:n,updateRecord:i,setRecord:a}=e;const[l,r]=Object(E.useState)();Object(E.useEffect)((()=>{var e;r((null===n||void 0===n||null===(e=n.currentDriver)||void 0===e?void 0:e.id)||null)}),[n]);return Object(L.jsx)(c.a,{onOk:()=>{var e;let t=null===n||void 0===n?void 0:n.id;null!==n&&void 0!==n&&null!==(e=n.currentDriver)&&void 0!==e&&e.id||l?w.a.putCheckCurrentDriver(t,{userId:l}).then((e=>{var t;const a=null===n||void 0===n||null===(t=n.permittedDrivers)||void 0===t?void 0:t.find((e=>(null===e||void 0===e?void 0:e.id)===l)),r={...n,currentDriver:a};i(r)})):i(n)},onCancel:()=>a(null),title:"V\xe4lj incheckad f\xf6rare f\xf6r fordon  ".concat(null===n||void 0===n?void 0:n.registry),visible:!!n,children:Object(L.jsxs)(o.a,{style:{width:"100%"},value:l,onChange:e=>r(e),showSearch:!0,allowClear:!0,autoComplete:!1,filterOption:(e,t)=>{var n;return null===(n=t.children)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},children:[Object(L.jsx)(o.a.Option,{value:null,children:"Ingen f\xf6rare"}),null===n||void 0===n||null===(t=n.permittedDrivers)||void 0===t?void 0:t.map((e=>Object(L.jsx)(o.a.Option,{value:e.id,children:e.displayName})))]})})}const Y=(e,t,n,i,a)=>{var l,s;const d=null===(l=e.state)||void 0===l?void 0:l.imei,u=e.id;let v;const j=t.find((e=>e.id===u&&!(null!==e&&void 0!==e&&e.isArchived))),b=j?j.id:null,O="Flytta enhet ".concat(d," till ett annat fordon inom samma organisation"),m="Vill du koppla enhet ".concat(d," till ett annat fordon? ");c.a.confirm({title:a?m:O,okText:a?"Koppla":"Ok",cancelText:a?"Hoppa \xf6ver":"Avbryt",content:Object(L.jsxs)("div",{children:[Object(L.jsx)(o.a,{style:{width:"300px"},defaultValue:b,onChange:e=>v=e,children:null===t||void 0===t||null===(s=t.filter((t=>t.organizationId===e.organizationId)))||void 0===s?void 0:s.filter((e=>!e.isArchived)).map((e=>{var t;if(null===e||void 0===e||null===(t=e.state)||void 0===t||!t.imei||e.id===u)return Object(L.jsxs)(o.a.Option,{value:e.id,children:[e.registry," ",e.displayName]})}))}),Object(L.jsx)(h.a,{}),Object(L.jsxs)(k.a,{flexDirection:"column",alignItems:"center",justifyContent:"center",children:[Object(L.jsx)(p.a.Text,{children:"... eller skapa ett nytt fordon"}),Object(L.jsx)("br",{}),Object(L.jsx)(r.a,{onClick:()=>{i(e),c.a.destroyAll()},children:"Skapa nytt"})]})]}),onOk(){n(e,v,t)},onCancel(){console.log("Cancel")}})},W=(e,t,n)=>{let a;let l=(null!==e&&void 0!==e&&e.displayName?(null===e||void 0===e?void 0:e.displayName)+" ":"")+(null!==e&&void 0!==e&&e.registry?null===e||void 0===e?void 0:e.registry:"")||(null===e||void 0===e?void 0:e.id);c.a.confirm({title:"Flytta ".concat(l," till en annan organisation"),style:{minWidth:500},content:Object(L.jsx)(i.a,{width:"100%",data:t,defaultValue:e.organizationId,onChange:e=>a=e}),onOk(){n(e,a)},onCancel(){}})},K=e=>Object(L.jsxs)("div",{style:{maxWidth:200},children:[Object(L.jsx)(_.a,{text:null===e||void 0===e?void 0:e.registry}),Object(L.jsx)("br",{}),Object(L.jsx)(p.a.Text,{style:{textAlign:"left",margin:0,backgroundColor:""},children:null===e||void 0===e?void 0:e.displayName})]});function q(e,t){let n;return n="POOL"===(null===e||void 0===e?void 0:e.benefitType)?"Till\xe5ts f\xf6r alla":(null===t||void 0===t?void 0:t.displayName)||"F\xf6rare ej vald",n}function J(e){var t;const n=null===e||void 0===e?void 0:e.color;let i=null===e||void 0===e?void 0:e.marker;return(null===(t=i)||void 0===t?void 0:t.constructor)===String&&(i=N.a[i]),Object(L.jsx)("div",{children:Object(L.jsx)(b.a,{style:{backgroundColor:n},children:i?Object(L.jsx)(R.b,{marker:i}):Object(L.jsx)(C.Icon,{icon:D.androidCar})})})}const Q=e=>{const t=((null===e||void 0===e?void 0:e.registry)||"")+" "+((null===e||void 0===e?void 0:e.displayName)||"");return Object(L.jsx)(O.a,{title:t,children:Object(L.jsx)(m.a,{color:A.b.SWITCH_BUSINESS,style:{margin:5},children:e.registry||e.displayName})})},Z=e=>{let{record:t,handleUpdateFreq:n,setRecordFrequencyInterval:i}=e;const[a,l]=Object(E.useState)(!1),[r,s]=Object(E.useState)(),[u,j]=Object(E.useState)(!1),[h,b]=Object(E.useState)(!1),[O,m]=Object(E.useState)("12-h");Object(E.useEffect)((()=>{var e;t&&(l(!0),s("24h"===(null===t||void 0===t?void 0:t.latestResponseFrequency)?1:2),m("24h"!==(null===t||void 0===t?void 0:t.latestResponseFrequency)?null===t||void 0===t||null===(e=t.latestResponseFrequency)||void 0===e?void 0:e.replace("h","-h"):"12-h"),j(!1),b(!1))}),[t]);const f={display:"block",lineHeight:"22px",maxWidth:"100%",whiteSpace:"wrap",marginBottom:8};return Object(L.jsx)("div",{children:Object(L.jsx)(c.a,{title:"\xc4ndra uppdateringsfrekvens",visible:a,onOk:()=>{var e;if(!h&&2===r)return void j(!0);const a=1===r?"24-h":O;n((null===t||void 0===t?void 0:t.id)||(null===t||void 0===t||null===(e=t.meta)||void 0===e?void 0:e.vehicle_id),a,t).then((()=>{!function(e){var n;e=e.replace("-h","h");let i=(null===t||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.vehicleDisplayName)||(null===t||void 0===t?void 0:t.displayName);const a="Rapporteringsintervallet f\xf6r ".concat(i," \xe4ndrades till ").concat(e,".<br /><br />Denna \xe4ndring sl\xe5r igenom vid n\xe4sta rapporteringstillf\xe4lle."),l="Rapporteringsintervallet f\xf6r ".concat(i," \xe4ndrades till ").concat(e,".<br /><b>Observera att detta intervall f\xf6rkortar enhetens batteritid drastiskt.</b><br /><br />Denna \xe4ndring sl\xe5r igenom vid n\xe4sta rapporteringstillf\xe4lle.");let r;switch(e){case"1h":case"3h":r=l;break;case"6h":case"12h":r=a}c.a.success({title:"\xc4ndring registrerad",content:Object(L.jsx)("div",{dangerouslySetInnerHTML:{__html:r}})})}(a),l(!1),i(null)})).catch((e=>{console.error("Error",e)}))},okText:"Uppdatera",onCancel:()=>{l(!1),i(null)},children:Object(L.jsxs)(k.a,{flexDirection:"column",gap:12,children:[(null===t||void 0===t?void 0:t.selectedResponseFrequency)!==(null===t||void 0===t?void 0:t.latestResponseFrequency)&&Object(L.jsxs)(p.a,{style:{color:A.b.YELLOW},children:["V\xe4ntande \xe4ndring: ",t.selectedResponseFrequency]})," ",Object(L.jsx)(p.a,{children:"V\xe4lj hur ofta enheten ska skicka en uppdatering om sin position. Observera att ett kortare intervall \xe4n det rekommenderade kraftigt f\xf6rkortar batteriets livsl\xe4ngd."}),Object(L.jsxs)(g.a.Group,{onChange:e=>s(e.target.value),value:r,children:[Object(L.jsx)(g.a,{style:f,value:1,children:Object(L.jsx)("b",{children:"Var 24:e timme (rekommenderas)"})}),Object(L.jsx)(g.a,{style:f,value:2,children:Object(L.jsx)("b",{children:"Anpassat intervall"})}),Object(L.jsxs)(o.a,{value:O,style:{width:"100%"},onChange:e=>{s(2),m(e)},children:[Object(L.jsx)(o.a.Option,{value:"12-h",children:"12 h"}),Object(L.jsx)(o.a.Option,{value:"6-h",children:"6 h"}),Object(L.jsx)(o.a.Option,{value:"3-h",children:"3 h"}),Object(L.jsx)(o.a.Option,{value:"1-h",children:"1 h"})]})]}),2===r&&Object(L.jsx)(d.a.Item,{validateStatus:u?"error":null,children:Object(L.jsx)(v.a,{checked:h,onChange:e=>{b(e.target.checked)},style:{color:u?A.b.RED:null},children:"* Jag \xe4r inf\xf6rst\xe5dd med att detta val kraftigt f\xf6rkortar enhetens batteritid."})})]})})})}},214:function(e,t,n){"use strict";var i=n(49);t.a=i.a},217:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));n(0);var i=n(11),a=n(541),l=n(95),r=(n(2),n(20),n(1));async function o(e,t,n,a){try{const r=await i.a.patchActivateVehicle(null===e||void 0===e?void 0:e.id),o=[...t],s=null===o||void 0===o?void 0:o.findIndex((t=>(null===e||void 0===e?void 0:e.id)===t.id));o.splice(s,1,{...o[s],...r}),n(o),l.a.success({title:"Fordonet \xe4r aktiverat",content:"Du har aktiverat fordon ".concat((null===e||void 0===e?void 0:e.registry)||(null===e||void 0===e?void 0:e.displayName),". \xc4ndra inst\xe4llningar i n\xe4sta steg."),okText:"OK",cancelText:"\xc5ngra",onOk:()=>{a(e)}})}catch(r){console.error(r)}}const s=(e,t,n,o,s,d,c)=>{l.a.confirm({title:"Arkivera fordon",icon:Object(r.jsx)(a.a,{}),content:Object(r.jsxs)("div",{children:[Object(r.jsxs)("p",{children:["Du kommer att arkivera fordon ",e.registry||e.displayName,"."]}),Object(r.jsx)("p",{children:Object(r.jsx)("b",{children:"Kopplingen mellan fordonet och dess Trackson-enhet kommer att brytas. Enheten kan d\xe4refter installeras i ett annat fordon."})}),Object(r.jsx)("p",{children:"All data som har registrerats fram tills nu finns kvar."}),Object(r.jsx)("p",{children:"Vill du arkivera fordonet?"})]}),onOk(){let a;i.a.patchArchiveVehicle(null===e||void 0===e?void 0:e.id).then((i=>{var l,r;a=[...t];const s=null===(l=a)||void 0===l?void 0:l.findIndex((t=>(null===e||void 0===e?void 0:e.id)===t.id)),d=a[s];if(a.splice(s,1,{...d,...i}),n(a),null!==e&&void 0!==e&&null!==(r=e.state)&&void 0!==r&&r.imei){const t=null===o||void 0===o?void 0:o.find((t=>{var n;return(null===t||void 0===t?void 0:t.imei)===(null===e||void 0===e||null===(n=e.state)||void 0===n?void 0:n.imei)}));t.installedVehicle=null}})).then((t=>{var n;if(null!==e&&void 0!==e&&null!==(n=e.state)&&void 0!==n&&n.imei){s(e,a,d,c,!0)}}))},onCancel(){},okText:"Arkivera"})}},246:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i={1:"Januari",2:"Februari",3:"Mars",4:"April",5:"Maj",6:"Juni",7:"Juli",8:"Augusti",9:"September",10:"Oktober",11:"November",12:"December"}},247:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return c}));var i=n(11),a=(n(0),n(541)),l=n(95),r=n(115),o=n(2),s=n(1);function d(e,t,n,a){l.a.success({title:"Anv\xe4ndaren \xe4r aktiverad",content:Object(s.jsxs)("div",{children:[Object(s.jsxs)("p",{children:["Du har aktiverat ",e.displayName,". Anv\xe4ndaren kan nu logga in med sina tidigare inloggningsuppgifter."]}),Object(s.jsx)("p",{children:"Du kan \xe4ndra anv\xe4ndaruppgifter i n\xe4sta steg."})]}),okText:"OK",cancelText:"\xc5ngra",onOk:async()=>{try{const l=await i.a.patchActivateUser(null===e||void 0===e?void 0:e.id),r=[...t],o=null===r||void 0===r?void 0:r.findIndex((t=>(null===e||void 0===e?void 0:e.id)===t.id));r.splice(o,1,{...r[o],...l}),n(r),console.log(l),a(e)}catch(l){console.error(l)}}})}function c(e,t,n){l.a.confirm({title:"Arkivera anv\xe4ndare",icon:Object(s.jsx)(a.a,{}),okText:"Arkivera",content:Object(s.jsxs)("div",{children:[Object(s.jsxs)("p",{children:["Du kommer att arkivera ",null===e||void 0===e?void 0:e.displayName,"."]}),Object(s.jsx)("p",{children:Object(s.jsx)("b",{children:" Anv\xe4ndaren kommer inte l\xe4ngre att kunna logga in i systemet."})}),Object(s.jsx)("p",{children:" All data som har skapats fram tills nu finns kvar."}),Object(s.jsx)("p",{children:"Vill du arkivera anv\xe4ndaren?"})]}),onOk(){i.a.patchArchiveUser(null===e||void 0===e?void 0:e.userId).then((i=>{const a=[...t],l=null===a||void 0===a?void 0:a.findIndex((t=>(null===e||void 0===e?void 0:e.userId)===t.userId)),r=a[l];a.splice(l,1,{...r,...i}),n(a)})).then((t=>{r.b.open({type:"success",content:o.c.YOU_HAVE_ARCHIVED_THE+o.f.USERS.toLowerCase()+" "+((null===e||void 0===e?void 0:e.displayName)||(null===e||void 0===e?void 0:e.id))})}))},onCancel(){}})}},255:function(e,t,n){"use strict";n.r(t),n.d(t,"modules",(function(){return Io})),n.d(t,"AppViews",(function(){return ko}));var i=n(0),a=n.n(i),l=n(98),o=n(55),s=n(18),d=n(108),c=n(12),u=n(54),v=n(144),j=n(381),h=n(63);const p=e=>{switch(e){case"FUNCTION":return f;case"SECURITY":return m;case"QUALITY":return g;case"GEO":return x;default:return null}},b={FUNCTION:"Funktionslarm",SECURITY:"S\xe4kerhetslarm",QUALITY:"Kvalitetslarm",GEO:"Geolarm"},O={NO_DRIVER:"F\xf6rarl\xf6s resa",UNPLUG:"Enhet urkopplad",BATTERY_SUB_20:"L\xe5g batterisp\xe4nning",DRIVING_SCHEDULE:"F\xe5r ej k\xf6ras utanf\xf6r schema",MISSING_TRIPS:"Resor ej rapporterade p\xe5 X dagar",INTERMITTENCE:"Tappad kontakt",JAMMING:"St\xf6rd signal (jamming)",CRASH:"Incident",TOWING:"B\xe4rgning",ODO_DIFF:"Odometer-diff skillnad mellan stopp och start",ODO_REMIND:"P\xe5minnelse Odo",ON_WAY:'"P\xe5 v\xe4g" under l\xe5ng tid',GEO_ZONE:"Geofence"},m={JAMMING:"St\xf6rd signal (jamming)",CRASH:"Incident"},g={ON_WAY:'"P\xe5 v\xe4g" under l\xe5ng tid'},f={NO_DRIVER:"F\xf6rarl\xf6s resa",UNPLUG:"Enhet urkopplad",BATTERY_SUB_20:"L\xe5g batterisp\xe4nning",MISSING_TRIPS:"Resor ej rapporterade p\xe5 X dagar",INTERMITTENCE:"Tappad kontakt"},x={GEO_ZONE:"Geofence"},y={CRITICAL:"KRITISK",HIGH:"H\xd6G",MEDIUM:"MEDEL",LOW:"L\xc5G"},E={alarmName:"Kategori",organizationId:"Organisation",alarmPrio:"Prio",name:"Alias",emails:"V\xe4lj mottagare",targetVehicleIds:"V\xe4lj fordon",schema:"Schema",repeatAfterHours:"Upprepa",daysMissingTrips:"Notifikation",notifyWhenAcknowledged:"Kvittering av larm",hoursMissingContact:"Notifikation",odoRemindDay:"Upprepa",isTracker:"Fordon/utrustning"},I={NO_DRIVER:{alarmName:!0,organizationId:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1,isTracker:!1},ODO_DIFF:{alarmName:!0,organizationId:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1,isTracker:!1},ON_WAY:{alarmName:!0,organizationId:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1,isTracker:!1},TOWING:{alarmName:!0,organizationId:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1,isTracker:!1},BATTERY_SUB_20:{alarmName:!0,organizationId:!0,isTracker:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1,lowBatteryLevel:!0},UNPLUG:{alarmName:!0,organizationId:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1,isTracker:!1},ODO_REMIND:{alarmName:!0,organizationId:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1,odoRemindDay:!0,isTracker:!1},DRIVING_SCHEDULE:{alarmName:!0,organizationId:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!0,isTracker:!1},MISSING_TRIPS:{alarmName:!0,organizationId:!0,alarmPrio:!1,name:!0,daysMissingTrips:!0,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1,isTracker:!1},INTERMITTENCE:{alarmName:!0,organizationId:!0,isTracker:!0,alarmPrio:!1,name:!0,hoursMissingContact:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1},CRASH:{alarmName:!0,organizationId:!0,isTracker:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,notifyWhenAcknowledged:!0,targetVehicleIds:!0,emails:!0,schema:!1},JAMMING:{alarmName:!0,organizationId:!0,isTracker:!0,alarmPrio:!1,name:!0,daysMissingTrips:!1,repeatAfterHours:!0,targetVehicleIds:!0,notifyWhenAcknowledged:!0,emails:!0,schema:!1}};var S=n(49);const T={emails:{width:"50%",paddingLeft:"10px"},targetVehicleIds:{paddingRight:"10px",width:"50%"},schema:{width:"100%"},daysMissingTrips:{},notifyWhenAcknowledged:{},lowBatteryLevel:{width:"30%"},selectDay:{width:80,margin:0},interval:{display:"flex",gap:15,alignItems:"center"}};var k=n(60),C=n(110),_=n(152),A=n(249),N=n(378),R=n(382),D=n(476),w=n(19),L=n(73),P=n(312),V=n(466),M=n(196),F=n(11),z=n(983),U=n(2),B=n(1);const G=e=>{let{data:t,displayTitle:n,displayPlaceHolder:a,selectedMethod:l,deleteEmail:r,addEmail:o}=e;const[s]=u.a.useForm(),[d,c]=Object(i.useState)([]);Object(i.useEffect)((()=>{F.a.getUsers().then((e=>{var t;e=null===(t=e)||void 0===t?void 0:t.filter((e=>!(null!==e&&void 0!==e&&e.isArchived))),c(e)}))}),[]);const[v,p]=Object(i.useState)(),b=[{title:l+" f\xf6r "+(null===n||void 0===n?void 0:n.toLowerCase()),dataIndex:"email",key:"email",width:"90%",render:e=>Object(B.jsx)("a",{children:e})},{key:"delete",width:"10%",render:(e,t)=>Object(B.jsxs)("div",{children:[Object(B.jsx)(L.a,{title:"\xc4ndra"}),Object(B.jsx)(P.a,{title:"Ta bort anv\xe4ndare?",okText:"Ta bort",onConfirm:()=>r(t),children:Object(B.jsx)(L.a,{title:"Ta bort",children:Object(B.jsx)("a",{style:{color:"#de4436"},children:Object(B.jsx)(z.a,{style:{fontSize:"18px"}})})})})]})}],O=Object.entries(d).map((e=>{let[t,n]=e;return{value:n.displayEmail,label:n.displayName+" - "+n.displayEmail}}));return Object(B.jsxs)(j.a,{bordered:!1,style:{height:350,overflow:"auto"},children:[Object(B.jsx)("div",{children:Object(B.jsxs)(u.a,{layout:"inline",form:s,children:[Object(B.jsx)(u.a.Item,{style:{width:"70%"},name:"email",rules:[{type:"email",message:U.b.PERSON_EMAIL},{required:!0,message:"Please input your E-mail!"}],children:Object(B.jsx)(V.a,{style:{minWidth:200},options:O,filterOption:(e,t)=>-1!==t.value.toUpperCase().indexOf(e.toUpperCase()),onChange:e=>{p(e)},children:Object(B.jsx)(C.a,{placeholder:a,value:v})})}),Object(B.jsx)(u.a.Item,{style:{width:"20%"},children:Object(B.jsx)(h.a,{onClick:()=>{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(v)&&(o(v),p(null),s.resetFields())},type:"primary",children:"L\xe4gg till"})})]})}),Object(B.jsx)(M.a,{columns:b,dataSource:t,pagination:!1})]})};var H=n(6);const{Title:Y}=v.a,W=e=>{const t=null!==e&&void 0!==e&&e.isTracker?"":"".concat(U.k[e.benefitType]," "),n=null===e||void 0===e?void 0:e.registry,i=null!==e&&void 0!==e&&e.displayName?" (".concat(e.displayName,")"):null;return n&&i?t+n+i:n?i?t+(null===e||void 0===e?void 0:e.vehicleId):t+n:t+(null===e||void 0===e?void 0:e.displayName)},K=e=>Object(B.jsx)("p",{children:W(e)}),q=e=>{const t=null===e||void 0===e?void 0:e.displayName;return Object(B.jsx)("p",{children:t})},J=e=>{let{emailData:t,setEmailData:n,...i}=e;return Object(B.jsx)("div",{style:i.style,children:Object(B.jsx)(G,{data:t,displayTitle:U.f.REPORT_SCHEDULING,displayPlaceHolder:U.f.SUPPLY_AN_EMAIL_ADDRESS,selectedMethod:U.f.MAIL,deleteEmail:e=>{const i=null===t||void 0===t?void 0:t.filter((t=>t!==e));n(i)},addEmail:e=>{const i=[...t,{email:e}];n(i)}})})},Q=e=>{let{checkedKeys:t,setCheckedKeys:n,knownOrganizations:a,...l}=e;const[r,o]=Object(i.useState)(["-1"]),[s,d]=Object(i.useState)(!0),c=l.selectedOrganization?l.selectedOrganization:parseInt(localStorage.getItem(w.e)),v=null===a||void 0===a?void 0:a.filter((e=>e.organizationId===c)),h=a.filter((e=>null!==e.parentOrganization)),p=[];if(c){const e=h.filter((e=>e.parentOrganization===v[0].organizationId));p.push(v[0]);for(let t of e)p.push(t)}const b=p.map((e=>{var n,i,a,r,o;let s=null===(n=l.knownVehicles)||void 0===n||null===(i=n.filter((e=>!e.isArchived)))||void 0===i||null===(a=i.filter((e=>l.isTracker?e.isTracker:!e.isTracker)))||void 0===a||null===(r=a.filter((t=>(null===t||void 0===t?void 0:t.organizationId)===(null===e||void 0===e?void 0:e.organizationId))))||void 0===r||null===(o=r.filter((e=>!(null!==t&&void 0!==t&&t.includes("org:"+(null===e||void 0===e?void 0:e.organizationId))))))||void 0===o?void 0:o.map((e=>({title:l.drivers?q(e):K(e),key:(null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.userId)})));return{title:null===e||void 0===e?void 0:e.fullName,key:"org:".concat(null===e||void 0===e?void 0:e.organizationId),children:[...s]}})),O=[{title:U.f.CHOOSE_ALL,key:"-1",children:b}];return Object(B.jsx)(j.a,{bordered:!1,style:{height:350},children:Object(B.jsx)(u.a.Item,{name:H.k.reportTarget,rules:[{required:!1,message:U.f.CHOOSE_A_VEHICLE}],children:Object(B.jsx)(D.a,{checkable:!0,onExpand:e=>{o(e),d(!1)},expandedKeys:r,autoExpandParent:s,onCheck:e=>{n(e)},checkedKeys:t,treeData:O,height:300,defaultExpandAll:!0})})})};var Z=n(51),X=n(65),$=n(115),ee=n(248);const te=[{featureType:"all",elementType:"geometry",stylers:[{color:"#202c3e"}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{gamma:.01},{lightness:20},{weight:"1.39"},{color:"#ffffff"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{weight:"0.96"},{saturation:"9"},{visibility:"on"},{color:"#000000"}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{lightness:30},{saturation:"9"},{color:"#29446b"}]},{featureType:"poi",elementType:"geometry",stylers:[{saturation:20}]},{featureType:"poi.park",elementType:"geometry",stylers:[{lightness:20},{saturation:-20}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:10},{saturation:-30}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#193a55"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{saturation:25},{lightness:25},{weight:"0.01"}]},{featureType:"water",elementType:"all",stylers:[{lightness:-20}]}],ne=(e,t)=>{const n="DARK"===localStorage.getItem(w.d);let i=n?[]:te,a=n?"Ljus karta":"M\xf6rk karta";const l=new e.StyledMapType(i,{name:a});t.mapTypes.set("dark",l)},ie={styles:"DARK"===localStorage.getItem(w.d)?te:null,streetViewControl:!0,mapTypeControl:!0,mapTypeControlOptions:{mapTypeIds:["roadmap","dark","satellite","hybrid","terrain"]}};var ae=n(118),le=n(984),re=n(20),oe=n(393);const se=e=>{let{locations:t,setLocations:n,editKey:a,setEditKey:l,userId:r,...o}=e;const[s,d]=Object(i.useState)(),[c,u]=Object(i.useState)(),[v,j]=Object(i.useState)(null);return Object(i.useEffect)((()=>{t&&t.length>0&&n(t)}),[]),Object(i.useEffect)((()=>{j(null)}),[a]),Object(B.jsxs)("div",{children:[Object(B.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",margin:"15px"}}),Object(B.jsx)(de,{setAddress:j,setCoordinate:u,editKey:a,showLocations:(null===t||void 0===t?void 0:t.length)>0?t:[],setRadius:d,radiusMs:s,showMap:o.showMap}),Object(B.jsx)("br",{}),Object(B.jsx)(ce,{userId:r,selectedId:o.selectedId,setAddress:j,address:v,data:t,getRadius:s,setEditKey:l,editKey:a,setData:n,coordinate:c,setShowMap:o.setShowMap})]})},de=e=>{const[t,n]=Object(i.useState)(),[a,l]=Object(i.useState)(),r=e.editKey,[o,d]=Object(i.useState)([59.334591,18.06324]),[c,u]=Object(i.useState)(null);let v,j=e.showLocations;Object(i.useEffect)((()=>{t&&a&&(null===a||void 0===a||a.event.trigger(t,"resize"),null===t||void 0===t||t.setOptions({...ie,styles:"DARK"===localStorage.getItem(w.d)?te:null}),ne(a,t))}),[localStorage.getItem(w.d),t,a]);const h=t=>{var n;const i=null===(n=c[0])||void 0===n?void 0:n.getRadius().toFixed();e.setRadius(Number(i))},p=t=>{if(e.coordinate!==[c[0].getCenter().lat(),c[0].getCenter().lng()]){t||(t={lat:c[0].getCenter().lat(),lng:c[0].getCenter().lng()});const n={lat:t.lat,lng:t.lng};if(e.showMap&&c){e.setCoordinate([t.lat,t.lng]);const i=new a.Geocoder;setTimeout((()=>{!function(e,t,n){e.geocode({location:n}).then((e=>{e.results[0]})).catch((e=>{console.log(e),setTimeout(3e3)}))}(i,0,n)}),1500)}}},b=t=>{if(e.editKey){var n;const e={lat:t.latLng.lat(),lng:t.latLng.lng()};null===(n=c[0])||void 0===n||n.setCenter(e),p(e)}};e.showMap||e.setCoordinate(null),Object(i.useEffect)((()=>{(null===c||void 0===c?void 0:c.length)>0&&(null===a||void 0===a||a.event.addListener(c[0],"radius_changed",h),null===a||void 0===a||a.event.addListener(c[0],"center_changed",p),null===a||void 0===a||a.event.addListener(t,"dblclick",b))}),[c]),Object(i.useEffect)((()=>{if(t&&a&&j){var n;if(r||d(null),r)j=null===(n=j)||void 0===n?void 0:n.filter((t=>t.zoneId===e.editKey));O({map:t,maps:a,filteredOverviewData:j})}}),[t,a,j,e.editKey]);const O=t=>{let{map:n,maps:i,filteredOverviewData:a}=t;c&&c.map((e=>{null===e||void 0===e||e.setMap(null)}));let l=[];null===a||void 0===a||a.sort(((e,t)=>t.radiusMs-e.radiusMs)).map(((t,a)=>{const o=t.zoneId===r;o&&(d([t.latitude,t.longitude]),e.setRadius(t.radiusMs)),v=new i.Circle({strokeColor:t.tripType===H.a.BUSINESS?"#17bcff":H.b.SWITCH_PRIVATE,strokeOpacity:.8,strokeWeight:.5,fillColor:t.tripType===H.a.BUSINESS?H.b.SWITCH_BUSINESS:"#0C6D44",fillOpacity:.3,map:n,draggable:!1,editable:o,center:{lat:t.latitude,lng:t.longitude},radius:t.radiusMs,geodesic:!0});const s=t.address||"-",c='<div id="content"><div id="siteNotice">'+t.zoneName+'<div id="bodyContent">'+s+"</div></div>",u=new i.InfoWindow({content:c,position:{lat:t.latitude,lng:t.longitude}});o||(v.addListener("mouseover",(()=>{u.open(n,v)})),v.addListener("mouseout",(()=>{u.close(n,v)}))),l=[...l,v,u]})),u(l)};Object(i.useEffect)((()=>{var n;r&&e.showMap&&(j=null===(n=j)||void 0===n?void 0:n.filter((e=>e.zoneId===r)));if(!e.showMap&&t&&a){const n=xe(a,e.showLocations);t.fitBounds(n)}}),[r,e.showMap]);const m=Object(i.useRef)(null),g=document.getElementById("places-ref"),f=()=>{var n,i,a,l;if(null===m||void 0===m||null===(n=m.current)||void 0===n||!n.getPlaces())return;const r=null===(i=m.current)||void 0===i?void 0:i.getPlaces()[0],o=null===r||void 0===r||null===(a=r.geometry)||void 0===a?void 0:a.viewport;t.fitBounds(o);const s=r.geometry.location.lat(),d=r.geometry.location.lng();e.setCoordinate([s,d]),e.setAddress(r.formatted_address);const u={lat:s,lng:d};null===(l=c[0])||void 0===l||l.setCenter(u)};return Object(i.useEffect)((()=>(null!==m&&void 0!==m&&m.current||null===a||void 0===a||!a.places||(m.current=new a.places.SearchBox(g),m.current.addListener("places_changed",f)),()=>{a&&(m.current=null,a.event.clearInstanceListeners(m))})),[a,f]),Object(B.jsx)("div",{style:{height:"50vh",width:"100%",position:r?"sticky":"relative",top:r?80:null,zIndex:10},children:Object(B.jsx)(ae.a,{bootstrapURLKeys:s.e,center:o,zoom:e.showMap?12:10,options:{...ie,disableDoubleClickZoom:r},yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:t=>{let{map:i,maps:a}=t;var r;if(ne(a,i),n(i),a)if(l(a),(null===e||void 0===e||null===(r=e.showLocations)||void 0===r?void 0:r.length)<1){const e=xe(a);i.fitBounds(e)}else{const t=xe(a,e.showLocations);i.fitBounds(t)}}})})},ce=e=>{const[t]=u.a.useForm(),[n,a]=Object(i.useState)(e.data),l=e.coordinate,[r,o]=Object(i.useState)();Object(i.useEffect)((()=>{o(e.address)}),[e.address]),Object(i.useEffect)((()=>{a(e.data)}));const s=t=>t.zoneId===e.editKey,d=()=>{t.resetFields(),e.setEditKey(""),e.setShowMap(!1)};const c=t=>{-1!==n.length&&(F.a.deleteZone(e.selectedId||e.userId,t.zoneId).then($.b.success(U.i.ZONES_DELETED)),function(t){const i=n.filter((e=>e.zoneId!==t.zoneId));a(i),e.setData(i)}(t))},v=[{title:U.i.NAME,dataIndex:H.m.ZONE_NAME,key:H.m.ZONE_NAME,editable:!0,width:"10%"},{title:U.i.ADDRESS,dataIndex:H.m.ADDRESS,key:H.m.ADDRESS,editable:!0,width:"30%",render:e=>e||null},{title:U.i.COORDINATE,dataIndex:H.m.LATITUDE,key:H.m.LATITUDE,editable:!0,width:"10%",render:(e,t)=>Object(B.jsxs)("span",{children:[t.latitude,",",Object(B.jsx)("br",{}),t.longitude]})},{title:U.i.RADIUS,dataIndex:H.m.RADIUS_MS,key:H.m.RADIUS_MS,editable:!1,width:"10%",render:(t,n)=>{let i=n.radiusMs;return e.editKey===n.zoneId&&(i=e.getRadius),Object(B.jsxs)("span",{style:{width:200},children:[i," m"]})}},{title:U.i.TRIP_TYPE,dataIndex:H.m.TRIP_TYPE,key:H.m.TRIP_TYPE,editable:!0,width:"10%",render:e=>(e=e===H.a.BUSINESS,Object(B.jsx)(h.a,{style:{color:e?"#699DFF":H.b.SWITCH_PRIVATE},children:e?U.m.BUSINESS:U.m.PRIVATE}))},{title:U.i.ENTRY_EXIT_TRIP,dataIndex:H.m.APPLICATION,key:H.m.APPLICATION,editable:!0,width:"10%",render:(e,t)=>{let n=t.activeOnTripStart&&t.activeOnTripEnd;return n=n?H.m.BOTH:null,n||(n=t.activeOnTripStart?H.m.EXIT:H.m.ENTRY),Object.entries(U.j).map((e=>{let[t,i]=e;if(t===n)return i}))}},{title:U.i.DESCRIPTION_GOAL,dataIndex:H.m.DESCRIPTION,key:H.m.DESCRIPTION,width:"10%",editable:!0},{dataIndex:H.m.OPERATION,width:"5%",render:(i,o)=>s(o)?Object(B.jsxs)("span",{children:[Object(B.jsxs)("a",{onClick:()=>(async i=>{const o=await t.validateFields(),s=[...n],c=s.findIndex((e=>i===e.zoneId)),u=s[c];console.log(o),console.log(e.address),null!==o.tripType&&(o.tripType=o.tripType===H.a.BUSINESS||!0===o.tripType?H.a.BUSINESS:H.a.PRIVATE),o.latitude=l?l[0]:u.latitude,o.longitude=l?l[1]:u.longitude,o.radiusMs=e.getRadius?e.getRadius:u.radiusMs,o.tripType=o.tripType?o.tripType:u.tripType,o.address=r,o.application&&(o.activeOnTripStart=o.application===H.m.EXIT||o.application===H.m.BOTH,o.activeOnTripEnd=o.application===H.m.ENTRY||o.application===H.m.BOTH),c>-1?s.splice(c,1,{...u,...o}):s.push(o),F.a.putZone((null===e||void 0===e?void 0:e.selectedId)||e.userId,i,o).then((()=>{e.setData(s),a(s),d()}))})(o.zoneId),style:{marginRight:8},children:[" ",U.f.SAVE]}),Object(B.jsx)("a",{onClick:()=>d(o.zoneId),children:U.f.BTN_ABORT})]}):Object(B.jsx)(re.a,{menu:()=>function(n){return Object(B.jsxs)(X.a,{children:[Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(oe.a,{}),onClick:()=>(n=>{t.resetFields(),t.setFieldsValue({...n}),e.setEditKey(n.zoneId),e.setShowMap(!0),$.b.destroy(),$.b.info(U.f.DBCLICK_ON_MAP_TO_CHOOSE_LOCATION,15)})(n),children:[U.f.BTN_CHANGE," "]}),Object(B.jsxs)(X.a.Item,{danger:!0,icon:Object(B.jsx)(z.a,{}),onClick:()=>c(n),children:[U.f.DELETE," "]})]})}(o)})}];const j={body:{cell:ue}},p=v.map((t=>t.editable?{...t,onCell:n=>({record:n,inputType:t.dataIndex===H.m.ZONE_NAME?H.m.ZONE_NAME:H.m.COORDINATE,dataIndex:t.dataIndex,coordinate:l,setNewRadius:e.setRadius,title:t.title,editing:s(n),setAddress:e.setAddress,address:e.address,override:r,setOveride:o})}:t));return Object(B.jsx)("div",{children:Object(B.jsx)(u.a,{form:t,component:!1,children:Object(B.jsx)(u.a,{form:t,component:!1,children:Object(B.jsx)(M.a,{components:j,rowKey:e=>e.zoneId,scroll:{x:1e3},dataSource:e.editKey?null===n||void 0===n?void 0:n.filter((t=>(null===t||void 0===t?void 0:t.zoneId)===e.editKey)):n,columns:p,rowClassName:"editable-row",pagination:!1})})})})},ue=e=>{var t;let{editing:n,dataIndex:a,title:l,inputType:r,record:o,index:s,coordinate:d,setNewRadius:c,children:j,...h}=e;const[p,b]=Object(i.useState)(null===o||void 0===o||null===(t=o.tripType)||void 0===t?void 0:t.startsWith(H.a.BUSINESS)),[O,m]=Object(i.useState)(null===o||void 0===o?void 0:o.radiusMs);Object(i.useEffect)((()=>{var e;b(null===o||void 0===o||null===(e=o.tripType)||void 0===e?void 0:e.startsWith(H.a.BUSINESS)),h.setOveride&&h.setOveride(null===o||void 0===o?void 0:o.address)}),[n]),Object(i.useEffect)((()=>{}),[h.address]);const g=(()=>{switch(a){case"latitude":return d?Object(B.jsxs)(v.a.Text,{children:[d[0],", ",Object(B.jsx)("br",{})," ",d[1]]}):Object(B.jsxs)(v.a.Text,{children:[null===o||void 0===o?void 0:o.latitude,", ",Object(B.jsx)("br",{})," ",null===o||void 0===o?void 0:o.longitude]});case"tripType":return Object(B.jsx)(R.a,{style:{marginLeft:15,backgroundColor:!0===p?H.b.SWITCH_BUSINESS:H.b.SWITCH_PRIVATE},checkedChildren:U.m.BUSINESS,unCheckedChildren:U.m.PRIVATE,checked:p,onChange:e=>{b(e)}});case"application":let e=o.activeOnTripStart&&o.activeOnTripEnd?H.m.BOTH:null;return e||(e=o.activeOnTripStart?H.m.EXIT:H.m.ENTRY),Object(B.jsx)(k.a,{defaultValue:e||null,children:ve});case"radiusMs":return Object(B.jsxs)("div",{style:{display:"flex",alignItems:"bottom",flexDirection:"column"},children:[" ",O," m",Object(B.jsx)(N.a,{onChange:e=>{c(e),m(e)},style:{width:150},max:800,value:O})]});case"address":return Object(B.jsx)(L.a,{title:"Om den \xe4r tom kommer den faktiska positionen att anv\xe4ndas",children:Object(B.jsx)(C.a,{style:{minWidth:250},placeholder:U.f.SUPPLY_A_NEW_ORG_STREET_ADDRESS,id:"places-ref",value:h.override,allowClear:!0,onChange:e=>{e.target.value?h.setOveride(e.target.value):(console.log("tom",e.target.value),h.setOveride(" "))}})});default:return Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY+U.f[null===a||void 0===a?void 0:a.toUpperCase()],style:{minWidth:180}})}})();return Object(B.jsx)("td",{...h,children:n?Object(B.jsx)(u.a.Item,{name:a,style:{margin:0},rules:[{required:!1,message:"Please Input ".concat(l,"!")}],children:g}):j})},ve=Object.entries(U.j).map((e=>{let[t,n]=e;return Object(B.jsx)(k.a.Option,{value:t,children:n},t)}));var je=n(240),he=n(395);const{Option:pe,OptGroup:be}=k.a,Oe=e=>{let{data:t,value:n,onChange:i,multiple:a}=e;const l=null===t||void 0===t?void 0:t.filter((e=>!(null!==e&&void 0!==e&&e.isArchived))),r=null===t||void 0===t?void 0:t.filter((e=>null===e||void 0===e?void 0:e.isArchived));return Object(B.jsx)("div",{children:Object(B.jsxs)(k.a,{showSearch:!0,mode:a,allowClear:a,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.object))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},maxTagCount:1,style:{minWidth:200},dropdownStyle:{minWidth:400},autoClearSearchValue:!1,placeholder:U.f.SEARCH_DRIVER,optionFilterProp:"children",onChange:e=>i(e),onSearch:()=>null,value:n,children:[a&&Object(B.jsx)(pe,{style:{color:"#286FBE",cursor:"pointer"},value:-1,children:(null===n||void 0===n?void 0:n.length)>0?Object(B.jsx)("span",{style:{color:"#286FBE",cursor:"pointer"},children:"Avmarkera alla"}):Object(B.jsx)("span",{style:{color:"#286FBE",cursor:"pointer"},children:"V\xe4lj alla"})},-1),null===l||void 0===l?void 0:l.map(((e,t)=>Object(B.jsx)(pe,{value:e.userId,object:e,children:e.displayName}))),(null===r||void 0===r?void 0:r.length)>0&&Object(B.jsx)(be,{label:"Arkiverade",children:null===r||void 0===r?void 0:r.map(((e,t)=>Object(B.jsxs)(pe,{value:e.userId,object:e,children:[Object(B.jsx)(he.a,{style:{marginRight:8}}),e.displayName]})))})]})})},me=[{latitude:55.27,longitude:14.09},{latitude:68.01,longitude:19.22}];let ge;const fe=()=>{var e;const[t,n]=Object(i.useState)(),[a,l]=Object(i.useState)(!0),[r,s]=Object(i.useState)(),[d,c]=Object(i.useState)([]),[u,j]=Object(i.useState)(),[p,b]=Object(i.useState)(),[O,m]=Object(i.useState)(),[g,f]=Object(i.useState)(!1),[x,y]=Object(i.useState)(!1),[E,I]=Object(i.useState)(),[S,T]=Object(i.useState)(""),{t:k}=Object(je.b)();null===(e=navigator)||void 0===e||e.geolocation.getCurrentPosition((e=>{let{coords:{latitude:t,longitude:n}}=e;I({lat:t,lng:n})})),Object(i.useEffect)((()=>{F.a.getOrganizationsSimple().then((e=>{s(e)}))}),[]),Object(i.useEffect)((()=>{F.b.getCurrentUser().then((e=>{var t;ge=e.userId,j(ge),C(ge),null!==(t=e.roles)&&void 0!==t&&t.includes("ROOT")&&f(!0)})),_()}),[]),Object(i.useEffect)((()=>{let e=p;var t;(null===p||void 0===p?void 0:p.length)>0&&(null===d||void 0===d?void 0:d.length)>0&&(e=null===(t=e)||void 0===t?void 0:t.filter((e=>d.includes(e.organizationId))));m(e)}),[d]);const C=e=>{l(!0),F.a.getZones(e).then((e=>{n(e),l(!1)}))},_=()=>{F.a.getUsersSimple().then((e=>{b(e),m(e)}))};return a?Object(B.jsx)(o.a,{}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:[Object(B.jsx)(v.a.Title,{children:"Platser"}),Object(B.jsxs)("div",{style:{display:"flex",gap:15,flexWrap:"wrap"},children:[g?Object(B.jsxs)("div",{style:{display:"flex",gap:15},children:[Object(B.jsx)(Z.a,{data:r,onChange:e=>{c(e)},selectedOrganization:d,isMultiple:!0}),Object(B.jsx)("br",{}),Object(B.jsx)(Oe,{data:O,value:u,onChange:e=>(e=>{j(e),l(!0),C(e)})(e)})]}):null,Object(B.jsx)(h.a,{type:"primary",disabled:x,onClick:()=>{const e={latitude:E?null===E||void 0===E?void 0:E.lat:59.334591,longitude:E?null===E||void 0===E?void 0:E.lng:18.06324,tripType:H.a.PRIVATE,zoneName:U.i.NEW_ZONE,radiusMs:400,activeOnTripEnd:!0,activeOnTripStart:!0};F.a.postZone(e,u||ge).then((i=>{let a;e.zoneId=i,y(!0),a=t?[e,...t]:[e],n(a),T(i)})).catch((e=>{$.b.error(U.c.SOMETHING_GONE_WRONG_TRY_AGAIN)})),$.b.destroy(),$.b.info(U.f.DBCLICK_ON_MAP_TO_CHOOSE_LOCATION,15)},icon:Object(B.jsx)(le.a,{}),children:U.f.ADD_NEW_ZONE})]})]}),Object(B.jsx)(se,{locations:t,setLocations:n,selectedId:u,editKey:S,setEditKey:T,showMap:x,setShowMap:y,userId:ge})]})},xe=(e,t)=>{const n=new e.LatLngBounds;return t||(t=me),t.forEach((t=>{const i=(null===t||void 0===t?void 0:t.latitude)||(null===t||void 0===t?void 0:t.lat),a=(null===t||void 0===t?void 0:t.longitude)||(null===t||void 0===t?void 0:t.lng);if(i&&a){const t=new e.LatLng(i,a);n.extend(t)}})),n},ye={daysList:[{day:1,start:800,stop:1700,active:!0},{day:2,start:800,stop:1700,active:!0},{day:3,start:800,stop:1700,active:!0},{day:4,start:800,stop:1700,active:!0},{day:5,start:800,stop:1700,active:!0},{day:6,start:800,stop:1700,active:!1},{day:7,start:800,stop:1700,active:!1}],tripType:"BUSINESS"},Ee=[{dayOfWeek:1,times:[{start:"0000",stop:"0600"},{start:"1700",stop:"2359"}],active:!0},{dayOfWeek:2,times:[{start:"0000",stop:"0600"},{start:"1700",stop:"2359"}],active:!0},{dayOfWeek:3,times:[{start:"0000",stop:"0600"},{start:"1700",stop:"2359"}],active:!0},{dayOfWeek:4,times:[{start:"0000",stop:"0600"},{start:"1700",stop:"2359"}],active:!0},{dayOfWeek:5,times:[{start:"0000",stop:"0600"},{start:"1700",stop:"2359"}],active:!0},{dayOfWeek:6,times:[{start:"0000",stop:"2359"}],active:!0},{dayOfWeek:7,times:[{start:"0000",stop:"2359"}],active:!0}];var Ie=n(464),Se=n(41),Te=n.n(Se);const ke=e=>{let{schedule:t,changeScheduleParam:n,...a}=e;const l=Object.entries(re.h).map((e=>{let[t,n]=e;return{title:n,key:t,dataIndex:t-1,render:(e,n)=>{if(n.map((e=>e.day===t?n=n[t]:null)))return Object(B.jsx)(r,{day:t,row:e})}}})),r=e=>{let{day:t,value:n,row:l}=e;const[r,c]=Object(i.useState)(null===l||void 0===l?void 0:l.active);return a.alarmSchedule?Object(B.jsxs)("div",{style:{minWidth:150},children:[!a.isTracker&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(s,{day:t,value:n,row:l,disabled:r,index:0})," ",Object(B.jsx)("br",{}),Object(B.jsx)("br",{}),Object(B.jsx)(s,{day:t,value:n,row:l,disabled:r,index:1})," ",Object(B.jsx)("br",{})]}),Object(B.jsx)(o,{day:t,value:n,row:l,disabled:r,setDisable:c})]}):Object(B.jsxs)("div",{style:{minWidth:150},children:[Object(B.jsx)(d,{day:t,value:n,row:l})," ",Object(B.jsx)("br",{}),Object(B.jsx)(o,{day:t,value:n,row:l,disabled:r,setDisable:c})]})},o=e=>{let{day:t,row:i,disabled:l,setDisable:r}=e;return Object(B.jsx)("div",{children:Object(B.jsx)(R.a,{defaultChecked:null===i||void 0===i?void 0:i.active,unCheckedChildren:"Inaktiv",checkedChildren:"Aktiv",disabled:a.ifDefaultSchedule,onChange:e=>{r(!l),n(t,{active:e})},style:{marginTop:a.isTracker?0:16,minWidth:85,backgroundColor:l?a.selectedTripType?H.b.SWITCH_BUSINESS:H.b.SWITCH_PRIVATE:null}})})},s=e=>{let{day:t,row:i,disabled:l,index:r}=e;const o="HH:mm",s=null===i||void 0===i?void 0:i.times[r];var d,c;s&&(s.start=(null===s||void 0===s||null===(d=s.start)||void 0===d?void 0:d.toString().length)<4?"0"+(null===s||void 0===s?void 0:s.start):null===s||void 0===s?void 0:s.start,s.stop=(null===s||void 0===s||null===(c=s.stop)||void 0===c?void 0:c.toString().length)<4?"0"+(null===s||void 0===s?void 0:s.stop):null===s||void 0===s?void 0:s.stop);let u=s?[Te()(null===s||void 0===s?void 0:s.start,o),Te()(null===s||void 0===s?void 0:s.stop,o)]:null;return Object(B.jsx)(Ie.a.RangePicker,{defaultValue:u,format:o,allowClear:0!==r,clearText:!0,order:!1,disabled:!!a.ifDefaultSchedule||!l,onChange:(e,a)=>{if(e||(i.times=i.times.filter(((e,t)=>t!==r))),e){const t={start:e[0].format("HHmm"),stop:e[1].format("HHmm")};i.times[r]?i.times[r]=t:i.times.push(t)}let l={times:[...i.times]};n(t,l)}})},d=e=>{var t,i;let{day:l,row:r}=e;const o="HH:mm";return r.start=(null===r||void 0===r||null===(t=r.start)||void 0===t?void 0:t.toString().length)<4?"0"+r.start:r.start,r.stop=(null===r||void 0===r||null===(i=r.stop)||void 0===i?void 0:i.toString().length)<4?"0"+r.stop:r.stop,Object(B.jsx)(Ie.a.RangePicker,{defaultValue:[Te()(null===r||void 0===r?void 0:r.start,o),Te()(null===r||void 0===r?void 0:r.stop,o)],format:o,allowClear:!1,minuteStep:5,disabled:!!a.ifDefaultSchedule||!r.active,onChange:(e,t)=>{n(l,{start:Te()(t[0],"HH:mm").format("HHmm"),stop:Te()(t[1],"HH:mm").format("HHmm")})}})};return Object(B.jsx)(M.a,{columns:l,dataSource:[t],pagination:!1,scroll:{x:1e3},style:a.ifDefaultSchedule?{opacity:.6}:{},...a})},{Title:Ce}=v.a,_e={mapAndDetailsView:{width:"100%"},targetView:{width:"50%"},detailsView:{width:"40%"},mapView:{minHeight:300,height:"100%"},schemaView:{marginTop:25,marginBottom:25}};function Ae(e){let{setPolygons:t,polygons:n,setCenterCoords:a,centerCoords:l,bounds:r,...o}=e;const[d,c]=Object(i.useState)([59.334591,18.06324]),[u,v]=Object(i.useState)();const j=Object(i.useRef)(null),h=document.getElementById("places-ref");const p=()=>{const e=new u.maps.Geocoder;null===e||void 0===e||e.geocode({address:null===h||void 0===h?void 0:h.value},(function(e,t){const i=null===u||void 0===u?void 0:u.maps.GeocoderStatus.OK;if(e)e=e[0].geometry.location;else{const n=parseFloat(null===l||void 0===l?void 0:l.latitude),a=parseFloat(null===l||void 0===l?void 0:l.longitude);e={lat:n,lng:a},t=i,c([n,a])}if(t===i){const t=function(e){return[u.maps.geometry.spherical.computeOffset(e,200,0),u.maps.geometry.spherical.computeOffset(e,200,120),u.maps.geometry.spherical.computeOffset(e,200,-120)]}(e);null===n||void 0===n||n.setPath(t)}}))};Object(i.useEffect)((()=>{l&&u&&p()}),[l,o.place]),Object(i.useEffect)((()=>{const e=null===u||void 0===u?void 0:u.maps;return null!==j&&void 0!==j&&j.current||null===e||void 0===e||!e.places||(j.current=new e.places.SearchBox(h),j.current.addListener("places_changed",(()=>function(e){var t,n,i;if(null===e||void 0===e||null===(t=e.current)||void 0===t||!t.getPlaces())return;const l=null===e||void 0===e||null===(n=e.current)||void 0===n?void 0:n.getPlaces()[0],r=null===l||void 0===l||null===(i=l.geometry)||void 0===i?void 0:i.viewport;null===u||void 0===u||u.map.fitBounds(r);const s=l.geometry.location.lat(),d=l.geometry.location.lng();o.setAddress(l.formatted_address),a({latitude:s,longitude:d})}(j)))),()=>{e&&(j.current=null,e.event.clearInstanceListeners(j))}}),[u]);function b(e,n){const i=new e.Polygon({map:n,paths:r,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!1,geodesic:!0,editable:!0,onMouseOver:()=>console.log("over")});console.log(r,i),i.addListener("dragend",(()=>((e,t,n)=>{var i=new t.LatLngBounds;const r=null===n||void 0===n?void 0:n.getPath().getArray();for(var o=0;o<(null===r||void 0===r?void 0:r.length);o++)i.extend(new t.LatLng(r[o].lat(),r[o].lng()));var s=i.getCenter(),d=s.lat(),c=s.lng();a({latitude:d,longitude:c}),console.log(l),console.log(d,c)})(0,e,i))),t(i),v({map:n,maps:e});const o=xe(e,r);n.fitBounds(o)}return Object(B.jsx)("div",{style:_e.mapView,children:Object(B.jsx)(ae.a,{bootstrapURLKeys:s.e,center:d,zoom:5,yesIWantToUseGoogleMapApiInternals:!0,options:{...ie,disableDoubleClickZoom:!0},onGoogleApiLoaded:e=>{let{map:t,maps:n}=e;ne(n,t),null===n||void 0===n||n.event.addListener(t,"dblclick",(e=>function(e){const t={latitude:e.latLng.lat(),longitude:e.latLng.lng()};a(t),o.setAddress(null)}(e))),b(n,t)}})})}function Ne(e){let{centerCoords:t,setCenterCoords:n,address:i,setAddress:a,alarm:l,zones:r,getZones:o,...s}=e;const d=[{label:U.f.INSIDE,value:H.k.activeOnEnter},{label:U.f.OUTSIDE,value:H.k.activeOnExit}],c=null!==l&&void 0!==l&&l.activeOnExit?H.k.activeOnExit:H.k.activeOnEnter;X.a,null===r||void 0===r||r.map((e=>Object(B.jsx)(X.a.Item,{children:e.zoneName},e.zoneId)));const v={0:U.f.LOW,50:"Normal",100:U.f.HIGH},h={display:"block",height:"30px",lineHeight:"30px",maxWidth:"100%",whiteSpace:"wrap"};return Object(B.jsxs)(j.a,{style:_e.detailsView,children:[Object(B.jsx)(u.a.Item,{name:H.k.organizationId,label:U.f.ORGANIZATION,rules:[{required:!0,message:U.f.SELECT_AN_EXISTING_ORGANISATION}],initialValue:null===l||void 0===l?void 0:l.organizationId,children:Object(B.jsx)(Z.a,{defaultValue:null===l||void 0===l?void 0:l.organizationId,data:s.knownOrganizations,onChange:e=>s.setSelectedOrganization(e),isMultiple:!1})}),Object(B.jsx)(u.a.Item,{name:"target",label:"Fordon/utrustning",rules:[{required:!0}],initialValue:s.isTracker,children:Object(B.jsxs)(k.a,{style:{width:"100%"},onChange:e=>s.setIsTracker(e),value:s.isTracker,children:[Object(B.jsx)(k.a.Option,{value:!1,children:"Fordon"}),Object(B.jsx)(k.a.Option,{value:!0,children:"Utrustning"})]})}),Object(B.jsx)(u.a.Item,{name:H.k.name,label:U.f.ALIAS,rules:[{required:!0,message:U.f.SUPPLY_AN_ALIAS}],children:Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY_AN_ALIAS})}),Object(B.jsx)(u.a.Item,{name:H.k.activeOn,label:U.f.ACTIVATE_ALARM_WHEN,initialValue:c,children:Object(B.jsx)(_.a.Group,{defaultValue:c,options:d})}),Object(B.jsx)(u.a.Item,{label:U.f.DISTORTION,name:H.k.distortion,initialValue:(null===l||void 0===l?void 0:l.distortion)||50,children:Object(B.jsx)(N.a,{marks:v,step:50,tooltipVisible:!1,defaultValue:50})}),Object(B.jsx)(u.a.Item,{name:"repeatAfterHoursSelect",label:E.repeatAfterHours,initialValue:0,style:{whiteSpace:"wrap"},children:Object(B.jsxs)(_.a.Group,{children:[Object(B.jsx)(_.a,{value:0,style:h,children:"Meddela bara en g\xe5ng"}),Object(B.jsxs)(_.a,{value:1,style:h,children:[Object(B.jsx)("span",{className:"ant-form-text",children:"Upprepa larmet varje "}),Object(B.jsx)(u.a.Item,{noStyle:!0,name:H.k.repeatAfterHours,initialValue:24,children:Object(B.jsx)(A.a,{min:0})}),Object(B.jsx)("span",{children:" h tills larmperioden avslutats eller att larmet kvitterats"})]})]})}),Object(B.jsxs)(u.a.Item,{name:"notifyWhenAcknowledged",label:E.notifyWhenAcknowledged,style:T.notifyWhenAcknowledged,rules:[{required:!1,message:"Detta f\xe4lt kan inte vara tomt"}],children:[Object(B.jsx)("span",{className:"ant-form-text",children:"Meddela n\xe4r larmet kvitterats "}),Object(B.jsx)(u.a.Item,{noStyle:!0,name:"notifyWhenAcknowledged",valuePropName:null!==l&&void 0!==l&&l.notifyWhenAcknowledged?"checked":null,children:Object(B.jsx)(R.a,{})})]})]})}function Re(e){return Object(B.jsxs)("div",{style:_e.targetView,children:[Object(B.jsx)(Ce,{level:3,children:U.f.WHICH}),Object(B.jsx)(Q,{checkedKeys:e.checkedKeys,setCheckedKeys:e.setCheckedKeys,knownVehicles:e.knownVehicles,knownOrganizations:e.knownOrganizations,selectedOrganization:e.selectedOrganization,...e})]})}function De(e){return Object(B.jsxs)("div",{style:_e.targetView,children:[Object(B.jsx)(Ce,{level:3,children:U.f.WHO}),Object(B.jsx)(J,{emailData:e.emailData,setEmailData:e.setEmailData})]})}function we(e){var t,n;const a=Object(l.h)(),r=parseInt(null===a||void 0===a||null===(t=a.state)||void 0===t?void 0:t.id),[d,c]=Object(i.useState)(null),[v]=u.a.useForm(),[j,p]=Object(i.useState)(),[b,O]=Object(i.useState)(),[m,g]=Object(i.useState)(!0),[f,x]=Object(i.useState)([]),[y,E]=Object(i.useState)(),I=Object(l.g)(),[T,k]=Object(i.useState)([]),[_,A]=Object(i.useState)(),[N,R]=Object(i.useState)(),[D,L]=Object(i.useState)(""),[P,V]=Object(i.useState)(),[M,z]=Object(i.useState)(),[G,Y]=Object(i.useState)(null),[W,K]=Object(i.useState)(!0),[q,J]=Object(i.useState)(),[Q,Z]=Object(i.useState)(!1);function X(){const e=s.c+"/alarmsZones/";I.push({pathname:e})}Object(i.useEffect)((()=>{if(r>-1?F.a.getGeoAlarmById(r).then((e=>{var t,n,i,a,l;const r=(null===e||void 0===e?void 0:e.targetVehicleIds)||[];let o=(null===e||void 0===e?void 0:e.targetOrganizationIds)||[],s=(null===e||void 0===e?void 0:e.targetTrackerOrganizationIds)||[];const d=(null===e||void 0===e?void 0:e.targetTrackerIds)||[];e.distortion=100-e.distortion,o=null===(t=o)||void 0===t?void 0:t.map((e=>"org:"+e)),s=null===(n=s)||void 0===n?void 0:n.map((e=>"org:"+e)),e.repeatAfterHoursSelect=0===e.repeatAfterHours||-1===e.repeatAfterHours?0:1,c(e),E(null===e||void 0===e?void 0:e.schedule),R(null===e||void 0===e?void 0:e.centerCoords),L(null===e||void 0===e?void 0:e.place),K(-1!==e.repeatAfterHours),J(e.organizationId),Z((null===d||void 0===d?void 0:d.length)>0||(null===(i=s)||void 0===i?void 0:i.length)>0),k([...r,...o,...s,...d]);const u=null===e||void 0===e||null===(a=e.emails)||void 0===a?void 0:a.map((e=>({email:e})));x(u);let v=null===(l=e.zoneCoords)||void 0===l?void 0:l.map((e=>({lat:e.latitude,lng:e.longitude})));Y(v)})):(E([...Ee]),R({latitude:0,longitude:0})),b||F.a.getVehicles().then((e=>{O(e)})),!P){const e=localStorage.getItem(w.s);F.a.getZones(e).then((e=>{V(e)}))}j||F.a.getOrganizationsSimple().then((e=>{parseInt(localStorage.getItem(w.e));p(e)}))}),[r]),Object(i.useEffect)((()=>{b&&j&&y&&g(!1)}),[j,b,y]);const te=async(e,t)=>{try{let n=t;e>-1?F.a.patchGeoAlarm(n,e):F.a.postGeoAlarm(n),null===v||void 0===v||v.resetFields()}catch(n){console.log("Validate Failed:",n)}};const ne=null!==M&&void 0!==M&&null!==(n=M.activeOn)&&void 0!==n&&n.includes(H.k.activeOnExit)?"utanf\xf6r":"inom";return m?Object(B.jsx)(o.a,{}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Ce,{children:U.f.ALARM_PLACES}),Object(B.jsxs)(u.a,{form:e.form,layout:"vertical",onFinish:e=>{var t,n;const i=[];null===(t=Object.entries(f))||void 0===t||t.map((e=>{let[t,n]=e;return i.push(n.email)}));let a=null===_||void 0===_?void 0:_.getPath().getArray().map((e=>({latitude:e.lat(),longitude:e.lng()})));if((null===a||void 0===a?void 0:a.length)<3)return void $.b.info(U.f.CHOOSE_MIN_3);const l=localStorage.getItem(w.e),o=e.activeOn.includes(H.k.activeOnEnter),s=e.activeOn.includes(H.k.activeOnExit);let d=null===T||void 0===T?void 0:T.filter((e=>e.toString().startsWith("org"))).map((e=>parseInt(e.replace("org:",""))));const c=W?e.repeatAfterHours:-1;let u=T.map((e=>null===b||void 0===b?void 0:b.find((t=>(null===t||void 0===t?void 0:t.id)===e))));u=null===(n=u.filter((e=>!d.includes(null===e||void 0===e?void 0:e.organizationId)&&e)))||void 0===n?void 0:n.map((e=>null===e||void 0===e?void 0:e.id));const v=Q?null===y||void 0===y?void 0:y.map((e=>({...e,times:[{start:"0000",stop:"2359"}]}))):null,j={organizationId:parseInt(l),schedule:v||y,emails:i,targetVehicleIds:Q?[]:u,targetOrganizationIds:Q?[]:d,targetTrackerIds:Q?u:[],targetTrackerOrganizationIds:Q?d:[],zoneCoords:[...a,a[0]],...e,repeatAfterHours:0===e.repeatAfterHoursSelect?0:c,centerCoords:N,place:D,activeOnEnter:o,activeOnExit:s,distortion:100-(null===e||void 0===e?void 0:e.distortion)};te(r,j).then((e=>{X()}))},initialValues:d,onValuesChange:(e,t)=>z(t),children:[Object(B.jsxs)("div",{style:_e.mapAndDetailsView,children:[Object(B.jsx)(Ce,{level:3,children:U.f.WHERE}),Object(B.jsx)(ee.a,{message:U.f.GEO_LARM_MESSAGE_INFO,type:"success"}),Object(B.jsx)("br",{}),Object(B.jsxs)(S.a,{justifyContent:"between",gap:25,children:[Object(B.jsxs)(S.a,{flexDirection:"column",style:{width:"60%"},gap:25,children:[Object(B.jsx)(u.a.Item,{noStyle:!0,name:H.k.place,label:U.f.ADDRESS,layout:"horizontal",children:Object(B.jsx)("div",{children:Object(B.jsx)(C.a.Search,{id:"places-ref",value:D,allowClear:!0,onChange:e=>{console.log(e.target.value),L(e.target.value)},type:"search",placeholder:"S\xf6k efter adress"})})}),Object(B.jsx)(Ae,{bounds:G,alarm:d,setAddress:L,address:D,polygons:_,setPolygons:A,centerCoords:N,setCenterCoords:R})]}),Object(B.jsx)(Ne,{knownOrganizations:j,zones:P,getZones:function(e){const t=null===P||void 0===P?void 0:P.find((t=>t.zoneId.toString()===e.key)),n={latitude:null===t||void 0===t?void 0:t.latitude,longitude:null===t||void 0===t?void 0:t.longitude};R(n),L(null===t||void 0===t?void 0:t.address)},alarm:d,setAddress:L,address:D,form:v,showRepeatAlarm:W,setShowRepeatAlarm:K,centerCoords:N,setCenterCoords:R,setSelectedOrganization:e=>J(e),isTracker:Q,setIsTracker:Z})]})]}),Q&&Object(B.jsx)(ee.a,{showIcon:!0,message:"Systemet kommer att meddela anv\xe4ndaren om enheten befinner sig ".concat(ne," angivet omr\xe5de vid rapporteringstillf\xe4llet."),type:"info",style:_e.schemaView}),Object(B.jsx)(Le,{changeScheduleParam:(e,t)=>{console.log(t),console.log(y);e-=1;let n=y;console.log(n[e]),console.log(n),n[e]={...n[e],...t},console.log(n),E(n)},schedule:y,isTracker:Q}),Object(B.jsx)("div",{style:_e.mapAndDetailsView,children:Object(B.jsxs)(S.a,{justifyContent:"between",gap:25,children:[Object(B.jsx)(Re,{checkedKeys:T,setCheckedKeys:k,knownVehicles:b,knownOrganizations:j,isGeoAlarm:!0,selectedOrganization:q,isTracker:Q}),Object(B.jsx)(De,{emailData:f,setEmailData:x})]})}),Object(B.jsxs)(S.a,{alignItems:"end",justifyContent:"end",gap:15,children:[Object(B.jsx)(u.a.Item,{children:Object(B.jsx)(h.a,{onClick:X,children:U.f.BTN_ABORT})}),Object(B.jsx)(u.a.Item,{children:Object(B.jsx)(h.a,{disabled:(null===T||void 0===T?void 0:T.length)<1,type:"primary",htmlType:"submit",children:U.f.SAVE})})]})]})]})}function Le(e){return Object(B.jsxs)("div",{style:_e.schemaView,children:[e.title&&Object(B.jsx)(Ce,{level:3,children:U.f.WHEN}),Object(B.jsx)(ke,{ifDefaultSchedule:!1,schedule:e.schedule,changeScheduleParam:e.changeScheduleParam,alarmSchedule:!0,isTracker:e.isTracker})]})}var Pe=()=>Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(we,{})}),Ve=n(93),Me=n(101),Fe=n(166),ze=n(171),Ue=n(985),Be=n(986),Ge=n(987),He=n(936),Ye=n(972),We=n(62),Ke=n(184);const qe=Object(i.createContext)({}),Je=e=>{let{children:t}=e;const[n,a]=Object(i.useState)([]);return Object(B.jsx)(qe.Provider,{value:{geozone:n,getGeozone:async(e,t)=>{const n=await F.a.getGeoAlarm().then((n=>{const i=n.filter((n=>{var i,a,l,r;return(null===(i=n.targetVehicleIds)||void 0===i?void 0:i.includes(e))||(null===(a=n.targetTrackerIds)||void 0===a?void 0:a.includes(e))||(null===(l=n.targetOrganizationIds)||void 0===l?void 0:l.includes(t))||(null===(r=n.targetTrackerOrganizationIds)||void 0===r?void 0:r.includes(t))}));return a(i),!0})).catch((e=>console.error(e)));return n}},children:t})},Qe=Object(i.createContext)({}),Ze=e=>{let{children:t}=e;return Object(B.jsx)(Qe.Provider,{value:{postContact:async e=>await F.b.postContactTrackson(e).then((e=>(console.log(e),!0))).catch((e=>(console.error(e),!1))),getTrackersReport:async(e,t)=>F.a.getTrackersReport(e,t).then((e=>e)).catch((e=>(console.error(e),!1))),getVehicleCertificate:(e,t,n)=>F.a.getAttestCkeckLite(e,t,n).then((i=>F.a.getAttestCheck(e,t,n,i).then((e=>({resCheck:e,checkLite:i}))).catch((e=>(console.error(e),!1))))).catch((e=>(console.error(e),!1))),getJournalsPDF:async(e,t,n,i,a,l,r)=>{await F.a.getJournalsPDF(e,t,n,i,a,l,r).then((e=>console.log(e))).catch((e=>console.error(e)))},getJournalsCSV:async(e,t,n,i,a,l)=>{await F.a.getJournalsCSV(e,t,n,i,a,l).then((e=>console.log(e))).catch((e=>console.error(e)))},getSummaryDriver:async(e,t,n,i,a,l,r,o)=>{await F.a.getSummaryDriverReports(e,t,n,i,a,l,r,o).then((e=>console.log(e))).catch((e=>console.error(e)))},getSummaryVehicle:async(e,t,n,i,a,l,r,o)=>{await F.a.getSummaryVehicleReports(e,t,n,i,a,l,r,o).then((e=>console.log(e))).catch((e=>console.error(e)))},getSummarySalary:async(e,t,n,i,a,l,r,o)=>{await F.a.getSalaryReports(e,t,n,i,a,l,r,o).then((e=>console.log(e))).catch((e=>console.error(e)))},getSummaryPurpose:async(e,t,n,i,a,l,r,o)=>{await F.a.getPurposeReports(e,t,n,i,a,l,r,o).then((e=>console.log(e))).catch((e=>console.error(e)))}},children:t})};var Xe=n(130),$e=n(38);const{Text:et}=v.a,{TabPane:tt}=ze.a;var nt=e=>{var t,n;let{mapOverviewData:a,selectedMarker:l,onClickMarker:r,openGeozone:o=(()=>null),...s}=e;const{getGeozone:d}=Object(i.useContext)(qe),{getTrackersReport:u}=Object(i.useContext)(Qe),{updateVehicleFrequencyUpdate:v}=Object(i.useContext)(Xe.a),j=Object(i.useContext)(c.a),[p,b]=Object(i.useState)(),[O,m]=Object(i.useState)(),g=null===j||void 0===j||null===(t=j.roles)||void 0===t?void 0:t.includes("ADMIN"),f=null===j||void 0===j||null===(n=j.roles)||void 0===n?void 0:n.includes("ROOT");Object(i.useEffect)((()=>{b(null===a||void 0===a?void 0:a.filter((e=>{var t;return!(null!==e&&void 0!==e&&null!==(t=e.meta)&&void 0!==t&&t.isArchived)})))}),[a]);const x=e=>null===e||void 0===e?void 0:e.isTracker,y=[{key:"registry",dataIndex:"registry",title:"Regnr/Alias",fixed:"left",width:150,render:(e,t)=>{var n,i,a,l;if(null===t||void 0===t||null===(n=t.meta)||void 0===n||!n.reg)return null===t||void 0===t||null===(l=t.meta)||void 0===l?void 0:l.vehicleDisplayName;const r={displayName:null===t||void 0===t||null===(i=t.meta)||void 0===i?void 0:i.vehicleDisplayName,registry:null===t||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.reg};return Object(re.j)(r)}},{key:"style",dataIndex:"style",title:"Ikon",align:"center",render:(e,t)=>Object(re.p)(null===t||void 0===t?void 0:t.meta)},{title:U.f.TYPE,dataIndex:H.k.meta,render:(e,t)=>{const n=null!==t&&void 0!==t&&t.isTracker?"Utrustning":U.k[null===e||void 0===e?void 0:e.benefitType];return Object(B.jsx)("span",{children:n})}},{title:U.f.LAST_SEEN,dataIndex:H.k.lastSeenMs,align:"center",render:(e,t)=>e?Object(B.jsx)(We.a,{value:e,typ:"map",isTracker:null===t||void 0===t?void 0:t.isTracker}):null},{title:U.f.STATUS,dataIndex:H.k.speed,render:(e,t)=>{const n=(null===t||void 0===t?void 0:t.isTracker)||!1;let i,a="#b4bed2";return e>0&&(a=H.b.SWITCH_PRIVATE),null===e&&(i=U.f.NO_INFO),0===e&&(i=U.f.PARKED),e>0&&(i=U.f.IN_MOVING),0!==(null===t||void 0===t?void 0:t.position.longitude)&&n?null:Object(B.jsx)(et,{style:{color:a},children:i})}},{dataIndex:H.k.meta,align:"right",render:(e,t)=>{var n,i,a;const o=e.vehicle_id===(null===l||void 0===l?void 0:l.meta.vehicle_id);null!==t&&void 0!==t&&null!==(n=t.meta)&&void 0!==n&&n.reg&&(null===t||void 0===t||null===(i=t.meta)||void 0===i||null===(a=i.reg)||void 0===a||a.split(" ").join("_"));let s=0===(null===t||void 0===t?void 0:t.position.longitude);const d=Object(B.jsxs)(h.a,{disabled:s,icon:o?Object(B.jsx)(Be.a,{}):Object(B.jsx)(Ue.a,{}),onClick:()=>r(t),children:[null!==t&&void 0!==t&&t.isTracker?null:o?"St\xe4ng":U.f.FOLLOW,null!==t&&void 0!==t&&t.isTracker?o?"St\xe4ng":"Visa p\xe5 karta":null]});return Object(B.jsx)(L.a,{title:s?"Fordonet befinner sig i privat l\xe4ge och kan d\xe4rf\xf6r inte sp\xe5ras":null,children:d})}},{dataIndex:"operation",width:80,render:(e,t)=>Object(B.jsx)(re.a,{menu:()=>function(e,t){var n,i,a;let l=0===(null===t||void 0===t?void 0:t.position.longitude),r="\xc4ndra uppdateringsfrekvens (".concat((null===t||void 0===t?void 0:t.latestResponseFrequency)||"24h",")");const s=null!==t&&void 0!==t&&null!==(n=t.meta)&&void 0!==n&&n.reg?null===t||void 0===t||null===(i=t.meta)||void 0===i||null===(a=i.reg)||void 0===a?void 0:a.split(" ").join("_"):"",c=g||f;return Object(B.jsxs)(X.a,{children:[c&&Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(Ge.a,{}),onClick:()=>(async e=>{await d(e.meta.vehicle_id,e.meta.organizationId)&&await o()})(t),children:U.f.SHOW_GEO_ZONE}),!x(t)&&!l&&Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(He.a,{}),onClick:()=>function(e){const t=e.meta.vehicle_id;F.a.postVehicleTracking(t).then((e=>{$.b.success(U.f.CURRENT_LOCATION_UPPDATED)}))}(t),children:U.f.UPDATE}),x(t)&&Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(Ye.a,{}),onClick:()=>{var e;return(async(e,t)=>{await u(e,t)||console.log("Export Successful")})(null===t||void 0===t||null===(e=t.meta)||void 0===e?void 0:e.vehicle_id,s)},children:U.f.EXPORT_RAPPORT}),x(t)&&c&&Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(He.a,{}),onClick:()=>m(t),children:r})]})}(0,t)})}];let E=s.benefitType?U.f[s.benefitType]:"Fordon/Utrustning";return Object(B.jsx)(B.Fragment,{children:a&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(ze.a,{defaultActiveKey:"1",children:Object(B.jsx)(tt,{tab:Object(B.jsx)($e.f,{text:E,overflowCount:9999999,badgeColor:"#3f3f3f",count:null===p||void 0===p?void 0:p.length}),children:Object(B.jsx)(M.a,{dataSource:p,columns:Object(re.m)(y),rowKey:(e,t)=>null===e||void 0===e?void 0:e.imei,scroll:{x:1e3},...re.n})},"1")}),Object(B.jsx)(re.e,{record:O,setRecordFrequencyInterval:m,handleUpdateFreq:async(e,t)=>{await v(e,t).then((e=>{s.updateMapOverviewData(),m(null)}))}})]})})};const it=Object(i.createContext)({}),at=e=>{let{children:t}=e;const[n,a]=Object(i.useState)();return Object(B.jsx)(it.Provider,{value:{mapOverviewData:n,updateMapOverviewData:()=>{F.a.getOverview().then((e=>{a(e)})).catch((e=>console.error(e)))},updateSelectedVehicleOverviewData:e=>F.a.getOverviewForVehicleId(e).then((e=>e)).catch((e=>(console.error(e),!1)))},children:t})};var lt=n(926),rt=n(542),ot=n(948),st=n(988),dt=n(477),ct=n(69),ut=n.n(ct),vt=n(268),jt=n(520),ht=(n(870),n(521)),pt=(n(871),n(872),n(873),n(82)),bt=n(91),Ot=n(57);n(325);const mt="#3e79f7",{Title:gt}=v.a,ft={marker:{backgroundColor:mt,width:48,height:48,borderRadius:24,transition:".3s",transform:"translate(-50%, -50%)",outlineStyle:"circle",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer"},markerRegistryPlate:{backgroundColor:mt,width:"max-content",padding:"5px 30px",transition:".3s",transform:"translate(-50%, -50%)",marginTop:-10,display:"flex",justifyContent:"center",color:"#fff"},markerDisplayNamePlate:{backgroundColor:"#ffffff",height:32,width:"max-content",padding:"4px 8px",transition:".3s",transform:"translate(-50%, -50%)",alignItems:"center",display:"flex",justifyContent:"center",color:"#000000",border:"1px solid #000000",fontWeight:"bold",fontSize:14},markerStart:{backgroundColor:"#D6D7DC",width:42,height:42,position:"relative",transform:"translate(-50%, -50%)",borderRadius:24,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer"},markerStop:{backgroundColor:"#6B7D92",width:42,height:42,borderRadius:24,transform:"translate(-50%, -50%)",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer"},markerIcon:{fontSize:28,color:"#fff"},markerIconFollowed:{backgroundColor:mt,width:80,height:80,borderRadius:40,transform:"translate(-50%, -50%)",zIndex:3,display:"flex",justifyContent:"center",alignItems:"center"},markerIconStart:{fontSize:28,color:"#6B7D92"},plate:{position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",left:52,top:6,height:36,width:100,backgroundColor:"#2B3855",borderRadius:4,border:"1px solid #D6D7DC"},plateText:{position:"relative",fontSize:18,fontWeight:"bold",color:"#D6D7DC",textAlign:"center"},cardHead:{textAlign:"center",borderBottom:"1px solid rgb(77, 91, 117)",paddingBottom:16,fontSize:24},infoWindow:{backgroundColor:"#283142",boxShadow:"0 2px 7px 1px rgba(0, 0, 0, 0.3)",position:"relative"}},xt=e=>{var t,n,i,a,l,r,o;const s=e.showInfo,d=(null===s||void 0===s||null===(t=s.meta)||void 0===t?void 0:t.vehicleDisplayName)||(null===s||void 0===s?void 0:s.meta.reg)||"ID "+(null===s||void 0===s||null===(n=s.meta)||void 0===n?void 0:n.vehicle_id);console.log("marker",s);const c=(null===s||void 0===s?void 0:s.isTracker)||!1,u="MOVING"===(null===s||void 0===s?void 0:s.meta.status)?Object(B.jsx)("span",{style:{color:H.b.GREEN},children:"I r\xf6relse"}):"Parkerad";"MOVING"===(null===s||void 0===s?void 0:s.meta.status)&&(null===s||void 0===s||s.speed_kph);let v,p,b=null!==s&&void 0!==s&&s.meta.gps_quality?10*(null===s||void 0===s?void 0:s.meta.gps_quality)/2:0;b=Math.round(b),p=b>3?"#21B573":b>2?"#fa8c16":"#de4436",console.log(s),v=(null===s||void 0===s?void 0:s.battery_percentage)<30?"#de4436":(null===s||void 0===s?void 0:s.battery_percentage)>=70?"#21B573":"#fa8c16";let O=(null===s||void 0===s||null===(i=s.meta)||void 0===i?void 0:i.reg)||(null===s||void 0===s||null===(a=s.meta)||void 0===a?void 0:a.vehicleDisplayName)||"ID "+(null===s||void 0===s||null===(l=s.meta)||void 0===l?void 0:l.vehicle_id);return Object(B.jsxs)(j.a,{style:ft.infoWindow,title:null!==s&&void 0!==s&&s.isTracker?d:O,headStyle:ft.cardHead,actions:[Object(B.jsx)(h.a,{onClick:()=>{e.onClick(e.showInfo)},danger:!0,children:"St\xe4ng"})],className:"markerBox",children:[Object(B.jsxs)(dt.b,{column:1,children:[!c&&Object(B.jsxs)(dt.b.Item,{children:[Object(B.jsx)("div",{style:{width:25,height:24},children:Object(B.jsx)(lt.a,{})}),d]}),!c&&Object(B.jsxs)(dt.b.Item,{children:[Object(B.jsx)("div",{style:{width:25,height:24},children:Object(B.jsx)(rt.a,{})}),(null===s||void 0===s||null===(r=s.driver)||void 0===r?void 0:r.displayName)||(null===s||void 0===s||null===(o=s.driver)||void 0===o?void 0:o.id)||"Ingen incheckad f\xf6rare"]}),c&&Object(B.jsxs)(dt.b.Item,{children:[Object(B.jsx)("div",{style:{width:25,height:24},children:Object(B.jsx)(He.a,{})}),(null===s||void 0===s?void 0:s.latestResponseFrequency)||"-"," uppdateringsfrekvens"]})]}),Object(B.jsxs)(dt.b,{column:2,children:[!c&&Object(B.jsxs)(dt.b.Item,{children:[Object(B.jsx)("div",{style:{width:25,height:24},children:Object(B.jsx)(ot.a,{})}),u]}),c&&Object(B.jsxs)(dt.b.Item,{children:[Object(B.jsx)("div",{style:{width:25,height:24},children:Object(B.jsx)(ut.a,{icon:jt.battery})}),(null===s||void 0===s?void 0:s.battery_percentage)||"-","%"]}),Object(B.jsxs)(dt.b.Item,{children:[Object(B.jsx)("div",{style:{width:25,height:24},children:Object(B.jsx)(st.a,{})}),Object(B.jsx)(We.a,{value:null===s||void 0===s?void 0:s.last_seen_ms,typ:"map",isTracker:c})]})]})]})},yt={androidCar:bt.androidCar,androidContact:bt.androidContact,bus:Ot.bus,home:Ot.home,road:Ot.road,glass:Ot.glass,briefcase:Ot.briefcase,wrench:Ot.wrench,shoppingCart:Ot.shoppingCart,truck:Ot.truck,bolt:Ot.bolt,cutlery:Ot.cutlery,lightbulbO:Ot.lightbulbO,ambulance:Ot.ambulance,bank:Ot.bank,plug:Ot.plug,paintBrush:Ot.paintBrush,androidDrafts:bt.androidDrafts,androidHome:bt.androidHome,androidGlobe:bt.androidGlobe,PB:bt.androidGlobe,androidAlert:bt.androidAlert},Et=e=>{const{data:t}=e,{lat:n,lng:i,IMEI:a,meta:l,followerDriver:r}=null!==t?t:null===e||void 0===e?void 0:e.selectedMarker;let o=1;"PB"!==l.type&&(o=2);const s=e.selectedMarker,d=yt[null===l||void 0===l?void 0:l.marker];const c=l.vehicleDisplayName||l.reg||l.vehicle_id;return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("div",{style:{...ft.marker,backgroundColor:l.color||mt,boxShadow:s?"0 0 0 20px rgba(255,0,0,0.35)":null},onClick:t=>e.onClick(e.selectedMarker),children:d?Object(B.jsx)(ut.a,{icon:d,size:28,style:ft.markerIcon}):Object(B.jsx)(lt.a,{style:ft.markerIcon})}),e.selectedMarker?Object(B.jsx)("div",{style:{...ft.markerRegistryPlate,backgroundColor:e.selectedMarker?l.color:mt},children:c}):Object(B.jsx)("div",{style:{...ft.markerDisplayNamePlate,backgroundColor:"#ffffff"},children:c}),e.showPlate&&Object(B.jsx)("div",{style:ft.plate,children:Object(B.jsx)("span",{style:ft.plateText,children:l.reg||l.vehicleDisplayName||l.vehicle_id})})]})},It=e=>Object(B.jsx)("div",{style:ft.markerStop,onClick:e.onClick,children:Object(B.jsx)(L.a,{title:e.text,children:Object(B.jsx)(ut.a,{icon:ht.ic_flag,style:ft.markerIcon})})}),St=e=>Object(B.jsx)("div",{style:ft.markerStart,onClick:e.onClick,children:Object(B.jsx)(L.a,{title:e.text,children:Object(B.jsx)(ut.a,{icon:vt.mapMarker,style:ft.markerIconStart})})});var Tt=n(94),kt=n(539),Ct=n(135);var _t=e=>{var t,n,a;let{vehiclesDataToShowOnTheMap:l,followDriver:r,selectedMarker:o,mapOverviewData:d,defaultCenter:c,onClickMarker:u=(()=>null),setSelectedMarker:v=(()=>null)}=e;const[j,h]=Object(i.useState)(),[p,b]=Object(i.useState)(5),[O,m]=Object(i.useState)(),[g,f]=Object(i.useState)(),[x,y]=Object(i.useState)(null),[E,I]=Object(i.useState)(null);return Object(i.useEffect)((()=>{const e=null===l||void 0===l?void 0:l.filter((e=>{var t;return null===(t=e.position)||void 0===t?void 0:t.latitude}));if(!((null===e||void 0===e?void 0:e.length)<1)&&(null===e||void 0===e?void 0:e.length)!==E&&!((null===l||void 0===l?void 0:l.length)<1)&&(null===l||void 0===l?void 0:l.length)!==E&&j&&e){const n=((e,t)=>{console.log("Creating bounds for passing to fitBounds");const n=new e.LatLngBounds;return null===t||void 0===t||t.forEach((t=>{var i,a;const l=null===t||void 0===t||null===(i=t.position)||void 0===i?void 0:i.latitude,r=null===t||void 0===t||null===(a=t.position)||void 0===a?void 0:a.longitude;if(l&&r){const t=new e.LatLng(l,r);n.extend(t)}})),n})(j.maps,e);var t;if(x&&n.equals(x));else if(y(n),I(null===e||void 0===e?void 0:e.length),j.map.fitBounds(n),1===(null===e||void 0===e?void 0:e.length))null===j||void 0===j||null===(t=j.map)||void 0===t||t.setZoom(17)}}),[j,l,x]),Object(i.useEffect)((()=>{null!==o&&b(17)}),[o]),Object(i.useEffect)((()=>{if(!j)return;var e,t;null===j||void 0===j||null===(e=j.maps)||void 0===e||e.event.trigger(null===j||void 0===j?void 0:j.map,"resize"),null===j||void 0===j||null===(t=j.map)||void 0===t||t.setOptions({...ie,styles:"DARK"===localStorage.getItem(w.d)?te:null}),ne(null===j||void 0===j?void 0:j.maps,null===j||void 0===j?void 0:j.map);const n=null===l||void 0===l?void 0:l.filter((e=>{var t;return null===(t=e.position)||void 0===t?void 0:t.latitude}));if(n){const e=[],t=null===j||void 0===j?void 0:j.map,i=null===j||void 0===j?void 0:j.maps,a=null!==o?d.filter((e=>(null===e||void 0===e?void 0:e.meta.vehicle_id)!==(null===o||void 0===o?void 0:o.meta.vehicle_id))):n;null===a||void 0===a||a.map((n=>{var a,l,s,d,c,v,j;let h=(null===n||void 0===n||null===(a=n.meta)||void 0===a?void 0:a.vehicleDisplayName)||(null===n||void 0===n||null===(l=n.meta)||void 0===l?void 0:l.reg)||(null===n||void 0===n?void 0:n.meta.vehicle_id);(null===n||void 0===n||null===(s=n.meta)||void 0===s?void 0:s.vehicle_id)===r&&o&&(h=" ");let p=Ct.a[null===n||void 0===n||null===(d=n.meta)||void 0===d?void 0:d.marker];var b,O;["androidAlert","androidCar","androidContact","androidDrafts","androidGlobe","androidHome"].includes(null===n||void 0===n||null===(c=n.meta)||void 0===c?void 0:c.marker)?p={path:null===(b=Ct.a.androidCar)||void 0===b?void 0:b.children[0].children[0].children[0].children[0].attribs.d,scale:.07}:p={path:null===(O=p)||void 0===O?void 0:O.children[0].attribs.d,scale:.02};const m=new i.Marker({key:null===n||void 0===n?void 0:n.meta.vehicle_id,position:{lat:null===n||void 0===n?void 0:n.position.latitude,lng:null===n||void 0===n?void 0:n.position.longitude},map:t,icon:{path:null===(v=p)||void 0===v?void 0:v.path,fillColor:null!==n&&void 0!==n&&n.meta.isArchived?"#b4bed2":null===n||void 0===n?void 0:n.meta.color,fillOpacity:1,strokeWeight:.3,scale:.02,className:"icon",...p},label:{text:null===(j=h)||void 0===j?void 0:j.toString(),className:"labels",fontSize:"14px",fontWeight:"bold"}});m.addListener("click",(()=>{u(n)})),e.push(m)})),O&&(O.clearMarkers(),O.setMap(null)),g&&g.map((e=>{null===e||void 0===e||e.setMap(null)}));const l={render:e=>{var t;let{count:n,position:a}=e;return new i.Marker({label:{text:String(n),color:"white",fontSize:"10px"},position:a,icon:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m1.png",zIndex:Number(null===(t=i.Marker)||void 0===t?void 0:t.MAX_ZINDEX)+n})}},s=new kt.a({map:t,markers:e,renderer:l});m(s),f(e)}}),[j,l,r,o]),Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(ae.a,{bootstrapURLKeys:s.e,center:o?c:null,defaultCenter:c,zoom:o?17:null,defaultZoom:p,yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:e=>{let{map:t,maps:n}=e;h({map:t,maps:n}),ne(n,t)},options:ie,children:o?Object(B.jsx)(Et,{data:r,lat:null===r||void 0===r||null===(t=r.position)||void 0===t?void 0:t.latitude,lng:null===r||void 0===r||null===(n=r.position)||void 0===n?void 0:n.longitude,followerDriver:r,selectedMarker:o,showInfo:o===(null===r||void 0===r||null===(a=r.meta)||void 0===a?void 0:a.vehicle_id),onClick:e=>u(e)},r):null})})};var At={appContent:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},contentHeader:{display:"flex",marginBottom:20,gap:15,flexWrap:"wrap"},mapContent:{height:"50vh",width:"100%"},mapRow:{height:"100%"}};const{Title:Nt}=v.a,{Search:Rt}=C.a;var Dt=e=>{let{openExportTrackerReportModal:t=(()=>null),openGeozone:n=(()=>null)}=e;const a=Object(i.useContext)(c.j),l=null===a||void 0===a?void 0:a.includes(parseInt(localStorage.getItem(w.e))),{mapOverviewData:r,updateMapOverviewData:o,updateSelectedVehicleOverviewData:s}=Object(i.useContext)(it),{organizations:d}=Object(i.useContext)(Tt.a),[u,v]=Object(i.useState)([]),[j,h]=Object(i.useState)(null),[p,b]=Object(i.useState)(null),[O,m]=Object(i.useState)([59.334591,18.06324]),[g,f]=Object(i.useState)(),[x,y]=Object(i.useState)([]),[E,I]=Object(i.useState)(),[S,T]=Object(i.useState)([]),[k,C]=Object(i.useState)(""),[_,A]=Object(i.useState)(),N=new URLSearchParams(window.location.search).get("vehicleId");Object(i.useEffect)((()=>{if(N&&r){var e,t,n,i;const a=null===r||void 0===r?void 0:r.find((e=>{var t;return(null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.vehicle_id)===parseInt(N)}));let l=(null===a||void 0===a||null===(e=a.meta)||void 0===e||null===(t=e.vehicleDisplayName)||void 0===t?void 0:t.toLowerCase())||(null===a||void 0===a||null===(n=a.meta)||void 0===n||null===(i=n.reg)||void 0===i?void 0:i.toLowerCase())||N;A(l)}}),[r,N]),Object(i.useEffect)((()=>{_&&C(_)}),[_]),Object(i.useEffect)((()=>{o()}),[]),Object(i.useEffect)((()=>{if(r){let e=null===r||void 0===r?void 0:r.sort(((e,t)=>{var n,i,a,l,r;return null===e||void 0===e||null===(n=e.meta)||void 0===n||null===(i=n.reg)||void 0===i||null===(a=i.toLowerCase())||void 0===a?void 0:a.localeCompare(null===t||void 0===t||null===(l=t.meta)||void 0===l||null===(r=l.reg)||void 0===r?void 0:r.toLowerCase())}));const t=null===e||void 0===e?void 0:e.map((e=>e.meta.vehicle_id));v(t),y(e)}}),[r]),Object(i.useEffect)((()=>{let e=r;var t,n,i;k&&(e=null===(t=e)||void 0===t?void 0:t.filter((e=>JSON.stringify(e).toLowerCase().includes(k))));S.length>0&&(e=null===(n=e)||void 0===n?void 0:n.filter((e=>{var t;return S.includes(null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.organizationId)})));if(E===H.k.TRACKER)e=null===(i=e)||void 0===i?void 0:i.filter((e=>null===e||void 0===e?void 0:e.isTracker));else if(E===H.k.VEHICLE){var a;e=null===(a=e)||void 0===a?void 0:a.filter((e=>!(null!==e&&void 0!==e&&e.isTracker)))}f(e),y(e)}),[u,S,k,E]),Object(i.useEffect)((()=>{const e=setInterval((()=>{o(),null!==p&&s(null===p||void 0===p?void 0:p.meta.vehicle_id).then((e=>{if(!1===e)b(null);else{const t=[null===e||void 0===e?void 0:e.position.latitude,null===e||void 0===e?void 0:e.position.longitude];h(e),m(t)}}))}),1e4);return()=>clearInterval(e)}),[p]);const R=e=>{if(null!==p&&(null===e||void 0===e?void 0:e.meta.vehicle_id)===(null===p||void 0===p?void 0:p.meta.vehicle_id))b(null),o();else{null===g||void 0===g||g.filter((t=>(null===t||void 0===t?void 0:t.meta.vehicle_id)!==(null===e||void 0===e?void 0:e.meta.vehicle_id)));m([e.position.latitude,e.position.longitude]),b(e),h(e)}};return!localStorage.getItem(w.e)?Object(B.jsx)(re.b,{selectedOrganization:S,organizationSelectOnChange:e=>T([e]),knownOrganizations:d}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{style:{...At.appContent},children:[Object(B.jsx)(Nt,{children:"Karta"}),Object(B.jsxs)("div",{style:{...At.contentHeader},children:[(null===d||void 0===d?void 0:d.length)<2?null:Object(B.jsx)(Z.a,{data:d,onChange:e=>{T(e)},selectedOrganization:S,isMultiple:!0}),Object(B.jsx)(re.g,{onChange:e=>{I(e)}}),Object(B.jsx)(Rt,{type:"text",placeholder:U.f.SEARCH_VEHICLE,value:k,enterButton:!0,onChange:e=>C(e.target.value.toLowerCase()),style:{width:300}})]})]}),Object(B.jsx)("div",{style:{...At.mapContent},children:l?Object(B.jsx)("span",{children:"Kartan \xe4r ej tillg\xe4nglig."}):Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(Ve.a,{style:{...At.mapRow},gutter:16,children:[Object(B.jsx)(Me.a,{span:null!==p?18:24,children:Object(B.jsx)(_t,{vehiclesDataToShowOnTheMap:g,followDriver:j,selectedMarker:p,mapOverviewData:r,defaultCenter:O,onClickMarker:e=>R(e),setSelectedMarker:e=>b(e)})}),null!==p?Object(B.jsx)(Me.a,{span:6,children:Object(B.jsx)(xt,{isTracker:p.isTracker,showInfo:j,onClick:e=>R(e)})}):Object(B.jsx)(B.Fragment,{})]})})}),Object(B.jsx)(Fe.a,{}),Object(B.jsx)(nt,{mapOverviewData:x,selectedVehicleIds:u,followDriver:j,selectedMarker:p,onClickMarker:R,openGeozone:n,updateMapOverviewData:o,benefitType:E})]})};const wt=Object(i.createContext)({}),Lt=e=>{let{children:t}=e;const n=Object(i.useContext)(c.v),a=Object(i.useContext)(c.p),[r,o]=Object(i.useState)(),[d,v]=Object(i.useState)(),[j,h]=Object(i.useState)(),[b,O]=Object(i.useState)(!1),[m,g]=Object(i.useState)(),[f,x]=Object(i.useState)([]),[E,I]=Object(i.useState)(),[S,D]=Object(i.useState)([]),[w,L]=Object(i.useState)(Ee),[P,V]=Object(i.useState)(!1),M=window.location.search,z=new URLSearchParams(M),G=z.get("id"),Y=z.get("alarmType"),W=Object(l.g)(),K={alarmName:d,name:"",repeatAfterHours:24,repeatAfterHoursSelect:0,daysMissingTrips:3,notifyWhenAcknowledged:!0,lowBatteryLevel:30,hoursMissingContact:24,odoRemindDay:"1",isTracker:!1,organizationId:null};Object(i.useEffect)((()=>{if(!Y)return;v("FUNCTION"===Y?"NO_DRIVER":"SECURITY"===Y?"JAMMING":"ODO_DIFF")}),[Y]),Object(i.useEffect)((()=>{F.a.getOrganizationsSimple().then((e=>{o(e)})).catch((e=>console.error(e)))}),[]),Object(i.useEffect)((()=>{if("-1"===G)return g(!0),void L(Ee);F.a.getAlarmSettingsById(G).then((e=>{var t,n,i,a;e.repeatAfterHoursSelect=0===e.repeatAfterHours?0:1,e.repeatAfterHours=0===e.repeatAfterHoursSelect?24:e.repeatAfterHours,h(e),g(!1),v(e.alarmName),e.emails=e.emails.map((e=>({email:e}))),x(e.emails);const l=(null===e||void 0===e?void 0:e.targetVehicleIds)||[];let r=(null===e||void 0===e?void 0:e.targetOrganizationIds)||[],o=(null===e||void 0===e?void 0:e.targetTrackerOrganizationIds)||[];const s=(null===e||void 0===e?void 0:e.targetTrackerIds)||[];r=null===(t=r)||void 0===t?void 0:t.map((e=>"org:"+e)),o=null===(n=o)||void 0===n?void 0:n.map((e=>"org:"+e)),V((null===s||void 0===s?void 0:s.length)>0||(null===(i=o)||void 0===i?void 0:i.length)>0),D([...l,...r,...o,...s]),I(e.organizationId),L((null===(a=e.schedule)||void 0===a?void 0:a.length)>0?e.schedule:Ee)}))}),[G]),Object(i.useEffect)((()=>{r&&r&&a&&(!0===m||!1===m)&&O(!0)}),[r,a,n,m]),Object(i.useEffect)((()=>{V(!1)}),[d]);const q={alarmPrio:Object(B.jsx)(le,{initialValues:K}),alarmName:Object(B.jsx)(k.a,{disabled:!m,onChange:e=>v(e),children:Object.entries(p(Y)).map((e=>{let[t,n]=e;return Object(B.jsx)(k.a.Option,{value:t,children:n})}))}),emails:Object(B.jsx)(J,{emailData:f,setEmailData:x}),targetVehicleIds:Object(B.jsx)(Q,{showTitle:!1,selectedOrganization:E,checkedKeys:S,setCheckedKeys:D,knownVehicles:n||[],knownOrganizations:r||[],isTracker:P,setIsTracker:V}),organizationId:Object(B.jsx)(Z.a,{selectedOrganization:E,onChange:e=>I(e),data:r||[],isMultiple:!1}),repeatAfterHours:Object(B.jsx)($,{}),schema:Object(B.jsx)(Le,{schemaView:{minWidth:"100%"},changeScheduleParam:(e,t)=>{let n=w;n[e-=1]={...n[e],...t},L(n)},schedule:w}),name:Object(B.jsx)(C.a,{placeholder:"Ange alias"}),notifyWhenAcknowledged:Object(B.jsx)(re,{checked:null===j||void 0===j?void 0:j.notifyWhenAcknowledged}),daysMissingTrips:Object(B.jsx)(te,{}),lowBatteryLevel:Object(B.jsx)(ie,{}),hoursMissingContact:Object(B.jsx)(ae,{}),odoRemindDay:Object(B.jsx)(ee,{}),isTracker:Object(B.jsx)(ne,{isTracker:P,setIsTracker:V})};function X(){const e=s.c+("FUNCTION"===Y?"/alarmsFunctions":"SECURITY"===Y?"/alarmsSafety":"/alarmsQuality");W.push(e,{tab:d})}function $(){const e={display:"block",height:"30px",lineHeight:"30px"};return Object(B.jsx)(u.a.Item,{noStyle:!0,name:"repeatAfterHoursSelect",children:Object(B.jsxs)(_.a.Group,{children:[Object(B.jsx)(_.a,{value:0,style:e,children:"Meddela bara en g\xe5ng"}),Object(B.jsxs)(_.a,{value:1,style:e,children:[Object(B.jsx)("span",{className:"ant-form-text",children:"Upprepa larmet varje "}),Object(B.jsx)(u.a.Item,{noStyle:!0,name:H.k.repeatAfterHours,children:Object(B.jsx)(A.a,{min:0})}),Object(B.jsx)("span",{className:"ant-form-text",children:"h tills larmperioden avslutats eller att larmet kvitterats"})]})]})})}function ee(){const e=[];for(let t=1;t<32;t++)e.push(Object(B.jsxs)(k.a.Option,{children:[t,":e"]},t));return Object(B.jsx)("div",{children:Object(B.jsxs)("div",{style:T.interval,children:[Object(B.jsx)("p",{style:T.paragraph,children:U.f.THIS}),Object(B.jsx)(u.a.Item,{name:H.k.odoRemindDay,initialValue:"1",style:T.selectDay,children:Object(B.jsx)(k.a,{children:e})}),Object(B.jsx)("p",{style:T.paragraph,children:U.f.EVERY_MONTH})]})})}function te(){return Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{className:"ant-form-text",children:"Meddela efter "}),Object(B.jsx)(u.a.Item,{noStyle:!0,name:"daysMissingTrips",children:Object(B.jsx)(A.a,{defaultValue:3,min:1})}),Object(B.jsx)("span",{className:"ant-form-text",children:" dagar utan resor"})]})}function ne(e){return Object(B.jsx)("div",{children:Object(B.jsxs)(k.a,{style:{width:"100%"},onChange:t=>e.setIsTracker(t),value:e.isTracker,children:[Object(B.jsx)(k.a.Option,{value:!1,children:"Fordon"}),Object(B.jsx)(k.a.Option,{value:!0,children:"Utrustning"})]})})}function ie(){const[e,t]=Object(i.useState)(30);return Object(B.jsxs)("div",{style:{minWidth:600},children:[Object(B.jsxs)("span",{className:"ant-form-text",children:["Meddela n\xe4r batteriniv\xe5n \xe4r mindre \xe4n ",Object(B.jsxs)("b",{children:[e,"%"]})]}),Object(B.jsx)(u.a.Item,{noStyle:!0,name:"lowBatteryLevel",children:Object(B.jsx)(N.a,{defaultValue:30,min:10,tooltipVisible:!1,onChange:e=>{t(e)},marks:{10:"10%",20:"20%",30:"30%",40:"40%",50:"50%",60:"60%",70:"70%",80:"80%",90:"90%",100:"100%"},step:10})})]})}function ae(){return Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{className:"ant-form-text",children:"Meddela n\xe4r det g\xe5tt "}),Object(B.jsx)(u.a.Item,{noStyle:!0,name:"hoursMissingContact",children:Object(B.jsx)(A.a,{defaultValue:3,min:1})}),Object(B.jsx)("span",{className:"ant-form-text",children:" h sedan enheten f\xf6rv\xe4ntades rapportera"})]})}function le(e){let{initialValues:t}=e;return Object(B.jsx)(k.a,{defaultValue:t.alarmPrio,onChange:e=>console.log(e),children:Object.entries(y).map((e=>{let[t,n]=e;return Object(B.jsx)(k.a.Option,{value:t,children:n})}))})}function re(e){let{checked:t}=e;return Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{className:"ant-form-text",children:"Meddela n\xe4r larmet kvitterats "}),Object(B.jsx)(u.a.Item,{noStyle:!0,name:"notifyWhenAcknowledged",valuePropName:t?"checked":null,children:Object(B.jsx)(R.a,{})})]})}return Object(B.jsx)(wt.Provider,{value:{loaded:b,alarmName:d,showAsCard:["alarmName","alarmPrio","alarmName","organizationId","isTracker","name","repeatAfterHours","daysMissingTrips","notifyWhenAcknowledged","lowBatteryLevel","hoursMissingContact","odoRemindDay"],fields:q,alarmType:Y,onFinish:function(e){var t,i;const a=[];f.map((e=>{a.push(e.email)}));let l=null===S||void 0===S||null===(t=S.filter((e=>e.toString().startsWith("org"))))||void 0===t?void 0:t.map((e=>parseInt(e.replace("org:","")))),r=S.map((e=>null===n||void 0===n?void 0:n.find((t=>(null===t||void 0===t?void 0:t.id)===e))));r=null===(i=r.filter((e=>!l.includes(null===e||void 0===e?void 0:e.organizationId)&&e)))||void 0===i?void 0:i.map((e=>null===e||void 0===e?void 0:e.id)),e.emails=a,e.alarmType=Y,e.repeatAfterHours=0===e.repeatAfterHoursSelect?0:e.repeatAfterHours,e.targetVehicleIds=P?[]:r,e.targetOrganizationIds=P?[]:l,e.targetTrackerIds=P?r:[],e.targetTrackerOrganizationIds=P?l:[],e.schema=w,j&&(e={...j,...e}),!0===m?F.a.postAlarmSettings(e).then((e=>{X()})):F.a.patchAlarmSettings(null===j||void 0===j?void 0:j.alarmSettingsId,e).then((e=>{X()}))},alarm:j,initialValues:K,onClickCancel:X,isTracker:P},children:t})};var Pt=()=>{const[e]=u.a.useForm(),t=Object(i.useContext)(wt);return t.loaded?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(v.a.Title,{children:["Skapa ett nytt ",b[t.alarmType]]}),Object(B.jsxs)(u.a,{onFinish:t.onFinish,onFinishFailed:e=>console.log(e),style:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"0px",justifyContent:"space-between"},form:e,layout:"vertical",name:"newAlarm",initialValues:t.alarm||t.initialValues,children:[Object(B.jsx)(j.a,{style:{minWidth:"100%",padding:"0px"},children:Object.entries(I[t.alarmName]).map((e=>{let[n,i]=e;if(i)return t.showAsCard.includes(n)?Object(B.jsx)(u.a.Item,{name:n,label:E[n],style:T[n],initialValue:t.isTracker,rules:[{required:!0,message:"Detta f\xe4lt kan inte vara tomt"}],children:t.fields[n]}):void 0}))}),Object.entries(I[t.alarmName]).map((e=>{let[n,i]=e;if(i&&!t.showAsCard.includes(n)){const e=t.isTracker&&"targetVehicleIds"===n?"V\xe4lj utrustning":E[n];return Object(B.jsx)(u.a.Item,{name:n,label:e,style:T[n],rules:[{required:!1,message:"Detta f\xe4lt kan inte vara tomt"}],children:t.fields[n]})}})),Object(B.jsx)(u.a.Item,{style:{width:"100%"},children:Object(B.jsxs)(S.a,{gap:20,justifyContent:"end",children:[Object(B.jsx)(h.a,{onClick:t.onClickCancel,children:"Avbryt"}),Object(B.jsx)(h.a,{htmlType:"submit",type:"primary",children:"Skapa"})]})})]})]}):Object(B.jsx)(o.a,{})},Vt=n(53);var Mt=()=>Object(B.jsx)(Vt.a,{wrappers:[c.w,c.q,c.g,Lt],children:Object(B.jsx)(Pt,{})});var Ft=e=>{const[t]=u.a.useForm();return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(v.a.Title,{children:"Felanm\xe4lan"}),Object(B.jsx)(j.a,{title:"Felanm\xe4lan",bordered:!0,style:{width:"49%",minWidth:350,margin:"auto"},children:Object(B.jsxs)(u.a,{form:t,layout:"vertical",name:"form_in_modal",initialValues:{modifier:"public"},onFinish:e=>{F.b.postContactTrackson(e).then((e=>{$.b.success("Din felanm\xe4lan har skickats!"),t.resetFields()})),console.log("Success:",e)},children:[Object(B.jsx)(u.a.Item,{label:"Titel",name:"subject",rules:[{required:!0,message:"Ange titel!"}],children:Object(B.jsx)(C.a,{placeholder:"t.ex. ABC123 har l\xe5g batteriniv\xe5"})}),Object(B.jsx)(u.a.Item,{label:"Beskrivning",name:"body",rules:[{required:!1,message:"Please input description!"}],children:Object(B.jsx)(C.a.TextArea,{rows:8,placeholder:"t.ex. Batteriniv\xe5 var l\xe5g p\xe5 morgonen"})}),Object(B.jsx)(u.a.Item,{label:"Din E-post",name:"addrFrom",rules:[{required:!0,message:"Ange E-post"}],children:Object(B.jsx)(C.a,{placeholder:"min-epost@example.com"})}),Object(B.jsx)(u.a.Item,{label:"Ditt Telefonnummer",name:"phone",rules:[{required:!0,message:"Ange telefonnummer"}],children:Object(B.jsx)(C.a,{placeholder:"0707..."})}),Object(B.jsx)(u.a.Item,{wrapperCol:{span:16},children:Object(B.jsx)(h.a,{type:"primary",htmlType:"submit",children:"Rapportera"})})]})})]})};var zt=()=>Object(B.jsx)(Ze,{children:Object(B.jsx)(Ft,{})}),Ut=n(95),Bt=n(100);const{TabPane:Gt}=ze.a,Ht=e=>{let{visible:t,onCreate:n,onCancel:a,knownVehicles:l,knownUsers:r}=e;const[o]=u.a.useForm(),[s,d]=Object(i.useState)(O.NO_DRIVER);return Object(B.jsx)(Ut.a,{visible:t,title:"Skapa ett nytt larm - "+s,okText:"Skapa larm",cancelText:"Avbryt",onCancel:a,onOk:()=>{o.validateFields().then((e=>{o.resetFields(),n(e)})).catch((e=>{console.log("Validate Failed:",e)}))},children:Object(B.jsxs)(u.a,{form:o,layout:"vertical",name:"form_in_modal",initialValues:{modifier:"public"},children:[Object(B.jsx)(u.a.Item,{name:"alarmName",label:"Larm",initialValue:"NO_DRIVER",rules:[{required:!0,message:"Please input the title of collection!"}],children:Object(B.jsx)(k.a,{onChange:e=>d(O[e]),children:Object.entries(O).map((e=>{let[t,n]=e;return Object(B.jsx)(k.a.Option,{value:t,children:n})}))})}),Object(B.jsx)(u.a.Item,{name:"alarmPrio",label:"Priority",initialValue:"HIGH",rules:[{required:!0,message:"Please input the title of collection!"}],children:Object(B.jsx)(k.a,{onChange:e=>d(O[e]),children:Object.entries(y).map((e=>{let[t,n]=e;return Object(B.jsx)(k.a.Option,{value:t,children:n})}))})}),Object(B.jsx)(u.a.Item,{name:"name",label:"Alias",rules:[{required:!0,message:"Please input the title of collection!"}],children:Object(B.jsx)(C.a,{type:"textarea"})}),Object(B.jsx)(u.a.Item,{name:"targetVehicleIds",label:"Fordon",rules:[{required:!0,message:"Please input the title of collection!"}],children:Object(B.jsx)(k.a,{mode:"multiple",onChange:e=>d(O[e]),children:null===l||void 0===l?void 0:l.map((e=>Object(B.jsxs)(k.a.Option,{value:e.id,children:[e.registry," ",e.displayName]})))})}),Object(B.jsx)(u.a.Item,{name:"emails",label:"E-post",rules:[{required:!0,message:"Please input the title of collection!"}],children:Object(B.jsx)(k.a,{mode:"multiple",onChange:e=>d(O[e]),children:null===r||void 0===r?void 0:r.map((e=>Object(B.jsx)(k.a.Option,{value:e.displayName,children:e.displayName})))})})]})})};var Yt=e=>{var t;let{alarmType:n}=e;const a=Object(l.g)(),r=Object(i.useContext)(c.f),d=Object(i.useContext)(c.v),u=Object(i.useContext)(c.n),j=Object(i.useContext)(c.z.context),[O,m]=Object(i.useState)([]),[g,f]=Object(i.useState)([]),[x,y]=Object(i.useState)([]),[E,S]=Object(i.useState)(!1),[T,k]=Object(i.useState)(),[C,_]=Object(i.useState)(!0),A=b[n];Object(i.useEffect)((()=>{g&&d&&u&&_(!1)}),[g,d,u]),Object(i.useEffect)((()=>{var e,t;k((null===a||void 0===a||null===(e=a.location)||void 0===e||null===(t=e.state)||void 0===t?void 0:t.tab)||Object.entries(p(n))[0][0]),F.a.getAlarmSettings().then((e=>{var t;e=null===(t=e)||void 0===t?void 0:t.filter((e=>e.alarmType===n)),f(e),y(e)}))}),[]),Object(i.useEffect)((()=>{(null===O||void 0===O?void 0:O.length)>0?f(x.filter((e=>O.includes(e.organizationId)))):f(x)}),[O]);null!==(t=I[T])&&void 0!==t&&t.isTracker;const N=[{title:U.f.ORGANIZATION,dataIndex:H.k.organizationId,hidden:j,render:e=>{const t=null===r||void 0===r?void 0:r.find((t=>t.organizationId===e));return null===t||void 0===t?void 0:t.fullName}},{title:"Larmalias",dataIndex:"name"},{title:"Intervall",dataIndex:"repeatAfterHours",render:e=>0===e?"Meddelas bara en g\xe5ng":"Upprepas varje "+e+" h "},{title:U.f.MAIL_RECIPIENTS,dataIndex:H.k.emails,render:e=>{if(1===(null===e||void 0===e?void 0:e.length))return Object(B.jsx)("a",{children:e[0]});if(0===(null===e||void 0===e?void 0:e.length))return"-";{let t=(null===e||void 0===e?void 0:e.length)+" "+U.f.MAIL_RECIPIENTS;return Object(Bt.a)(t,null,e)}}},{title:"Aktivt",dataIndex:"active",align:"right",render:(e,t)=>Object(B.jsx)(R.a,{onChange:e=>D({active:e},t),defaultChecked:e})},{title:"",dataIndex:"operation",width:80,fixed:"right",render:(e,t)=>Object(B.jsx)(re.a,{menu:()=>function(e){return Object(B.jsxs)(X.a,{children:[Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(oe.a,{}),onClick:()=>w(e.alarmSettingsId),children:"Se detaljer/\xc4ndra"}),Object(B.jsxs)(X.a.Item,{danger:!0,icon:Object(B.jsx)(z.a,{}),onClick:()=>(e=>{const t=null===g||void 0===g?void 0:g.filter((t=>t.alarmSettingsId!==e));F.a.deleteAlarmSettings(e).then((e=>{f(t)}))})(e.alarmSettingsId),children:[U.f.DELETE," "]})]})}(t)})}].filter((e=>!e.hidden));const D=(e,t)=>{F.a.patchAlarmSettings(t.alarmSettingsId,e)},w=e=>{const t=s.c+"/alarmEditor/?alarmType="+n+"&id="+(e||-1);a.push({pathname:t,state:{id:e}})};function L(e,t){let n=!1;return t.map((e=>{e.active&&(n=!0)})),e>0&&!n?H.b.YELLOW:0===e?H.b.RED:H.b.GREEN}return C?Object(B.jsx)(o.a,{}):Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(B.jsx)(v.a.Title,{children:A}),Object(B.jsxs)("div",{style:{display:"flex",gap:15,alignItems:"center",flexWrap:"wrap"},children:[(null===r||void 0===r?void 0:r.length)<2?null:Object(B.jsx)(Z.a,{data:r,onChange:e=>m(e),selectedOrganization:O,isMultiple:!0}),Object(B.jsxs)(h.a,{type:"primary",onClick:()=>w(-1),icon:Object(B.jsx)(le.a,{}),children:[U.f.ADD," "]})]})]}),Object(B.jsx)(Ht,{visible:E,onCreate:function(e){e.organizationId=2226,e.alarmType=n,e.targetVehicleIds=F.a.postAlarmSettings(e),S(!E)},onCancel:()=>{S(!1)},knownVehicles:d,knownUsers:u}),T&&Object(B.jsx)(ze.a,{defaultActiveKey:T,onChange:e=>k(e),children:Object.entries(p(n)).map((e=>{let[t,n]=e,i=g.filter((e=>e.alarmName===t));return Object(B.jsx)(Gt,{tab:Object(B.jsx)($e.f,{text:n,overflowCount:999,badgeColor:L(null===i||void 0===i?void 0:i.length,i),count:null===i||void 0===i?void 0:i.length}),children:Object(B.jsx)(M.a,{dataSource:i,scroll:{x:1e3},columns:Object(re.m)(N),...re.n})},t)}))})]})};var Wt=()=>Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(Yt,{alarmType:"SECURITY"})});var Kt=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.w,c.u,c.q,c.o,c.g],children:Object(B.jsx)(Wt,{})}),qt=n(379),Jt=n(220),Qt=n(125),Zt=n(989),Xt=n(960),$t=n(945);const en=e=>{var t,n,i,a;let{showModalForAlarmGeo:l,setShowModalForAlarmGeo:r,record:o}=e;return null!==o&&void 0!==o&&o.position?Object(B.jsx)(Ut.a,{title:null===o||void 0===o?void 0:o.address,visible:l,onOk:()=>r(!1),onCancel:()=>r(!1),footer:null,width:1e3,children:Object(B.jsx)(ae.a,{style:{height:400,transform:"translate(0, 0px)"},bootstrapURLKeys:{key:s.h},center:[null===o||void 0===o||null===(t=o.position)||void 0===t?void 0:t.latitude,null===o||void 0===o||null===(n=o.position)||void 0===n?void 0:n.longitude],zoom:15,options:ie,yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:e=>{let{map:t,maps:n}=e;ne(n,t)},children:Object(B.jsx)(tn,{lat:null===o||void 0===o||null===(i=o.position)||void 0===i?void 0:i.latitude,lng:null===o||void 0===o||null===(a=o.position)||void 0===a?void 0:a.longitude})})}):null},tn=()=>Object(B.jsx)(ct.Icon,{icon:Ot.warning,style:{fontSize:16,borderRadius:"50%",boxShadow:"0 0 0 20px rgba(255,0,0,0.35)",backgroundColor:"0 0 0 20px rgba(255,0,0,0.35)",outlineStyle:"circle",color:"red"}}),nn=a.a.createContext(null),an=e=>{const[t,n]=Object(i.useState)(),[a,l]=Object(i.useState)(),[r,o]=Object(i.useState)(),[s,d]=Object(i.useState)(!0),[u,v]=Object(i.useState)(),[j,h]=Object(i.useState)(),[p,O]=Object(i.useState)(),[m,g]=Object(i.useState)([]),[f,x]=Object(i.useState)([]),[y,E]=Object(i.useState)([]),I=Object(i.useContext)(c.v),S=Object(i.useContext)(c.p),[T,k]=Object(i.useState)();let C=[Te()().add(-30,"days"),Te()().endOf("day")];function _(){var e,t,i,a;let l=T?null===(e=T[0])||void 0===e?void 0:e.unix():null===(t=C[0])||void 0===t?void 0:t.unix(),r=T?null===(i=T[1])||void 0===i?void 0:i.unix():null===(a=C[1])||void 0===a?void 0:a.unix();F.a.getAlarmPeriod(l,r).then((e=>{const t=e.map((e=>{const t=null===I||void 0===I?void 0:I.find((t=>t.id===e.vehicleId));return{...e,vehicle:t}}));n(t)}))}Object(i.useEffect)((()=>{k(C)}),[]),Object(i.useEffect)((()=>{_()}),[I]);return Object(B.jsx)(nn.Provider,{value:{alarmData:t,setAlarmData:n,unacknowledgedAlarm:a,acknowledgedAlarm:r,selectedOrganization:u,selectedVehicles:j,setSelectedVehicles:h,selectedDrivers:p,selectedAlarmTypes:m,selectedAlarmSubTypes:f,selectedAlarmTypesAndSubTypes:y,setSelectedAlarmTypesAndSubTypes:E,knownVehicles:I,knownAlarmTypes:[{value:-1,key:-1,label:"--V\xe4lj alla--",children:[]},{value:"SECURITY",key:"SECURITY",label:"S\xe4kerhetslarm",children:[{value:"CRASH",key:"CRASH",label:"- Incident"},{value:"JAMMING",key:"JAMMING",label:"- St\xf6rd signal (jamming)"}]},{value:"FUNCTION",key:"FUNCTION",label:"Funktionslarm",children:[{value:"NO_DRIVER",key:"NO_DRIVER",label:"- F\xf6rarl\xf6s resa"},{value:"UNPLUG",key:"UNPLUG",label:"- Enhet urkopplad"},{value:"MISSING_TRIPS",key:"MISSING_TRIPS",label:"- Resor ej rapporterade p\xe5 X dagar"},{value:"INTERMITTENCE",key:"INTERMITTENCE",label:"- Tappad kontakt"},{value:"BATTERY_SUB_20",key:"BATTERY_SUB_20",label:"- L\xe5g batterisp\xe4nning"}]},{value:"GEO",key:"GEO",label:"Geo-larm",children:[{value:"GEO_ZONE",key:"GEO_ZONE",label:"- Geofence"}]}],organizationSelectOnChange:e=>{v(e)},vehiclesSelectOnChange:e=>{if(e.includes(-1)){if((null===j||void 0===j?void 0:j.length)>0)return void h([]);const t=e?I.map((e=>null===e||void 0===e?void 0:e.id)):[];return void h(t)}const t=e.filter((e=>null!==e));h(t)},driversSelectOnChange:e=>{if(e.includes(-1)){if((null===p||void 0===p?void 0:p.length)>0)return void O([]);const t=e?S.map((e=>null===e||void 0===e?void 0:e.userId)):[];return void O(t)}const t=e.filter((e=>null!==e));O(t)},alarmTypesAndSubTypesSelectOnChange:e=>{let t=[],n=[];E(e),console.log("selected types and subtypes",e),console.log(Object.keys(b)),e.map((e=>{Object.keys(b).includes(e)?t.push(e):n.push(e)})),g(t),x(n)},onChangeDate:e=>{if(e&&e.length>1){const t=e[0].startOf("day"),n=e[1].endOf("day");k([t,n])}},pickerValue:C,defaultPickerValue:T,setDefaultPickerValue:k,loading:s,setLoading:d,fetchAlarms:_},children:e.children})},{Option:ln,OptGroup:rn}=k.a,on=e=>{let{value:t,onChange:n,data:i,multiple:a,...l}=e;const r=null===i||void 0===i?void 0:i.filter((e=>!(null!==e&&void 0!==e&&e.isArchived))),o=null===i||void 0===i?void 0:i.filter((e=>null===e||void 0===e?void 0:e.isArchived));return Object(B.jsx)("div",{children:Object(B.jsx)(L.a,{placement:"topLeft",title:U.f.START_TYPING_TO_SEARCH,children:Object(B.jsxs)(k.a,{mode:a,allowClear:a,defaultValue:t,maxTagCount:1,style:{minWidth:200},dropdownStyle:{minWidth:400},autoClearSearchValue:!1,onChange:n,showSearch:!0,placeholder:l.placeholder||U.f.FILTER_BY_VEHICLE,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.object))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},value:t,children:[a&&Object(B.jsx)(ln,{style:{color:"#286FBE",cursor:"pointer"},value:-1,children:(null===t||void 0===t?void 0:t.length)>0?Object(B.jsx)("span",{style:{color:"#286FBE",cursor:"pointer"},children:"Avmarkera alla"}):Object(B.jsx)("span",{style:{color:"#286FBE",cursor:"pointer"},children:"V\xe4lj alla"})},-1),null===r||void 0===r?void 0:r.map(((e,t)=>Object(B.jsxs)(k.a.Option,{value:e.id,object:e,children:[e.registry," ",e.displayName," ",e.registry||e.displayName?"":U.f.UNKNOWN+" "+e.id]},e.id))),(null===o||void 0===o?void 0:o.length)>0&&Object(B.jsx)(rn,{label:"Arkiverade",children:null===o||void 0===o?void 0:o.map(((e,t)=>Object(B.jsxs)(k.a.Option,{value:e.id,object:e,children:[Object(B.jsx)(he.a,{style:{marginRight:8}}),e.registry," ",e.displayName," ",e.registry||e.displayName?"":U.f.UNKNOWN+" "+e.id]},e.id)))})]})})})};var sn=n(168);const{Title:dn}=v.a,{TabPane:cn}=ze.a;var un=()=>{const[e,t]=Object(i.useState)(),[n,a]=Object(i.useState)(),[r,o]=Object(i.useState)(),[d,u]=Object(i.useState)([]),[v,j]=Object(i.useState)(!1),[p,O]=Object(i.useState)(!1),[y,E]=Object(i.useState)(!1),[I,T]=Object(i.useState)(),[k,_]=Object(i.useState)(!1),{push:A}=Object(l.g)(),{alarmData:N,selectedOrganization:R,selectedVehicles:D,setSelectedVehicles:P,selectedDrivers:V,selectedAlarmTypes:z,selectedAlarmSubTypes:G,selectedAlarmTypesAndSubTypes:Y,knownVehicles:W,knownAlarmTypes:K,organizationSelectOnChange:q,vehiclesSelectOnChange:J,driversSelectOnChange:Q,alarmTypesAndSubTypesSelectOnChange:$,onChangeDate:ee,defaultPickerValue:te,loading:ne,setLoading:ie,fetchAlarms:ae}=Object(i.useContext)(nn),le=Object(i.useContext)(c.f),oe=Object(i.useContext)(c.p),se=Object(i.useContext)(c.z.context),{t:de}=Object(je.b)();function ce(){let e=N;var n,i,a,l,r;(null===R||void 0===R?void 0:R.length)>0&&(e=null===(n=e)||void 0===n?void 0:n.filter((e=>null===R||void 0===R?void 0:R.includes(e.organizationId))));(null===D||void 0===D?void 0:D.length)>0&&(e=null===(i=e)||void 0===i?void 0:i.filter((e=>null===D||void 0===D?void 0:D.includes(e.vehicleId))));(null===V||void 0===V?void 0:V.length)>0&&(e=null===(a=e)||void 0===a?void 0:a.filter((e=>null===V||void 0===V?void 0:V.includes(e.driverId))));((null===z||void 0===z?void 0:z.length)>0||(null===G||void 0===G?void 0:G.length)>0)&&(e=null===(l=e)||void 0===l?void 0:l.filter((e=>(null===z||void 0===z?void 0:z.includes(e.alarmType))||(null===G||void 0===G?void 0:G.includes(e.alarmName)))));v&&(e=null===(r=e)||void 0===r?void 0:r.filter((e=>null===e.timestampStopMs)));t(e)}Object(i.useEffect)((()=>{console.log("this is the selected vehicle",D)}),[D]),Object(i.useEffect)((()=>{console.log("this is the selected vehicle id",d)}),[d]),Object(i.useEffect)((()=>{ce()}),[N]),Object(i.useEffect)((()=>{let t=null===e||void 0===e?void 0:e.filter((e=>!1===(null===e||void 0===e?void 0:e.acknowledged)));a(t),ie(!1)}),[e]),Object(i.useEffect)((()=>{let t=null===e||void 0===e?void 0:e.filter((e=>!0===(null===e||void 0===e?void 0:e.acknowledged)));o(t),ie(!1)}),[e]),Object(i.useEffect)((()=>{}),[r,n]),Object(i.useEffect)((()=>{ce()}),[v]);const ue=e=>{let{showModalForAcknowledgingAlarms:t,record:n,handleAcknowledged:a}=e;const[l,r]=Object(i.useState)();return Object(B.jsxs)(Ut.a,{title:"Kvittera larm",visible:t,onOk:()=>(r(!1),void a(n,l)),onCancel:()=>(E(!1),void r(!1)),okText:"Kvittera",cancelText:"Avbryt",width:500,children:[Object(B.jsx)("p",{children:"H\xe4r kan du v\xe4lja att l\xe4gga till en egen notering om larmet (max 40 tecken)."}),Object(B.jsx)(C.a,{style:{marginTop:"0.25em"},value:l||null,onChange:e=>function(e){r(e.target.value)}(e),placeholder:"Egen kommentar",allowClear:!0,maxLength:40})]})},ve=e=>{let{showAlarmCommentModal:t,record:n}=e;return Object(B.jsx)(Ut.a,{visible:t,icon:null,title:"Kvitteringskommentar",onOk:()=>_(!1),onCancel:()=>_(!1),footer:null,width:350,children:Object(B.jsx)("div",{children:Object(B.jsx)("p",{children:null===n||void 0===n?void 0:n.comment})})})};const he=null===e||void 0===e?void 0:e.map((e=>({text:e.geoZoneAlarmName,value:e.geoZoneAlarmName})));null===he||void 0===he||he.filter(((e,t)=>t===he.findIndex((t=>t.value===e.value))));const pe=(e,t)=>{const i={acknowledged:!0,comment:t};F.a.patchAlarmPeriod(i,e.activeAlarmPeriodId).then((t=>{E(!1);const i=null===n||void 0===n?void 0:n.filter((t=>t.activeAlarmPeriodId!==e.activeAlarmPeriodId));a(i);const l=r?[...r]:[];e={...e,acknowledged:t.acknowledged,comment:t.comment,acknowledgedBy:t.acknowledgedBy,acknowledgedTimestampMs:t.acknowledgedTimestampMs},null===l||void 0===l||l.push(e),o(l.sort(((e,t)=>t.activeAlarmPeriodId-e.activeAlarmPeriodId)))}))};let be=[{title:U.f.ORGANIZATION,dataIndex:H.k.organizationId,hidden:se,render:e=>{const t=null===le||void 0===le?void 0:le.find((t=>t.organizationId===e));return null===t||void 0===t?void 0:t.fullName}},{title:U.f.ALARM_TYPE,dataIndex:H.k.alarmType,render:e=>b[e]},{title:U.f.ALARM_NAME,dataIndex:H.k.alarmName,render:(e,t)=>{switch(t.alarmType){case"SECURITY":return m[e];case"GEO":return x[e];case"FUNCTION":return f[e];case"QUALITY":return g[e];default:return"Ok\xe4nd larmtyp"}}},{title:de(U.f.ALIAS),dataIndex:H.k.geoZoneAlarmName},{title:"Fordon/Utrustning",dataIndex:H.k.vehicle,render:e=>{const t=null===W||void 0===W?void 0:W.find((t=>t.id===(null===e||void 0===e?void 0:e.id))),n=null===t||void 0===t?void 0:t.registry,i=null!==t&&void 0!==t&&t.displayName?" (".concat(t.displayName,")"):null;return n&&i?n+i:n?i?null===t||void 0===t?void 0:t.vehicleId:n:null===t||void 0===t?void 0:t.displayName}},{title:U.f.TIMEPOINT,dataIndex:H.k.vehicle,render:(e,t)=>{const n=Object(pt.a)(t.timestampStartMs,"ddd, D MMM"),i=Object(pt.a)(t.timestampStartMs,"ddd, D MMM YYYY HH:mm"),a=t.timestampStopMs?Object(pt.a)(t.timestampStopMs,"ddd, D MMM "):U.f.ONGOING,l=t.timestampStopMs?Object(pt.a)(t.timestampStopMs,"ddd, D MMM YYYY HH:mm"):U.f.ONGOING;return t.timestampStartMs===t.timestampStopMs?Object(B.jsx)("span",{children:n}):Object(B.jsxs)(L.a,{title:i+" - "+l,children:[Object(B.jsxs)("span",{children:[n," - "]}),a?Object(B.jsx)("span",{children:a}):Object(B.jsx)("span",{style:{color:H.b.YELLOW},children:U.f.ONGOING})]})}},{title:U.f.ACKNOWLEDGED,dataIndex:H.k.acknowledged,width:180,render:(e,t)=>{let n=null===oe||void 0===oe?void 0:oe.find((e=>e.userId===(null===t||void 0===t?void 0:t.acknowledgedBy)));return e?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("p",{children:[Object(pt.a)(null===t||void 0===t?void 0:t.acknowledgedTimestampMs,"D MMM HH:mm"),Object(B.jsx)("br",{}),null===n||void 0===n?void 0:n.displayName]}),null!==t&&void 0!==t&&t.comment?Object(B.jsx)(Zt.a,{style:{fontSize:"1.5em",color:H.b.BLUE},onClick:()=>function(e){T(e),_(!k)}(t)}):null]}):Object(B.jsxs)(S.a,{justifyContent:"between",children:[Object(B.jsx)(h.a,{type:"primary",onClick:()=>pe(t,null),children:"Kvittera"}),Object(B.jsx)(h.a,{icon:Object(B.jsx)(Zt.a,{}),onClick:()=>function(e){T(e),E(!y)}(t)})]})}},{title:"",dataIndex:"operation",width:80,render:(e,t)=>Object(B.jsx)(re.a,{menu:()=>function(e){const t=null===W||void 0===W?void 0:W.find((t=>(null===t||void 0===t?void 0:t.id)===(null===e||void 0===e?void 0:e.vehicleId)));return Object(B.jsxs)(X.a,{children:[Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(Xt.a,{}),onClick:()=>function(e,t){const n=null===e||void 0===e?void 0:e.geoZoneAlarmId,i=W.find((t=>t.id===(null===e||void 0===e?void 0:e.vehicleId)));localStorage.setItem(w.f,i.registry),A({pathname:"".concat(s.c,"/")+t,state:{searchTerm:i.registry,id:n}})}(e,me(e)),children:[U.f.SHOW_LARM," "]}),!(null!==t&&void 0!==t&&t.isArchived)&&Object(B.jsx)(X.a.Item,{danger:!1,icon:Object(B.jsx)($t.a,{}),onClick:()=>function(e,t,n){const i=null===e||void 0===e?void 0:e.vehicleId;let a;a=n?"&&showArchived=".concat(n):"",A("".concat(s.c,"/").concat(t,"?vehicleId=").concat(i)+a)}(e,"map"),children:"Visa p\xe5 karta"}),"            ",Object(B.jsxs)(X.a.Item,{danger:!1,icon:Object(B.jsx)(Ue.a,{}),onClick:()=>function(e){O(!p),T(e)}(e),children:[U.f.SHOW_WHERE_ALARM_TRIGGERED," "]})]})}(t)})}].filter((e=>!e.hidden));const me=e=>("GEO"===e.alarmType?"geoLarmDetails/":"alarmEditor/?alarmType="+e.alarmType+"&id=")+e.geoZoneAlarmId;return ne?null:Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:[Object(B.jsx)(dn,{children:U.f.TRIGGERED_LARM}),Object(B.jsx)(h.a,{icon:Object(B.jsx)(Ye.a,{}),onClick:()=>{let e=Te.a.tz.guess(),t="_",n=e;null===D||void 0===D||D.map((e=>{const n=null===W||void 0===W?void 0:W.find((t=>t.id===e)),i=(null===n||void 0===n?void 0:n.registry)||(null===n||void 0===n?void 0:n.displayName);t=t+i+"_"})),F.a.getAlarmEventsReport(te[0].unix(),te[1].unix(),V,D,R,n,z,G).then((e=>{console.log(e)}))},children:"Exportera"})]}),Object(B.jsxs)(S.a,{flexDirection:"column",style:{marginBottom:10},children:[Object(B.jsxs)(S.a,{style:{gap:10,flexWrap:"wrap"},children:[(null===le||void 0===le?void 0:le.length)<2?null:Object(B.jsx)(Z.a,{data:le,onChange:q,selectedOrganization:R,isMultiple:!0}),Object(B.jsx)(on,{multiple:"multiple",data:W,onChange:J,placeholder:"Filtrera efter fordon eller utrustning",value:D}),Object(B.jsx)(Oe,{multiple:"multiple",data:oe,value:V,onChange:Q}),Object(B.jsx)("div",{children:Object(B.jsx)(qt.a,{multiple:!0,allowClear:!0,showSearch:!0,maxTagCount:1,style:{minWidth:200},dropdownStyle:{minWidth:400},placeholder:"Filtrera efter larmtyp",treeData:K,treeDefaultExpandAll:!0,value:Y,onChange:$})}),Object(B.jsx)("div",{children:Object(B.jsx)(Jt.a.RangePicker,{dropdownClassName:"one-month",onChange:e=>ee(e),defaultValue:te,format:"YYYY-MM-DD",allowClear:!1,defaultPickerValue:te})}),Object(B.jsx)(h.a,{type:"primary",onClick:()=>{ae()},children:U.f.BTN_SEARCH})]}),Object(B.jsx)(Qt.a,{style:{marginTop:"18px"},checked:v,onChange:e=>j(e.target.checked),children:"Visa endast p\xe5g\xe5ende larm f\xf6r vald period"})]}),Object(B.jsx)(en,{setShowModalForAlarmGeo:O,showModalForAlarmGeo:p,record:I}),Object(B.jsx)(ue,{setShowModalForAcknowledgingAlarms:E,showModalForAcknowledgingAlarms:y,record:I,handleAcknowledged:pe}),Object(B.jsx)(ve,{setShowAlarmCommentModal:_,showAlarmCommentModal:k,record:I}),n?Object(B.jsxs)(ze.a,{defaultActiveKey:"1",children:[Object(B.jsx)(cn,{tab:Object(B.jsx)($e.f,{text:U.f.ACTUALLY,overflowCount:999,count:null===n||void 0===n?void 0:n.length}),children:Object(B.jsx)(M.a,{dataSource:n,columns:Object(re.m)(be),scroll:{x:1e3},...re.n})},"1"),Object(B.jsx)(cn,{tab:Object(B.jsx)($e.f,{text:U.f.LOG,overflowCount:999,count:null===r||void 0===r?void 0:r.length}),children:Object(B.jsx)(M.a,{dataSource:r,columns:Object(re.m)(be),scroll:{x:1e3},...re.n})},"2")]}):Object(B.jsx)(sn.a,{}),"        "]})};const vn=Object(i.createContext)({}),jn=e=>{let{children:t}=e;return Object(i.useEffect)((()=>{console.log("TEST context alarm")}),[]),Object(B.jsx)(vn.Provider,{value:{},children:t})};var hn=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.g,c.q,c.w,c.l.provider,an,jn],children:Object(B.jsx)(un,{})});var pn=()=>Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(Yt,{alarmType:"FUNCTION"})});var bn=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.w,c.u,c.q,c.o,c.g],children:Object(B.jsx)(pn,{})});const On=()=>Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(Yt,{alarmType:"QUALITY"})});var mn=()=>Object(B.jsx)(Vt.a,{wrappers:[c.u,c.q,c.g],children:Object(B.jsx)(On,{})}),gn=n(179);const{Title:fn}=v.a,xn=e=>{var t,n,i,a,l,r;let{i:o}=e;const s=null===o||void 0===o?void 0:o.times[0],d=null===o||void 0===o?void 0:o.times[1];let c=null!==o&&void 0!==o&&o.active?"green":null;var u,v;(s.start=(null===s||void 0===s||null===(t=s.start)||void 0===t?void 0:t.toString().length)<4?"0"+(null===s||void 0===s?void 0:s.start):null===s||void 0===s?void 0:s.start,s.stop=(null===s||void 0===s||null===(n=s.stop)||void 0===n?void 0:n.toString().length)<4?"0"+(null===s||void 0===s?void 0:s.stop):null===s||void 0===s?void 0:s.stop,d)&&(d.start=(null===d||void 0===d||null===(u=d.start)||void 0===u?void 0:u.toString().length)<4?"0"+(null===d||void 0===d?void 0:d.start):null===d||void 0===d?void 0:d.start,d.stop=(null===d||void 0===d||null===(v=d.stop)||void 0===v?void 0:v.toString().length)<4?"0"+(null===d||void 0===d?void 0:d.stop):null===d||void 0===d?void 0:d.stop);const j=e=>(null===e||void 0===e?void 0:e.toString().slice(0,2))+":"+e.toString().slice(2),h=null!==o&&void 0!==o&&o.active?j((null===s||void 0===s||null===(i=s.start)||void 0===i?void 0:i.toString().length)<4?"0"+(null===s||void 0===s?void 0:s.start):null===s||void 0===s?void 0:s.start)+" -":" ";let p=null!==o&&void 0!==o&&o.active?j((null===s||void 0===s||null===(a=s.stop)||void 0===a?void 0:a.toString().length)<4?"0"+(null===s||void 0===s?void 0:s.stop):null===s||void 0===s?void 0:s.stop):" ";return Object(B.jsxs)(gn.a,{style:{marginRight:8,marginTop:8,minWidth:110},color:c,children:[re.h[null===o||void 0===o?void 0:o.dayOfWeek],Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("br",{}),h+" "+p,Object(B.jsx)("br",{}),d&&c?j((null===d||void 0===d||null===(l=d.start)||void 0===l?void 0:l.toString().length)<4?"0"+(null===d||void 0===d?void 0:d.start):null===d||void 0===d?void 0:d.start)+" - "+j((null===d||void 0===d||null===(r=d.stop)||void 0===r?void 0:r.toString().length)<4?"0"+(null===d||void 0===d?void 0:d.stop):null===d||void 0===d?void 0:d.stop):null]})]})};function yn(){const[e]=u.a.useForm(),[t,n]=Object(i.useState)([]),[a,r]=Object(i.useState)(),[d,j]=Object(i.useState)(""),[p,b]=Object(i.useState)(!0),[O,m]=Object(i.useState)(),[g,f]=Object(i.useState)(),[x,y]=Object(i.useState)(),[E,I]=Object(i.useState)(!1),T=Object(l.g)(),k=Object(i.useContext)(c.z.context);Object(i.useContext)(c.v);Object(i.useEffect)((()=>{F.b.getCurrentUser().then((e=>{var t;r(e),null!==(t=e.roles)&&void 0!==t&&t.includes("ROOT")&&I(!0)})),F.a.getOrganizationsSimple().then((e=>{m(e)}))}),[]),Object(i.useEffect)((()=>{a&&F.a.getGeoAlarm().then((e=>{console.log(e),b(!0),n(e),b(!1)}))}),[a]),Object(i.useEffect)((()=>{let e=t;var n;(null===g||void 0===g?void 0:g.length)>0&&(e=null===(n=e)||void 0===n?void 0:n.filter((e=>null===g||void 0===g?void 0:g.includes(e.organizationId))));y(e)}),[g,t]);const C=e=>{const t=s.c+"/geoLarmDetails/"+e;console.log("show item",e,t),T.push({pathname:t,state:{id:e}})},_=[{title:U.f.ORGANIZATION,dataIndex:H.k.organizationId,hidden:k,render:e=>{const t=null===O||void 0===O?void 0:O.find((t=>t.organizationId===e));return null===t||void 0===t?void 0:t.fullName}},{title:U.f.ALIAS,dataIndex:H.k.name},{title:"Intervall",dataIndex:"repeatAfterHours",render:e=>0===e||-1===e?"Meddelas bara en g\xe5ng":"Upprepas varje "+e+" h "},{title:U.f.MAIL_RECIPIENTS,dataIndex:H.k.emails,render:e=>{if(1===(null===e||void 0===e?void 0:e.length))return Object(B.jsx)("a",{children:e[0]});if(0===(null===e||void 0===e?void 0:e.length))return"-";{let t=(null===e||void 0===e?void 0:e.length)+" "+U.f.MAIL_RECIPIENTS;return Object(Bt.a)(t,null,e)}}},{title:"Aktivt",dataIndex:"active",align:"right",render:(e,t)=>Object(B.jsx)(R.a,{onChange:e=>A({active:e},t),defaultChecked:e})},{title:"",dataIndex:"operation",width:80,fixed:"right",render:(e,i)=>Object(B.jsx)(re.a,{menu:()=>function(e){return Object(B.jsxs)(X.a,{children:[Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(oe.a,{}),onClick:()=>C(null===e||void 0===e?void 0:e.alarmSettingsId),children:"Se detaljer/\xc4ndra "}),Object(B.jsxs)(X.a.Item,{danger:!0,icon:Object(B.jsx)(z.a,{}),onClick:()=>(e=>{const i=null===t||void 0===t?void 0:t.filter((t=>t.alarmSettingsId!==e));F.a.deleteGeoAlarm(e).then((e=>{n(i)}))})(e.alarmSettingsId),children:[U.f.DELETE," "]})]})}(i)})}].filter((e=>!e.hidden)),A=(e,t)=>{F.a.patchAlarmSettings(t.alarmSettingsId,e)};return p?Object(B.jsx)(o.a,{}):Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(B.jsx)(fn,{children:U.f.ALARM_PLACES}),Object(B.jsxs)(S.a,{gap:15,children:[E?Object(B.jsx)("div",{style:{display:"flex",marginBottom:20,gap:15},children:(null===O||void 0===O?void 0:O.length)<2?null:Object(B.jsx)(Z.a,{data:O,onChange:e=>{f(e)},selectedOrganization:g,isMultiple:!0})}):null,Object(B.jsx)(h.a,{type:"primary",onClick:()=>C(-1),icon:Object(B.jsx)(le.a,{}),children:U.f.ADD})]})]}),Object(B.jsx)(u.a,{form:e,component:!1,children:Object(B.jsx)(M.a,{dataSource:x,columns:Object(re.m)(_),scroll:{x:1e3},rowClassName:"editable-row",rowKey:e=>e.alarmSettingsId,expandable:{rowExpandable:e=>{var t;return(null===(t=e.schedule)||void 0===t?void 0:t.length)>0},expandedRowRender:e=>{var t;return Object(B.jsxs)("div",{style:{marginLeft:80},children:[Object(B.jsx)(v.a.Text,{children:"Schema"}),Object(B.jsx)(S.a,{children:null===e||void 0===e||null===(t=e.schedule)||void 0===t?void 0:t.map((e=>Object(B.jsx)(xn,{i:e})))})]})}},...re.n})})]})}var En=()=>Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(yn,{})});var In=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.u,c.q,c.w,c.g],children:Object(B.jsx)(En,{})}),Sn=n(210);var Tn={headerContent:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},ecoContent:{textAlign:"center",display:"flex",flexWrap:"wrap",justifyContent:"center",width:"100%",gap:16},card:{padding:"2em 3em",minHeight:"100%",width:"33%",minWidth:400,maxWidth:500},dataDisplay:{fontSize:"42px"},dataSubDisplay:{fontSize:"24px"},dataDescription:{fontSize:"14px"}};const kn=Object(i.createContext)({}),Cn=e=>{let{children:t}=e;const[n,a]=Object(i.useState)([]);return Object(B.jsx)(kn.Provider,{value:{ecoScore:n,getEcoScore:(e,t,n)=>{F.a.getEcoScore(e,t,n).then((e=>a(e))).catch((e=>console.error(e)))},downloadEcoScoreReport:(e,t,n,i)=>{F.a.getEcoReport(e,t,n,i).then((e=>{const t=document.createElement("a");t.href="data:application/pdf;base64,"+e,t.download="EcoScoreRapport.pdf",t.dispatchEvent(new MouseEvent("click")),message.destroy()})).catch((e=>{message.destroy()})).catch((e=>console.error(e)))}},children:t})},{Title:_n,Text:An}=v.a,{RangePicker:Nn}=Jt.a;var Rn=()=>{const{organizations:e}=Object(i.useContext)(Tt.a),t=Object(i.useContext)(c.t).raw,{ecoScore:n,getEcoScore:a,downloadEcoScoreReport:l}=Object(i.useContext)(kn),r=Object(i.useContext)(c.l.context),s=[Te()().subtract("7","days"),Te()()],[u,p]=Object(i.useState)([]),[b,O]=Object(i.useState)(null),[m,g]=Object(i.useState)([]),[f,x]=Object(i.useState)([]),y=parseInt(localStorage.getItem(w.e));Object(i.useEffect)((()=>{r&&O(r),t&&g(t),x([s[0].unix(),s[1].unix()])}),[t,y,r]),Object(i.useEffect)((()=>{b&&a(1e3*f[0],1e3*f[1],b)}),[b,f]);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap",alignItems:"start"},children:[Object(B.jsx)(v.a.Title,{children:"Ecoscore"}),Object(B.jsxs)("div",{style:{display:"flex",gap:15,alignItems:"center",flexWrap:"wrap"},children:[e?Object(B.jsx)(Z.a,{data:e,onChange:e=>(e=>{if(p(e),e.length>0){var n;const i=t.filter((t=>e.includes(t.organizationId)));console.log(i),g(i),O(null===(n=i[0])||void 0===n?void 0:n.id)}else{var i;const e=t.filter((e=>e.organizationId===y));g(e),O(null===(i=e[0])||void 0===i?void 0:i.id)}})(e),selectedOrganization:u,isMultiple:!0}):null,Object(B.jsx)(on,{data:m,onChange:e=>O(e),value:b}),Object(B.jsx)(Nn,{dropdownClassName:"one-month",onChange:e=>(e=>{x([e[0].unix(),e[1].unix()])})(e),defaultValue:s}),Object(B.jsx)(h.a,{icon:Object(B.jsx)(Ye.a,{}),onClick:()=>{let e=Te.a.tz.guess();const t=f?f[0]:s[0].unix(),n=f?f[1]:s[1].unix(),i=0!==u.length?u:parseInt(localStorage.getItem(w.e));l(t,n,e,i)},children:"Exportera alla"})]})]}),n?Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(Ve.a,{gutter:[16,16],style:{...Tn.ecoContent},children:[Object(B.jsxs)(j.a,{bordered:!1,style:{...Tn.card},children:[Object(B.jsx)(_n,{level:2,children:"Total"}),Object(B.jsx)(Sn.a,{type:"dashboard",percent:n.total,strokeColor:Object(d.g)(n.total)}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{children:U.a.AVERAGE_AV_ECOSCORE_FOR_PERIOD}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{type:"secondary",style:{fontSize:".7rem"},children:U.a.TOTAL_AVERAGE})]}),Object(B.jsxs)(j.a,{bordered:!1,style:{...Tn.card},children:[Object(B.jsx)(_n,{level:3,children:"Totalt CO2-utsl\xe4pp"}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{style:{...Tn.dataDisplay,color:H.b.BLUE},children:null!==n.totalCo2Kg&&n.totalCo2Kg>0?n.totalCo2Kg.toFixed(2):"-"}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{style:{...Tn.dataSubDisplay},children:"Kg"}),Object(B.jsx)("br",{}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{type:"secondary",style:{...Tn.dataDescription},children:"Totalt utsl\xe4pp f\xf6r perioden"})]}),Object(B.jsxs)(j.a,{bordered:!1,style:{...Tn.card},children:[Object(B.jsx)(_n,{level:3,children:"Genomsnittligt CO2-utsl\xe4pp"}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{style:{...Tn.dataDisplay,color:Object(d.b)(n.vehicleCo2GKm)},children:null!==n.vehicleCo2GKm?n.vehicleCo2GKm:"-"}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{style:{...Tn.dataSubDisplay},children:"g/Km"}),Object(B.jsx)("br",{}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{type:"secondary",style:{...Tn.dataDescription},children:"Fordonets genomsnittliga CO2-utsl\xe4pp"}),Object(B.jsx)("br",{})]}),Object(B.jsxs)(j.a,{bordered:!1,style:{...Tn.card},children:[Object(B.jsx)(_n,{level:3,children:U.a.CURVE_TAKING}),Object(B.jsx)(Sn.a,{type:"dashboard",percent:n.cornering,strokeColor:Object(d.g)(n.cornering)}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{children:U.a.BAD_CURVE_TAKING_REDUCES_YOUR_ECOSCORE}),Object(B.jsx)("br",{})]}),Object(B.jsxs)(j.a,{bordered:!1,style:{...Tn.card},children:[Object(B.jsx)(_n,{level:3,children:U.a.ACCELERATION}),Object(B.jsx)(Sn.a,{type:"dashboard",percent:n.acceleration,strokeColor:Object(d.g)(n.acceleration)}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{children:U.a.RAPID_ACCELERATION_REDUCES_YOUR_ECOSCORE}),Object(B.jsx)("br",{})]}),Object(B.jsxs)(j.a,{bordered:!1,style:{...Tn.card},children:[Object(B.jsx)(_n,{level:3,children:U.a.BRAKING}),Object(B.jsx)(Sn.a,{type:"dashboard",percent:n.breaking,strokeColor:Object(d.g)(n.breaking)}),Object(B.jsx)("br",{}),Object(B.jsx)(An,{children:U.a.STARK_BRAKING_REDUCES_YOUR_ECOSCORE}),Object(B.jsx)("br",{})]})]})}):Object(B.jsx)(o.a,{})]})},Dn=n(131);var wn=()=>Object(B.jsx)(c.b,{children:Object(B.jsx)(Tt.b,{children:Object(B.jsx)(c.u,{children:Object(B.jsx)(Cn,{children:Object(B.jsx)(c.l.provider,{children:Object(B.jsx)(Rn,{})})})})})});var Ln=()=>Object(B.jsx)(Pe,{}),Pn=n(474),Vn=n(940);n(878);const{Title:Mn}=v.a,{Text:Fn}=v.a,{TextArea:zn}=C.a,{Panel:Un}=Pn.a,Bn=()=>{const[e,t]=Object(i.useState)(),[n,a]=Object(i.useState)(!1);Object(i.useEffect)((()=>{F.b.getCurrentUser().then((e=>{var n,i;console.log("userId",e),t(e.userId),(null!==(n=e.roles)&&void 0!==n&&n.includes("ROOT")||null!==(i=e.roles)&&void 0!==i&&i.includes("ADMIN"))&&a(!0)}),[])}),[]);const l={paddingLeft:24,paddingBottom:0},r={maxWidth:"100%",paddingLeft:24};return Object(B.jsxs)(Pn.a,{accordion:!0,bordered:!1,className:"guides-custom-collapse",children:[Object(B.jsxs)(Un,{header:"Installation av OBD-enhet",className:"guides-custom-panel",children:[Object(B.jsx)("p",{style:l,children:"Best\xe4llt en enhet som installeras i bilens OBD-uttag? Ta med dig enheten och medf\xf6ljande f\xf6rl\xe4ngningskabel och g\xf6r som v\xe5r s\xe4ljare P\xe4r i videon. Du vet att den \xe4r korrekt installerad n\xe4r de tv\xe5 gr\xf6na LED-lamporna p\xe5 enhetens nederkant blinkar, och efter en stund blir enheten synlig i systemet."}),Object(B.jsx)("iframe",{src:"https://player.vimeo.com/video/824014510?h=7d00561c78&title=0&byline=0&portrait=0&speed=0&badge=0&autopause=0&player_id=0&app_id=58479",width:"750",height:"422",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",style:r,allowFullScreen:!0,title:"MONTERA_OBD"})]},"1"),Object(B.jsxs)(Un,{header:"Installation av batterienhet",className:"guides-custom-panel",children:[Object(B.jsx)("p",{style:l,children:"Best\xe4llt en enhet som ska kopplas direkt p\xe5 bilbatteriet? Leta fram en passande hylsnyckel och g\xf6r som v\xe5r s\xe4ljare P\xe4r i videon. Du vet att den \xe4r korrekt installerad n\xe4r de tv\xe5 gr\xf6na LED-lamporna p\xe5 enhetens nederkant blinkar, och efter en stund blir enheten synlig i systemet."}),Object(B.jsx)("iframe",{src:"https://player.vimeo.com/video/824014438?h=3498016c48&title=0&byline=0&portrait=0&speed=0&badge=0&autopause=0&player_id=0&app_id=58479",width:"750",height:"422",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",style:r,allowFullScreen:!0,title:"MONTERA_BATTERI"})]},"2"),n?Object(B.jsxs)(Un,{header:"Registrera ny anv\xe4ndare",className:"guides-custom-panel",children:[Object(B.jsx)("p",{style:l,children:"Har ni f\xe5tt en ny kollega? L\xe4gg till denne som anv\xe4ndare i systemet genom att f\xf6lja guiden i videon."}),Object(B.jsx)("iframe",{src:"https://player.vimeo.com/video/824014554?h=ea6ac7f2b0&title=0&byline=0&portrait=0&speed=0&badge=0&autopause=0&player_id=0&app_id=58479",width:"750",height:"422",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",style:r,allowFullScreen:!0,title:"NY_ANV"})]},"3"):"",Object(B.jsxs)(Un,{header:"L\xe4gga upp ett arbetstidsschema",className:"guides-custom-panel",children:[n?Object(B.jsx)("p",{style:l,children:"Vill ni automatisera klassificeringen av tj\xe4nste- respektive privata resor? Genom att l\xe4gga in ett arbetstidsschema f\xf6r varje f\xf6rare ser ni till att alla resor som startas inom den angivna tidsperioden f\xe5r samma klassificering."}):Object(B.jsx)("p",{style:l,children:"Vill du automatisera klassificeringen av tj\xe4nste- respektive privata resor? Genom att l\xe4gga in ditt arbetstidsschema ser du till att alla resor som startas inom den angivna tidsperioden f\xe5r samma klassificering."}),Object(B.jsx)("iframe",{src:"https://player.vimeo.com/video/824014368?h=ced156af2b&title=0&byline=0&portrait=0&speed=0&badge=0&autopause=0&player_id=0&app_id=58479",width:"750",height:"422",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",style:r,allowFullScreen:!0,title:"ARBETSTIDSSCHEMA"})]},"4"),n?Object(B.jsxs)(Un,{header:"Schemal\xe4gga rapporter",className:"guides-custom-panel",children:[Object(B.jsx)("p",{style:l,children:"Vill ni slippa ta ut rapporter manuellt varje m\xe5nad? V\xe5r s\xe4ljare P\xe4r har l\xf6sningen."}),Object(B.jsx)("iframe",{src:"https://player.vimeo.com/video/824014647?h=2010bcb45f&title=0&byline=0&portrait=0&speed=0&badge=0&autopause=0&player_id=0&app_id=58479",width:"750",height:"422",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",style:r,allowFullScreen:!0,title:"RAPPORTER"})]},"5"):"",n?Object(B.jsxs)(Un,{header:"Registrera nytt fordon",className:"guides-custom-panel",children:[Object(B.jsx)("p",{style:l,children:"N\xe4r ni f\xe5r era enheter levererade av oss \xe4r de redan kopplade till ett fordon i systemet - se angivet registreringsnummer eller fordonsnummer p\xe5 enheten. Har ni d\xe4remot k\xf6pt ett nytt fordon och vill flytta en enhet till detta fordon beh\xf6ver ni registrera det nya fordonet i systemet."}),Object(B.jsx)("iframe",{src:"https://player.vimeo.com/video/824014601?h=8f53d4af84&title=0&byline=0&portrait=0&speed=0&badge=0&autopause=0&player_id=0&app_id=58479",width:"750",height:"422",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",style:r,allowFullScreen:!0,title:"NYTT_FORDON"})]},"6"):"",n?Object(B.jsxs)(Un,{header:"Flytta enhet till ett annat fordon",className:"guides-custom-panel",children:[Object(B.jsx)("p",{style:l,children:"F\xf6r att flytta enheten till ett nytt fordon, f\xf6lj instruktionerna i videon."}),Object(B.jsx)("iframe",{src:"https://player.vimeo.com/video/824014401?h=4120b43c47&title=0&byline=0&portrait=0&speed=0&badge=0&autopause=0&player_id=0&app_id=58479",width:"750",height:"422",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",style:r,allowFullScreen:!0,title:"FLYTTA_ENHET"}),Object(B.jsx)("p",{style:{paddingLeft:24,paddingTop:44},children:"Har ni fler fordon \xe4n ni har enheter? H\xf6r av er till er kontaktperson eller kontakta oss p\xe5 kundtj\xe4nst s\xe5 hj\xe4lper vi er vidare."})]},"7"):""]})},Gn=()=>Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(j.a,{bordered:!0,className:"otherQuestionsCard",style:{minWidth:300},children:[Object(B.jsx)(Mn,{level:2,children:"Saknar du n\xe5gon guide?"}),Object(B.jsxs)(Fn,{style:{whiteSpace:"normal"},children:[Object(B.jsx)("br",{}),"Vi arbetar just nu p\xe5 att ta fram mer informationsmaterial. Under tiden kanske vi kan f\xe5 bjuda p\xe5 en personlig guidning i systemet?",Object(B.jsx)("br",{}),Object(B.jsx)("br",{}),"Tveka inte att h\xf6ra av dig till oss!"]}),Object(B.jsx)("br",{}),Object(B.jsx)("br",{}),Object(B.jsx)("br",{}),Object(B.jsx)("a",{href:"tel: +460104240940",children:Object(B.jsxs)(h.a,{size:"large",type:"primary",style:{minWidth:"200px",width:"80%",margin:"auto"},children:[Object(B.jsx)(Vn.a,{style:{marginBottom:"4.5em"}}),"010 - 424 09 40"]})})]})});var Hn=()=>Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:[Object(B.jsx)(Mn,{children:"Guider"}),Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:"100%",width:"100%",justifyContent:"center",alignItems:"top",gap:"3em"},children:[Object(B.jsx)(Bn,{}),Object(B.jsx)(Gn,{})]})]});var Yn=()=>Object(B.jsx)(Vt.a,{wrappers:[],children:Object(B.jsx)(Hn,{})}),Wn=n(174),Kn=n(469),qn=n(27),Jn=n(991),Qn=n(938),Zn=n(937),Xn=n(992),$n=n(993),ei=n(980),ti=n(994),ni=n(995),ii=n(996),ai=n(524),li=(n(879),n.p+"static/media/Sweden_road_sign_E25.3835ae9f.svg"),ri=n.p+"static/media/Sweden_road_sign_E25_white.e753906a.svg",oi=n(162);function si(){return Object(B.jsx)(oi.a,{})}n(85);const di=(e,t,n)=>{let i={driver:{...e.user_id?{user_id:e.user_id}:{}},trip:{...e.override_start?{override_start:e.override_start}:{},...e.override_stop?{override_stop:e.override_stop}:{},...e.purpose?{purpose:e.purpose}:{},...e.description?{description:e.description}:{}}};return!0!==e.attested&&!1!==e.attested||(i={...i,attested:e.attested}),!0!==e.lightAttested&&!1!==e.lightAttested||(i={...i,lightAttested:e.lightAttested}),!0!==e.correctedByDriver&&!1!==e.correctedByDriver||(i={...i,correctedByDriver:e.correctedByDriver}),!0!==e.devComment&&!1!==e.devComment&&null!==e.devComment||(i={...i,devComment:e.devComment}),t&&Object.entries(t).map((e=>{let[t,n]=e;i[t]={...i[t],...n}})),n||i},ci={requestFetchJournals:null,requestResetJournals:null,patchJournals:null,requestDownloadCSV:null},ui=Object(i.createContext)(ci),vi=e=>{let{children:t}=e;const[n,a]=Object(i.useState)([]),l=Object(i.useRef)(n);l.current=n;const[r,o]=Object(i.useState)(!1),[s,d]=Object(i.useState)(!1),[c,u]=Object(i.useState)([]),v=Object(i.useMemo)((()=>{const e=[];return null===n||void 0===n||n.map((t=>{if((null===t||void 0===t?void 0:t.length)<2)e.push(t);else{var n,i,a,l;let r=t[0],o=t[(null===t||void 0===t?void 0:t.length)-1],s=0,d=0,c=0,u=null,v=0,j=0,h=null;null===t||void 0===t||t.map((e=>{var t;s+=null===(t=e.trip)||void 0===t?void 0:t.odometer_max,d=null!==e&&void 0!==e&&e.congestionTaxSek?parseInt(null===e||void 0===e?void 0:e.congestionTaxSek)+d:d,c=(null===e||void 0===e?void 0:e.congestionTaxCount)+c,null!==(null===e||void 0===e?void 0:e.congestionTaxSekOverride)&&(u=parseInt(null===e||void 0===e?void 0:e.congestionTaxSekOverride)+(u||0)),v=null!==e&&void 0!==e&&e.infraTaxSek?parseInt(null===e||void 0===e?void 0:e.infraTaxSek)+v:v,j=(null===e||void 0===e?void 0:e.infraTaxCount)+j,null!==(null===e||void 0===e?void 0:e.infraTaxSekOverride)&&(h=parseInt(null===e||void 0===e?void 0:e.infraTaxSekOverride)+(h||0))}));const p={...t[0],geocode_start:null!==o&&void 0!==o&&o.override_start?{format:null===o||void 0===o?void 0:o.override_start}:null===o||void 0===o?void 0:o.geocode_start,trip:{...null===(n=t[0])||void 0===n?void 0:n.trip,odometer_start:null===o||void 0===o||null===(i=o.trip)||void 0===i?void 0:i.odometer_start,odometer_max:s,timestamp_start_ms:null===o||void 0===o||null===(a=o.trip)||void 0===a?void 0:a.timestamp_start_ms,purpose:null===r||void 0===r||null===(l=r.trip)||void 0===l?void 0:l.purpose},stopTimeBackwards:null===o||void 0===o?void 0:o.stopTimeBackwards,mergedTripsId:null===t||void 0===t?void 0:t.map((e=>e.journal_id)),congestionTaxSek:d,congestionTaxCount:c,congestionTaxSekOverride:null!==u?u:null,infraTaxSek:v,infraTaxCount:j,infraTaxSekOverride:null!==h?h:null,congestionData:{...null===o||void 0===o?void 0:o.congestionData}};e.push([p])}})),console.log("Building journal state",e),e}),[n]),j=Object(i.useMemo)((()=>{const e={};return console.log("Rebuilding journal table data"),v.forEach((t=>{t.forEach((t=>{var n;const i=Te()(null===t||void 0===t||null===(n=t.trip)||void 0===n?void 0:n.timestamp_start_ms).format("YYYY-MM-DD");void 0===e[i]&&(e[i]=[]),e[i].push(t)}))})),e}),[v]),h=Object(i.useMemo)((()=>{const e={};return console.log("Rebuilding journal table data with just bad trips"),v.forEach((t=>{t.forEach((t=>{if(t.isBadTrip){var n;const i=Te()(null===t||void 0===t||null===(n=t.trip)||void 0===n?void 0:n.timestamp_start_ms).format("YYYY-MM-DD");void 0===e[i]&&(e[i]=[]),e[i].push(t)}}))})),e}),[v]);return Object(B.jsx)(ui.Provider,{value:{journals:n,loadedJournals:r,loadingJournals:s,mapOverviewData:c,journalState:v,journalTableData:j,journalTableDataBadTrips:h,requestDownloadCSV:(e,t,n,i,a,l)=>F.a.getJournalsCSV(e,t,n,i,a,l).then((e=>{console.log("csv response: ",e)})),requestFetchJournals:(e,t,n,i,l,r,s)=>{o(!1),d(s),F.a.getJournals(e,t,n,i,l,r).then((e=>{a(e.journals),o(!0),d(!1)})).catch((e=>{o(!1),d(!1)}))},requestResetJournals:()=>{a([])},patchJournals:(e,t,n,i)=>{a(((e,t)=>e.map((e=>e.map((e=>{if(e.journal_id!==t.payload.journal_id)return e;{const n=Object.fromEntries(Object.entries(e).map((e=>{let[n,i]=e;return[n,n in t.payload.data?{...i,...t.payload.data[n]}:i]})));return t.payload.data.object?(console.log(t.payload.data),t.payload.data.object):!0===t.payload.data.lightAttested||!1===t.payload.data.lightAttested?{...n,lightAttested:t.payload.data.lightAttested,status:t.payload.data.lightAttested?"CHECKED":"NONE"}:!0===t.payload.data.correctedByDriver||!1===t.payload.data.correctedByDriver?{...n,correctedByDriver:t.payload.data.correctedByDriver,status:t.payload.data.correctedByDriver?"CORRECTED":"BAD"}:!0===t.payload.data.attested||!1===t.payload.data.attested?(console.log("r",n,t.payload.data.attested),{...n,attested:t.payload.data.attested}):null===t.payload.data.devComment?(console.log("r",n,t.payload.data.devComment),{...n,devComment:t.payload.data.devComment?[t.payload.data.devComment]:null}):(console.log("updated obj: ",n),n)}})))))(l.current,{payload:{data:di(t,n,i),journal_id:e}}))}},children:t})},ji=e=>JSON.parse(e.response),hi=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;const a=localStorage.getItem(w.b);return console.debug("Dispatching request",e,t," with JWT = ",a),new Promise(((l,r)=>{let o=new XMLHttpRequest;o.onload=()=>{l(o)},o.onerror=()=>{r()},console.debug("Calling XHR open"),o.open(e,t),n||"OPTIONS"!==e?(console.debug("Adding request header"),o.setRequestHeader("Authorization","JWT "+a)):console.debug("Ignoring request header"),console.debug("Calling XHR send"),o.send(i)}))};var pi=n(990),bi=n(72),Oi=n(147);const mi=e=>{let{editing:t,dataIndex:n,title:i,inputType:a,record:l,index:r,children:o,...s}=e;const d=Object(B.jsx)(C.a,{});return Object(B.jsx)("td",{...s,children:t?Object(B.jsx)(u.a.Item,{name:n,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(i,"!")}],children:d}):o})},gi=e=>{var t,n;let{data:a,setData:l,selectedJourney:r,taxType:o,infra:s}=e;const[d]=u.a.useForm(),[c,j]=Object(i.useState)(""),h=e=>e.passageId===c,p=async(e,t)=>{try{var n,i;t||await d.validateFields();let r=[],o=[],s=0,c=0,u=0,v=0,h=0,p=0;(null===a||void 0===a||null===(n=a.congestionData)||void 0===n||null===(i=n.passages)||void 0===i?void 0:i.findIndex((t=>e===t.passageId)))>-1&&F.a.patchJournalPassage(e,t).then((e=>{var t;null===(t=e[0])||void 0===t||t.map((e=>{var t,n,i,a;null!==e&&void 0!==e&&null!==(t=e.trip)&&void 0!==t&&t.coords&&(r=[...r,...null===e||void 0===e||null===(i=e.trip)||void 0===i?void 0:i.coords]);null!==e&&void 0!==e&&null!==(n=e.congestionData)&&void 0!==n&&n.passages&&(o=[...o,...null===e||void 0===e||null===(a=e.congestionData)||void 0===a?void 0:a.passages]);s=null!==e&&void 0!==e&&e.congestionTaxSek?parseInt(null===e||void 0===e?void 0:e.congestionTaxSek)+s:s,c=(null===e||void 0===e?void 0:e.congestionTaxCount)+c,null!==(null===e||void 0===e?void 0:e.congestionTaxSekOverride)&&(u=parseInt(null===e||void 0===e?void 0:e.congestionTaxSekOverride)+(u||0)),v=null!==e&&void 0!==e&&e.infraTaxSek?parseInt(null===e||void 0===e?void 0:e.infraTaxSek)+v:v,h=(null===e||void 0===e?void 0:e.infraTaxCount)+h,null!==(null===e||void 0===e?void 0:e.infraTaxSekOverride)&&(p=parseInt(null===e||void 0===e?void 0:e.infraTaxSekOverride)+(p||0))}));const n={...a,trip:{...null===a||void 0===a?void 0:a.trip,coords:r},congestionTaxSek:s,congestionTaxCount:c,congestionTaxSekOverride:null!==u?u:null,infraTaxSek:v,infraTaxCount:h,infraTaxSekOverride:null!==p?p:null,congestionData:{passages:o}};l(n),j("")}))}catch(r){console.log("Validate Failed:",r)}},b={body:{cell:mi}},O=[{title:"Station",dataIndex:"station",key:"station",render:e=>null===e||void 0===e?void 0:e.name},{title:"Tidpunkt",dataIndex:"isotime",key:"isotime",render:e=>Object(pt.a)(e)},{title:"Kostnad",dataIndex:"overridePrice",key:"overridePrice",editable:!0,render:(e,t)=>{let n="overridePrice";s&&(n="overridePriceInfra");return(null!==t[n]?t[n]:t[o]||0)+" kr"}},{title:"Typ",dataIndex:"address",key:"address",render:(e,t)=>{var n,i,a,l;const o=U.m[null===r||void 0===r||null===(n=r.data)||void 0===n||null===(i=n.trip)||void 0===i?void 0:i.purpose],s=Object(Vt.b)(null===r||void 0===r||null===(a=r.data)||void 0===a||null===(l=a.trip)||void 0===l?void 0:l.purpose);return Object(B.jsx)(v.a.Text,{strong:!0,style:s,children:o})}},{dataIndex:"operation",render:(e,t)=>h(t)?Object(B.jsxs)("span",{children:[Object(B.jsx)("a",{href:"javascript:;",onClick:()=>(async e=>{const t=await d.validateFields(),n={overridePrice:t.overridePrice},i={overridePriceInfra:t.overridePrice};p(e,s?i:n)})(t.passageId),style:{marginRight:8},children:U.f.SAVE}),Object(B.jsx)("a",{onClick:()=>(t.passageId,void j("")),children:U.f.BTN_ABORT})]}):Object(B.jsx)("span",{children:Object(B.jsx)("a",{disabled:""!==c,onClick:()=>(e=>{d.setFieldsValue({...e}),j(e.passageId)})(t),children:U.f.BTN_CHANGE})})}].map((e=>e.editable?{...e,onCell:t=>({record:t,inputType:"age"===e.dataIndex?"number":"text",dataIndex:e.dataIndex,title:e.title,editing:h(t)})}:e));let m=null===a||void 0===a||null===(t=a.congestionData)||void 0===t||null===(n=t.passages)||void 0===n?void 0:n.filter((e=>"priceInfra"===o?e[o]:(null===e||void 0===e?void 0:e.priceInfra)<=0));return Object(B.jsx)(u.a,{form:d,component:!1,children:Object(B.jsx)(qn.b,{renderEmpty:()=>Object(Oi.a)("Inga registrerade passager"),children:Object(B.jsx)(M.a,{rowKey:e=>e.passageId,components:b,dataSource:m,columns:O,rowClassName:e=>!1===(null===e||void 0===e?void 0:e.isActive)&&"is-not-active-row",pagination:!1})})})};function fi(e){var t,n;let{dataTax:a,selectedJourney:l,data:r,setData:o,setHeaderCongestionTax:s}=e,[d,c]=Object(i.useState)(0),[u,j]=Object(i.useState)(0),p=!1;Object(i.useEffect)((()=>{var e,t;if(!r)return;const n=null!==(null===r||void 0===r?void 0:r.congestionTaxSekOverride)?null===r||void 0===r?void 0:r.congestionTaxSekOverride:(null===r||void 0===r?void 0:r.congestionTaxSek)||0;c(null===n||void 0===n?void 0:n.toString());const i=(null===r||void 0===r||null===(e=r.congestionData)||void 0===e||null===(t=e.passages)||void 0===t?void 0:t.map((e=>e)).filter((e=>(null===e||void 0===e?void 0:e.priceInfra)<=0)).length)||0;j(i),p=null!==(null===r||void 0===r?void 0:r.congestionTaxSekOverride)}),[r,l]),Object(i.useEffect)((()=>{s("Tr\xe4ngselskatt - ".concat(d," kr (").concat(u," ").concat(1===u?"passage":"passager",")"))}),[d,u]);let b="DONE"===(null===r||void 0===r?void 0:r.status)||"LOCKED"===(null===r||void 0===r?void 0:r.status)||"CHECKED"===(null===r||void 0===r?void 0:r.status),O=r&&null!==(null===r||void 0===r?void 0:r.congestionTaxSekOverride)||(null===r||void 0===r||null===(t=r.congestionData)||void 0===t||null===(n=t.passages)||void 0===n?void 0:n.some((e=>e.overridePrice)));return Object(B.jsxs)("div",{style:{minHeight:200,pointerEvents:b?"none":"auto"},children:[Object(B.jsx)("br",{}),Object(B.jsx)(S.a,{alignItems:"center",justifyContent:"end",children:O&&Object(B.jsx)(h.a,{style:{marginBottom:10,float:"right"},icon:Object(B.jsx)(pi.a,{}),onClick:()=>{let e=[],t=0,n=0,i=null;F.a.putJournalRestorePassages(l.data.journal_id,!1,!0).then((a=>{var l;null===(l=a[0])||void 0===l||l.map((a=>{var l,r;null!==a&&void 0!==a&&null!==(l=a.congestionData)&&void 0!==l&&l.passages&&(e=[...e,...null===a||void 0===a||null===(r=a.congestionData)||void 0===r?void 0:r.passages]);t=null!==a&&void 0!==a&&a.congestionTaxSek?parseInt(null===a||void 0===a?void 0:a.congestionTaxSek)+t:t,n=(null===a||void 0===a?void 0:a.congestionTaxCount)+n,null!==(null===a||void 0===a?void 0:a.congestionTaxSekOverride)&&(i=parseInt(null===a||void 0===a?void 0:a.congestionTaxSekOverride)+(i||0))}));const s={...r,congestionTaxSek:t,congestionTaxCount:n,congestionTaxSekOverride:null!==i?i:null,congestionData:{passages:e}};console.log(s),o(s)}))},children:"\xc5terst\xe4ll"})}),Object(B.jsx)(gi,{data:r,setData:o,selectedJourney:l,taxType:"price"}),Object(B.jsx)("br",{}),Object(B.jsxs)(S.a,{alignItems:"baseline",justifyContent:"end",children:[Object(B.jsxs)(v.a.Title,{type:"danger",level:2,children:["Total kr:"," "]}),null!==(null===r||void 0===r?void 0:r.congestionTaxSekOverride)&&Object(B.jsx)(v.a.Paragraph,{style:{textDecoration:"line-through",color:H.b.RED,fontSize:26,marginLeft:10},children:((null===r||void 0===r?void 0:r.congestionTaxSek)||"0")+" "}),Object(B.jsx)(v.a.Paragraph,{style:{color:H.b.RED,fontSize:26,marginLeft:10},editable:{onChange:e=>{F.a.putJournal(l.data.journal_id,{congestionTaxSekOverride:e}).then((t=>{const n={...r,congestionTaxSekOverride:e};o(n),c(e)})).catch((e=>{}))}},children:d})]})]})}function xi(e){var t,n;let{dataTax:a,selectedJourney:l,data:r,setData:o,setHeaderInfraTax:s}=e,[d,c]=Object(i.useState)(0),[u,j]=Object(i.useState)(0),p=!1;Object(i.useEffect)((()=>{var e,t;if(!r)return;const n=null!==(null===r||void 0===r?void 0:r.infraTaxSekOverride)?null===r||void 0===r?void 0:r.infraTaxSekOverride:(null===r||void 0===r?void 0:r.infraTaxSek)||0;c(null===n||void 0===n?void 0:n.toString());const i=(null===r||void 0===r||null===(e=r.congestionData)||void 0===e||null===(t=e.passages)||void 0===t?void 0:t.map((e=>e)).filter((e=>(null===e||void 0===e?void 0:e.priceInfra)>0)).length)||0;j(i),p=null!==(null===r||void 0===r?void 0:r.infraTaxSekOverride)}),[r,l]),Object(i.useEffect)((()=>{s("Infrastrukturavgift - ".concat(d," kr (").concat(u," ").concat(1===u?"passage":"passager",")"))}),[d,u]);let b="DONE"===(null===r||void 0===r?void 0:r.status)||"LOCKED"===(null===r||void 0===r?void 0:r.status)||"CHECKED"===(null===r||void 0===r?void 0:r.status),O=r&&null!==(null===r||void 0===r?void 0:r.infraTaxSekOverride)||(null===r||void 0===r||null===(t=r.congestionData)||void 0===t||null===(n=t.passages)||void 0===n?void 0:n.some((e=>e.overridePriceInfra)));return Object(B.jsxs)("div",{style:{pointerEvents:b?"none":"auto"},children:[Object(B.jsx)("br",{}),Object(B.jsx)(S.a,{alignItems:"center",justifyContent:"end",children:O&&Object(B.jsx)(h.a,{style:{marginBottom:10,float:"right"},icon:Object(B.jsx)(pi.a,{}),onClick:()=>{let e=[],t=0,n=0,i=null;F.a.putJournalRestorePassages(l.data.journal_id,!0,!1).then((a=>{var l;null===(l=a[0])||void 0===l||l.map((a=>{var l,r;null!==a&&void 0!==a&&null!==(l=a.congestionData)&&void 0!==l&&l.passages&&(e=[...e,...null===a||void 0===a||null===(r=a.congestionData)||void 0===r?void 0:r.passages]);t=null!==a&&void 0!==a&&a.infraTaxSek?parseInt(null===a||void 0===a?void 0:a.infraTaxSek)+t:t,n=(null===a||void 0===a?void 0:a.infraTaxCount)+n,null!==(null===a||void 0===a?void 0:a.infraTaxSekOverride)&&(i=parseInt(null===a||void 0===a?void 0:a.infraTaxSekOverride)+(i||0))}));const s={...r,infraTaxSek:t,infraTaxCount:n,infraTaxSekOverride:null!==i?i:null,congestionData:{passages:e}};console.log(s),o(s)}))},children:"\xc5terst\xe4ll"})}),Object(B.jsx)(gi,{data:r,setData:o,selectedJourney:l,taxType:"priceInfra",infra:!0}),Object(B.jsx)("br",{}),Object(B.jsxs)(S.a,{alignItems:"baseline",justifyContent:"end",children:[Object(B.jsxs)(v.a.Title,{type:"danger",level:2,children:["Total kr:"," "]}),null!==(null===r||void 0===r?void 0:r.infraTaxSekOverride)&&Object(B.jsx)(v.a.Paragraph,{style:{textDecoration:"line-through",color:H.b.RED,fontSize:26,marginLeft:10},children:((null===r||void 0===r?void 0:r.infraTaxSek)||0)+" "}),Object(B.jsx)(v.a.Paragraph,{style:{color:H.b.RED,fontSize:26,marginLeft:10},editable:{onChange:e=>{c(e),F.a.putJournal(l.data.journal_id,{infraTaxSekOverride:e}).then((t=>{const n={...r,infraTaxSekOverride:e};o(n)})).catch((e=>{}))}},children:d})]})]})}var yi=e=>{var t,n,a,l,r,o,d;let{selectedJourney:c,visible:u,onOk:v,onCancel:j,dataTax:h,clickedButton:p}=e;const b=Object(i.useRef)(null),[O,m]=Object(i.useState)([0,0]),[g,f]=Object(i.useState)(),[x,y]=Object(i.useState)(),[E,I]=Object(i.useState)(),[S,T]=Object(i.useState)(),[k,C]=Object(i.useState)(!1),[_,A]=Object(i.useState)(),N=Object(i.useContext)(ui),[R,D]=Object(i.useState)(null),[P,V]=Object(i.useState)(null);Object(i.useEffect)((()=>{A(Math.random())}),[u]),Object(i.useEffect)((()=>{T(null===c||void 0===c?void 0:c.data)}),[c]),Object(i.useEffect)((()=>{x&&E&&(null===E||void 0===E||E.event.trigger(x,"resize"),null===x||void 0===x||x.setOptions({...ie,styles:"DARK"===localStorage.getItem(w.d)?te:null}),ne(E,x))}),[localStorage.getItem(w.d),x,E]);Object(i.useEffect)((()=>{if(f(12),x&&E&&c){var e,t;const n=((e,t)=>{const n=new e.LatLngBounds;return t.forEach((t=>{const i=null===t||void 0===t?void 0:t.latitude,a=null===t||void 0===t?void 0:t.longitude;if(i&&a){const t=new e.LatLng(i,a);n.extend(t)}})),V(n),n})(E,null===c||void 0===c||null===(e=c.data)||void 0===e||null===(t=e.trip)||void 0===t?void 0:t.coords);V(n)}x&&E&&c&&(e=>{let{map:t,maps:n,coords:i,selectedJourney:a}=e,l=[];null===a||void 0===a||a.data.trip.coords.map((e=>{l=[...l,{lat:e.latitude,lng:e.longitude}]})),R&&R.setMap(null);const r=new n.Polyline({path:l,geodesic:!0,strokeColor:H.b.GREEN,strokeOpacity:1,strokeWeight:5});let o=null===a||void 0===a?void 0:a.data.trip.coords;const s=new n.LatLngBounds;o.forEach((e=>{s.extend(new window.google.maps.LatLng(e.latitude,e.longitude))})),r.setMap(t),V(s),D(r)})({map:x,maps:E,selectedJourney:c})}),[x,E,c]),Object(i.useEffect)((()=>{null===x||void 0===x||x.fitBounds(P,{top:80,right:80,left:80,bottom:80})}),[P]);const M=e=>{var t,n,i;const a=e?0:(null===c||void 0===c||null===(t=c.data)||void 0===t||null===(n=t.trip)||void 0===n||null===(i=n.coords)||void 0===i?void 0:i.length)-1,l={lat:null===c||void 0===c?void 0:c.data.trip.coords[a].latitude,lng:null===c||void 0===c?void 0:c.data.trip.coords[a].longitude};m([l.lat,l.lng]),f(e?20:19)},[z,U]=Object(i.useState)(""),[G,Y]=Object(i.useState)("");return Object(B.jsx)(Ut.a,{title:"Rutt",visible:u,onOk:v,onCancel:()=>{var e,t;C(!0),F.a.getJournalsByIds((null===c||void 0===c||null===(e=c.data)||void 0===e?void 0:e.mergedTripsId)||(null===c||void 0===c||null===(t=c.data)||void 0===t?void 0:t.journal_id),!0).then((e=>{var t;null===(t=e[0])||void 0===t||t.map((e=>{e.stopTimeBackwards=c.data.stopTimeBackwards,N.patchJournals(null===e||void 0===e?void 0:e.journal_id,{field:null},null,{object:e})}))})).then((e=>{C(!1),j()}))},footer:null,width:800,children:Object(B.jsxs)(oi.a,{spinning:k,children:[Object(B.jsxs)(ae.a,{ref:b,bounds:null===c||void 0===c?void 0:c.data.trip.coords,style:{height:400,transform:"translate(0, 0px)"},bootstrapURLKeys:{key:s.h},center:O,zoom:g,options:ie,yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:e=>{let{map:t,maps:n}=e;ne(n,t),y(t),I(n)},children:[Object(B.jsx)(St,{lat:null===c||void 0===c?void 0:c.data.trip.coords[0].latitude,lng:null===c||void 0===c?void 0:c.data.trip.coords[0].longitude,text:null===c||void 0===c||null===(t=c.data)||void 0===t||null===(n=t.geocode_start)||void 0===n?void 0:n.format,onClick:e=>M("start")}),Object(B.jsx)(It,{lat:null===c||void 0===c?void 0:c.data.trip.coords[(null===c||void 0===c?void 0:c.data.trip.coords.length)-1].latitude,lng:null===c||void 0===c?void 0:c.data.trip.coords[(null===c||void 0===c?void 0:c.data.trip.coords.length)-1].longitude,text:null===c||void 0===c||null===(a=c.data)||void 0===a||null===(l=a.geocode_stop)||void 0===l?void 0:l.format,onClick:e=>M()}),null===c||void 0===c||null===(r=c.data)||void 0===r||null===(o=r.congestionData)||void 0===o||null===(d=o.passages)||void 0===d?void 0:d.map((e=>{var t,n,i,a,l;return Object(B.jsx)("div",{style:{width:8,height:8,position:"absolute",borderRadius:4,display:"flex",justifyContent:"center",alignItems:"center"},lat:null===e||void 0===e||null===(t=e.station)||void 0===t||null===(n=t.geometry)||void 0===n?void 0:n.coordinates[1],lng:null===e||void 0===e||null===(i=e.station)||void 0===i||null===(a=i.geometry)||void 0===a?void 0:a.coordinates[0],children:Object(B.jsx)(L.a,{title:null===e||void 0===e||null===(l=e.station)||void 0===l?void 0:l.name,children:Object(B.jsx)("img",{alt:"Sweden road sign E25",width:28,src:li})})})}))]}),Object(B.jsxs)(Pn.a,{style:{marginTop:20},children:[Object(B.jsx)(Pn.a.Panel,{header:G,forceRender:!0,children:Object(B.jsx)(fi,{data:S,setData:T,selectedJourney:c,dataTax:h,setHeaderCongestionTax:Y})},(null===S||void 0===S?void 0:S.journal_id)+"1"+_),Object(B.jsx)(Pn.a.Panel,{header:z,forceRender:!0,children:Object(B.jsx)(xi,{data:S,setData:T,selectedJourney:c,dataTax:h,setHeaderInfraTax:U})},(null===S||void 0===S?void 0:S.journal_id)+"2"+_)]})]})})},Ei=n(246);const{Option:Ii,OptGroup:Si}=k.a,{RangePicker:Ti}=Jt.a,{Text:ki}=v.a,Ci=()=>{var e,t,n;const{Title:a}=v.a,l=Object(i.useRef)(!0),r=Object(i.useContext)(ui),[s,d]=Object(i.useState)(null),j={journalId:null,showModal:!1,preSelectId:null,selectedId:null,selectedName:null,data:null,organizationId:null},p={journal:null,showMergeModal:!1,description1:null,description2:null,selectedDescription:null,id1:null,id2:null,preSelectedTripId:null},[b,O]=Object(i.useState)(j),[m,g]=Object(i.useState)(p),[f,x]=Object(i.useState)(),[y,E]=Object(i.useState)(!1),[I,T]=Object(i.useState)(!1),[A,N]=Object(i.useState)([]),[D,P]=Object(i.useState)([]);let V=r.journalTableData;const z=r.loadingJournals,[G,Y]=Object(i.useState)([]),[W,K]=Object(i.useState)(!0),[q,J]=Object(i.useState)("e"),[Q,te]=Object(i.useState)(!0),[ne,ie]=Object(i.useState)([]);let ae=[Te()().startOf("day").add(-13,"days"),Te()().endOf("day")];const[le,oe]=Object(i.useState)(ae),se=Object(i.useContext)(c.f),de=Object(i.useContext)(c.p),ce=Object(i.useContext)(c.t).raw,[ue,ve]=Object(i.useState)(ce),[je,he]=Object(i.useState)(de),pe=Object(i.useContext)(c.a),be=null===pe||void 0===pe?void 0:pe.userId,me=null===pe||void 0===pe?void 0:pe.displayName,ge=!!de,fe=!!ce,xe=!localStorage.getItem(w.e),[ye,Ee]=Object(i.useState)(!1),Ie=Object(i.useContext)(c.l.context);Object(i.useEffect)((()=>{if(!pe)return;const e=new URLSearchParams(window.location.search),t=e.get("vehicleId"),n=e.get("userId");if(t){const e=parseInt(t);Ee([e])}else if(n){const e=parseInt(n);ie([e])}else ie([null===pe||void 0===pe?void 0:pe.userId]),Ee([Ie])}),[pe,Ie]),Object(i.useEffect)((()=>{r.requestResetJournals()}),[]),Object(i.useEffect)((()=>{if((null===G||void 0===G?void 0:G.length)<1)return ve(ce),void he(de);const e=null===ce||void 0===ce?void 0:ce.filter((e=>null===G||void 0===G?void 0:G.includes(null===e||void 0===e?void 0:e.organizationId))),t=null===de||void 0===de?void 0:de.filter((e=>null===G||void 0===G?void 0:G.includes(null===e||void 0===e?void 0:e.organizationId)));ve(e),he(t)}),[G,ce,de]),Object(i.useEffect)((()=>{V.length>1&&(E(!0),T(!0))}),[V]),Object(i.useEffect)((()=>{}),[V]);const Se=(e,t,n,i,a)=>F.a.putJournal(e,t).then((n=>{l.current,r.patchJournals(e,t,a)})).catch((e=>{console.log(e),$.b.error("Ett fel uppstod. F\xf6rs\xf6k igen.")})),ke=(e,t,n,i)=>{K(!1);let a=null;a=F.a.putJournal(e,n?{override_start:n}:{override_stop:i}),a.then((t=>{l.current&&(J(e),setTimeout((()=>{K(!0)}),3e3))})).catch((e=>{K(!1),console.log(e),$.b.error("Ett fel uppstod. F\xf6rs\xf6k igen.")}))},Ce=(e,t)=>{Se(t,{lightAttested:e})},_e=(e,t)=>{Se(t,{correctedByDriver:e})},Ae=(e,t)=>{g("textarea"===e?{...m,selectedDescription:t}:{...m,selectedDescription:e})},Ne=()=>{O(j)},Re=[{title:"Datum",dataIndex:"journalKey",key:"journalKey",render:(e,t,n)=>{Te.a.locale();const i=Te()(e).format("dddd, D MMMM YYYY");const a=(l=i).charAt(0).toUpperCase()+l.slice(1);var l;return Object(B.jsx)("div",{id:e,children:a})}}];function De(e,t){if(e.preventDefault(),0===Ve.length)alert("Markera minst en resa");else{var n,i,a;let e="1",r=null===(n=t.data.journal_id)||void 0===n?void 0:n.toString(),o=[],s=[],c=0,u=0,v=null,j=0,h=0,p=null;var l;if(null!==t&&void 0!==t&&null!==(i=t.data)&&void 0!==i&&i.mergedTripsId)F.a.getJournalsByIds(null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l.mergedTripsId,!0).then((e=>{var n,i;null===(n=e[0])||void 0===n||n.map((e=>{var t,n,i,a;null!==e&&void 0!==e&&null!==(t=e.trip)&&void 0!==t&&t.coords&&(o=[...null===e||void 0===e||null===(i=e.trip)||void 0===i?void 0:i.coords,...o]);null!==e&&void 0!==e&&null!==(n=e.congestionData)&&void 0!==n&&n.passages&&(s=[...s,...null===e||void 0===e||null===(a=e.congestionData)||void 0===a?void 0:a.passages]);c=null!==(null===e||void 0===e?void 0:e.congestionTaxSek)?parseInt(null===e||void 0===e?void 0:e.congestionTaxSek)+c:c,u=(null===e||void 0===e?void 0:e.congestionTaxCount)+u,null!==(null===e||void 0===e?void 0:e.congestionTaxSekOverride)&&(v=parseInt(null===e||void 0===e?void 0:e.congestionTaxSekOverride)+(v||0)),j=null!==(null===e||void 0===e?void 0:e.infraTaxSek)?parseInt(null===e||void 0===e?void 0:e.infraTaxSek)+j:j,h=(null===e||void 0===e?void 0:e.infraTaxCount)+h,null!==(null===e||void 0===e?void 0:e.infraTaxSekOverride)&&(p=parseInt(null===e||void 0===e?void 0:e.infraTaxSekOverride)+(p||0))})),Fe(!0),d({data:{...null===t||void 0===t?void 0:t.data,trip:{...null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.trip,coords:o},congestionTaxSek:c,congestionTaxCount:u,congestionTaxSekOverride:null!==v?v:null,infraTaxSek:j,infraTaxCount:h,infraTaxSekOverride:null!==p?p:null,congestionData:{passages:s}}})}));null!==t&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.mergedTripsId||F.a.getJournals(le[0].unix(),le[1].unix(),ye,ne,e,r).then((e=>{var n;e.stopTimeBackwards=t.data.stopTimeBackwards,null!==(null===e||void 0===e||null===(n=e.trip)||void 0===n?void 0:n.coords)&&(Fe(!0),d({data:e}))}))}}const we=(e,t)=>{var n;if(!V)return;let i=null===(n=Object.entries(V[t]))||void 0===n?void 0:n.findIndex((t=>{let[n,i]=t;return(null===i||void 0===i?void 0:i.journal_id)===e}));return V[t][i-1]};function Le(e,t){let n=e,i=null===n||void 0===n?void 0:n.selectedDescription,a=null===n||void 0===n?void 0:n.id1,l=null===n||void 0===n?void 0:n.id2;F.a.putJournalMerge(a,l,i).then((e=>{g(p),tt(null),$e(null),x(t),r.requestFetchJournals(le[0].unix(),le[1].unix(),ye,ne)})).catch((e=>{console.error(e)}))}const Pe=Object.entries(V).map(((e,t)=>({journalKey:e[0],key:t}))),Ve=[1,2],[Me,Fe]=Object(i.useState)(!1),ze=e=>{let t=Te.a.tz.guess();const n=Te()().tz(t).format("YYYY-MM-DD"),i=me;let a="_",l=t;$.b.loading(U.f.REPORT_IS_CREATED,0),null===ye||void 0===ye||ye.map((e=>{const t=null===ce||void 0===ce?void 0:ce.find((t=>t.id===e)),n=(null===t||void 0===t?void 0:t.registry)||(null===t||void 0===t?void 0:t.displayName);a=a+n+"_"})),e===H.k.SUMMARY_ALL_VEHICLES&&(a="_"+U.f.ALL_VEHICLES.toUpperCase()+"_");let o=ye.length<5?n+a+"_"+i+"_":n+"_"+ye.length+"_fordon_"+i+"_";if(e===H.k.PDF&&(o=o+U.l.JOURNAL+".pdf",F.a.getJournalsPDF(le[0].unix(),le[1].unix(),ye,o,l,ne,G).then((e=>{$.b.destroy()}))),e===H.k.CSV&&(o=o+U.l.JOURNAL+".csv",r.requestDownloadCSV(le[0].unix(),le[1].unix(),ye,o,ne,G)),e===H.k.SUMMARY_VEHICLE&&(o=o+U.l.SUMMARY_VEHICLE+".pdf",F.a.getSummaryVehicleReports(le[0].unix(),le[1].unix(),ye,o,l,!1,ne,G)),e===H.k.SUMMARY_DRIVER&&(o=o+U.l.SUMMARY_DRIVER+".pdf",F.a.getSummaryDriverReports(le[0].unix(),le[1].unix(),ye,o,l,!1,ne,G)),e===H.k.SALARY&&(o=o+U.l.SALARY+".pdf",F.a.getSalaryReports(le[0].unix(),le[1].unix(),ye,o,l,!1,ne,G)),e===H.k.PURPOSE&&(o=o+U.l.PURPOSE+".pdf",F.a.getPurposeReports(le[0].unix(),le[1].unix(),ye,o,l,!1,ne,G)),e===H.k.SUMMARY_ALL_VEHICLES){const e=null===ue||void 0===ue?void 0:ue.map((e=>e.id));o=o+U.l.SUMMARY+".pdf",F.a.getSummaryReports(le[0].unix(),le[1].unix(),e,o,l,!0,ne)}},Be=Object(B.jsxs)(X.a,{onClick:e=>{ne.length>0||ye.length>0||G.length>0?function(e){Ut.a.confirm({title:"Export",content:Object(B.jsxs)("div",{children:[Object(B.jsx)("p",{children:"Din rapport kommer att inkludera f\xf6ljande"}),G.length>0?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("p",{children:"Organisation(er):"}),Object(B.jsx)("ul",{children:null===G||void 0===G?void 0:G.map((e=>{const t=null===se||void 0===se?void 0:se.find((t=>t.organizationId===e)),n=null===t||void 0===t?void 0:t.fullName;return Object(B.jsx)("li",{children:n})}))})]}):null,ye.length>0?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("p",{children:"Fordon:"}),Object(B.jsx)("ul",{children:null===ye||void 0===ye?void 0:ye.map((e=>{const t=null===ce||void 0===ce?void 0:ce.find((t=>t.id===e)),n=(null===t||void 0===t?void 0:t.registry)||(null===t||void 0===t?void 0:t.displayName);return Object(B.jsx)("li",{children:n})}))})]}):null,ne.length>0?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("p",{children:"F\xf6rare:"}),Object(B.jsx)("ul",{children:null===ne||void 0===ne?void 0:ne.map((e=>{const t=null===de||void 0===de?void 0:de.find((t=>t.userId===e));return Object(B.jsx)("li",{children:t.displayName})}))})]}):null]}),okText:"OK",cancelText:"Avbryt",onOk(){ze(e.key),console.log("OK")},onCancel(){console.log("Cancel")}})}(e):ze(e.key)},children:[Object(B.jsxs)(X.a.ItemGroup,{title:"K\xf6rjournal",children:[Object(B.jsxs)(X.a.Item,{children:["Rapport som ",Object(B.jsx)("b",{children:"PDF"})]},H.k.PDF),Object(B.jsxs)(X.a.Item,{children:["Rapport som ",Object(B.jsx)("b",{children:"CSV"})]},H.k.CSV)]}),Object(B.jsxs)(X.a.ItemGroup,{title:"Sammanst\xe4llningar",children:[Object(B.jsx)(X.a.Item,{children:"Fordonsrapport"},H.k.SUMMARY_VEHICLE),Object(B.jsx)(X.a.Item,{children:"F\xf6rarrapport"},H.k.SUMMARY_DRIVER),Object(B.jsx)(X.a.Item,{children:"L\xf6nerapport"},H.k.SALARY),Object(B.jsx)(X.a.Item,{children:"Syfterapport"},H.k.PURPOSE)]})]});let Ge=[],He=Te()().subtract(0,"year").startOf("year").format("YYYY").toLowerCase(),We=Te()().subtract(0,"month").startOf("month").format("MMMM").toLowerCase();We=null===(e=Object.entries(Ei.a))||void 0===e?void 0:e.find((e=>{let[t,n]=e;return(null===n||void 0===n?void 0:n.toLowerCase())===We}));for(let i=1;i<4;i++){var Ke;let e=!1;const t=Te()().subtract(i,"month").startOf("month").format("MMMM").toLowerCase(),n=null===(Ke=Object.entries(Ei.a))||void 0===Ke?void 0:Ke.find((e=>{let[n,i]=e;return(null===i||void 0===i?void 0:i.toLowerCase())===t}));We[0]<4&&n[0]>9&&(e=!0),Ge.push({key:[n[0]+"/"+(e?He-1:He)],value:n[1]+" "+(e?He-1:He)})}const qe=Object(B.jsx)(X.a,{onClick:e=>{var t;if((null===ye||void 0===ye?void 0:ye.length)<1)return void $.b.warning("V\xe4lj vilket fordon du vill attestera",15);const n=null===e||void 0===e||null===(t=e.key)||void 0===t?void 0:t.split("/"),i=n[0],a=n[1];let l=ye[0];F.a.getAttestCkeckLite(i,a,l).then((e=>{F.a.getAttestCheck(i,a,l).then((t=>{!function(e,t,n,i,a){var l,o,s;const d=e.countNoDescription,c=e.countLightAttested,u=e.countNotCertified;let v=null===(l=Object.entries(Ei.a))||void 0===l?void 0:l.find((e=>{let[n,i]=e;return n===t}));v=null===(o=v[1])||void 0===o?void 0:o.toLowerCase();const j=null===ce||void 0===ce?void 0:ce.find((e=>(null===e||void 0===e?void 0:e.id)===i)),h=null===(s=Object.entries(a))||void 0===s?void 0:s.map((e=>{var t,n;let[i,a]=e;const l=i.split("-")[1];return null===(n=(null===(t=Object.entries(Ei.a))||void 0===t?void 0:t.find((e=>{let[t,n]=e;return t.toString()===l})))[1])||void 0===n?void 0:n.toLowerCase()}));Ut.a.confirm({title:"Vill du attestera "+v+" f\xf6r "+((null===j||void 0===j?void 0:j.registry)||"")+"("+((null===j||void 0===j?void 0:j.displayName)||"-")+")?",content:Object(B.jsxs)("div",{children:[Object(B.jsxs)("p",{children:["Alla resor f\xf6r ",Object(B.jsx)("b",{children:v})," m\xe5nad kommer nu att attesteras. Detta kan inte \xe5ngras."]}),Object(B.jsx)("p",{children:"Vill du forts\xe4tta?"}),(null===h||void 0===h?void 0:h.length)>1&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(ee.a,{message:" Du kommer att attestera alla m\xe5nader inkl "+(null===h||void 0===h?void 0:h.map((e=>" "+e)))+".",type:"warning",showIcon:!0}),Object(B.jsx)("br",{})]}),Object(B.jsx)(ee.a,{message:"Du har "+d+" resor av typen tj\xe4nst som saknar syfte.",type:"warning",showIcon:!0}),Object(B.jsx)("br",{}),Object(B.jsx)(ee.a,{message:c+"/"+u+" resor \xe4r markerade som bekr\xe4ftade.",type:"warning",showIcon:!0})]}),okText:"Attestera",cancelText:"Avbryt",onOk(){F.a.patchAttestUser(t,n,i).then((e=>{r.requestFetchJournals(le[0].unix(),le[1].unix(),ye,ne)})),console.log("OK")},onCancel(){console.log("Cancel")}})}(t,i,a,l,e)}))}))},children:null===(t=Object.entries(Ge))||void 0===t?void 0:t.map((e=>{let[t,n]=e;return Object(B.jsx)(X.a.Item,{children:null===n||void 0===n?void 0:n.value},null===n||void 0===n?void 0:n.key)}))});let Je=null===s||void 0===s?void 0:s.data;Te()().subtract(1,"month").startOf("month").format("MMMM").toLowerCase();function Qe(e){let{devComment:t}=e,n=null,i=null;if("INCOMPATIBLE_PURPOSES"===t)n="Varning: Icke kompatibla resor",i=Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("p",{children:"Vi har uppt\xe4ckt att du f\xf6rs\xf6kt sl\xe5 ihop en eller flera resor av olika typ (privat och tj\xe4nst). Dessa resor \xe4r markerade med en gul flagga."}),Object(B.jsx)("p",{children:"F\xf6r att v\xe4rna om din integritet har vi gett dessa resor resetypen Privat. I journalen nedan kan du enkelt \xe4ndra resetyp till Tj\xe4nst eller bryta is\xe4r resan, s\xe5 l\xe4nge den inte \xe4r attesterad. Redan attesterade resor \xe4r l\xe5sta och kan d\xe4rf\xf6r inte \xe4ndras."})]});return Object(B.jsx)(ee.a,{message:n,description:i,type:"warning",showIcon:!0,style:{marginBottom:20}})}let Ze=1!==(null===ye||void 0===ye?void 0:ye.length)||1!==(null===ne||void 0===ne?void 0:ne.length);const[Xe,$e]=Object(i.useState)(),[et,tt]=Object(i.useState)();return ge&&fe&&!xe?Object(B.jsxs)("div",{children:[Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginBottom:20},children:[Object(B.jsxs)(S.a,{justifyContent:"between",wrap:"wrap",children:[Object(B.jsx)(a,{children:"Resor"}),Object(B.jsxs)(S.a,{justifyContent:"start",style:{gap:15,marginBottom:20},wrap:"wrap",children:[(null===se||void 0===se?void 0:se.length)<2?null:Object(B.jsx)("div",{children:Object(B.jsx)(Z.a,{data:se,onChange:e=>{Y(e)},selectedOrganization:G,isMultiple:!0})}),Object(B.jsx)(on,{multiple:"multiple",data:ue,onChange:e=>{if(J(null),e.includes(-1)){if((null===ye||void 0===ye?void 0:ye.length)>0)return void Ee([]);const t=e?ue.map((e=>null===e||void 0===e?void 0:e.id)):[];return void Ee(t)}const t=e.filter((e=>null!==e));Ee(t)},value:ye}),Object(B.jsx)(Oe,{multiple:"multiple",data:je,value:ne,onChange:e=>{if(e.includes(-1)){if((null===ne||void 0===ne?void 0:ne.length)>0)return void ie([]);const t=e?je.map((e=>null===e||void 0===e?void 0:e.userId)):[];return void ie(t)}const t=e.filter((e=>null!==e));ie(t)}}),Object(B.jsx)("div",{children:Object(B.jsx)(Ti,{dropdownClassName:"one-month",onChange:e=>(e=>{if(e&&e.length>1){const t=e[0].startOf("day"),n=e[1].endOf("day");ae=[t,n],oe(ae)}})(e),defaultValue:le,format:"YYYY-MM-DD",defaultPickerValue:le})}),Object(B.jsx)(h.a,{type:"primary",onClick:()=>{te(!1),E(!1),T(!1);r.requestFetchJournals(le[0].unix(),le[1].unix(),ye,ne,"0",null,!0)},children:U.f.BTN_SEARCH})]})]}),Object(B.jsxs)(S.a,{justifyContent:"start",style:{gap:15},children:[Object(B.jsx)(Wn.a,{overlay:Be,children:Object(B.jsxs)(h.a,{icon:Object(B.jsx)(Ye.a,{}),children:["Exportera rapport",Object(B.jsx)(ii.a,{})]})}),Object(B.jsx)(Wn.a,{disabled:Ze,overlay:qe,children:Object(B.jsx)(L.a,{title:Ze?"V\xe4lj en f\xf6rare och ett fordon som du vill attestera":null,children:Object(B.jsxs)(h.a,{disabled:Ze,children:["Attestera resor",Object(B.jsx)(ii.a,{})]})})})]})]})}),Object(B.jsx)(yi,{selectedJourney:s,onOk:()=>Fe(!1),onCancel:()=>Fe(!1),dataTax:Je,visible:!0===Me}),y&&Object(B.jsx)(ee.a,{message:"Varning",description:"Du har resor som beh\xf6ver korrigeras. Kontrollera vilka resor som blivit flaggade av din arbetsgivare.",type:"warning",showIcon:!0,style:{marginBottom:20}}),I&&A&&A.map((e=>Object(B.jsx)(Qe,{devComment:e}))),Object(B.jsx)("div",{id:"test"}),Object(B.jsx)(Kn.a,{style:{zIndex:"20"}}),z?Object(B.jsx)(si,{}):Object(B.jsx)(qn.b,{renderEmpty:()=>Object(Oi.a)(Q?"Ange s\xf6kalternativ och tryck p\xe5 S\xf6k f\xf6r att visa k\xf6rjournal.":"Inga resor f\xf6r vald filtrering."),children:Object(B.jsx)(M.a,{expandable:{expandedRowRender:e=>{var t,n,i,a;const o=e.journalKey;!(null!==pe&&void 0!==pe&&null!==(t=pe.roles)&&void 0!==t&&t.includes("ADMIN"))&&null!==pe&&void 0!==pe&&null!==(n=pe.roles)&&void 0!==n&&n.includes("ROOT");const s=null===pe||void 0===pe||null===(i=pe.roles)||void 0===i?void 0:i.includes("ROOT"),d=[{dataIndex:"devComment",key:"devComment",width:"5%",render:(e,t,n)=>{var i,a,s,d,c;let u=t.data.devComment,v=t.data.journal_id;const j=(null===t||void 0===t||null===(i=t.data)||void 0===i||null===(a=i.driver)||void 0===a?void 0:a.id)===be,h="LOCKED"===(null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.status)||"CORRECTED"===(null===t||void 0===t||null===(d=t.data)||void 0===d?void 0:d.status)||"DONE"===(null===t||void 0===t||null===(c=t.data)||void 0===c?void 0:c.status);return Object(B.jsx)("div",{onClick:()=>u&&j?((e,t)=>{let n={devComment:e};F.a.patchJournalDevCommentOff(t).then((e=>{l.current,r.patchJournals(t,n)}))})(null,v):null,id:o,className:"active-div flex",style:{fontSize:"1.1em",opacity:"100%",cursor:"pointer"},children:u&&Object(B.jsx)(L.a,{title:j?(e=>{let t=[];if(e||null!==e)return e.map((e=>{if("INCOMPATIBLE_PURPOSES"===e)return t.push("Icke-kompatibla resetyper")})),Object(B.jsxs)(B.Fragment,{children:[t.map((e=>Object(B.jsx)("p",{children:e}))),j&&!h?Object(B.jsx)("p",{style:{marginBottom:0},children:"Klicka f\xf6r att sl\xe4cka denna flagga."}):null," "]})})(u):null,children:Object(B.jsx)(Jn.a,{style:{fontSize:"1.1em",opacity:"100%",color:H.b.YELLOW,marginRight:5}})})})}},{dataIndex:"status",key:"status",width:"5%",render:(e,t,n)=>{var i,a,l,r,s;e=t.data.status;let d=t.data.journal_id;const c=t.data.lightAttested;null===t||void 0===t||null===(i=t.data)||void 0===i||i.correctedByDriver;let u=(null===t||void 0===t||null===(a=t.data)||void 0===a||null===(l=a.driver)||void 0===l?void 0:l.id)!==be;null===t||void 0===t||null===(r=t.data)||void 0===r||r.attested;switch(e){case"NONE":return Object(B.jsx)("div",{className:"active-div flex",onClick:()=>u?null:Ce(!c,d),id:o,style:{fontSize:"1.4em",opacity:"100%",cursor:"pointer"},children:Object(B.jsx)(L.a,{title:u?"Du kan endast bekr\xe4fta dina egna resor":"Ej bekr\xe4ftad",children:Object(B.jsx)(Ue.a,{style:{color:H.b.BLUE}})})});case"CHECKED":return Object(B.jsx)("div",{className:"active-div flex",onClick:()=>u?null:Ce(!c,d),id:o,style:{fontSize:"1.4em",opacity:"100%",cursor:"pointer"},children:Object(B.jsx)(L.a,{title:u?"Du kan endast avbekr\xe4fta dina egna resor":"Bekr\xe4ftad",children:Object(B.jsx)(Qn.a,{style:{color:H.b.GREEN,marginRight:5}})})});case"LOCKED":return Object(B.jsx)("div",{className:"active-div flex",id:o,style:{opacity:"100%",cursor:"pointer"},children:Object(B.jsx)(L.a,{title:"Attesterad",children:Object(B.jsx)(Zn.a,{style:{fontSize:"1.4em",opacity:"100%",color:H.b.YELLOW,marginRight:5}})})});case"BAD":let e=null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.adminComment;return Object(B.jsx)("div",{className:"active-div flex",onClick:()=>u?null:_e(!0,d),id:o,style:{opacity:"100%",cursor:"pointer"},children:Object(B.jsx)(L.a,{title:u?"Du kan endast korrigera dina egna resor":e,children:Object(B.jsx)(Jn.a,{style:{fontSize:"1.4em",opacity:"100%",color:"#bf0e0e",marginRight:5}})})});case"CORRECTED":return Object(B.jsx)("div",{className:"active-div flex",onClick:()=>u?null:_e(!1,d),id:o,style:{opacity:"100%",cursor:"pointer"},children:Object(B.jsx)(L.a,{title:u?"Du kan endast avkorrigera dina egna resor":"Korrigerad",children:Object(B.jsx)(Jn.a,{style:{fontSize:"1.4em",opacity:"100%",color:H.b.GREEN,marginRight:5}})})});case"DONE":return Object(B.jsx)("div",{className:"active-div flex",id:o,style:{opacity:"100%",cursor:"pointer"},children:Object(B.jsx)(L.a,{title:"Godk\xe4nd",children:Object(B.jsx)(Xn.a,{style:{fontSize:"1.4em",opacity:"100%",color:H.b.GREEN,marginRight:5}})})});default:return"foo"}}},{title:"Regnr",dataIndex:"vehicle",key:"vehicle",width:"5%",render:(e,t,n)=>Object(B.jsx)(gn.a,{children:t.data.vehicle.reg})},{title:"Tid",dataIndex:"timestamp",key:"timestamp_start_ms",width:"5%",render:(e,t,n)=>{var i,a,l,r,o,s,d;const{data:c}=t,u=Object(pt.a)(null===c||void 0===c||null===(i=c.trip)||void 0===i?void 0:i.timestamp_start_ms,"HH:mm",!1),v=Object(pt.a)(null===c||void 0===c||null===(a=c.trip)||void 0===a?void 0:a.timestamp_stop_ms,"HH:mm",!1);return(null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l.driver.id)===be||"PRIVATE_AUTO"!==(null===t||void 0===t||null===(r=t.data)||void 0===r||null===(o=r.trip)||void 0===o?void 0:o.purpose)&&"PRIVATE"!==(null===t||void 0===t||null===(s=t.data)||void 0===s||null===(d=s.trip)||void 0===d?void 0:d.purpose)?Object(B.jsxs)("div",{className:"d-table",children:[Object(B.jsx)("p",{className:"d-table-row",children:v}),Object(B.jsx)("br",{}),Object(B.jsx)("p",{className:"d-table-row",children:u})]}):null}},{title:"Adress",dataIndex:"address_start",key:"address",width:"20%",render:(e,t,n)=>{var i,a;const l=(!(null!==(i=t.data.driver)&&void 0!==i&&i.id)||(null===(a=t.data.driver)||void 0===a?void 0:a.id)!==be)&&"PRIVATE"===t.data.trip.purpose;let r=t.data.override_start;var o,s;r||(r=null===(o=t.data)||void 0===o||null===(s=o.geocode_start)||void 0===s?void 0:s.format);let d=t.data.override_stop;var c;d||(d=null===(c=t.data.geocode_stop)||void 0===c?void 0:c.format);const v=!0===W&&t.data.journal_id===q?"success":null;return Object(B.jsx)("div",{className:"d-table",children:Object(B.jsx)(u.a,{style:{width:"100%",minWidth:"300px"},children:Object(B.jsxs)(u.a.Item,{style:{margin:"auto",width:"100%"},hasFeedback:!0,validateStatus:v,children:[Object(B.jsx)("div",{children:l?"\u2014 Sekretess \u2014":Object(B.jsx)(C.a,{defaultValue:d,onChange:e=>{var n;ke(t.data.journal_id,null===(n=t.data.driver)||void 0===n||n.user_id,null,e.target.value)},prefix:Object(B.jsx)("div",{style:{color:"#6B7D92"},children:Object(B.jsx)($n.a,{})})})}),Object(B.jsx)("span",{children:l?"\u2014 Sekretess \u2014":Object(B.jsx)(C.a,{prefix:Object(B.jsx)("div",{style:{color:"#D6D7DC"},children:Object(B.jsx)(ei.a,{})}),onChange:e=>{var n;ke(t.data.journal_id,null===(n=t.data.driver)||void 0===n||n.user_id,e.target.value,null)},defaultValue:r})})]})})})}},{title:"F\xf6rare",dataIndex:"driver",key:"driver",width:"10%",render:(e,t,n)=>{var i,a;const{data:l}=t;return Object(B.jsx)(L.a,{title:"Byt incheckad f\xf6rare f\xf6r den resan",children:Object(B.jsx)("a",{type:"link",disabled:(null===(i=t.data.driver)||void 0===i?void 0:i.id)!==be&&null!==(null===(a=t.data.driver)||void 0===a?void 0:a.id)&&("PRIVATE_AUTO"===t.data.trip.purpose||"PRIVATE"===t.data.trip.purpose),style:{color:"PRIVATE"===t.data.trip.purpose||"PRIVATE"===t.data.trip.purpose?H.b.SWITCH_PRIVATE:H.b.SWITCH_BUSINESS},onClick:()=>(e=>{var t;O({journalId:e.journal_id,preSelectId:e.driver.id,showModal:!0,data:e,organizationId:null===e||void 0===e||null===(t=e.trip)||void 0===t?void 0:t.organizationId})})(l),children:l.driver.displayName?l.driver.displayName:"F\xf6rare ej vald"})})}},{title:"Restid",dataIndex:"total_time",key:"total_time",width:"10%",render:(e,t,n)=>{const{data:i}=t;return t.data.driver.id===be||"PRIVATE"!==t.data.trip.purpose&&"PRIVATE"!==t.data.trip.purpose?Object(B.jsx)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"none",justifyContent:"space-between",alignItems:"center"},children:Object(B.jsx)("span",{style:Object(Vt.b)(t.data.trip),children:Object(pt.c)(i.trip.timestamp_stop_ms,i.trip.timestamp_start_ms)})}):null}},{title:"Avst\xe5nd",dataIndex:"odometer_total",key:"distance",width:"5%",render:(e,t,n)=>{const{data:i}=t,a=(.001*i.trip.odometer_max).toFixed(2);return Object(B.jsx)("div",{className:"d-table",style:Object(Vt.b)(t.data.trip),children:Object(B.jsxs)("span",{className:"d-table-row",children:[a," km"]})})}},{title:"Stopptid",dataIndex:"stopTimeBackwards",key:"stopTimeBackwards",width:"5%",render:(e,t,n)=>t.data.driver.id===be||"PRIVATE"!==t.data.trip.purpose&&"PRIVATE"!==t.data.trip.purpose?Object(B.jsx)("span",{style:Object(Vt.b)(t.data.trip),children:t.data.stopTimeBackwards?Object(pt.b)(t.data.stopTimeBackwards):null}):null},{title:"M\xe4tarst\xe4llning",dataIndex:"odometer_start",key:"odometers",width:"9%",render:(e,t,n)=>{const{data:i}=t;return Object(B.jsxs)("div",{className:"d-table",children:[Object(B.jsxs)("span",{className:"d-table-row",children:[Object(pt.d)((i.trip.odometer_stop/1e3).toFixed(0))," km"]}),Object(B.jsx)("br",{}),Object(B.jsxs)("span",{className:"d-table-row",children:[Object(pt.d)((i.trip.odometer_start/1e3).toFixed(0))," km"]})]})}},{title:"Syfte",dataIndex:"description",width:"10%",render:(e,t,n)=>{var i,a,l,r;const o=t.data.trip.purpose.startsWith("BUSINESS"),d=(null===(i=t.data.driver)||void 0===i?void 0:i.id)===be;let c=!0;const u=null===pe||void 0===pe||null===(a=pe.purposes)||void 0===a?void 0:a.map((e=>({value:e})));t.data.adminComment;return Object(B.jsxs)(S.a,{flexDirection:"column",justifyContent:"center",alignItems:"start",gap:10,children:[Object(B.jsx)(R.a,{style:{backgroundColor:o?H.b.SWITCH_BUSINESS:H.b.SWITCH_PRIVATE,marginRight:10,minWidth:80},checkedChildren:"Tj\xe4nst",unCheckedChildren:"Privat",disabled:!s&&(null===(l=t.data.driver)||void 0===l?void 0:l.id)!==be&&null!==(null===(r=t.data.driver)||void 0===r?void 0:r.id)&&("PRIVATE_AUTO"===t.data.trip.purpose||"PRIVATE"===t.data.trip.purpose),onChange:e=>{!1!==e||d?(Se(t.data.journal_id,{purpose:e?"BUSINESS":"PRIVATE"}),c=!c):function(e,t,n,i,a){Ut.a.confirm({title:"Du \xe4r p\xe5 v\xe4g att l\xe5sa denna resa",content:"Om du markerar denna resa som privat kommer endast f\xf6raren sj\xe4lv kunna se och \xe4ndra p\xe5 resans detaljer.\nVill du verkligen \xe4ndra denna resa till privat? Du kan inte \xe5ngra detta.",okText:"Ja, \xe4ndra till privat",onOk(){Se(e.data.journal_id,{purpose:n?"BUSINESS":"PRIVATE"}),i=!i},onCancel(){}})}(t,0,e,c)},checked:o}),Object(B.jsx)(Ai,{disabled:d,tripId:t.data.journal_id,value:t.data.trip.description,options:u,o:t,userId:be})]})}},{title:"Rutt",dataIndex:"purpose",width:"20%",render:(e,t,n)=>{var i,a,l,s,d,c,u,j,p,b,O,m,f,y,E,I,T,k,C;let _=!0===(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.merged),A=null!==(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.congestionTaxSekOverride)?null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l.congestionTaxSekOverride:(null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.congestionTaxSek)||0,N=null!==(null===t||void 0===t||null===(d=t.data)||void 0===d?void 0:d.infraTaxSekOverride)?null===t||void 0===t||null===(c=t.data)||void 0===c?void 0:c.infraTaxSekOverride:(null===t||void 0===t||null===(u=t.data)||void 0===u?void 0:u.infraTaxSek)||0;const R=(null===t||void 0===t||null===(j=t.data)||void 0===j?void 0:j.congestionTaxCount)||(null===t||void 0===t||null===(p=t.data)||void 0===p?void 0:p.congestionTaxSekOverride)||(null===t||void 0===t||null===(b=t.data)||void 0===b?void 0:b.infraTaxSekOverride)||(null===t||void 0===t||null===(O=t.data)||void 0===O?void 0:O.infraTaxCount);let D=R?li:ri,w=(null===t||void 0===t||null===(m=t.data)||void 0===m||null===(f=m.trip)||void 0===f||f.purpose,we(null===t||void 0===t||null===(y=t.data)||void 0===y?void 0:y.journal_id,o));null===w||void 0===w||null===(E=w.trip)||void 0===E||E.purpose;const P=function(e,t){var n,i,a,l,r,o,s,d,c,u,v,j,h,p;let b=!0;const O=we(null===e||void 0===e?void 0:e.journal_id,t);(null===O||void 0===O||null===(n=O.driver)||void 0===n?void 0:n.id)!==(null===e||void 0===e||null===(i=e.driver)||void 0===i?void 0:i.id)&&(b=!1),(null===O||void 0===O||null===(a=O.vehicle)||void 0===a?void 0:a.vehicleId)!==(null===e||void 0===e||null===(l=e.vehicle)||void 0===l?void 0:l.vehicleId)&&(b=!1),(null===O||void 0===O||null===(r=O.trip)||void 0===r?void 0:r.purpose)!==(null===e||void 0===e||null===(o=e.trip)||void 0===o?void 0:o.purpose)&&(b=!1),"PRIVATE"!==(null===O||void 0===O||null===(s=O.trip)||void 0===s?void 0:s.purpose)&&"PRIVATE_AUTO"!==(null===O||void 0===O||null===(d=O.trip)||void 0===d?void 0:d.purpose)&&"PRIVATE"!==(null===e||void 0===e||null===(c=e.trip)||void 0===c?void 0:c.purpose)&&"PRIVATE_AUTO"!==(null===e||void 0===e||null===(u=e.trip)||void 0===u?void 0:u.purpose)||(null===O||void 0===O||null===(v=O.driver)||void 0===v?void 0:v.id)===(null===pe||void 0===pe?void 0:pe.userId)&&(null===e||void 0===e||null===(j=e.driver)||void 0===j?void 0:j.id)===(null===pe||void 0===pe?void 0:pe.userId)||(b=!1);const m=(null===O||void 0===O||null===(h=O.trip)||void 0===h?void 0:h.timestamp_start_ms)-(null===e||void 0===e||null===(p=e.trip)||void 0===p?void 0:p.timestamp_stop_ms);return Math.floor(m/1e3/60)>120&&(b=!1),null!==O&&void 0!==O&&O.lightAttested&&(b=!1),b}(null===t||void 0===t?void 0:t.data,o);return Object(B.jsxs)(S.a,{style:{minWidth:"175px"},flexDirection:"column",gap:10,children:[Object(B.jsx)(L.a,{title:"Visa karta med rutter",children:Object(B.jsx)(h.a,{className:"active-div",style:{width:"100%",opacity:.9,cursor:"pointer"},disabled:t.data.driver.id!==be&&("PRIVATE"===t.data.trip.purpose||"PRIVATE"===t.data.trip.purpose),onClick:e=>{De(e,t)},size:"small",children:Object(B.jsxs)(S.a,{gap:8,children:[Object(B.jsx)(ct.Icon,{icon:ai.location}),"Visa karta"]})})}),_&&Object(B.jsx)(h.a,{icon:Object(B.jsx)(ti.a,{}),onClick:e=>{((e,t)=>{var n;let i=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.mergedTripsId;F.a.putJournalUnmerge(i).then((e=>{console.log(e),r.requestFetchJournals(le[0].unix(),le[1].unix(),ye,ne),x(t)})).catch((e=>{console.log(e),$.b.error("Ett fel uppstod. F\xf6rs\xf6k igen.")}))})(t,o)},size:"small",children:"Bryt is\xe4r resor"}),!_&&P&&Object(B.jsx)(h.a,{disabled:(null===t||void 0===t||null===(I=t.data)||void 0===I||null===(T=I.driver)||void 0===T?void 0:T.id)!==be&&!(null!==pe&&void 0!==pe&&null!==(k=pe.roles)&&void 0!==k&&k.includes("ADMIN"))&&!(null!==pe&&void 0!==pe&&null!==(C=pe.roles)&&void 0!==C&&C.includes("ROOT")),icon:Object(B.jsx)(ni.a,{}),onClick:e=>{((e,t,n)=>{var i;let a=e,l=n.data,r=we(a,t),o=null!==r&&void 0!==r&&r.mergedTripsId?null===r||void 0===r||null===(i=r.mergedTripsId)||void 0===i?void 0:i.at(-1):null===r||void 0===r?void 0:r.journal_id;if(l.trip.description===r.trip.description){let i={journalId:e,journalKey:t,journal:n,id1:a,id2:o,showMergeModal:!1};g(i),Le(i,t)}else g({journalId:e,journalKey:t,journal:n,id1:a,id2:o,showMergeModal:!0,description1:l.trip.description,description2:r.trip.description})})(t.data.journal_id,o,t)},size:"small",children:"Sl\xe5 ihop med n\xe4sta"}),Object(B.jsx)(h.a,{className:"active-div",style:{width:"100%",opacity:.9,cursor:"pointer"},disabled:t.data.driver.id!==be&&("PRIVATE"===t.data.trip.purpose||"PRIVATE"===t.data.trip.purpose),onClick:e=>{De(e,t)},size:"small",children:Object(B.jsxs)(S.a,{gap:8,children:[Object(B.jsx)("img",{alt:"Sweden road sign E25",width:23,src:D}),Object(B.jsxs)(v.a.Text,{style:{color:R?H.b.RED:null},children:[A+N," kr"]})]})})]})}}].filter((e=>!e.hidden));let c=[];o&&void 0!==V[o]&&V[o].length>0&&V[o].forEach(((e,t)=>{c.push({k:e.id,data:{viewChecked:!0,viewSaved:144===e.journal_id,...e}})}));c.map((e=>{var t;return null===(t=e.data.attested)||void 0===t?void 0:t.attested}));return c.map((e=>{e.data.isBadTrip&&!e.data.attested&&E(!0),e.data.devComment&&T(!0);D.findIndex((t=>t.id2===e.data.journal_id))>-1&&(c=c.filter((t=>t.data.journal_id!==e.data.journal_id)))})),Object(B.jsx)(M.a,{rowClassName:e=>{var t,n,i;return("DONE"===(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.status)||"LOCKED"===(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.status)||"CHECKED"===(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.status))&&"disabled-row"},rowKey:e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.journal_id},columns:d,dataSource:c,pagination:!1,defaultExpandAllRows:!0,children:" "},null===(a=c)||void 0===a?void 0:a.length)},defaultExpandAllRows:!0,expandRowByClick:!0,fixed:!0,style:{position:"sticky",top:0,zIndex:9999,backgroundColor:"#283142"}},columns:Re,rowKey:e=>e.key,dataSource:Pe,defaultExpandAllRows:!0,scrollToFirstRowOnChange:!0,pagination:!1},null===Pe||void 0===Pe?void 0:Pe.length)}),Object(B.jsx)(Ut.a,{title:"Syfte",style:{maxWidth:500},visible:m.showMergeModal,onOk:()=>Le(m,null===m||void 0===m?void 0:m.journalKey),onCancel:()=>(g(p),tt(null),void $e(null)),children:Object(B.jsxs)(_.a.Group,{onChange:e=>((e,t)=>{$e(e.target.value);let n=t,i=e.target.value;Ae(i,n)})(e,et),style:{display:"flex",flexDirection:"column"},value:Xe,children:[m.description1&&"\u2013"!=m.description1&&Object(B.jsx)(_.a,{style:{marginBottom:"0.5em"},value:m.description1,children:m.description1}),m.description2&&"\u2013"!=m.description2&&Object(B.jsx)(_.a,{style:{marginBottom:"0.5em"},value:m.description2,children:m.description2}),Object(B.jsxs)(_.a,{value:"textarea",children:[Object(B.jsx)("span",{children:"Ange nytt syfte..."}),Object(B.jsx)("div",{children:"textarea"===Xe?Object(B.jsx)(C.a,{style:{marginTop:"0.25em"},value:et,onChange:e=>{tt(e.target.value);let t=e.target.value;Ae("textarea",t)},placeholder:U.f.SUPPLY_PURPOSE,allowClear:!0}):null})]})]})}),Object(B.jsx)(Ut.a,{title:"F\xf6rare",visible:b.showModal,onOk:()=>(e=>{if(null!=(null===b||void 0===b?void 0:b.selectedId)&&(null===b||void 0===b?void 0:b.selectedId)!=b.preSelectId){const e=b.selectedId,t=b.journalId;let n=null,i={driver:{displayName:b.selectedName,id:b.selectedId}};n=Se(t,{user_id:e},0,0,i),n.then((()=>{let e={...b.data,driver:{displayName:b.selectedName,id:b.selectedId}};r.patchJournals(t,{field:null},null,{object:e})})).catch((e=>{console.log(e),$.b.error("Ett fel uppstod. F\xf6rs\xf6k igen.")}))}Ne()})(),onCancel:()=>Ne(),children:Object(B.jsx)(u.a.Item,{children:Object(B.jsx)(k.a,{showSearch:!0,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.children))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},className:"default-input-field",placeholder:"V\xe4lj f\xf6rare",optionFilterProp:"children",onChange:e=>{return t=e,void O({...b,selectedId:t,selectedName:de.filter((e=>e.userId===t))[0].displayName});var t},onSearch:()=>null,value:b.selectedId||b.preSelectId,children:null===de||void 0===de||null===(n=de.filter((e=>!e.isArchived&&(null===e||void 0===e?void 0:e.organizationId)===(null===b||void 0===b?void 0:b.organizationId))))||void 0===n?void 0:n.map((e=>Object(B.jsx)(Ii,{value:e.userId,children:e.displayName})))})})})]}):Object(B.jsx)("div",{children:xe?Object(B.jsx)(re.b,{selectedOrganization:G,organizationSelectOnChange:e=>Y([e]),knownOrganizations:se}):Object(B.jsxs)("div",{children:["Laddar resor...",Object(B.jsx)(o.a,{})]})})},_i=e=>{let{...t}=e;const n=Object(i.useContext)(c.t),a={foo:(e,t)=>({...e,hello:"baz"}),receiveJournals:(e,t)=>({...e,journalQuery:null,journalURL:t.url,journals:{...t.journals}})},[l,r]=Object(i.useReducer)(((e,t)=>a[t.type](e,t.payload)),{},void 0);return Object(i.useEffect)((()=>{if(!l.journalQuery)return;if(!n.idByReg)return;const e=new Date(l.journalQuery.startDate).getTime()/1e3,t=new Date(l.journalQuery.endDate).getTime()/1e3,i=l.journalQuery.filters.registration.map((e=>n.idByReg[e]));let a="?from_ts=".concat(e,"&to_ts=").concat(t);a+=(null===i||void 0===i?void 0:i.length)>0?"&vehicleIds="+i:"",a+="&excludeCoords=true";const o=s.a+"/journal"+a;o!==l.journalURL&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const i=localStorage.getItem(w.b);return console.debug("Dispatching request",e,t," with JWT = ",i),new Promise(((a,l)=>{let r=new XMLHttpRequest;r.onload=()=>{a(r)},r.onerror=()=>{l()},console.debug("Calling XHR open"),r.open(e,t),r.setRequestHeader("Authorization","JWT "+i),console.debug("Calling XHR send"),r.send(n)}))}("GET",o).then(ji).then((e=>{r({type:"receiveJournals",payload:{url:o,journals:e}})}))}),[l.journalQuery,n.idByReg]),Object(B.jsx)(c.m.Provider,{value:{state:l,dispatch:r},children:Object(B.jsx)(Ci,{...t})})},Ai=e=>{var t,n,a;let{tripId:l,value:r,timeout:o=1e3,o:s,options:d,userId:c,formStyle:v}=e;const[j,h]=Object(i.useState)(""),[p,b,O]=Ri(r),[m,g,f]=Ri(s),[x,y,E]=Ri(r),I=Object(i.useContext)(ui);Object(i.useEffect)((()=>{g(s)}),[s]);const S=()=>{"validating"!==j&&null!==O.current&&O.current!==E.current&&F.a.putJournal(l,{description:O.current}).then((()=>{h("success"),y(O.current);let e={...f.current.data,trip:{...f.current.data.trip,description:O.current||"\u2013"}};I.patchJournals(l,{field:null},null,{object:e})})).catch((e=>{console.error(e),h("error"),b(r)}))};return Object(i.useEffect)((()=>{const e=setInterval(S,o);return()=>{clearInterval(e)}}),[]),Object(B.jsx)(u.a,{style:v,children:Object(B.jsx)(u.a.Item,{style:{margin:"auto"},hasFeedback:!0,validateStatus:j,children:Object(B.jsx)(V.a,{style:{minWidth:200},options:d,disabled:(null===s||void 0===s||null===(t=s.data)||void 0===t||null===(n=t.driver)||void 0===n?void 0:n.id)!==c&&null!==(null===(a=s.data.driver)||void 0===a?void 0:a.id)&&("PRIVATE_AUTO"===s.data.trip.purpose||"PRIVATE"===s.data.trip.purpose),defaultValue:p,filterOption:(e,t)=>{var n;return-1!==(null===t||void 0===t||null===(n=t.value)||void 0===n?void 0:n.toUpperCase().indexOf(e.toUpperCase()))},onChange:e=>{h("validating"),b(e)},children:Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY_PURPOSE,allowClear:!0})})})})};var Ni=()=>Object(B.jsx)(Vt.a,{wrappers:[c.e.provider,c.b,c.g,c.q,c.u,c.l.provider,vi],children:Object(B.jsx)(_i,{})});function Ri(e){const[t,n]=Object(i.useState)(e),a=Object(i.useRef)(t);return a.current=t,[t,n,a]}n(882);const Di=["TAT100"];var wi={checkbox:{width:"100%",margin:"10px 0"},divider:{margin:"12px 0"}};const{Text:Li}=v.a;var Pi=e=>{let{visible:t,vehicles:n,onCancel:a=(()=>null),onOk:l=(()=>null)}=e;const{getTrackersReport:r}=Object(i.useContext)(Qe),{organizations:o}=Object(i.useContext)(Tt.a),[s,d]=Object(i.useState)([]),[c,u]=Object(i.useState)([]),v=JSON.parse(localStorage.getItem(w.e));Object(i.useEffect)((()=>{if(n){const e=n.filter((e=>Di.includes(null===e||void 0===e?void 0:e.deviceType))).map((e=>Object(B.jsx)(Qt.a,{value:null===e||void 0===e?void 0:e.meta.vehicle_id,style:{...wi.checkbox},children:e.meta.reg},null===e||void 0===e?void 0:e.meta.vehicle_id)));d(e)}}),[n]);return Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(Ut.a,{title:"Export Tracker Report",visible:t,onCancel:a,onOk:async()=>{const e=o.find((e=>e.organizationId===v));!1!==await r(c,null===e||void 0===e?void 0:e.fullName)?setTimeout((()=>{l()}),300):a()},children:[Object(B.jsx)(Li,{children:"V\xe4lj vilka trackers som ska inkluderas i rapporten"}),Object(B.jsx)(Fe.a,{style:{...wi.divider}}),Object(B.jsx)(Qt.a.Group,{onChange:e=>(e=>{u(e)})(e),children:s})]})})};const{Text:Vi}=v.a;var Mi=e=>{let{visible:t,onClose:n=(()=>null)}=e;const a=Object(i.useRef)(null),{geozone:l}=Object(i.useContext)(qe),[r,o]=Object(i.useState)(),[d,c]=Object(i.useState)(),[u,v]=Object(i.useState)([]);return Object(i.useEffect)((()=>{if(d&&r&&l){(null===u||void 0===u?void 0:u.length)>0&&u.map((e=>{e.setMap(null)}));const e=[];null===l||void 0===l||l.map((t=>{var n;!function(e,t,n){var i;const a=null===n||void 0===n||null===(i=n.zoneCoords)||void 0===i?void 0:i.map((e=>({lat:e.latitude,lng:e.longitude}))),l=new e.Polygon({map:t,paths:a,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!1,geodesic:!0,editable:!1}),r=u;r.push(l),v(r)}(d,r,t),null===t||void 0===t||null===(n=t.zoneCoords)||void 0===n||n.map((t=>e.push({lat:t.latitude,lng:t.longitude})))}));const t=xe(d,e);r.fitBounds(t)}}),[r,d,l]),Object(B.jsx)(Ut.a,{title:"Geozoner",visible:t,onOk:n,onCancel:n,width:800,children:l.length<=0?Object(B.jsx)(Vi,{children:"Inga Geozoner f\xf6r valt fordon"}):Object(B.jsx)("div",{style:{...At.mapContent},children:Object(B.jsx)(ae.a,{ref:a,bootstrapURLKeys:s.e,center:{lat:59.57053037008066,lng:16.391671447753904},zoom:5,options:ie,yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:e=>{let{map:t,maps:n}=e;ne(n,t),o(t),c(n)}})})})};var Fi=()=>{const e={show:!1,vehicles:null},t={show:!1},[n,a]=Object(i.useState)(e),[l,r]=Object(i.useState)(t),o=()=>{a(e)};return Object(B.jsx)(Tt.b,{children:Object(B.jsx)(c.b,{children:Object(B.jsx)(Xe.b,{children:Object(B.jsx)(at,{children:Object(B.jsx)(Ze,{children:Object(B.jsx)(Je,{children:Object(B.jsxs)(c.k,{children:[Object(B.jsx)(Dt,{openExportTrackerReportModal:e=>(e=>{a({show:!0,vehicles:e})})(e),openGeozone:()=>{r({show:!0})}}),Object(B.jsx)(Pi,{visible:n.show,vehicles:n.vehicles,onCancel:o,onOk:o}),l.show&&Object(B.jsx)(Mi,{visible:l.show,geozone:l.geozone,onClose:()=>{r(t)}})]})})})})})})})},zi=n(197),Ui=n(221);var Bi={vehicleSelector:{width:200},Title:{marginBottom:0}},Gi=n(138);const{Title:Hi,Text:Yi}=v.a,{Option:Wi}=k.a;var Ki=()=>{var e,t,n,a,l,r,u,v,j,p;const{updateSelectedVehicleOverviewData:b}=Object(i.useContext)(it),{organizations:O}=Object(i.useContext)(Tt.a),m=Object(i.useContext)(c.v),g=Object(i.useContext)(c.l.context),f=Object(i.useContext)(c.n),[x,y]=Object(i.useState)(),[E,I]=Object(i.useState)(),[S,T]=Object(i.useState)(!1),[k,C]=Object(i.useState)([59.334591,18.06324]),[_,A]=Object(i.useState)([]),[N,R]=Object(i.useState)(!1),[D,L]=Object(i.useState)(!1),[P,V]=Object(i.useState)([]),[M,F]=Object(i.useState)([]),[z,G]=Object(i.useState)(),[H,Y]=Object(i.useState)(""),[W,K]=Object(i.useState)([]),[q,J]=Object(i.useState)(),Q=Object(i.useContext)(c.j),X=null===Q||void 0===Q?void 0:Q.includes(parseInt(localStorage.getItem(w.e)));Object(i.useEffect)((()=>{const e=null===m||void 0===m?void 0:m.find((e=>e.id===g));y(e),F(m)}),[g,m]),Object(i.useEffect)((()=>{null!==x&&void 0!==x&&x.id&&(b(null===x||void 0===x?void 0:x.id).then((e=>I(e))),$(x))}),[x]),Object(i.useEffect)((()=>{var e;T(!(null!==E&&void 0!==E&&null!==(e=E.position)&&void 0!==e&&e.latitude))}),[E]),Object(i.useEffect)((()=>{var e,t;z&&(null===z||void 0===z||null===(e=z.maps)||void 0===e||e.event.trigger(null===z||void 0===z?void 0:z.map,"resize"),null===z||void 0===z||null===(t=z.map)||void 0===t||t.setOptions({...ie,styles:"DARK"===localStorage.getItem(w.d)?te:null}),ne(null===z||void 0===z?void 0:z.maps,null===z||void 0===z?void 0:z.map))}),[localStorage.getItem(w.d),z]);Object(i.useEffect)((()=>{let e;if(!z)return void console.error("Cannot set bounds yet: don't have maps instance");if(!q||0===q.length)return void console.error("Cannot set bounds yet: don't have overviewData, or overviewData is empty");{const t=[...W];t.sort(),e=t.map((e=>""+e)).join(",")}if(e===H)return;const t=((e,t)=>{console.log("Creating bounds for passing to fitBounds");const n=new e.LatLngBounds;return t.forEach((t=>{var i,a;const l=null===t||void 0===t||null===(i=t.position)||void 0===i?void 0:i.latitude,r=null===t||void 0===t||null===(a=t.position)||void 0===a?void 0:a.longitude;if(l&&r){const t=new e.LatLng(l,r);n.extend(t)}})),n})(z.maps,q);z.map.fitBounds(t),Y(e)}),[z,q,W]);const $=e=>{A(null===e||void 0===e?void 0:e.permittedDrivers)},le=e=>{let{value:t,record:n}=e;let i="F\xf6rare ej vald";if("POOL"===(null===n||void 0===n?void 0:n.benefitType)&&(i="Till\xe5ts f\xf6r alla"),1===(null===t||void 0===t?void 0:t.length)){const e=null===_||void 0===_?void 0:_.find((e=>e.userId===t[0].id));i=e?null===e||void 0===e?void 0:e.displayName:"-"}if((null===t||void 0===t?void 0:t.length)>1){const e=null===t||void 0===t?void 0:t.map((e=>e.id));let n=(null===t||void 0===t?void 0:t.length)+" f\xf6rare";return Object(Bt.a)(n,null,null,e,null,f,O)}return i};return Object(B.jsx)(B.Fragment,{children:x?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(Ve.a,{justify:"space-between",align:"middle",children:[Object(B.jsx)(Me.a,{children:Object(B.jsx)(Hi,{style:Bi.Title,children:"Mina fordon"})}),Object(B.jsx)(Me.a,{children:Object(B.jsxs)(zi.b,{align:"baseline",children:[Object(B.jsx)(Z.a,{data:O,onChange:e=>{if(0!==(null===e||void 0===e?void 0:e.length)){V(e);const t=m.filter((t=>e.includes(t.organizationId)));F(t)}else V([]),F(m)},selectedOrganization:P,isMultiple:!0}),Object(B.jsx)(on,{data:M,onChange:e=>{const t=M.find((t=>t.id===e));t&&(y(t),(e=>{var t,n;x?C([null===x||void 0===x||null===(t=x.position)||void 0===t?void 0:t.latitude,null===x||void 0===x||null===(n=x.position)||void 0===n?void 0:n.longitude]):(C([59.334591,18.06324]),R(!1),T(!1))})(null===t||void 0===t||t.id),$(t))},value:null===x||void 0===x?void 0:x.id})]})})]}),Object(B.jsx)(Fe.a,{}),X?Object(B.jsx)(Yi,{children:"Kartan \xe4r ej tillg\xe4nglig."}):Object(B.jsx)("div",{style:{height:"40vh"},children:Object(B.jsx)(ae.a,{bootstrapURLKeys:s.e,center:k,zoom:N?13:5,yesIWantToUseGoogleMapApiInternals:!0,options:ie,onGoogleApiLoaded:e=>{let{map:t,maps:n}=e;console.log("Google API is loaded"),ne(n,t),G({map:t,maps:n})},children:(null===E||void 0===E?void 0:E.position)&&Object(B.jsx)(Et,{data:E,lat:null===E||void 0===E||null===(e=E.position)||void 0===e?void 0:e.latitude,lng:null===E||void 0===E||null===(t=E.position)||void 0===t?void 0:t.longitude})})}),Object(B.jsx)(Fe.a,{}),x&&(null===x||void 0===x?void 0:x.isArchived)&&Object(B.jsxs)("div",{children:[Object(B.jsxs)(dt.b,{bordered:!0,column:{xs:1,sm:1,md:2},children:[Object(B.jsxs)(dt.b.Item,{label:U.f.VEHICLE,style:{},children:[Object(B.jsx)("b",{children:null===x||void 0===x?void 0:x.registry})," ",(null===x||void 0===x?void 0:x.displayName)||"-"]}),Object(B.jsx)(dt.b.Item,{label:U.f.ARCHIVED,style:{minWidth:0},children:null!==(null===x||void 0===x?void 0:x.archived)?Object(B.jsx)(We.a,{value:null===x||void 0===x?void 0:x.archivedTsMs,typ:"map",isTracker:null===x||void 0===x?void 0:x.isTracker,defaultText:!0}):"-"})]}),Object(B.jsx)("br",{}),Object(B.jsx)(ee.a,{message:"Detta fordon \xe4r arkiverat",description:"Arkiverade fordon registrerar ingen k\xf6rdata. Aktivering av fordon kan g\xf6ras av f\xf6retagsadmin under fliken Fordon.",type:"info",showIcon:!0})]}),x&&!(null!==x&&void 0!==x&&x.isArchived)&&Object(B.jsxs)(dt.b,{bordered:!0,column:{xs:1,sm:1,md:2},children:[Object(B.jsxs)(dt.b.Item,{label:U.f.VEHICLE,style:{},children:[Object(B.jsx)("b",{children:null===x||void 0===x?void 0:x.registry})," ",(null===x||void 0===x?void 0:x.displayName)||"-"]}),Object(B.jsx)(dt.b.Item,{label:U.f.IMEI,style:{},children:(null===x||void 0===x||null===(n=x.state)||void 0===n?void 0:n.imei)||"-"}),Object(B.jsx)(dt.b.Item,{label:U.f.BENEFIT_TYPE,style:{},children:null!==x&&void 0!==x&&x.isTracker?"Utrustning":U.k[null===x||void 0===x?void 0:x.benefitType]}),Object(B.jsx)(dt.b.Item,{label:U.f.CURRENT_DRIVER,style:{},children:(null===x||void 0===x||null===(a=x.currentDriver)||void 0===a?void 0:a.displayName)||U.f.NO_DRIVER}),Object(B.jsx)(dt.b.Item,{label:U.f.DEFAULT,style:{width:"25%"},children:U.m[(null===x||void 0===x?void 0:x.defaultTripType)||"-"]}),Object(B.jsx)(dt.b.Item,{label:U.f.PRIMARY_DRIVER,style:{width:"25%"},children:(null===x||void 0===x||null===(l=x.defaultDriver)||void 0===l?void 0:l.displayName)||U.f.NO_DRIVER}),Object(B.jsx)(dt.b.Item,{label:U.f.ICON,style:{},children:Object(B.jsxs)(zi.b,{align:"baseline",children:[Object(B.jsx)(Ui.a,{style:{backgroundColor:null===x||void 0===x||null===(r=x.style)||void 0===r?void 0:r.color},children:null!==x&&void 0!==x&&null!==(u=x.style)&&void 0!==u&&u.marker?Object(B.jsx)(d.a,{marker:(e=>{let t=e;return e.constructor===String&&(t=d.h[t]),t})(null===x||void 0===x||null===(v=x.style)||void 0===v?void 0:v.marker)}):"-"}),S&&"Privat resa - visas ej p\xe5 karta"]})}),null!==x&&void 0!==x&&x.isTracker?null:Object(B.jsx)(dt.b.Item,{label:U.f.PERMITTED_DRIVERS,style:{minWidth:0},children:Object(B.jsx)(le,{value:_,record:x})}),Object(B.jsx)(dt.b.Item,{label:U.f.LAST_SEEN,style:{minWidth:0},children:null!==(null===x||void 0===x?void 0:x.lastSeen)?Object(B.jsx)(We.a,{value:null===x||void 0===x?void 0:x.lastSeen,typ:"map",isTracker:null===x||void 0===x?void 0:x.isTracker}):"-"}),null!==x&&void 0!==x&&x.isTracker?null:Object(B.jsx)(dt.b.Item,{label:"Respons frekvens",style:{minWidth:0},children:(null===x||void 0===x?void 0:x.latestResponseFrequency)||"-"}),null!==x&&void 0!==x&&x.isTracker?null:Object(B.jsx)(dt.b.Item,{label:"M\xe4tarst\xe4llning",style:{minWidth:0},children:D?Object(B.jsx)(re.f,{visible:D,onCancel:()=>L(!1),record:x,updateOdometer:null===x||void 0===x?void 0:x.state.odometer}):Object(B.jsx)("div",{children:null!==x&&void 0!==x&&null!==(j=x.state)&&void 0!==j&&j.odometer?Object(B.jsxs)(zi.b,{children:[Object(B.jsx)(Yi,{children:Object(Gi.a)(x)}),Object(B.jsx)(h.a,{type:"link",icon:Object(B.jsx)(oe.a,{}),onClick:()=>{L(!0)}})]}):"-"})}),Object(B.jsx)(dt.b.Item,{label:"Landskod",style:{minWidth:0},children:null!==(null===x||void 0===x?void 0:x.isoCountryCode)?Object(B.jsxs)(zi.b,{size:8,children:[Object(B.jsx)(Ui.a,{src:"".concat(d.c).concat(null===x||void 0===x||null===(p=x.isoCountryCode)||void 0===p?void 0:p.toLowerCase(),".svg")}),Object(B.jsx)(Yi,{children:null===x||void 0===x?void 0:x.isoCountryCode})]}):"-"}),null!==x&&void 0!==x&&x.isTracker?null:Object(B.jsx)(dt.b.Item,{label:"Br\xe4nsletyp / Br\xe4nslef\xf6rbrukning",style:{minWidth:0},children:null!==(null===x||void 0===x?void 0:x.fuel1)?Object(d.f)(null===x||void 0===x?void 0:x.hybrid,(ve=null===x||void 0===x?void 0:x.fuel1,je=null===x||void 0===x?void 0:x.fuel2,{fuel1:ve,fuel2:je}),(ce=null===x||void 0===x?void 0:x.consumption1,ue=null===x||void 0===x?void 0:x.consumption2,{consumption1:ce,consumption2:ue})):"-"}),x.isTracker?null:Object(B.jsx)(dt.b.Item,{label:"CO2 utsl\xe4pp",style:{minWidth:0},children:null!==(null===x||void 0===x?void 0:x.co2GKm1)?Object(d.e)(null===x||void 0===x?void 0:x.hybrid,(se=null===x||void 0===x?void 0:x.co2GKm1,de=null===x||void 0===x?void 0:x.co2GKm2,{co2GKm1:se,co2GKm2:de})):"-"})]})]}):Object(B.jsx)(o.a,{})});var se,de,ce,ue,ve,je};var qi=()=>Object(B.jsx)(c.b,{children:Object(B.jsx)(Tt.b,{children:Object(B.jsx)(c.w,{children:Object(B.jsx)(c.u,{children:Object(B.jsx)(c.o,{children:Object(B.jsx)(at,{children:Object(B.jsx)(c.l.provider,{children:Object(B.jsx)(c.k,{children:Object(B.jsx)(Ki,{})})})})})})})})}),Ji=n(377),Qi=n(932),Zi=n(927),Xi=n(997),$i=n(998),ea=n(929),ta=n(191),na=n(36);n(258),n(883),n(884);const ia=a.a.createContext(null),aa=e=>{const[t,n]=Object(i.useState)(),[a,l]=Object(i.useState)(),[r,o]=Object(i.useState)(!0),[s,d]=Object(i.useState)(),[c,u]=Object(i.useState)("");Object(i.useEffect)((()=>{F.a.getDevices().then((e=>{console.log(e),n(e),l(e),o(!1)}))}),[]);return Object(i.useEffect)((()=>{var e;let n=t;var i;(c.length>1&&(n=null===(e=n)||void 0===e?void 0:e.filter((e=>JSON.stringify(e).toLowerCase().includes(c)))),(null===s||void 0===s?void 0:s.length)>0)&&(n=null===(i=n)||void 0===i?void 0:i.filter((e=>s.includes(e.organizationId))));l(n)}),[c,t,s]),Object(B.jsx)(ia.Provider,{value:{filteredList:a,selectedOrganization:s,handleChange:e=>{u(e.target.value.toLowerCase())},organizationSelectOnChange:e=>{d(e)},loading:r,setLoading:o,searchTerm:c},children:e.children})},la={FMB001:"Plug-n-drive",FMT100:"Plug-n-drive",FMC001:"Plug-n-drive",TAT100:"GPS-tracker",FMB920:"Anl\xe4ggningsmaskin",FMM001:"Bert \xc5kes Test FMM"},{Search:ra}=C.a,oa={labelCol:{span:4},wrapperCol:{span:24}},sa={types:{email:"Not a validate email!"}},da="tempus egestas sed sed risus pretium quam vulputate dignissim suspendisse in est ante in nibh mauris cursus mattis molestie a iaculis at erat pellentesque adipiscing commodo elit at imperdiet dui",ca=[{id:45,category:"POOLCAR",registry:"abc123"},{id:46,category:"POOLCAR",registry:"tdr344"},{id:47,category:"POOLCAR",registry:"mkl432"}],ua=[];ca.map(((e,t)=>{var n;ua.push(Object(B.jsx)(ta.a,{value:t,children:null===(n=e.registry)||void 0===n?void 0:n.toUpperCase()}))}));const va=[];Object.entries(la).map((e=>{let[t,n]=e;va.push(Object(B.jsxs)(ta.a,{value:t,children:[t," ",n]}))}));Object(Ji.a)((e=>{var t,n;return null===(t=e.nav)||void 0===t||null===(n=t.devices)||void 0===n?void 0:n.data}),(e=>{const t={};return e?(e.forEach((e=>{t[e.id]={...e,iccid:e.iccid?e.iccid:"iccid-todo",phone:e.phone?e.phone:"-",displayName:la[e.deviceType],installedVehicle:e.installedVehicle?{id:e.installedVehicle,registry:"DEM000",category:"POOLCAR"}:null}})),t):t}));const ja=e=>{let{devices:t,vehicles:n,organizations:a,editDevice:l,createDevice:r}=e;t=Object.entries(t).map((e=>{let[t,i]=e;const l=null===n||void 0===n?void 0:n.find((e=>e.id===i.installedVehicle)),r=null===a||void 0===a?void 0:a.find((e=>e.organizationId===i.organizationId));return{...i,installedVehicle:{id:null===l||void 0===l?void 0:l.id,registry:null===l||void 0===l?void 0:l.registry,displayName:null===l||void 0===l?void 0:l.displayName},driver:{currentDriver:null===l||void 0===l?void 0:l.currentDriver,defaultDriver:null===l||void 0===l?void 0:l.defaultDriver},organization:{organizationId:null===r||void 0===r?void 0:r.organizationId,fullName:null===r||void 0===r?void 0:r.fullName}}}));const[o,s]=Object(i.useState)(!1),[d,c]=Object(i.useState)(!1),[u,v]=Object(i.useState)(!1),[j,p]=Object(i.useState)(!1),[b,O]=Object(i.useState)(),m=()=>{s(!o)},g=()=>{c(!d)},f=()=>{v(!u)},x=[{key:"organizationId",dataIndex:"organizationId",title:"Kopplad till",render:e=>{const t=null===a||void 0===a?void 0:a.find((t=>t.organizationId===e));return Object(B.jsx)("div",{children:Object(B.jsx)(na.a,{children:null===t||void 0===t?void 0:t.fullName})})}},{key:"identity",dataIndex:"identity",title:"Identitet",render:(e,t)=>Object(B.jsxs)("div",{children:[Object(B.jsx)(na.a,{children:null===t||void 0===t?void 0:t.imei}),Object(B.jsx)("br",{}),Object(B.jsx)(na.a,{type:"secondary",children:null===t||void 0===t?void 0:t.iccid})]})},{key:"deviceType",dataIndex:"deviceType",title:"Typ av enhet",render:(e,t)=>Object.entries(la).map((t=>{let[n,i]=t;if(n===e)return Object(B.jsxs)("div",{children:[i,Object(B.jsx)("br",{}),Object(B.jsxs)(na.a,{type:"secondary",children:[" ",e," "]})]})}))},{key:"status",dataIndex:"status",title:"Batteri",render:e=>{let t="";return e.latestBatteryLevel||(e.latestBatteryLevel=0),t=(null===e||void 0===e?void 0:e.latestBatteryLevel)<=20?"#ff6b72":(null===e||void 0===e?void 0:e.latestBatteryLevel)>=20&&(null===e||void 0===e?void 0:e.latestBatteryLevel)<=50?"#ffc542":(null===e||void 0===e?void 0:e.latestBatteryLevel)>=50&&(null===e||void 0===e?void 0:e.latestBatteryLevel)<80?"#3e82f7":"#04d182",Object(B.jsx)(Sn.a,{type:"dashboard",percent:null===e||void 0===e?void 0:e.latestBatteryLevel,strokeColor:t,width:40,strokeWidth:10})}},{key:"status",dataIndex:"status",title:"S\xe5gs senast",render:e=>null!==e&&void 0!==e&&e.timestampMs?Object(B.jsx)("div",{children:Object(B.jsx)(We.a,{value:null===e||void 0===e?void 0:e.timestampMs,typ:"map"})}):"\u2013"},{key:"installedVehicle",dataIndex:"installedVehicle",title:"Fordon",render:(e,t)=>{var n;return e?Object(B.jsxs)("div",{children:[Object(B.jsx)(na.a,{children:null===e||void 0===e||null===(n=e.registry)||void 0===n?void 0:n.toUpperCase()}),Object(B.jsx)("br",{}),Object(B.jsx)(na.a,{type:"secondary",children:null===e||void 0===e?void 0:e.displayName})]}):"-"}},{key:"tools",title:"Verktyg",width:540,render:(e,t)=>Object(B.jsxs)("span",{children:[Object(B.jsx)(h.a,{type:"link",icon:Object(B.jsx)(Qi.a,{}),size:"small",onClick:()=>{O(t),m()},children:"Install. info"}),Object(B.jsx)(Fe.a,{type:"vertical"}),Object(B.jsx)(h.a,{danger:!0,type:"link",icon:Object(B.jsx)(Zi.a,{}),size:"small",onClick:()=>{O(t),g()},children:"Felanm\xe4lan"}),Object(B.jsx)(Fe.a,{type:"vertical"}),Object(B.jsx)(h.a,{type:"link",icon:Object(B.jsx)(Xi.a,{}),style:{color:"#04d182"},size:"small",onClick:()=>{O(t),f()},children:"Omstart"})]})}];Object(bi.c)();return Object(B.jsxs)("div",{children:[Object(B.jsx)(ha,{visible:o,hidden:m,deviceInfo:b}),Object(B.jsx)(pa,{visible:d,hidden:g,deviceInfo:b}),Object(B.jsx)(Oa,{visible:j,hidden:()=>{p(!j)}}),Object(B.jsx)(ba,{visible:u,hidden:f,confirm:()=>{f(),(e=>{var t,n;console.log("-> sDeviceVehicleId",e);const i=null===e||void 0===e||null===(t=e.installedVehicle)||void 0===t?void 0:t.id,a=null===e||void 0===e||null===(n=e.organization)||void 0===n?void 0:n.organizationId;console.log("-> sDeviceOrgId",a),F.a.vehicleCpuReset(a||null,i)})(b)}}),Object(B.jsx)(M.a,{dataSource:t,scroll:{x:!0},columns:x,tableLayout:"fixed"})]})},ha=e=>{let{visible:t,hidden:n,deviceInfo:i}=e;return Object(B.jsxs)(Ut.a,{title:"Installation information",visible:t,onCancel:n,footer:[null],children:[Object(B.jsxs)(Ve.a,{justify:"space-between",children:[Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"Aktiverad"}),Object(B.jsx)(We.a,{value:null===i||void 0===i?void 0:i.physicalInstallTimestamp,typ:"map"})]})}),Object(B.jsx)(Fe.a,{type:"vertical",className:"modal-divider"}),Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"Enhet typ"}),Object(B.jsx)(na.a,{type:"secondary",children:Object.entries(la).map((e=>{let[t,n]=e;if(t===(null===i||void 0===i?void 0:i.deviceType))return n}))})]})}),Object(B.jsx)(Fe.a,{type:"vertical",className:"modal-divider"}),Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"Typ av installation"}),Object(B.jsx)(na.a,{type:"secondary",children:null===i||void 0===i?void 0:i.currentInstallationLocation})]})})]}),Object(B.jsxs)(Ve.a,{justify:"start",style:{marginTop:"24px"},gutter:16,children:[Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"IMEI"}),Object(B.jsx)(na.a,{type:"secondary",children:null===i||void 0===i?void 0:i.imei})]})}),Object(B.jsx)(Fe.a,{type:"vertical",className:"modal-divider"}),Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"ICCID"}),Object(B.jsx)(na.a,{type:"secondary",children:null===i||void 0===i?void 0:i.iccid})]})})]})]})},pa=e=>{var t,n,i,a,l,r,o,s,d,c,v,j,p;let{visible:b,hidden:O,deviceInfo:m}=e;const[g]=u.a.useForm();return Object(B.jsxs)(Ut.a,{title:"Felanm\xe4lan",visible:b,onCancel:O,footer:[null],children:[Object(B.jsxs)(Ve.a,{justify:"space-between",align:"start",children:[Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"Kopplat till"}),Object(B.jsx)(na.a,{type:"secondary",children:null===m||void 0===m||null===(t=m.organization)||void 0===t?void 0:t.fullName})]})}),Object(B.jsx)(Fe.a,{type:"vertical",className:"modal-divider"}),Object(B.jsx)(Me.a,{children:Object(B.jsxs)(S.a,{flexDirection:"column",children:[Object(B.jsx)("h5",{children:"Fordon"}),Object(B.jsx)(na.a,{children:null===m||void 0===m||null===(n=m.installedVehicle)||void 0===n||null===(i=n.registry)||void 0===i?void 0:i.toUpperCase()}),Object(B.jsx)(na.a,{type:"secondary",children:null===m||void 0===m||null===(a=m.installedVehicle)||void 0===a?void 0:a.displayName})]})}),Object(B.jsx)(Fe.a,{type:"vertical",className:"modal-divider"}),Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"Kategory"}),Object(B.jsx)(na.a,{type:"secondary",children:null===m||void 0===m||null===(l=m.installedVehicle)||void 0===l?void 0:l.category})]})})]}),Object(B.jsxs)(Ve.a,{justify:"space-between",style:{marginTop:"24px"},gutter:16,children:[Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"Prim\xe4r F\xf6rare"}),Object(B.jsx)(na.a,{type:"secondary",children:null===m||void 0===m||null===(r=m.driver)||void 0===r||null===(o=r.defaultDriver)||void 0===o?void 0:o.displayName})]})}),Object(B.jsx)(Fe.a,{type:"vertical",className:"modal-divider"}),Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"Incheckad F\xf6rare"}),Object(B.jsx)(na.a,{type:"secondary",children:null===m||void 0===m||null===(s=m.driver)||void 0===s||null===(d=s.currentDriver)||void 0===d?void 0:d.displayName})]})}),Object(B.jsx)(Fe.a,{type:"vertical",className:"modal-divider"}),Object(B.jsx)(Me.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{children:"Larm"}),null!==m&&void 0!==m&&null!==(c=m.functional)&&void 0!==c&&c.alarm?Object(B.jsxs)("div",{children:[Object(B.jsx)($i.a,{style:{color:(null===m||void 0===m||null===(v=m.functional)||void 0===v?void 0:v.alarm)>=6?"#ff6b72":"#ffc542"}}),Object(B.jsxs)(na.a,{type:"secondary",style:{marginLeft:"8px",color:(null===m||void 0===m||null===(j=m.functional)||void 0===j?void 0:j.alarm)>=6?"#ff6b72":"#ffc542"},children:[null===m||void 0===m||null===(p=m.functional)||void 0===p?void 0:p.alarm," larm"]})]}):Object(B.jsxs)("div",{children:[Object(B.jsx)(ea.a,{style:{color:"#04d182"}}),Object(B.jsx)(na.a,{type:"secondary",style:{marginLeft:"8px"},children:"inga larm"})]})]})})]}),Object(B.jsx)(Fe.a,{}),Object(B.jsx)("h5",{children:"Meddelande"}),Object(B.jsxs)(u.a,{...oa,name:"nest-messages",validateMessages:sa,layout:"vertical",style:{marginTop:"16px"},onFinish:e=>{e.body="Enhet "+m.imei+" Meddelande: "+e.body,F.b.postReportTrackson(e).then((e=>{$.b.success("Din felanm\xe4lan har skickats!"),g.resetFields()})),console.log("Success:",e)},children:[Object(B.jsx)(u.a.Item,{label:"Titel",name:"subject",rules:[{required:!0,message:"Ange titel!"}],children:Object(B.jsx)(C.a,{placeholder:"t.ex. ABC123 har l\xe5g batteriniv\xe5"})}),Object(B.jsx)(u.a.Item,{label:"Beskrivning",name:"body",rules:[{required:!1,message:"Please input description!"}],children:Object(B.jsx)(C.a.TextArea,{rows:8,placeholder:"t.ex. Batteriniv\xe5 var l\xe5g p\xe5 morgonen"})}),Object(B.jsx)(u.a.Item,{label:"Din E-post",name:"addrFrom",rules:[{required:!0,message:"Ange E-post"}],children:Object(B.jsx)(C.a,{placeholder:"min-epost@example.com"})}),Object(B.jsx)(u.a.Item,{label:"Ditt Telefonnummer",name:"phone",rules:[{required:!0,message:"Ange telefonnummer"}],children:Object(B.jsx)(C.a,{placeholder:"0707..."})}),Object(B.jsx)(u.a.Item,{wrapperCol:{...oa.wrapperCol},style:{textAlign:"right"},children:Object(B.jsx)(h.a,{type:"primary",htmlType:"submit",style:{borderRadius:"4px"},children:"Skicka"})})]})]})},ba=e=>{let{visible:t,hidden:n,confirm:i}=e;return Object(B.jsx)(Ut.a,{title:"Omstart",visible:t,onCancel:n,className:"restart-modal",footer:[Object(B.jsx)(h.a,{onClick:n,className:"cancel-btn",children:"Avbryt"},"cancel"),Object(B.jsx)(h.a,{type:"primary",className:"confirm-btn",onClick:i,children:"Starta om"},"next")],children:Object(B.jsxs)(S.a,{flexDirection:"column",alignItems:"center",children:[Object(B.jsx)($i.a,{style:{color:"#ffc542",fontSize:"40px"}}),Object(B.jsx)("h1",{children:"Varning"}),Object(B.jsx)("p",{children:"\xc4r du s\xe4ker p\xe5 att du vill starta om enheten?"})]})})},Oa=e=>{let{visible:t,hidden:n}=e;return Object(B.jsxs)(Ut.a,{title:"\xc4ndra",visible:t,onCancel:n,footer:[null],width:640,children:[Object(B.jsxs)("div",{className:"change-instruction",children:[Object(B.jsx)("h5",{children:"Flytta enhet till annat fordon"}),Object(B.jsx)("div",{className:"description",children:Object(B.jsx)("ul",{children:Object(B.jsx)("li",{children:Object(B.jsx)("p",{children:da})})})})]}),Object(B.jsxs)("div",{className:"change-instruction",children:[Object(B.jsx)("h5",{children:"Ers\xe4tta defekt enhet"}),Object(B.jsx)("div",{className:"description",children:Object(B.jsx)("ul",{children:Object(B.jsx)("li",{children:Object(B.jsx)("p",{children:da})})})})]}),Object(B.jsxs)("div",{className:"change-instruction",children:[Object(B.jsx)("h5",{children:"Byta enhet mellan tv\xe5 fordon"}),Object(B.jsx)("div",{className:"description",children:Object(B.jsx)("ul",{children:Object(B.jsx)("li",{children:Object(B.jsx)("p",{children:da})})})})]}),Object(B.jsxs)("div",{className:"change-instruction",children:[Object(B.jsx)("h5",{children:"Pensionera enhet"}),Object(B.jsx)("div",{className:"description",children:Object(B.jsx)("ul",{children:Object(B.jsx)("li",{children:Object(B.jsx)("p",{children:da})})})})]})]})},ma=()=>{const[e,t]=Object(i.useState)(!1),n=Object(i.useContext)(c.v),a=Object(i.useContext)(c.f),{filteredList:l,selectedOrganization:r,handleChange:s,organizationSelectOnChange:d,loading:u,searchTerm:j}=Object(i.useContext)(ia);return u?Object(B.jsx)(o.a,{}):Object(B.jsxs)("div",{children:[Object(B.jsx)(ga,{visible:e,onCancel:()=>{t(!1)},handleAdd:function(e,t){}}),Object(B.jsx)("div",{className:"table-container",children:Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[Object(B.jsx)(v.a.Title,{children:"Enheter"}),Object(B.jsxs)("div",{style:{display:"flex",gap:15},children:[(null===a||void 0===a?void 0:a.length)<2?null:Object(B.jsx)(Z.a,{data:a,onChange:d,selectedOrganization:r,isMultiple:!0}),Object(B.jsx)(C.a.Search,{type:"text",placeholder:"S\xf6k enhet",defaultValue:j,enterButton:!0,onChange:s,style:{width:300}})]})]})}),Object(B.jsx)(ja,{devices:l,vehicles:n,organizations:a,editDevice:e=>(console.log("device has been edited"),!0),createDevice:e=>{}})]})},ga=e=>{let{visible:t,onCancel:n,handleAdd:a}=e;const[l]=u.a.useForm(),r=Object(i.useRef)();Object(i.useEffect)((()=>{r.current=t}),[t]);const o=r.current;Object(i.useEffect)((()=>{console.log(t,o),!t&&o&&l.resetFields()}),[t]);return Object(B.jsx)(Ut.a,{title:"L\xe4gg till ny enhet",visible:t,onOk:e=>{l.submit()},onCancel:n,children:Object(B.jsxs)(u.a,{form:l,onFinish:e=>{console.log(e),(e=>{console.log("new device added",e),e.imei,e.deviceType,ca[null===e||void 0===e?void 0:e.installedVehicle],null===ca||void 0===ca||ca.iccid,null===ca||void 0===ca||ca.phone,console.log("FIX DEVICE POST")})(e),n()},layout:"vertical",name:"userForm",children:[Object(B.jsx)(u.a.Item,{name:"imei",label:"IMEI",rules:[{required:!0,message:"Ange IMEI nr!"}],children:Object(B.jsx)(C.a,{placeholder:"1234567898765432"})}),Object(B.jsx)(u.a.Item,{name:"deviceType",label:"Typ av enhet",rules:[{required:!0,message:"V\xe4lj typ av enhet!"}],children:Object(B.jsx)(k.a,{children:va})}),Object(B.jsx)(u.a.Item,{name:"iccid",label:"ICCID",rules:[{required:!0,message:"Ange ICCID nr!"}],children:Object(B.jsx)(C.a,{placeholder:"1234567898765432"})}),Object(B.jsx)(u.a.Item,{name:"phone",label:"Telefonnummer",rules:[{required:!0,message:"Ange telefonnummer!"}],children:Object(B.jsx)(C.a,{placeholder:"1234567898765432"})}),Object(B.jsx)(u.a.Item,{name:"installedVehicle",label:"Ansluten till bilen",rules:[{required:!1}],children:Object(B.jsx)(k.a,{children:ua})})]})})};var fa=()=>Object(B.jsx)(Vt.a,{wrappers:[c.w,aa,c.g,c.d],children:Object(B.jsx)(ma,{})}),xa=n(190);const ya={scheduleForm:{display:"flex",flexDirection:"row",gap:40},selectDay:{width:80,margin:0},column:{width:"50%",minWidth:400},input:{width:"50%"},button:{width:"50%",marginRight:0,justifyContent:"flex-end"},saveButton:{display:"flex",justifyContent:"flex-end",margin:"15px"},interval:{display:"flex",gap:15,alignItems:"center"},paragraph:{margin:0,fontSize:"18px"}},{Option:Ea}=k.a,{Title:Ia}=v.a,Sa=e=>{const[t]=u.a.useForm(),[n,a]=Object(i.useState)(Ta),[l,o]=Object(i.useState)([]),[s,d]=Object(i.useState)([]),[c,v]=Object(i.useState)([]),[j,p]=Object(i.useState)(!0),[b,O]=Object(i.useState)();Object(i.useEffect)((()=>{o([]),d([])}),[e.selectedOrganization,b]),Object(i.useEffect)((()=>{!function(){let e;switch(b){case H.n.SUMMARY_VEHICLE:e={vehicles:!0,drivers:!1};break;case H.n.SUMMARY_DRIVER:case H.n.SALARY:e={vehicles:!1,drivers:!0};break;default:e=Ta}a(e)}()}),[b]),Object(i.useEffect)((()=>{(null===c||void 0===c?void 0:c.length)>0&&((null===l||void 0===l?void 0:l.length)>0||s.length>0)?p(!1):p(!0)}),[c,l,s]);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Ia,{level:3,children:U.f.CREATE_NEW_SCHEDULE}),Object(B.jsx)(u.a,{form:t,onFinish:n=>{const i=[];c.map((e=>{i.push(e.email)}));const a=localStorage.getItem(w.e),u=Te.a.tz.guess();(t=>{if(l.length>0){const n=null===l||void 0===l?void 0:l.some((e=>"string"===typeof e));if(null!==l&&void 0!==l&&l.includes("-1")){const n=[],i=null===l||void 0===l?void 0:l.filter((e=>Number.isInteger(e)));for(let t of null===e||void 0===e?void 0:e.knownVehicles)for(let e of i)(null===t||void 0===t?void 0:t.id)===e&&n.push(t.organizationId);t.reportTarget=null,t.reportTargetOrganizations=n}if(n&&(null===l||void 0===l||!l.includes("-1"))){const n=[],i=[],a=[];l.filter((e=>"string"===typeof e)).map((e=>e.replace("org:",""))).forEach((e=>n.push(Number(e))));for(let t of l)if("string"!==typeof r)for(let n of e.knownVehicles)t===n.id&&i.push(n);i.filter((e=>!n.includes(e.organizationId))).forEach((e=>a.push(e.id))),t.reportTarget=a,t.reportTargetOrganizations=n}}if(s.length>0){const n=null===s||void 0===s?void 0:s.some((e=>"string"===typeof e));if(null!==s&&void 0!==s&&s.includes("-1")){const n=[],i=null===s||void 0===s?void 0:s.filter((e=>Number.isInteger(e)));for(let t of null===e||void 0===e?void 0:e.knownUsers)for(let e of i)(null===t||void 0===t?void 0:t.userId)===e&&n.push(t.organizationId);t.reportTargetDrivers=null,t.reportTargetDriverOrganizations=n}if(n&&(null===s||void 0===s||!s.includes("-1"))){const n=[],i=[],a=[];s.filter((e=>"string"===typeof e)).map((e=>e.replace("org:",""))).forEach((e=>n.push(Number(e))));for(let t of s)if("string"!==typeof r)for(let n of e.knownUsers)t===n.userId&&i.push(n);i.filter((e=>!n.includes(e.organizationId))).forEach((e=>a.push(e.userId))),t.reportTargetDrivers=a,t.reportTargetDriverOrganizations=n}}F.a.postReport(t).then((t=>{e.setKnownReports([...e.knownReports,t]),$.b.success(U.f.REPORT_CREATED)})),setTimeout((()=>{window.location.reload()}),150)})({schedule:n.schedule,name:n.name,reportType:n.reportType,reportTarget:l.filter((e=>Number.isInteger(e))),reportTargetDrivers:s.filter((e=>Number.isInteger(e))),email:i,organizationId:e.selectedOrganization||a,zoneId:u}),null===t||void 0===t||t.resetFields(),o([]),d([]),v([]),O(null)},children:Object(B.jsxs)("div",{style:ya.scheduleForm,children:[Object(B.jsxs)("div",{style:ya.column,children:[Object(B.jsx)(ka,{setReportType:O}),n.vehicles&&Object(B.jsx)(Q,{showTitle:U.f.CHOOSE_VEHICLES,checkedKeys:l,setCheckedKeys:o,knownVehicles:e.knownVehicles,knownOrganizations:e.knownOrganizations,selectedOrganization:e.selectedOrganization,targetOrganizations:!0}),n.drivers&&Object(B.jsx)(Q,{showTitle:U.f.CHOOSE_DRIVERS,checkedKeys:s,setCheckedKeys:d,knownVehicles:e.knownUsers,drivers:!0,knownOrganizations:e.knownOrganizations,selectedOrganization:e.selectedOrganization})]}),Object(B.jsxs)("div",{style:ya.column,children:[Object(B.jsx)(J,{emailData:c,setEmailData:v}),Object(B.jsx)(_a,{}),Object(B.jsx)(Fe.a,{dashed:!0}),Object(B.jsx)(Ca,{}),Object(B.jsx)("div",{style:ya.saveButton,children:Object(B.jsx)(h.a,{htmlType:"submit",type:"primary",disabled:j,children:U.f.CREATE_NEW_SCHEDULE})})]})]})})]})};let Ta={vehicles:!0,drivers:!0};const ka=e=>{let{setReportType:t}=e;return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Ia,{level:4,children:U.f.REPORTS_TYPE}),Object(B.jsx)(u.a.Item,{name:H.k.reportType,initialValue:"JOURNAL",children:Object(B.jsx)(k.a,{style:{width:"50%"},onChange:function(e){t(e)},children:Object.entries(U.l).map((e=>{let[t,n]=e;return Object(B.jsx)(Ea,{value:t,children:n})}))})})]})},Ca=()=>{let e=U.f.MONTHLY_REPORT;return Object(B.jsxs)("div",{children:[Object(B.jsx)(Ia,{level:4,children:U.f.ALIAS}),Object(B.jsx)(u.a.Item,{name:H.k.name,initialValue:e,children:Object(B.jsx)(C.a,{style:ya.input,placeholder:U.f.SUPPLY_AN_ALIAS})})]})},_a=()=>{const e=[];for(let t=1;t<32;t++)e.push(Object(B.jsxs)(Ea,{children:[t,":e"]},t));return Object(B.jsxs)("div",{children:[Object(B.jsx)(Ia,{level:4,children:U.f.TIMEPOINT}),Object(B.jsxs)("div",{style:ya.interval,children:[Object(B.jsx)("p",{style:ya.paragraph,children:U.f.THIS}),Object(B.jsx)(u.a.Item,{name:H.k.schedule,initialValue:"1",style:ya.selectDay,children:Object(B.jsx)(k.a,{onChange:function(e){},children:e})}),Object(B.jsx)("p",{style:ya.paragraph,children:U.f.EVERY_MONTH})]})]})},{Title:Aa}=v.a,Na=e=>{const[t,n]=Object(i.useState)([]),[a,l]=Object(i.useState)(e.knownReports),r=Object(i.useContext)(c.z.context);Object(i.useEffect)((()=>{if(l(e.knownReports),e.selectedOrganization){var t;const i=null===(t=e.knownReports)||void 0===t?void 0:t.filter((t=>t.organizationId===e.selectedOrganization));n(i)}else n(e.knownReports)}),[e.selectedOrganization,a,e.knownReports]);const o=t=>{F.a.deleteReport(t.reportScheduleId).then((n=>{!function(t){const n=null===a||void 0===a?void 0:a.filter((e=>(null===e||void 0===e?void 0:e.reportScheduleId)!==(null===t||void 0===t?void 0:t.reportScheduleId)));l(n),e.setKnownReports(n),$.b.success(U.f.REPORT_DELETED)}(t)}))};const s=[{title:U.f.ORGANIZATION,dataIndex:"organizationId",key:"organizationId",hidden:r,render:t=>{const n=e.knownOrganizations.find((e=>e.organizationId===t));return null===n||void 0===n?void 0:n.fullName}},{title:U.f.REPORTS_TYPE,dataIndex:"reportType",key:"reportType",render:e=>U.l[e]},{title:U.f.ALIAS,dataIndex:"name",key:"name",render:e=>e},{title:U.f.VEHICLE,dataIndex:"reportTarget",key:"reportTarget",width:150,render:(t,n)=>{if((null===(null===n||void 0===n?void 0:n.reportTargetOrganizations)||0===(null===n||void 0===n?void 0:n.reportTargetOrganizations.length))&&0===(null===t||void 0===t?void 0:t.length))return"-";if(1===(null===t||void 0===t?void 0:t.length)&&0===n.reportTargetOrganizations.length){var i,a,l;const n=null===(i=e.knownVehicles)||void 0===i?void 0:i.find((e=>e.id===t[0]));let r="".concat(null===n||void 0===n?void 0:n.displayName," ").concat(null===(null===n||void 0===n?void 0:n.defaultDriver)?"-":null===n||void 0===n||null===(a=n.defaultDriver)||void 0===a?void 0:a.displayName," / ").concat(null===(null===n||void 0===n?void 0:n.currentDriver)?"-":null===n||void 0===n||null===(l=n.currentDriver)||void 0===l?void 0:l.displayName);return Object(B.jsx)(L.a,{title:r,children:Object(B.jsx)(gn.a,{color:H.b.SWITCH_BUSINESS,style:{margin:5},children:null===n||void 0===n?void 0:n.registry})})}if(1===(null===n||void 0===n?void 0:n.reportTargetOrganizations.length)&&0===(null===t||void 0===t?void 0:t.length)){var r;const t=null===n||void 0===n||null===(r=n.reportTargetOrganizations)||void 0===r?void 0:r.map((t=>{var n;const i=null===(n=e.knownOrganizations)||void 0===n?void 0:n.find((e=>e.organizationId===t));return null===i||void 0===i?void 0:i.fullName}));return U.f.ALL_VEHICLES+" inom "+(null===t||void 0===t?void 0:t.map((e=>e+" ")))}if((null===t||void 0===t?void 0:t.length)>0&&0===n.reportTargetOrganizations.length){let n=(null===t||void 0===t?void 0:t.length)+" "+U.f.VEHICLE;return Object(Bt.a)(n,t,null,null,e.knownVehicles,null,e.knownOrganizations)}if((null===t||void 0===t?void 0:t.length)>=0&&n.reportTargetOrganizations.length>0){const i=[];(null===t||void 0===t?void 0:t.length)>0&&(null===t||void 0===t||t.forEach((e=>i.push(e)))),(null===n||void 0===n?void 0:n.reportTargetOrganizations.length)>0&&(null===n||void 0===n||n.reportTargetOrganizations.forEach((t=>{null===e||void 0===e||e.knownVehicles.filter((e=>e.organizationId===t)).forEach((e=>i.push(e.id)))})));let a=(null===i||void 0===i?void 0:i.length)+" "+U.f.VEHICLE;return Object(Bt.a)(a,i,null,null,e.knownVehicles,null,e.knownOrganizations)}}},{title:U.f.DRIVER,dataIndex:"reportTargetDrivers",key:"reportTargetDrivers",width:150,render:(t,n)=>{if(null===(null===n||void 0===n?void 0:n.reportTargetDriverOrganizations)&&0===(null===t||void 0===t?void 0:t.length))return"-";if(1===(null===t||void 0===t?void 0:t.length)&&0===n.reportTargetDriverOrganizations.length){var i;const n=null===(i=e.knownUsers)||void 0===i?void 0:i.find((e=>e.userId===t[0]));return Object(B.jsx)("a",{children:null===n||void 0===n?void 0:n.displayName})}if(0===(null===t||void 0===t?void 0:t.length)&&0===(null===n||void 0===n?void 0:n.reportTargetDriverOrganizations.length))return"-";if(1===(null===n||void 0===n?void 0:n.reportTargetDriverOrganizations.length)&&0===(null===t||void 0===t?void 0:t.length)){const t=null===e||void 0===e?void 0:e.knownOrganizations.find((e=>e.organizationId===(null===n||void 0===n?void 0:n.reportTargetDriverOrganizations[0])));return"".concat(U.f.ALL_DRIVERS," inom ").concat(null===t||void 0===t?void 0:t.fullName)}if((null===t||void 0===t?void 0:t.length)>0&&0===n.reportTargetDriverOrganizations.length){let n=(null===t||void 0===t?void 0:t.length)+" "+U.f.DRIVER;return Object(Bt.a)(n,null,null,t,null,e.knownUsers,e.knownOrganizations)}if((null===t||void 0===t?void 0:t.length)>=0&&n.reportTargetDriverOrganizations.length>0){const i=[];(null===t||void 0===t?void 0:t.length)>0&&(null===t||void 0===t||t.forEach((e=>i.push(e)))),(null===n||void 0===n?void 0:n.reportTargetDriverOrganizations.length)>0&&(null===n||void 0===n||n.reportTargetDriverOrganizations.forEach((t=>{null===e||void 0===e||e.knownUsers.filter((e=>{e.organizationId===t&&i.push(e.userId)}))})));let a=(null===i||void 0===i?void 0:i.length)+" "+U.f.DRIVER;return Object(Bt.a)(a,null,null,i,null,e.knownUsers,e.knownOrganizations)}}},{title:U.f.MAIL_RECIPIENTS,dataIndex:"email",key:"email",render:e=>{if(1===(null===e||void 0===e?void 0:e.length))return Object(B.jsx)("a",{children:e[0]});if(0===(null===e||void 0===e?void 0:e.length))return"-";{let t=(null===e||void 0===e?void 0:e.length)+" "+U.f.MAIL_RECIPIENTS;return Object(Bt.a)(t,null,e)}}},{title:U.f.SEND_REPORT,dataIndex:"schedule",key:"schedule",render:e=>U.f.THIS+" "+e+":e "+U.f.EVERY_MONTH},{title:"",dataIndex:"operation",width:80,render:(e,t)=>Object(B.jsx)(re.a,{menu:()=>function(e){return Object(B.jsx)(X.a,{children:Object(B.jsxs)(X.a.Item,{danger:!0,icon:Object(B.jsx)(z.a,{}),onClick:()=>o(e),children:[U.f.DELETE," "]})})}(t)})}].filter((e=>!e.hidden));return Object(B.jsxs)("div",{children:[Object(B.jsx)(Aa,{level:3,children:U.f.CURRENT_SCHEDULES}),Object(B.jsx)(M.a,{columns:Object(re.m)(s),scroll:{x:1e3},dataSource:t,rowClassName:"editable-row",...re.n})]})},{Title:Ra}=v.a;var Da=()=>{const{knownUsers:e,knownVehicles:t,knownOrganizations:n,knownReports:a,loading:l,selectedOrganization:r,organizationSelectOnChange:s,setKnownReports:d}=Object(i.useContext)(xa.a);return l?Object(B.jsx)(o.a,{}):Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:[Object(B.jsx)(Ra,{children:U.f.SCHEDULING}),Object(B.jsx)(Z.a,{data:n,onChange:s,selectedOrganization:r,isMultiple:!1})]}),Object(B.jsx)(Fe.a,{}),Object(B.jsx)(Sa,{knownVehicles:t,knownUsers:e,setKnownReports:d,knownReports:a,knownOrganizations:n,selectedOrganization:r}),Object(B.jsx)(Fe.a,{}),Object(B.jsx)(Na,{knownReports:a,knownVehicles:t,knownUsers:e,setKnownReports:d,selectedOrganization:r,knownOrganizations:n})]})};var wa=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.g,c.q,c.w,xa.b],children:Object(B.jsx)(Da,{})}),La=n(999),Pa=n(1e3),Va=n(1001);n(470);const Ma=Object(i.createContext)(null),Fa=e=>{const[t,n]=Object(i.useState)(),[a,l]=Object(i.useState)([]),[r,o]=Object(i.useState)([]),[s,d]=Object(i.useState)([]),[u,v]=Object(i.useState)(),[j,h]=Object(i.useState)(),[p,b]=Object(i.useState)(!1),[O,m]=Object(i.useState)(!1),[g,f]=Object(i.useState)(),[x,y]=Object(i.useState)(!0);let E="YYYY/MM";const I=Object(i.useContext)(c.e.context),S=Object(i.useContext)(c.h);Object(i.useEffect)((()=>{I&&(v(I),T(I,I))}),[I]),Object(i.useEffect)((()=>{S&&f(S.sort(((e,t)=>e.organizationId>t.organizationId?1:-1)))}),[S]),Object(i.useEffect)((()=>{if(!u)return;y(!0);const e=u.split("/");F.a.getReportDriver(e[1],e[0]).then((e=>{n(e),y(!1)}))}),[u]),Object(i.useEffect)((()=>{var e;if(!t)return;let n=t,i=S;var a;(s.length>1&&(n=null===(e=n)||void 0===e?void 0:e.filter((e=>JSON.stringify(e).toLowerCase().includes(s)))),(null===r||void 0===r?void 0:r.length)>0)&&(i=null===(a=i)||void 0===a?void 0:a.filter((e=>null===r||void 0===r?void 0:r.includes(e.organizationId))));f(i),l(n)}),[s,r,t]);const T=(e,t)=>{const n=Te()(e,E).startOf("month").unix(),i=Te()(e,E).endOf("month").unix();v(t),h([n,i])};return Object(B.jsx)(Ma.Provider,{value:{filteredData:a,handleChange:e=>{d(e.target.value.toLowerCase())},setOrganizationId:o,organizationId:r,setSearchTerm:d,timestamp:j,selectedDriverReport:O,organizationData:g,handleChangeShowModal:e=>{b(!p),m(e)},selectedPeriod:u,setSelectedPeriod:v,organizationSelectOnChange:e=>{o(e)},handleUnattestDriver:e=>{const i=null===u||void 0===u?void 0:u.split("/"),a=i[1],l=i[0];F.a.patchAttestUserUnlock(e,a,l).then((i=>{const a=[...t];let l=null===t||void 0===t?void 0:t.findIndex((t=>t.personId===e)),r=t[l];r={...r,attested:!1},a.splice(l,1,{...r}),n(a)}))},showModal:p,onChangeDatePicker:T,updateObject:(e,i,a)=>{const l=[...t],r=l.findIndex((t=>e===t.personId&&i===t.vehicle.vehicleId)),o=l[r];l.splice(r,1,{...o,...a}),n(l)},dateFormat:E,loading:x},children:e.children})};function za(e){const[t,n]=Object(i.useState)(e),a=Object(i.useRef)(t);return a.current=t,[t,n,a]}const Ua=e=>{let{tripId:t,value:n,timeout:a=1e3}=e;const[l,r]=Object(i.useState)(""),[o,s,d]=za(n),[c,v,j]=za(n),h=()=>{"validating"!==l&&null!==d.current&&d.current!==j.current&&F.a.putJournal(t,{adminComment:d.current||""}).then((()=>{r("success"),v(d.current)})).catch((e=>{r("error"),s(n)}))};return Object(i.useEffect)((()=>{const e=setInterval(h,a);return()=>{clearInterval(e)}}),[]),Object(B.jsx)(u.a,{style:{width:140},children:Object(B.jsx)(u.a.Item,{style:{margin:"auto"},hasFeedback:!0,validateStatus:l,children:Object(B.jsx)(C.a,{style:{},value:o,onChange:e=>{r("validating"),s(e.target.value)},placeholder:"Skriv kommentar...",allowClear:!0})})})};function Ba(e){var t;let{visible:n,handleChangeShowModal:a,updateObject:l,driverReport:r,timestemp:s,...d}=e;const c=Object(i.useContext)(ui);let u=c.journalTableData;c.journalTableDataBadTrips;const j=c.loadedJournals,[p,b]=Object(i.useState)(""),[O,m]=Object(i.useState)([]),[g,f]=Object(i.useState)(!1),[x,y]=Object(i.useState)([]);let E=Te.a.tz.guess();const I=[{title:"Datum",dataIndex:"journalKey",key:"journalKey",render:(e,t,n)=>(Te.a.locale(),Te()(e).format("dddd, D MMMM YYYY"))}];let S=[];Object.entries(O).forEach(((e,t)=>{S.push({journalKey:e[0],key:t})})),Object(i.useEffect)((()=>{if(!O)return;let e=[];Object.entries(O).forEach(((t,n)=>{t[1].map((t=>{t.isBadTrip&&e.push(t.journal_id)})),y(e)}))}),[O]),Object(i.useEffect)((()=>{m(u)}),[u]),Object(i.useEffect)((()=>{m(!0===g?c.journalTableDataBadTrips:u)}),[g]),Object(i.useEffect)((()=>{var e;r&&s&&(b(""),y([]),f(!1),c.requestFetchJournals(s[0],s[1],[null===r||void 0===r||null===(e=r.vehicle)||void 0===e?void 0:e.vehicleId],[null===r||void 0===r?void 0:r.personId]))}),[r,s]);const T=()=>{var e;(e=>{var t;let n=[];Object.entries(O).forEach(((e,t)=>{e[1].map((e=>{x.includes(e.journal_id)&&(e.mergedTripsId?n.push(e.mergedTripsId):n.push(e.journal_id))}))})),F.a.putAttestRefuse(p,e[1],e[0],E,null===r||void 0===r?void 0:r.personId,null===r||void 0===r||null===(t=r.vehicle)||void 0===t?void 0:t.vehicleId,n).then((e=>{var t;l(null===r||void 0===r?void 0:r.personId,null===r||void 0===r||null===(t=r.vehicle)||void 0===t?void 0:t.vehicleId,{attested:!1})}))})(null===(e=d.selectedPeriod)||void 0===e?void 0:e.split("/")),a()},k=()=>{var e;(e=>{var t;F.a.putAttestConfirm(p,e[1],e[0],E,null===r||void 0===r?void 0:r.personId,null===r||void 0===r||null===(t=r.vehicle)||void 0===t?void 0:t.vehicleId).then((e=>{var t;l(null===r||void 0===r?void 0:r.personId,null===r||void 0===r||null===(t=r.vehicle)||void 0===t?void 0:t.vehicleId,{adminApproved:!0})}))})(null===(e=d.selectedPeriod)||void 0===e?void 0:e.split("/")),a()},_=x.length>0?{color:"rgb(158, 168, 187)",backgroundColor:"rgb(88, 99, 121)",borderColor:"rgb(77, 91, 117)"}:{color:"#fff",borderColor:H.b.GREEN,backgroundColor:H.b.GREEN};return u?Object(B.jsxs)(Ut.a,{bodyStyle:{overflowY:"auto",maxHeight:"calc(100vh - 250px)"},style:{minWidth:"95%"},title:"Granskning av attesterad k\xf6rjournal",visible:n,footer:[Object(B.jsx)(h.a,{onClick:a,children:"Avbryt"},"1"),Object(B.jsx)(B.Fragment,{children:x.length>0?Object(B.jsx)(h.a,{onClick:T,danger:!0,children:"Avattestera"},"2"):Object(B.jsx)(P.a,{title:"Du har inte flaggat n\xe5gra resor f\xf6r korrigering - vill du avattestera hela m\xe5naden?",onConfirm:T,okText:"OK",cancelText:"Avbryt",children:Object(B.jsx)(h.a,{danger:!0,children:"Avattestera"},"2")})}),Object(B.jsx)(h.a,{onClick:k,style:_,disabled:x.length>0,children:"Godk\xe4nn"},"3")],onCancel:a,children:[Object(B.jsxs)(v.a.Title,{level:2,style:{marginBottom:"2rem"},children:["K\xf6rjournal f\xf6r ",null===r||void 0===r?void 0:r.fullName," (fordon ",null===r||void 0===r||null===(t=r.vehicle)||void 0===t?void 0:t.reg,")"]}),Object(B.jsx)("div",{style:{maxWidth:"900px"},children:Object(B.jsx)("p",{children:"Nedanst\xe5ende k\xf6rjournal \xe4r bekr\xe4ftad och attesterad av f\xf6raren. Efter att ha granskat journalen kan du v\xe4lja att godk\xe4nna eller avattestera journalen. Du kan ocks\xe5 v\xe4lja att skicka med ett meddelande till f\xf6raren (ej obligatoriskt)."})}),Object(B.jsx)(C.a.TextArea,{style:{marginBottom:"30px"},value:p,onChange:e=>b(e.target.value),placeholder:"Meddelande till f\xf6rare...",rows:4}),Object(B.jsxs)("div",{style:{float:"right"},className:"extraModalButtons",children:[Object(B.jsx)(h.a,{style:{marginRight:"8px"},onClick:a,children:"Avbryt"},"1"),Object(B.jsx)(B.Fragment,{children:x.length>0?Object(B.jsx)(h.a,{style:{marginRight:"8px"},onClick:T,danger:!0,children:"Avattestera"},"2"):Object(B.jsx)(P.a,{title:"Du har inte flaggat n\xe5gra resor f\xf6r korrigering - vill du avattestera hela m\xe5naden?",onConfirm:T,okText:"OK",cancelText:"Avbryt",children:Object(B.jsx)(h.a,{style:{marginRight:"8px"},danger:!0,children:"Avattestera"},"2")})}),Object(B.jsx)(h.a,{onClick:k,style:_,disabled:x.length>0,children:"Godk\xe4nn"},"3")]}),Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{children:["Visa bara flaggade resor",Object(B.jsx)(R.a,{style:{marginLeft:20},checked:g,onChange:f})]}),j?S.length>0?Object(B.jsx)(M.a,{columns:I,rowKey:e=>e.key,expandable:{expandedRowRender:e=>Object(B.jsx)(Ga,{selectedRowKeys:x,setSelectedRowKeys:y,record:e,journals:O}),defaultExpandAllRows:!0,expandRowByClick:!0},dataSource:S,pagination:!1}):null:Object(B.jsx)(o.a,{})]})]}):Object(B.jsx)(o.a,{})}const Ga=e=>{let{record:t,journals:n,selectedRowKeys:a,setSelectedRowKeys:l}=e;const r=Object(i.useContext)(c.a),o=null===r||void 0===r?void 0:r.userId,s=null===t||void 0===t?void 0:t.journalKey,d=[{title:"Flaggad",dataIndex:"badTrips",key:"badTrips",width:90,render:(e,t)=>{const n=t.data.journal_id;return Object(B.jsx)(B.Fragment,{children:a.map((e=>Object(B.jsx)(B.Fragment,{children:(n===e)>0&&Object(B.jsx)(Jn.a,{style:{color:"#bf0e0e"}})})))})}},{title:"Tid",dataIndex:"timestamp",key:"timestamp_start_ms",width:"8%",render:(e,t)=>{const{data:n}=t,i=Object(pt.a)(n.trip.timestamp_start_ms,"HH:mm",!1),a=Object(pt.a)(n.trip.timestamp_stop_ms,"HH:mm",!1);return t.data.driver.id===o||"PRIVATE_AUTO"!==t.data.trip.purpose&&"PRIVATE"!==t.data.trip.purpose?Object(B.jsxs)(S.a,{flexDirection:"column",justifyContent:"space-between",children:[Object(B.jsxs)("span",{title:a,children:[Object(B.jsx)("div",{style:{height:"2rem"},children:a})," "]}),Object(B.jsx)("br",{}),Object(B.jsxs)("span",{title:i,children:[Object(B.jsx)("div",{style:{height:"2rem"},children:i})," "]})]}):null}},{title:"Adress",dataIndex:"address",key:"address",render:(e,t)=>{var n,i,a,l,r,s;const d=(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.override_start)||(null===t||void 0===t||null===(i=t.data)||void 0===i||null===(a=i.geocode_start)||void 0===a?void 0:a.format),c=(null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l.override_stop)||(null===t||void 0===t||null===(r=t.data)||void 0===r||null===(s=r.geocode_stop)||void 0===s?void 0:s.format),u={color:"rgb(158, 168, 187)",backgroundColor:"rgb(88, 99, 121)",border:"1px solid rgb(77, 91, 117)",borderRadius:"0.625rem",display:"block",padding:"8.5px 11px"};return Object(B.jsxs)(S.a,{flexDirection:"column",justifyContent:"space-between",style:{whiteSpace:"pre-wrap"},children:[t.data.driver.id===o||"PRIVATE_AUTO"!==t.data.trip.purpose&&"PRIVATE"!==t.data.trip.purpose?Object(B.jsxs)("span",{title:c,children:[Object(B.jsx)("div",{style:{height:"2rem"},children:c})," "]}):Object(B.jsx)("div",{style:u,children:"Privat resa"}),Object(B.jsx)("br",{}),t.data.driver.id===o||"PRIVATE_AUTO"!==t.data.trip.purpose&&"PRIVATE"!==t.data.trip.purpose?Object(B.jsxs)("span",{title:d,children:[Object(B.jsx)("div",{style:{height:"2rem"},children:d})," "]}):Object(B.jsx)("div",{style:u,children:"Privat resa"})]})}},{title:"Restid",dataIndex:"total_time",key:"total_time",width:"8%",render:(e,t)=>{var n,i,a,l;const r=null===t||void 0===t||null===(n=t.data)||void 0===n||null===(i=n.trip)||void 0===i?void 0:i.timestamp_start_ms,o=null===t||void 0===t||null===(a=t.data)||void 0===a||null===(l=a.trip)||void 0===l?void 0:l.timestamp_stop_ms;return Object(B.jsx)("span",{title:Object(pt.c)(o,r),children:Object(pt.c)(o,r)})}},{title:"Avst\xe5nd",dataIndex:"odometer_total",key:"distance",width:"8%",render:(e,t)=>{var n,i;const a=(.001*(null===t||void 0===t||null===(n=t.data)||void 0===n||null===(i=n.trip)||void 0===i?void 0:i.odometer_max)).toFixed(2);return Object(B.jsxs)("span",{title:a+" km",children:[a," km"]})}},{title:"Stopptid",dataIndex:"stopTimeBackwards",key:"stopTimeBackwards",width:"8%",render:(e,t)=>{var n,i,a,l,r,s;let d=t.data.stopTimeBackwards?Object(pt.b)(t.data.stopTimeBackwards):null;return(null===t||void 0===t||null===(n=t.data)||void 0===n||null===(i=n.driver)||void 0===i?void 0:i.id)===o||"PRIVATE"!==(null===t||void 0===t||null===(a=t.data)||void 0===a||null===(l=a.trip)||void 0===l?void 0:l.purpose)&&"PRIVATE"!==(null===t||void 0===t||null===(r=t.data)||void 0===r||null===(s=r.trip)||void 0===s?void 0:s.purpose)?Object(B.jsx)("span",{title:d,children:d}):null}},{title:"M\xe4tarst\xe4llning",dataIndex:"odometer_start",key:"odometers",width:"8%",render:(e,t)=>{var n,i,a,l;const r=Object(pt.d)(((null===t||void 0===t||null===(n=t.data)||void 0===n||null===(i=n.trip)||void 0===i?void 0:i.odometer_stop)/1e3).toFixed(0))+" km",o=Object(pt.d)(((null===t||void 0===t||null===(a=t.data)||void 0===a||null===(l=a.trip)||void 0===l?void 0:l.odometer_start)/1e3).toFixed(0))+" km";return Object(B.jsxs)(S.a,{flexDirection:"column",children:[Object(B.jsx)("span",{title:r,children:r}),Object(B.jsx)("span",{title:o,children:o})]})}},{title:"Syfte",dataIndex:"description",key:"description",width:"8%",render:(e,t)=>{var n,i;const a=null===t||void 0===t||null===(n=t.data)||void 0===n||null===(i=n.trip)||void 0===i?void 0:i.description,l=t.data.trip.purpose.startsWith("BUSINESS");return Object(B.jsxs)(S.a,{flexDirection:"column",justifyContent:"center",alignItems:"start",gap:10,children:[Object(B.jsx)(R.a,{style:{backgroundColor:l?H.b.SWITCH_BUSINESS:H.b.SWITCH_PRIVATE,marginRight:10},checkedChildren:"Tj\xe4nst",unCheckedChildren:"Privat",disabled:!0,checked:l}),Object(B.jsx)("span",{children:a})]})}},{title:"Tskatt",dataIndex:"tax",key:"tax",width:"8%",render:(e,t)=>{var n,i,a,l,r,o,s,d;const c=(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.congestionTaxCount)||(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.congestionTaxSekOverride);let u=null!==(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.congestionTaxSekOverride)?null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l.congestionTaxSekOverride:(null===t||void 0===t||null===(r=t.data)||void 0===r?void 0:r.congestionTaxSek)||0,j=c?li:ri;const h=null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.congestionTaxCount;let p=1===h?"passage":"passager",b=((null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.congestionTaxSek)||"0")+" kr";return Object(B.jsxs)(S.a,{flexDirection:"column",children:[Object(B.jsxs)(S.a,{gap:8,children:[Object(B.jsx)("img",{alt:"Sweden road sign E25",width:23,height:23,src:j}),null!==(null===t||void 0===t||null===(d=t.data)||void 0===d?void 0:d.congestionTaxSekOverride)&&Object(B.jsx)("span",{title:b,children:Object(B.jsx)(v.a.Text,{style:{textDecoration:"line-through"},children:b})}),Object(B.jsx)("span",{title:u+"kr",children:Object(B.jsxs)(v.a.Text,{style:{color:u?H.b.RED:null},children:[u," kr"]})})]}),Object(B.jsx)("span",{title:h?h+" "+p:null,children:h?h+" "+p:null})]})}},{title:"Infra.avg.",dataIndex:"tax",key:"tax",width:"8%",render:(e,t)=>{var n,i,a,l,r,o,s,d;const c=(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.infraTaxSekOverride)||(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.infraTaxCount);let u=null!==(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.infraTaxSekOverride)?null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l.infraTaxSekOverride:(null===t||void 0===t||null===(r=t.data)||void 0===r?void 0:r.infraTaxSek)||0,j=c?li:ri;const h=null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.infraTaxCount;let p=1===h?"passage":"passager",b=((null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.infraTaxSek)||"0")+" kr";return Object(B.jsxs)(S.a,{flexDirection:"column",children:[Object(B.jsxs)(S.a,{gap:8,children:[Object(B.jsx)("img",{alt:"Sweden road sign E25",width:23,height:23,src:j}),null!==(null===t||void 0===t||null===(d=t.data)||void 0===d?void 0:d.infraTaxSekOverride)&&Object(B.jsx)("span",{title:b,children:Object(B.jsx)(v.a.Text,{style:{textDecoration:"line-through"},children:b})}),Object(B.jsx)("span",{title:u+"kr",children:Object(B.jsxs)(v.a.Text,{style:{color:u?H.b.RED:null},children:[u," kr"]})})]}),Object(B.jsx)("span",{title:h?h+" "+p:null,children:h?h+" "+p:null})]})}},{title:"Kommentar",dataIndex:"adminComment",key:"adminComment",width:160,render:(e,t)=>Object(B.jsx)("span",{title:t.data.adminComment,children:Object(B.jsx)(Ua,{tripId:t.data.journal_id,value:t.data.adminComment,o:t})})}],u={preserveSelectedRowKeys:!0,selectedRowKeys:a,onChange:(e,t)=>{l(e)}};let j=[];return s&&void 0!==n[s]&&n[s].length>0&&n[s].forEach(((e,t)=>{j.push({k:e.id,data:{viewChecked:!0,viewSaved:144===e.journal_id,...e}})})),Object(B.jsx)(M.a,{rowKey:e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.journal_id},columns:Object(re.m)(d),dataSource:j,scroll:{x:1200},sticky:{offsetHeader:-30,offsetScroll:0},pagination:!1,rowSelection:{...u}})};var Ha=n(289);const Ya=e=>{var t,n;let{columns:i,filteredData:a,knownOrganizations:l,organization:r,getDriverReport:o,showButton:s}=e,d=null===l||void 0===l||null===(t=l.find((e=>e.organizationId===r.organizationId)))||void 0===t?void 0:t.fullName,c=null===l||void 0===l?void 0:l.find((e=>e.organizationId===r.parentOrganization)),u=null===l||void 0===l?void 0:l.find((e=>e.organizationId===(null===c||void 0===c?void 0:c.parentOrganization))),v=null===l||void 0===l?void 0:l.find((e=>e.organizationId===(null===u||void 0===u?void 0:u.parentOrganization)));a=null===(n=a)||void 0===n?void 0:n.filter((e=>e.organizationId===r.organizationId)),console.log(r);const j=()=>{var e;return Object(B.jsxs)(S.a,{style:{marginBottom:16},justifyContent:"between",alignItems:"center",children:[Object(B.jsxs)(Ha.a,{style:{fontSize:22},children:[Object(B.jsx)(Ha.a.Item,{children:null===v||void 0===v?void 0:v.fullName}),Object(B.jsx)(Ha.a.Item,{children:null===u||void 0===u?void 0:u.fullName}),Object(B.jsx)(Ha.a.Item,{children:null===c||void 0===c?void 0:c.fullName}),Object(B.jsx)(Ha.a.Item,{children:d})]}),s&&Object(B.jsxs)(h.a,{disabled:(null===(e=a)||void 0===e?void 0:e.length)<1,onClick:()=>o(null,a),style:{},children:["Exportera samlad l\xf6nerapport f\xf6r ",d]})]})};return Object(B.jsxs)("div",{style:{marginBottom:"4em"},children:[Object(B.jsx)(j,{}),Object(B.jsx)(M.a,{dataSource:a,pagination:!1,columns:Object(re.m)(i),scroll:{x:1500},...re.n})]})};var Wa=()=>{const{filteredData:e,handleChange:t,organizationId:n,organizationSelectOnChange:a,selectedPeriod:l,timestamp:r,handleChangeShowModal:s,selectedDriverReport:d,showModal:u,updateObject:j,organizationData:p,onChangeDatePicker:b,dateFormat:O,loading:m}=Object(i.useContext)(Ma),g=Object(i.useContext)(c.f),f=Object(i.useContext)(c.a);function x(e,t){var n,i;let a=Te.a.tz.guess(),l=a;let o=Te()().tz(a).format("YYYY-MM-DD")+"_"+((null===e||void 0===e?void 0:e.fullName)||"Alla f\xf6rare")+"_";o=o+U.l.SUMMARY+".pdf",(null===(n=t)||void 0===n?void 0:n.length)>0&&(t=t.map((e=>e.personId))),F.a.getSalaryReports(r[0],r[1],null===e||void 0===e||null===(i=e.vehicle)||void 0===i?void 0:i.vehicleId,o,l,!1,t||e.personId,!0)}const y=e=>{!function(e,t){F.a.putAttestReminder(e[1],t).then((()=>{$.b.success("Meddelande skickat till ".concat(t.fullName))}))}(null===l||void 0===l?void 0:l.split("/"),e)};console.log("date",Te()().endOf("day"));const E=[{title:"F\xf6rare",dataIndex:"fullName",key:"fullName",fixed:"left"},{title:"Fordon",dataIndex:"vehicle",key:"vehicle",fixed:"left",render:e=>(e.reg||"")+(e.full_name?" ("+e.full_name+")":"")},{title:"Resor",dataIndex:"tripCount",key:"tripCount",width:100,align:"right",render:e=>e+" st"},{title:"Privat",dataIndex:"tripDistancePrivate",key:"tripDistancePrivate",align:"right",width:150,render:e=>Object(B.jsx)("span",{style:{color:H.b.GREEN},children:(null===e||void 0===e?void 0:e.toFixed(2))+" km"})},{title:"Tj\xe4nst",dataIndex:"tripDistanceBusiness",key:"tripDistanceBusiness",align:"right",width:150,render:e=>Object(B.jsx)("span",{style:{color:H.b.BLUE},children:(null===e||void 0===e?void 0:e.toFixed(2))+" km"})},{title:"Status",dataIndex:"status",key:"status",width:150,render:(e,t)=>t.adminApproved?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Xn.a,{style:{color:H.b.GREEN}})," Godk\xe4nd"]}):t.refused&&!t.attested?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(La.a,{style:{color:H.b.RED}})," Nekad"]}):t.attested?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Zn.a,{style:{color:H.b.YELLOW}})," Attesterad"]}):t.attested?void 0:Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Pa.a,{})," Ej attesterad"]})},{title:"Verktyg",dataIndex:"reviewOrRemind",key:"reviewOrRemind",align:"right",width:150,render:(e,t)=>{let n=null===f||void 0===f?void 0:f.roles,i=!(null===n||void 0===n||!n.includes("ROOT"));return Object(B.jsxs)(B.Fragment,{children:[t.adminApproved&&t.attested&&i&&Object(B.jsx)(h.a,{icon:Object(B.jsx)(Va.a,{}),onClick:()=>(e=>{var t;const n=null===l||void 0===l?void 0:l.split("/");F.a.putUnapprove("",n[1],n[0],null===e||void 0===e?void 0:e.personId,null===e||void 0===e||null===(t=e.vehicle)||void 0===t?void 0:t.vehicleId,[]).then((()=>{var t;j(null===e||void 0===e?void 0:e.personId,null===e||void 0===e||null===(t=e.vehicle)||void 0===t?void 0:t.vehicleId,{adminApproved:!1})}))})(t),children:"L\xe5s upp"}),!t.adminApproved&&t.attested&&Object(B.jsxs)(h.a,{icon:Object(B.jsx)(Ue.a,{}),onClick:()=>(e=>{s(e)})(t),children:["Granska"," "]}),!t.adminApproved&&!t.attested&&Object(B.jsx)(h.a,{icon:Object(B.jsx)(Xt.a,{}),onClick:()=>y(t),children:"P\xe5minn"})]})}},{title:"Exportera",dataIndex:"isLocked",key:"isLocked",align:"right",width:200,render:(e,t)=>Object(B.jsx)(h.a,{icon:Object(B.jsx)(Ye.a,{}),onClick:()=>x(t),children:"L\xf6nerapport"})}];return!e&&l?Object(B.jsx)(o.a,{}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(B.jsx)(v.a.Title,{children:"L\xf6nerapporter"}),Object(B.jsxs)("div",{style:{display:"flex",gap:15,alignItems:"center",flexWrap:"wrap"},children:[Object(B.jsx)(Jt.a.MonthPicker,{value:Te()(l,O),format:O,onChange:b,disabledDate:function(e){return e&&e>Te()().subtract(1,"months").endOf("month")},allowClear:!1,placeholder:"Select month"}),(null===g||void 0===g?void 0:g.length)<2?null:Object(B.jsx)(Z.a,{data:g,onChange:a,selectedOrganization:n,isMultiple:!0}),Object(B.jsx)(C.a.Search,{type:"text",placeholder:"S\xf6k efter regnr, IMEI eller f\xf6rare",label:"Registreringsnummer",enterButton:!0,onChange:t,style:{width:300}})]})]}),Object(B.jsx)(Ba,{visible:u,handleChangeShowModal:s,updateObject:j,driverReport:d,timestemp:r,selectedPeriod:l}),m?Object(B.jsx)(o.a,{}):null===p||void 0===p?void 0:p.map((t=>Object(B.jsx)(Ya,{getDriverReport:x,columns:E,filteredData:e,organization:t,knownOrganizations:g,showButton:!0})))]})};var Ka=()=>Object(B.jsx)(Vt.a,{wrappers:[c.i,c.e.provider,c.g,c.b,Fa,vi],children:Object(B.jsx)(Wa,{})});const{Title:qa}=v.a;var Ja=e=>{let{onEditAccount:t=(()=>null)}=e;const{currentUser:n}=Object(i.useContext)(Dn.a),{getOrganizationById:a}=Object(i.useContext)(Tt.a),[l,r]=Object(i.useState)();Object(i.useEffect)((()=>{void 0!==n&&(async e=>{const t=await a(e);void 0!==t&&r(t)})(n.organizationId)}),[n]);return void 0===n||void 0===l?Object(B.jsx)(o.a,{}):Object(B.jsxs)("div",{children:[Object(B.jsxs)(Ve.a,{justify:"space-between",children:[Object(B.jsx)(Me.a,{children:Object(B.jsx)(qa,{children:"Organisation - Konto"})}),Object(B.jsx)(Me.a,{children:Object(B.jsx)(h.a,{type:"primary",onClick:()=>{t(n,l)},children:"\xc4ndra"})})]}),Object(B.jsx)("div",{children:Object(B.jsxs)(dt.b,{bordered:!0,column:{xs:1,sm:1,md:1},children:[Object(B.jsx)(dt.b.Item,{label:"F\xf6retagsnamn",children:l.fullName}),Object(B.jsx)(dt.b.Item,{label:"Organisationsnummer",children:l.organizationNumber}),Object(B.jsx)(dt.b.Item,{label:"Postadress",children:Object(d.d)(l.postalAddress)}),Object(B.jsx)(dt.b.Item,{label:"Fakturaadress",children:Object(d.d)(l.invoiceAddress)}),Object(B.jsx)(dt.b.Item,{label:"E-post",children:l.email}),Object(B.jsx)(dt.b.Item,{label:"Telefonnummer",children:l.phone})]})})]})};var Qa={body:{maxHeight:720,overflow:"auto"}};const{Title:Za}=v.a;var Xa=e=>{let{show:t,org:n,onCancel:a=(()=>null)}=e;const{patchOrganizationAccount:l}=Object(i.useContext)(Tt.a),[r]=u.a.useForm(),[o,s]=Object(i.useState)(!1),[d,c]=Object(i.useState)();Object(i.useEffect)((()=>{void 0!==n?(r.setFieldsValue({postalStreet:n.postalAddress.streetAndNum,postalCity:n.postalAddress.city,postalCountry:n.postalAddress.country,postalState:n.postalAddress.state,postalZip:n.postalAddress.zip,invoiceStreet:n.invoiceAddress.streetAndNum,invoiceCity:n.invoiceAddress.city,invoiceCountry:n.invoiceAddress.country,invoiceState:n.invoiceAddress.state,invoiceZip:n.invoiceAddress.zip,phone:n.phone}),c(n)):r.setFieldsValue({postalStreet:"",postalCity:"",postalCountry:"",postalState:"",postalZip:"",invoiceStreet:"",invoiceCity:"",invoiceCountry:"",invoiceState:"",invoiceZip:"",phone:""})}));return Object(B.jsxs)(Ut.a,{visible:t,title:"Redigera Konto",onCancel:a,onOk:()=>{r.validateFields().then((e=>{(async e=>{const t={};!0===o?(t.postalAddress={streetAndNum:e.postalStreet,zip:e.postalZip,city:e.postalCity,country:e.postalCountry,state:e.postalState},t.phone=e.phone):(t.invoiceAddress={streetAndNum:e.invoiceStreet,zip:e.invoiceZip,city:e.invoiceCity,country:e.invoiceCountry,state:e.invoiceState},t.phone=e.phone),!0===await l(n.organizationId,t)&&window.location.reload()})(e)})).catch((e=>console.log("validate Failed:",e)))},bodyStyle:Qa.body,children:[Object(B.jsxs)(ze.a,{defaultActiveKey:"1",onChange:e=>(e=>{1===Number(e)&&s(!1),2===Number(e)&&s(!0)})(e),children:[Object(B.jsx)(ze.a.TabPane,{tab:"Faktura Address",children:Object(B.jsx)(u.a,{form:r,layout:"vertical",name:"editUserOrg",children:Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(u.a.Item,{name:"invoiceStreet",label:"Gata",rules:[{required:!0,message:"L\xe4gg en post address"}],children:Object(B.jsx)(C.a,{})}),Object(B.jsx)(u.a.Item,{name:"invoiceCity",label:"Stad",rules:[{required:!0,message:"L\xe4gg en stad"}],children:Object(B.jsx)(C.a,{})}),Object(B.jsx)(u.a.Item,{name:"invoiceState",label:"Stat",rules:[{required:!0,message:"L\xe4gg en stat"}],children:Object(B.jsx)(C.a,{})}),Object(B.jsx)(u.a.Item,{name:"invoiceCountry",label:"Land",rules:[{required:!0,message:"L\xe4gg en land"}],children:Object(B.jsx)(C.a,{})}),Object(B.jsx)(u.a.Item,{name:"invoiceZip",label:"Postkod",rules:[{required:!0,message:"L\xe4gg en postkod"}],children:Object(B.jsx)(C.a,{})})]})})},1),Object(B.jsx)(ze.a.TabPane,{tab:"PostAdress",children:Object(B.jsx)(u.a,{form:r,layout:"vertical",name:"editUserOrg",children:Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(u.a.Item,{name:"postalStreet",label:"Gata",rules:[{required:!0,message:"L\xe4gg en post address"}],children:Object(B.jsx)(C.a,{})}),Object(B.jsx)(u.a.Item,{name:"postalCity",label:"Stad",rules:[{required:!0,message:"L\xe4gg en stad"}],children:Object(B.jsx)(C.a,{})}),Object(B.jsx)(u.a.Item,{name:"postalState",label:"Stat",rules:[{required:!0,message:"L\xe4gg en stat"}],children:Object(B.jsx)(C.a,{})}),Object(B.jsx)(u.a.Item,{name:"postalCountry",label:"Land",rules:[{required:!0,message:"L\xe4gg en land"}],children:Object(B.jsx)(C.a,{})}),Object(B.jsx)(u.a.Item,{name:"postalZip",label:"Postkod",rules:[{required:!0,message:"L\xe4gg en postkod"}],children:Object(B.jsx)(C.a,{})})]})})},2)]}),Object(B.jsx)(Fe.a,{}),Object(B.jsx)(u.a,{form:r,layout:"vertical",name:"editPhone",children:Object(B.jsx)(u.a.Item,{name:"phone",label:"Telefonnummer",children:Object(B.jsx)(C.a,{})})})]})};var $a=()=>{const e={show:!1,account:null},[t,n]=Object(i.useState)(e),[a,l]=Object(i.useState)();return Object(B.jsx)(Dn.b,{children:Object(B.jsxs)(Tt.b,{children:[Object(B.jsx)(Ja,{onEditAccount:(e,t)=>((e,t)=>{n({show:!0,account:e}),l(t)})(e,t)}),Object(B.jsx)(Xa,{show:t.show,org:a,onCancel:()=>{n(e)}})]})})};var el=()=>Object(B.jsx)(Vt.a,{wrappers:[],children:Object(B.jsx)(Ke.b,{})}),tl=n(120),nl=n(955),il=n(966),al=n(396),ll=n(45);const{TabPane:rl}=ze.a,ol=e=>{let{visible:t,onModalFinish:n,onCancel:a,organizations:l,...r}=e;const[o]=u.a.useForm(),[s,d]=Object(i.useState)(r.record),[c,v]=Object(i.useState)(!0),[j,h]=Object(i.useState)([]);return Object(i.useEffect)((()=>{if((null===j||void 0===j?void 0:j.length)<2){let e=Object.assign(l);h(e)}}),[l]),Object(i.useEffect)((()=>{d(r.record),v(!0),o.resetFields(),o.setFieldsValue({...r.record})}),[r.record,t]),Object(B.jsx)(Ut.a,{visible:t,style:{minWidth:800},title:s?s.fullName:U.f.ADD_NEW_ORG,okText:s?U.f.BTN_SAVE:U.f.ADD,cancelText:U.f.BTN_ABORT,onCancel:a,onOk:()=>{o.validateFields().then((e=>{o.resetFields(),n(e)})).catch((e=>{console.log("Validate Failed:",e)}))},children:Object(B.jsx)(u.a,{form:o,layout:"vertical",name:"form_in_modal",initialValues:s,children:Object(B.jsxs)(ze.a,{defaultActiveKey:"1",children:[Object(B.jsxs)(rl,{tab:U.f.ORG,children:[Object(B.jsx)(u.a.Item,{name:H.k.fullname,label:U.f.ORG_NAME,rules:[{required:!0,message:U.f.SUPPLY_A_NEW_BUSINESS_NAME}],children:Object(B.jsx)(C.a,{prefix:Object(B.jsx)(nl.a,{style:{marginRight:3}}),placeholder:U.f.SUPPLY_A_NEW_BUSINESS_NAME})}),Object(B.jsx)(u.a.Item,{name:H.k.parentOrganization,label:U.f.PARENT,rules:[{required:!1,message:"Ange F\xf6retagsnamn"}],children:Object(B.jsx)(Z.a,{data:l,defaultValue:null===s||void 0===s?void 0:s.parentOrganization})}),Object(B.jsx)(u.a.Item,{name:H.k.organizationNumber,label:U.f.ORG_NUM,rules:[{required:!1,message:"Ange Organisationsnummer"}],children:Object(B.jsx)(C.a,{prefix:Object(B.jsx)(il.a,{style:{marginRight:3}}),placeholder:U.f.SUPPLY_A_NEW_ORG})}),Object(B.jsx)(u.a.Item,{name:H.k.email,label:U.f.MAIL,rules:[{required:!1,message:"Ange E-postadress"}],children:Object(B.jsx)(C.a,{prefix:Object(B.jsx)(al.a,{style:{marginRight:3}}),placeholder:U.f.SUPPLY_A_NEW_ORG_EMAIL})}),Object(B.jsx)(u.a.Item,{name:H.k.phone,label:U.f.PHONE_NUMBER,rules:[{required:!1,message:"Ange Telefonnummer"}],children:Object(B.jsx)(C.a,{prefix:Object(B.jsx)(Vn.a,{style:{marginRight:3}}),placeholder:U.f.SUPPLY_A_NEW_ORG_PHONE})}),s?null:Object(B.jsx)(u.a.Item,{name:H.k.adminUserEmail,label:U.f.SUPPLY_ADMINS_EMAIL,rules:[{required:!1,message:"Ange adminUserEmail",autoComplete:!1}],children:Object(B.jsx)(C.a,{prefix:Object(B.jsx)(al.a,{style:{marginRight:3}}),placeholder:U.f.SUPPLY_AN_EMAIL_ADDRESS,autoComplete:"new-password"})}),s?null:Object(B.jsx)(u.a.Item,{name:H.k.sendInvite,valuePropName:"checked",children:Object(B.jsx)(Qt.a,{checked:!c,onChange:()=>v(!c),children:U.f.SEND_INVITE})}),c&&!s?Object(B.jsx)(u.a.Item,{name:H.k.adminUserPassword,label:U.f.ADMINS_PASSWORD,rules:[{required:!1,message:"Ange adminUserPassword",autoComplete:!1}],children:Object(B.jsx)(C.a.Password,{prefix:Object(B.jsx)(Zn.a,{style:{marginRight:3}}),placeholder:U.f.SUPPLY_A_NEW_ORG_PASSWORD,autoComplete:"new-password"})}):null]},"1"),Object(B.jsx)(rl,{tab:U.f.POSTAL_ADDRESS,children:Object(B.jsx)(fl,{typ:H.k.postalAddress})},"2"),Object(B.jsx)(rl,{tab:U.f.INVOICE_ADDRESS,children:Object(B.jsx)(fl,{typ:H.k.invoiceAddress})},"3"),"//TODO: Modules",s?Object(B.jsx)(rl,{tab:U.f.VEHICLE,children:Object(B.jsx)(sl,{record:s,knownVehicles:r.knownVehicles})},"5"):null,s?Object(B.jsx)(rl,{tab:U.f.USERS,children:Object(B.jsx)(dl,{record:s,knownUsers:r.knownUsers,knownVehicles:r.knownVehicles})},"6"):null,s?Object(B.jsx)(rl,{tab:U.f.DEVICES,children:Object(B.jsx)(pl,{record:s,knownDevices:r.knownDevices})},"7"):null,Object(B.jsx)(rl,{tab:U.f.ORGANIZATIONS,children:Object(B.jsx)(hl,{record:s,knownOrganizations:l})},"8")]})})})},sl=e=>{let{knownVehicles:t,record:n}=e;const{push:i}=Object(l.g)(),a=null===t||void 0===t?void 0:t.filter((e=>(null===e||void 0===e?void 0:e.organizationId)===(null===n||void 0===n?void 0:n.organizationId)));const r=[{title:U.f.REG_NUM,dataIndex:H.k.registry,key:H.k.registry,render:(e,t)=>Object(B.jsxs)("a",{onClick:()=>{return n=e||t.displayName,localStorage.setItem(w.f,n),void i({pathname:"".concat(s.c,"/superVehicles"),state:{searchTerm:n}});var n},children:[e," ",null===t||void 0===t?void 0:t.displayName]})},{title:U.f.DRIVER,dataIndex:H.k.currentDriver,key:H.k.currentDriver,render:e=>Object(B.jsx)("text",{children:null===e||void 0===e?void 0:e.displayName})},{title:U.f.TRAVELS,dataIndex:H.k.address,key:H.k.address},{title:U.f.MILEAGE_FULL,dataIndex:H.k.odometer,key:H.k.odometer,render:(e,t)=>{var n,i;return null!==t&&void 0!==t&&null!==(n=t.odometer)&&void 0!==n&&n.valueKm?Object(B.jsxs)("text",{children:[null===t||void 0===t||null===(i=t.odometer)||void 0===i?void 0:i.valueKm," km"]}):"-"}}];return Object(B.jsxs)("div",{children:[Object(B.jsxs)(v.a.Title,{level:2,children:[null===n||void 0===n?void 0:n.fullName," - ",U.f.VEHICLE]}),Object(B.jsx)("br",{}),Object(B.jsx)(M.a,{size:"small",columns:r,dataSource:a})]})},dl=e=>{let{knownUsers:t,knownVehicles:n,record:i}=e;const{push:a}=Object(l.g)(),r=null===t||void 0===t?void 0:t.filter((e=>(null===e||void 0===e?void 0:e.organizationId)===(null===i||void 0===i?void 0:i.organizationId)));const o=[{title:U.f.USERS,dataIndex:H.k.displayName,key:H.k.displayName,render:(e,t)=>Object(B.jsx)("a",{onClick:()=>{return e=t.displayName,localStorage.setItem(w.f,e),void a({pathname:"".concat(s.c,"/users"),state:{searchTerm:e}});var e},children:e})},{title:U.f.MAIL,dataIndex:H.k.displayEmail,key:H.k.displayEmail,render:e=>Object(B.jsx)("text",{children:e})},{title:U.f.PHONE_NUMBER,dataIndex:H.k.phone,key:H.k.phone},{title:U.f.LAST_SEEN_DRIVING,dataIndex:H.k.lastSeenDriving,key:H.k.lastSeenDriving,render:e=>e?Object(B.jsx)(We.a,{value:e,typ:"map"}):"-"},{title:U.f.LAST_SEEN,dataIndex:H.k.lastSeenApp,key:H.k.lastSeenApp,render:e=>e?Object(B.jsx)(We.a,{value:e,typ:"map"}):"-"},{title:U.f.CHECKED,dataIndex:H.k.currentVehicle,key:H.k.currentVehicle,render:e=>{const t=null===n||void 0===n?void 0:n.find((t=>t.id===e[0]));return((null===t||void 0===t?void 0:t.registry)||"")+(null!==t&&void 0!==t&&t.displayName?" ("+(null===t||void 0===t?void 0:t.displayName)+")":"")}}];return Object(B.jsxs)("div",{children:[Object(B.jsxs)(v.a.Title,{level:2,children:[null===i||void 0===i?void 0:i.fullName," - ",U.f.USERS]}),Object(B.jsx)("br",{}),Object(B.jsx)(M.a,{scroll:{x:300},size:"small",columns:o,dataSource:r})]})},cl=[],ul=(e,t,n)=>{const i=t||"0",a=n||cl,l=[];for(let o=0;o<3;o++){const e="".concat(i,"-").concat(o);a.push({title:e,key:e}),o<2&&l.push(e)}if(e<0)return a;const r=e-1;l.forEach(((e,t)=>(a[t].children=[],ul(r,e,a[t].children))))},vl=[],jl=e=>{for(let t=0;t<e.length;t++){const n=e[t],{key:i}=n;vl.push({key:i,title:i}),n.children&&jl(n.children)}},hl=e=>{let{knownOrganizations:t,record:n}=e;const a=Object(ll.m)(t,null===n||void 0===n?void 0:n.organizationId),[l,r]=Object(i.useState)([null===n||void 0===n?void 0:n.organizationId]);return Object(i.useEffect)((()=>{r([null===n||void 0===n?void 0:n.organizationId])}),[n]),Object(B.jsx)("div",{children:Object(B.jsx)(D.a,{defaultExpandAll:!0,selectedKeys:l,onSelect:e=>r(e),treeData:a})})},pl=e=>{let{knownDevices:t,record:n}=e;const{push:i}=Object(l.g)(),a=null===t||void 0===t?void 0:t.filter((e=>(null===e||void 0===e?void 0:e.organizationId)===(null===n||void 0===n?void 0:n.organizationId)));const r=[{title:U.f.IMEI,dataIndex:H.k.imei,key:H.k.imei,render:(e,t)=>Object(B.jsx)("a",{onClick:()=>{return e=t.deviceId,localStorage.setItem(w.f,e),void i({pathname:"".concat(s.c,"/superdevices"),state:{searchTerm:e}});var e},children:e})},{title:U.f.PHONE_NUMBER,dataIndex:H.k.phone,key:H.k.phone},{title:U.f.BATTERY,dataIndex:H.k.status,key:H.k.status,render:e=>null!==e&&void 0!==e&&e.latestBatteryLevel?Object(B.jsxs)("text",{children:[null===e||void 0===e?void 0:e.latestBatteryLevel," %"]}):"-"},{title:U.f.INSTALL,dataIndex:H.k.physicalInstallTimestamp,key:H.k.physicalInstallTimestamp,render:e=>e?Object(B.jsx)(We.a,{value:e,typ:"map"}):"-"},{title:U.f.RETIRED,dataIndex:H.k.retired,key:H.k.retired,render:e=>Object(B.jsx)("text",{children:e?U.f.YES:U.f.NO})}];return Object(B.jsxs)("div",{children:[Object(B.jsxs)(v.a.Title,{level:2,children:[null===n||void 0===n?void 0:n.fullName," - ",U.f.DEVICES]}),Object(B.jsx)("br",{}),Object(B.jsx)(M.a,{scroll:{x:300},size:"small",columns:r,dataSource:a})]})};var bl=n(259);const Ol=Object(i.createContext)({}),ml=e=>{let{children:t}=e;const[n,a]=Object(i.useState)([]),[l,r]=Object(i.useState)([]),[o,s]=Object(i.useState)(!0),d=Object(i.useContext)(bl.a),u=d.devicesLoaded,v=Object(i.useContext)(c.t).raw,j=Object(i.useContext)(Dn.a).users,h=d.devices,p=Object(i.useContext)(Tt.a);return Object(i.useEffect)((()=>{p.getAllOrganizationsForRoot().then((e=>{a(e)}))}),[]),Object(i.useEffect)((()=>{r(n),s(!1)}),[n]),Object(B.jsx)(Ol.Provider,{value:{allOrganizationsForRoot:n,deviceLoaded:u,knownDevices:h,knownVehicles:v,knownUsers:j,data:l,setData:r,loading:o},children:t})},gl=e=>{let{searchTerm:t,editingKey:n,visible:a,setVisible:l,setEditingKey:r}=e;const[o,s]=Object(i.useState)(""),{data:d,setData:c,deviceLoaded:v,knownDevices:j,knownVehicles:h,knownUsers:p}=Object(i.useContext)(Ol);Object(i.useEffect)((()=>{}),[n]),Object(i.useEffect)((()=>{let e=d.filter((e=>JSON.stringify(e).toLowerCase().includes(t)));s(e),r("")}),[t,d]);const b=e=>{l(!1),r(""),F.a.postOrganization(e).then(((t,n)=>{e.organizationId=t.organizationId,O(e),$.b.success(U.f.NEW_ORG_CREATED)}))},O=e=>{const t=[e,...d];c(t)},m=async(e,t)=>{try{const n=t,i=[...d],a=i.findIndex((t=>e===t.organizationId));if(t.parentOrganization||(n.parentOrganization=0),a>-1){const e=i[a];i.splice(a,1,{...e,...n}),c(i),r("")}else i.push(n),c(i),r("");F.a.patchOrganization(e,n).then((e=>{$.b.success(U.f.YOUR_CHANGED_SAVED),c(i)}))}catch(n){console.log("Validate Failed:",n)}},g=e=>{Ut.a.confirm({title:"Bekr\xe4fta borttagning",content:"\xc4r du s\xe4ker p\xe5 att du vill ta bort denna organisation?",okText:"Ta bort",okType:"danger",cancelText:"Avbryt",onOk:()=>{F.a.deleteOrganization(e.organizationId).then((t=>{$.b.success(U.f.COMPANY_DELETED),function(e){const t=d.filter((t=>t.organizationId!==e.organizationId));c(t)}(e)})).catch((e=>{$.b.error("Ett fel intr\xe4ffade vid borttagning av organisationen."),console.error(e)}))}})};const f=[{title:U.f.ORG_NAME,dataIndex:H.k.fullname,editable:!1,fixed:"left"},{title:U.f.PARENT,dataIndex:H.k.parentOrganization,editable:!1,render:e=>{const t=d.find((t=>t.organizationId===e&&0!==e));return null===t||void 0===t?void 0:t.fullName}},{title:U.f.MAIL,dataIndex:H.k.email,editable:!1},{title:U.f.ORG_NUM,dataIndex:H.k.organizationNumber,editable:!1},{title:U.f.POSTAL_ADDRESS,dataIndex:H.k.postalAddress,editable:!1,render:e=>{if(null!==e&&void 0!==e&&e.streetAndNum)return(null===e||void 0===e?void 0:e.streetAndNum)+", "+(null===e||void 0===e?void 0:e.zip)+", "+(null===e||void 0===e?void 0:e.city)+", "+(null===e||void 0===e?void 0:e.country)}},{title:U.f.PHONE_NUMBER,dataIndex:H.k.phone,editable:!1},{title:"",dataIndex:"operation",width:80,fixed:"right",render:(e,t)=>Object(B.jsx)(re.a,{menu:()=>function(e){return Object(B.jsxs)(X.a,{children:[Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(oe.a,{}),onClick:()=>function(e){l(!0),r(e.organizationId)}(e),children:[U.f.BTN_CHANGE," "]}),Object(B.jsxs)(X.a.Item,{danger:!0,icon:Object(B.jsx)(z.a,{}),onClick:()=>g(e),children:[U.f.DELETE," "]})]})}(t)})}];return Object(B.jsxs)(u.a,{component:!1,children:[Object(B.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",margin:"15px"},children:Object(B.jsx)(ol,{visible:a,organizations:d,onModalFinish:e=>{r(""),l(!1),n?m(n,e):b(e)},knownVehicles:h,knownUsers:p,knownDevices:j,record:d.find((e=>e.organizationId===n)),onCancel:()=>{l(!1),r("")}})}),d?Object(B.jsx)(M.a,{dataSource:o,columns:Object(re.m)(f),rowKey:e=>null===e||void 0===e?void 0:e.organizationId,scroll:{x:1e3},pagination:{onChange:()=>{r("")}},...re.n}):Object(B.jsx)(sn.a,{}),"        "]})};ul(1),jl(cl);const fl=e=>{let{record:t,typ:n}=e;return Object(B.jsxs)(u.a.Item,{style:{display:"flex",justifyContent:"center",margin:"auto"},children:[Object(B.jsx)(u.a.Item,{name:[n,H.k.streetAndNum],initialValue:null===t||void 0===t?void 0:t.streetAndNum,label:U.f.STREET_ADDRESS,rules:[{required:!1,message:"Province is required"}],children:Object(B.jsx)(C.a,{prefix:Object(B.jsx)($t.a,{style:{marginRight:3}}),placeholder:U.f.SUPPLY_A_NEW_ORG_STREET_ADDRESS})}),Object(B.jsx)(u.a.Item,{name:[n,H.k.zip],label:U.f.POSTAL_CODE,initialValue:null===t||void 0===t?void 0:t.zip,rules:[{required:!1,message:"Street is required"}],children:Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY_A_NEW_ORG_POSTAL_CODE})}),Object(B.jsx)(u.a.Item,{name:[n,H.k.city],initialValue:null===t||void 0===t?void 0:t.city,label:U.f.CITY,rules:[{required:!1,message:"Street is required"}],children:Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY_A_NEW_ORG_COUNTY,defaultValue:null===t||void 0===t?void 0:t.city})}),Object(B.jsx)(u.a.Item,{name:[n,H.k.state],initialValue:null===t||void 0===t?void 0:t.state,label:U.f.COUNTY,rules:[{required:!1,message:"Street is required"}],children:Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY_A_NEW_ORG_COUNTY,defaultValue:null===t||void 0===t?void 0:t.state})}),Object(B.jsx)(u.a.Item,{name:[n,H.k.country],initialValue:null===t||void 0===t?void 0:t.country,label:U.f.COUNTRY,rules:[{required:!1,message:"Street is required"}],children:Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY_A_NEW_ORG_COUNTRY,defaultValue:null===t||void 0===t?void 0:t.country})})]})};var xl=()=>{const[e,t]=Object(i.useState)(""),[n,a]=Object(i.useState)(""),[l,r]=Object(i.useState)(!1);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[Object(B.jsxs)(v.a.Title,{children:[U.f.SUPERADMIN," - ",U.f.ORGANIZATIONS]}),Object(B.jsxs)("div",{style:{display:"flex",gap:15},children:[Object(B.jsx)(C.a.Search,{type:"text",placeholder:U.f.SEARCH_ORG,defaultValue:e,enterButton:!0,onChange:e=>{t(e.target.value.toLowerCase())},style:{width:300}}),Object(B.jsx)(h.a,{type:"primary",icon:Object(B.jsx)(le.a,{}),onClick:()=>{r(!0),a("")},children:"L\xe4gg till ny organisation"})]})]}),Object(B.jsx)(gl,{searchTerm:e,visible:l,editingKey:n,setEditingKey:a,setVisible:r})]})};var yl=()=>Object(B.jsx)(Vt.a,{wrappers:[c.u,Dn.b,bl.b,Tt.b,tl.b,ml],children:Object(B.jsx)(xl,{})}),El=n(266);var Il=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.g,c.s,c.w,Dn.b,xa.b],children:Object(B.jsx)(El.c,{})}),Sl=n(541),Tl=n(392),kl=n(934),Cl=n(951),_l=n(394),Al=n(1002),Nl=n(122),Rl=n(315),Dl=n(217);const{Text:wl}=v.a,{TabPane:Ll}=ze.a,Pl=n(181);Pl.registerLocale(n(182));const Vl=Pl.getNames("sv",{select:"alias"}),Ml=Object.entries(Vl).map((e=>{let[t,n]=e;return{key:t,label:n}})).sort(((e,t)=>e.label.localeCompare(t.label))),Fl=Ml.filter((e=>"SE"===e.key||"FI"===e.key||"NO"===e.key||"DK"===e.key)),zl=Ml.find((e=>"SE"===e.key)),Ul=Fl.findIndex((e=>"SE"===e.key));Fl.splice(Ul,1),Fl.unshift(zl);const Bl=()=>{const[e,t]=Object(i.useState)(),[n,a]=Object(i.useState)(!0),[l,r]=Object(i.useState)(!1),[o,s]=Object(i.useState)(""),d=Object(i.useContext)(c.h),u=Object(i.useContext)(c.x),j=Object(i.useContext)(c.c);Object(i.useEffect)((()=>{u&&a(!1)}),[u]);function p(){r(!0)}return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:[Object(B.jsx)(v.a.Title,{children:"Superadmin - Fordon"}),Object(B.jsxs)("div",{style:{display:"flex",gap:15,flexWrap:"wrap"},children:[Object(B.jsx)(Z.a,{data:d,onChange:e=>{t(e)},selectedOrganization:e,isMultiple:!0}),Object(B.jsx)(C.a.Search,{type:"text",placeholder:"S\xf6k efter regnr, IMEI eller f\xf6rare",label:"Registreringsnummer",defaultValue:o,enterButton:!0,onChange:e=>{s(e.target.value.toLowerCase())},style:{width:"400px"}}),Object(B.jsx)(h.a,{type:"primary",onClick:()=>p(),icon:Object(B.jsx)(lt.a,{}),children:"L\xe4gg till"})]})]}),Object(B.jsx)(Hl,{organizationId:e,knownOrganizations:d,isModalVisible:l,setIsModalVisible:r,searchTerm:o,setSearchTerm:s,vehicles:u,knownDevices:j,knownVehicles:u,handleOnClickAddVehicle:p})]})},Gl=e=>{let{marker:t}=e;return Object(B.jsx)(ct.Icon,{icon:t})},Hl=e=>{let{vehicles:t,changeOdometerValue:n,changeDefaultTripType:a,changeBenefitType:l,setIsModalVisible:r,knownDevices:s,knownVehicles:d,...v}=e;const[j]=u.a.useForm(),[p,b]=Object(i.useState)(),[O,m]=Object(i.useState)(!0),[g,f]=Object(i.useState)(!1),[x,y]=Object(i.useState)(),[E,I]=Object(i.useState)(!1),[S,T]=Object(i.useState)(),[k,C]=Object(i.useState)(),[_,A]=Object(i.useState)(),[N,R]=Object(i.useState)(),[D,P]=Object(i.useState)(null),V=Object(i.useContext)(c.n),G=null===V||void 0===V?void 0:V.filter((e=>!e.isArchived)),Y=Object(i.useContext)(c.z.context);Object(i.useEffect)((()=>{}),[G]),Object(i.useEffect)((()=>{const e=null===p||void 0===p?void 0:p.sort(((e,t)=>{var n;return null===(n=e.registry)||void 0===n?void 0:n.localeCompare(t.registry)}));C(null===e||void 0===e?void 0:e.filter((e=>!e.isArchived))),T(null===e||void 0===e?void 0:e.filter((e=>e.isArchived)))}),[p]),Object(i.useEffect)((()=>{const e=localStorage.getItem(w.f);e&&(v.setSearchTerm(e.toLowerCase()),localStorage.removeItem(w.f)),y(d),b(d)}),[d]),Object(i.useEffect)((()=>{var e,t,n;let i=x;var a;(i&&m(!1),v.searchTerm.length>1&&(i=null===(e=i)||void 0===e?void 0:e.filter((e=>JSON.stringify(e).toLowerCase().includes(v.searchTerm)))),(null===v||void 0===v||null===(t=v.organizationId)||void 0===t?void 0:t.length)>0)&&(i=null===(a=i)||void 0===a?void 0:a.filter((e=>v.organizationId.includes(e.organizationId))));i=null===(n=i)||void 0===n?void 0:n.filter((e=>!e.isTracker)),b(i)}),[v.searchTerm,x,v.organizationId]);const W=e=>{Ut.a.confirm({title:"Bekr\xe4fta borttagning av ".concat((null===e||void 0===e?void 0:e.registry)||e.displayName),icon:Object(B.jsx)(Sl.a,{}),okType:"danger",content:"\xc4r du s\xe4ker p\xe5 att du vill ta bort detta fordon?",onOk(){F.a.deleteVehicle(e.id).then((t=>{$.b.success((null===e||void 0===e?void 0:e.registry)||e.displayName+" har tagits bort"),function(e){const t=null===x||void 0===x?void 0:x.filter((t=>(null===t||void 0===t?void 0:t.id)!==(null===e||void 0===e?void 0:e.id)));b(t),y(t)}(e)}))},onCancel(){},okText:"Ta bort"})},K=(e,t)=>{f(!0);const n={organizationId:t};F.a.patchChangeOrgVehicle(e.id,n).then((n=>{$.b.success("Fordon flyttades till en annan organisation.");const i=[...x],a=i.findIndex((t=>e.id===t.id)),l=i[a];let r;r={...l,organizationId:t,permittedDrivers:[],defaultDriver:null,currentDriver:null},i.splice(a,1,{...l,...r}),b(i),y(i)})).catch((e=>{$.b.error("N\xe5got gick fel. F\xf6rs\xf6k igen."),console.error(e)}))};function q(e,t,n){var i;f(!0),n=n||x;const a=null===(i=e.state)||void 0===i?void 0:i.imei,l=s.findIndex((e=>e.imei===a));if(-1===l)return f(!1),void $.b.error("Kunde inte hitta enheten.");const r=s[l];if(e.id!==t&&t)try{var o,d;F.a.patchDevices(r.id,t);const i=[...n],a=i.findIndex((t=>t.id===e.id)),l=i.findIndex((e=>e.id===t));let s;-1!==l&&(s={...i[l]},s.state={...r},s.odometer=e.odometer,i.splice(l,1,s));const c={...i[a]};c.state=null,c.odometer=null,i.splice(a,1,c),b(i),y(i),Ut.a.success({title:"Enheten flyttades",content:Object(B.jsx)("div",{children:Object(B.jsxs)("p",{children:["Enhet ",r.imei," flyttades till ",Object(B.jsx)("strong",{children:(null===(o=s)||void 0===o?void 0:o.registry)||(null===(d=s)||void 0===d?void 0:d.displayName)}),"."]})})})}catch(c){console.error(c),$.b.error("N\xe5got gick fel. F\xf6rs\xf6k igen.")}finally{f(!1)}else f(!1)}const J=[{key:"registry",dataIndex:"registry",title:"Regnr",fixed:"left",width:150,render:(e,t)=>Object(re.j)(t)},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",width:200,render:e=>{var t;const n=null===(t=v.knownOrganizations)||void 0===t?void 0:t.find((t=>t.organizationId===e));return n?n.fullName:"-"}},{title:"Arkiverad",dataIndex:H.k.archivedTsMs,key:"archived",render:(e,t)=>e?Object(B.jsx)(We.a,{value:e,typ:"map",isTracker:t.isTracker,defaultText:!0}):"-"},{title:"",dataIndex:"operation",render:(e,t)=>Object(B.jsx)("div",{style:{float:"right"},children:Object(B.jsx)(h.a,{icon:Object(B.jsx)(Tl.a,{}),onClick:()=>Object(Dl.a)(t,x,y,Q),children:U.f.ACTIVE})})}].filter((e=>!e.hidden));function Q(e){A(e),r(!0)}function Z(e){R(e),r(!0)}const ee=e=>{var t;const n=null===e||void 0===e||null===(t=e.state)||void 0===t?void 0:t.imei;return Object(B.jsxs)(X.a,{children:[Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(oe.a,{}),onClick:()=>Q(e),children:[U.f.BTN_CHANGE," "]}),Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(rt.a,{}),onClick:()=>P(e),children:[U.f.CHECK_IN_DRIVER," "]}),Object(B.jsxs)(X.a.Item,{disabled:!n,icon:Object(B.jsx)(kl.a,{}),onClick:()=>Object(re.l)(e,x,q,Z),children:[U.f.MOVE_TO_ANOTHER_VEHICLE," "]}),Object(B.jsxs)(X.a.Item,{disabled:!n,icon:Object(B.jsx)(ti.a,{}),onClick:()=>(e=>{var t;const n=null===(t=e.state)||void 0===t?void 0:t.imei,i=s.find((e=>e.imei===n)),a=x.findIndex((t=>t.id===e.id));i&&Ut.a.confirm({title:"Bekr\xe4fta avinstallering f\xf6r ".concat((null===e||void 0===e?void 0:e.registry)||e.displayName),icon:Object(B.jsx)(Sl.a,{}),okType:"danger",content:"\xc4r du s\xe4ker p\xe5 att du vill avinstallera enhet?",onOk(){F.a.deleteAdminDevicesInstalled(i.id).then((e=>{if($.b.success("Enheten har avinstallerats"),f(!1),i.installedVehicle=null,i.retired=!1,-1!==a){const e=[...x];e[a].state=null,y(e)}}))},onCancel(){},okText:"Avinstallera"})})(e),children:[U.f.UNINSTALL_DEVICE," "]}),Object(B.jsxs)(X.a.Item,{disabled:!n,icon:Object(B.jsx)(Cl.a,{}),onClick:()=>(e=>{var t;const n=null===(t=e.state)||void 0===t?void 0:t.imei,i=s.find((e=>e.imei===n));Ut.a.confirm({title:"Bekr\xe4fta pensionering f\xf6r ".concat((null===e||void 0===e?void 0:e.registry)||e.displayName),icon:Object(B.jsx)(Sl.a,{}),okType:"danger",content:"\xc4r du s\xe4ker p\xe5 att du vill pensionera enhet?",onOk(){F.a.patchAdminDevices(null===i||void 0===i?void 0:i.id,{retired:!0}).then((e=>{$.b.success("Enheten \xe4r pensionerad"),i.retired=!0,i.retired=!0}))},onCancel(){},okText:"Pensionera"})})(e),children:[U.f.RETIRE_DEVICE," "]}),Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(_l.a,{}),onClick:()=>Object(re.c)(e,v.knownOrganizations,K),children:[U.f.MOVE_VEHICLE_TO_OTHER_ORGANIZATION," "]}),Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(Al.a,{}),onClick:()=>{return t=e,void Ut.a.confirm({title:"Radera Biluppgiftershistorik",content:"Vill du radera Biluppgiftershistorik?",onOk(){F.a.deleteVehicleHistory(t.id).then((e=>{const n=[...x],i=null===n||void 0===n?void 0:n.findIndex((e=>t.id===e.id)),a=n[i];n.splice(i,1,{...a,...e}),y(n)}))}});var t},children:[U.f.REMOVE_VEHICLES_INFO," "]}),Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(he.a,{}),onClick:()=>Object(Dl.b)(e,x,y,s,re.l,q,Z),children:[U.f.ARCHIVE," "]}),Object(B.jsxs)(X.a.Item,{danger:!0,icon:Object(B.jsx)(z.a,{}),onClick:()=>W(e),children:[U.f.REMOVE_VEHICLE," "]})]})},te=[{key:"registry",dataIndex:"registry",title:"Regnr",fixed:"left",width:150,render:(e,t)=>Object(re.j)(t)},{key:"style",dataIndex:"style",title:"Ikon",width:80,render:e=>{var t;const n=null===e||void 0===e?void 0:e.color;let i=null===e||void 0===e?void 0:e.marker;return(null===(t=i)||void 0===t?void 0:t.constructor)===String&&(i=Ct.a[i]),Object(B.jsx)("div",{children:Object(B.jsx)(Ui.a,{style:{backgroundColor:n},children:i?Object(B.jsx)(Gl,{marker:i}):Object(B.jsx)(ct.Icon,{icon:bt.androidCar})})})}},{key:"benefitType",dataIndex:"benefitType",title:"Typ",width:150,render:(e,t)=>{var n;return null===(n=Object.entries(H.c).find((t=>{let[n,i]=t;return(null===i||void 0===i?void 0:i.TYPE)===e}))[1])||void 0===n?void 0:n.TYPE_DISPLAY_TEXT}},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",editable:!1,width:150,hidden:Y,render:e=>{var t;const n=null===(t=v.knownOrganizations)||void 0===t?void 0:t.find((t=>t.organizationId===e));return n?n.fullName:"-"}},{key:"defDriver",dataIndex:"defaultDriver",title:"F\xf6rvald f\xf6rare",editable:!0,width:150,render:(e,t)=>Object(re.k)(t,e)},{key:"curDriver",dataIndex:"currentDriver",title:"Incheckad f\xf6rare",editable:!0,width:150,render:e=>(null===e||void 0===e?void 0:e.displayName)||"F\xf6rare ej vald"},{title:"Beh\xf6riga f\xf6rare",key:"dPermitted",dataIndex:"permittedDrivers",width:150,render:(e,t)=>{var n,i,a,l;e=null===(n=e)||void 0===n?void 0:n.filter((e=>null===G||void 0===G?void 0:G.find((t=>t.id===e.id))));let r;if("POOL"===(null===t||void 0===t?void 0:t.benefitType)&&(r="Till\xe5ts f\xf6r alla"),0===(null===(i=e)||void 0===i?void 0:i.length)&&(r="F\xf6rare ej vald"),1===(null===(a=e)||void 0===a?void 0:a.length)){const t=null===G||void 0===G?void 0:G.find((t=>t.userId===e[0].id));r=null===t||void 0===t?void 0:t.displayName}if((null===(l=e)||void 0===l?void 0:l.length)>1){var o,s;const t=null===(o=e)||void 0===o?void 0:o.map((e=>e.id));let n=(null===(s=e)||void 0===s?void 0:s.length)+" f\xf6rare";return Object(Bt.a)(n,null,null,t,null,G,v.knownOrganizations)}return r}},{title:"S\xe5gs senast",dataIndex:"lastSeen",key:"lastSeen",width:150,render:(e,t)=>e?Object(B.jsx)(We.a,{value:e,typ:"map",isTracker:t.isTracker}):"-"},{key:"brand",dataIndex:"brand",title:"Bilm\xe4rke",width:150,render:(e,t)=>{const n=t.brand||"",i=t.model||"",a=t.modelYear||"";return"".concat(n," ").concat(i," ").concat(a)}},{key:"vehicleType",dataIndex:"hybrid",title:"Br\xe4nsletyp",width:100,render:(e,t)=>{var n,i;return Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[t.fuel1?Object(B.jsx)(wl,{children:null===(n=t.fuel1)||void 0===n?void 0:n.svName}):null,t.fuel2?Object(B.jsx)(wl,{children:null===(i=t.fuel2)||void 0===i?void 0:i.svName}):null]})}},{key:"odom",dataIndex:"odometer",title:"M\xe4tarst\xe4llning",width:150,render:(e,t)=>Object(Gi.a)(t)},{key:"co2_fuel",dataIndex:"co2_fuel",title:"CO2",width:150,render:(e,t)=>{const n=null!==(null===t||void 0===t?void 0:t.co2GKm1)?"".concat(null===t||void 0===t?void 0:t.co2GKm1," g/km"):null,i=null!==(null===t||void 0===t?void 0:t.co2GKm2)?"".concat(null===t||void 0===t?void 0:t.co2GKm2," g/km"):null;return Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(B.jsx)(wl,{children:n}),Object(B.jsx)(wl,{children:i})]})}},{key:"consumption",dataIndex:"consumption",title:"F\xf6rbrukning",width:120,render:(e,t)=>{const n=null!==t&&void 0!==t&&t.fuel1?(null===t||void 0===t?void 0:t.consumption1)+" "+(null===t||void 0===t?void 0:t.fuel1.consumptionUnit):null,i=null!==t&&void 0!==t&&t.fuel2?(null===t||void 0===t?void 0:t.consumption2)+" "+(null===t||void 0===t?void 0:t.fuel2.consumptionUnit):null;return Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(B.jsx)(wl,{children:n}),Object(B.jsx)(wl,{children:i})]})}},{key:"isoCountryCode",dataIndex:"isoCountryCode",title:"Landskod",width:100},{key:"defaultTripType",dataIndex:"defaultTripType",title:"F\xf6rval",width:80,render:e=>{const t=null===e||void 0===e?void 0:e.startsWith("PRIVATE"),n=Object.entries(H.d).filter((t=>{let[n,i]=t;return(null===i||void 0===i?void 0:i.TYPE)===e})).map((e=>{let[t,n]=e;return null===n||void 0===n?void 0:n.TYPE_DISPLAY_TEXT})),i=t?H.b.SWITCH_PRIVATE:H.b.SWITCH_BUSINESS;return Object(B.jsx)(gn.a,{style:{color:i},children:n})}},{key:"imei",dataIndex:"state",title:"Enhet",width:150,render:(e,t)=>{var n;if(null===e||void 0===e||!e.imei)return;let i=null===e||void 0===e||null===(n=e.imei)||void 0===n?void 0:n.toString();return Object(B.jsx)(L.a,{title:i,children:i})}},{title:"",dataIndex:"operation",width:80,render:(e,t)=>Object(B.jsx)(re.a,{menu:()=>ee(t)})}].filter((e=>!e.hidden));function ne(e){const t=[...x],n=null===t||void 0===t?void 0:t.findIndex((t=>(null===e||void 0===e?void 0:e.id)===t.id)),i=t[n];t.splice(n,1,{...i,...e}),y(t),P(null)}return Object(B.jsxs)(u.a,{form:j,component:!1,children:[Object(B.jsx)(Rl.a,{knownOrganizations:v.knownOrganizations,organizationId:v.organizationId,permittedDrivers:G,imeiList:s,knownDevices:s,record:_,setRecord:A,setData:function(e){const t=[...x];if(Array.isArray(e))e.forEach((e=>{const n=t.findIndex((t=>e.id===t.id));n>-1?t.splice(n,1,{...t[n],...e}):t.push(e)}));else{const n=t.findIndex((t=>e.id===t.id));n>-1?t.splice(n,1,{...t[n],...e}):t.push(e)}b(t),y(t),r(!1),A(null),R(null)},onModalCancel:()=>{A(null),R(null),r(!1)},moveDevice:N,isModalVisible:v.isModalVisible,updateRecord:ne,handleMoveDeviceToOtherVehicle:q,isRoot:!0}),Object(B.jsx)(re.d,{record:D,updateRecord:ne,setRecord:P}),k?Object(B.jsxs)(oi.a,{spinning:g,children:[Object(B.jsx)(Nl.b,{setShowAlertArchived:I,showAlertArchived:E,content:Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(Ll,{tab:Object(B.jsx)($e.f,{text:"Aktiva fordon",overflowCount:9999999,badgeColor:"#3f3f3f",count:null===k||void 0===k?void 0:k.length}),children:[E&&Object(B.jsx)(Nl.a,{message:U.f.messageArchivedAlert}),Object(B.jsx)(M.a,{dataSource:k,columns:Object(re.m)(te),ellipsis:!0,scroll:{x:1e3},...re.n,tableLayout:"fixed"})]},"1"),Object(B.jsxs)(Ll,{tab:Object(B.jsx)($e.f,{text:"Arkiverade fordon",overflowCount:9999999,badgeColor:"#3f3f3f",showTooltip:!1,count:null===S||void 0===S?void 0:S.length}),children:[E&&Object(B.jsx)(Nl.a,{message:U.f.messageArchivedAlert}),Object(B.jsx)(qn.b,{renderEmpty:()=>Object(Oi.a)("Du har inga arkiverade fordon"),children:Object(B.jsx)(M.a,{dataSource:S,columns:Object(re.m)(J),scroll:{x:1e3},rowClassName:"editable-row",...re.n})})]},"2")]})}),Object(B.jsx)("div",{style:{width:"100%",textAlign:"right"},children:Object(B.jsx)(h.a,{type:"primary",onClick:()=>{Ut.a.confirm({title:"Uppdatera BU-uppgifter",content:"Nya uppgifter kommer att l\xe4sas in baserat p\xe5 data ifr\xe5n Transportstyrelsen. Detta b\xf6r endast g\xf6ras i samband med stor f\xf6r\xe4ndring eller f\xf6rnyelse av fordonsflottan. Vill du forts\xe4tta?",okText:"Ja",onOk(){const e=p.map((e=>e.id));F.a.postVehicleSetFlag(e,"SE").then((e=>{y(e),b(e)})).catch((e=>{console.log(e)}))},onCancel(){}})},icon:Object(B.jsx)(lt.a,{}),children:"H\xe4mta Biluppgifter f\xf6r fordon med SE flagga utan historik"})})]}):Object(B.jsx)(o.a,{})]})};var Yl=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.o,c.y,c.d,c.i],children:Object(B.jsx)(Bl,{})}),Wl=n(316).a,Kl=n(103);const{Text:ql}=v.a,{Option:Jl,OptGroup:Ql}=k.a;n(181).registerLocale(n(182));const Zl=[];Object.entries(Ct.a).map((e=>{let[t,n]=e;Zl.push(Object(B.jsx)(Jl,{value:t,children:Object(B.jsx)(ct.Icon,{icon:n})}))}));const Xl=e=>{var t,n,a,l,r,o,s,d,c,v,j,h,p,b,O,m,g,f;const[x,y]=Object(i.useState)(null===(t=e.record)||void 0===t?void 0:t.organizationId),[E,I]=Object(i.useState)(null),[S,T]=Object(i.useState)(),[_,A]=Object(i.useState)(),[N,R]=Object(i.useState)(!1),[D]=u.a.useForm(),[w,L]=Object(i.useState)();Object(i.useEffect)((()=>{P()}),[e.isModalVisible]),Object(i.useEffect)((()=>{P()}),[x]),Object(i.useEffect)((()=>{var t,n;if((null===(t=e.record)||void 0===t||null===(n=t.state)||void 0===n||!n.imei)&&e.record&&!e.moveDevice){var i;const t=null===(i=e.record)||void 0===i?void 0:i.id;F.a.getVehicleDevice(t).then((e=>{const t=Array.from(new Set(null===e||void 0===e?void 0:e.map((e=>e.deviceId))));t.reverse(),A(t)}))}}),[e.record,e.moveDevice]),Object(i.useEffect)((()=>{var t,n;if(e.isModalVisible)if((null===e||void 0===e||null===(t=e.knownOrganizations)||void 0===t?void 0:t.length)<2&&!e.record)y(null===e||void 0===e||null===(n=e.knownOrganizations[0])||void 0===n?void 0:n.organizationId);else if(e.moveDevice){var i;y(null===(i=e.moveDevice)||void 0===i?void 0:i.organizationId)}else{var a;y(null===(a=e.record)||void 0===a?void 0:a.organizationId)}}),[e.knownOrganizations,e.record,e.isModalVisible,e.moveDevice]);const P=()=>{var t,n;D.resetFields(),D.setFieldsValue({organizationId:x}),L((null===(t=e.record)||void 0===t||null===(n=t.style)||void 0===n?void 0:n.color)||Object(re.i)()),I(null)},V=e=>{Ut.a.confirm({title:"Ingen enhet kopplad till tracker",content:"Du har inte valt n\xe5gon enhet. \xc4r detta korrekt? Tracker kommer inte visas p\xe5 karta.",okText:"Ja, ingen enhet",onOk(){M(e)},onCancel(){}})},M=t=>{let n=t.permittedDrivers?t.permittedDrivers.map((t=>{var n,i;const a=e.permittedDrivers.findIndex((e=>e.userId===t));return{id:null===(n=e.permittedDrivers[a])||void 0===n?void 0:n.userId,displayName:null===(i=e.permittedDrivers[a])||void 0===i?void 0:i.displayName}})):[];t={...t,permittedDrivers:n,style:{...t.style,color:w},defaultTripType:"BUSINESS",benefitType:"TRACKER"},e.record?function(t){var n;const i=null===(n=e.record)||void 0===n?void 0:n.id;let a;F.a.patchVehicle(i,t).then((e=>{a=e})).then((()=>e.moveDevice?e.handleMoveDeviceToOtherVehicle(e.moveDevice,i,t):Promise.resolve())).then((()=>{var n,l,r;if(null===(n=t.state)||void 0===n||!n.imei||null!==(l=e.record)&&void 0!==l&&null!==(r=l.state)&&void 0!==r&&r.imei)return Promise.resolve();{const n=t.state.imei;return F.a.patchDevices(n,i).then((t=>{var l;a.state=t;const r=null===(l=e.knownDevices)||void 0===l?void 0:l.find((e=>(null===e||void 0===e?void 0:e.id)===n));r&&(r.installedVehicle=i)}))}})).then((()=>{e.setData(a)})).catch((e=>{var t;let n=Kl.b[null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data];I(n)}))}(t):async function(t){try{var n,i,a;const o=await F.a.postSuperVehicle(t,x),s=o.id;let d=o;var l;if(e.moveDevice)await e.handleMoveDeviceToOtherVehicle(e.moveDevice,s),d.state=null===(l=e.moveDevice)||void 0===l?void 0:l.state;else if(null!==(n=t.state)&&void 0!==n&&n.imei&&(null===(i=e.record)||void 0===i||null===(a=i.state)||void 0===a||!a.imei)){var r;const n=t.state.imei,i=await F.a.patchDevices(n,s);d.state=i;const a=null===(r=e.knownDevices)||void 0===r?void 0:r.find((e=>(null===e||void 0===e?void 0:e.id)===n));a&&(a.installedVehicle=s)}e.moveDevice?e.setData([d,{...e.moveDevice,state:null}]):e.setData(d)}catch(s){var o;let e=Kl.b[null===s||void 0===s||null===(o=s.response)||void 0===o?void 0:o.data];I(e)}}(t)};const z=null===(n=e.permittedDrivers)||void 0===n||null===(a=n.filter((t=>{var n,i;return null===(n=e.record)||void 0===n||null===(i=n.permittedDrivers)||void 0===i?void 0:i.some((e=>(null===e||void 0===e?void 0:e.id)===(null===t||void 0===t?void 0:t.id)))})))||void 0===a?void 0:a.map((e=>null===e||void 0===e?void 0:e.id)),U=null===(l=e.permittedDrivers)||void 0===l?void 0:l.filter((e=>e.organizationId===x));let G=null===(r=e.imeiList)||void 0===r?void 0:r.filter((e=>e.organizationId===x&&!e.installedVehicle&&!0!==e.retired));return G=null===(o=G)||void 0===o?void 0:o.filter((e=>e.isTracker)),Object(B.jsx)(Ut.a,{centered:!0,title:"Tracker",onCancel:()=>{y(null),e.onModalCancel()},onOk:()=>D.submit(),okText:e.record?"Spara":"L\xe4gg till nytt tracker",visible:e.isModalVisible,bodyStyle:{overflowY:"auto",maxHeight:"calc(100vh - 200px)"},children:Object(B.jsxs)(u.a,{form:D,name:"basic",layout:"vertical",style:{margin:"auto",justifyContent:"center"},onFinish:t=>{var n,i;t.state.imei||null!==(n=e.record)&&void 0!==n&&null!==(i=n.state)&&void 0!==i&&i.imei?M(t):V(t)},initialValues:{...e.record,permittedDrivers:z,style:e.record?{...e.record.style}:{marker:"wrench",color:w},state:{imei:(null===(s=e.moveDevice)||void 0===s||null===(d=s.state)||void 0===d?void 0:d.imei)||(null===(c=e.record)||void 0===c||null===(v=c.state)||void 0===v?void 0:v.imei)}},children:[E&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(ee.a,{type:"error",message:E,showIcon:!0}),Object(B.jsx)("br",{})]}),Object(B.jsx)(u.a.Item,{label:"Organisation",name:"organizationId",rules:[{required:!0,message:"V\xe4lj organisation!"}],children:Object(B.jsx)(Z.a,{disabled:e.record||e.moveDevice,placeholder:"V\xe4lj organisation",data:e.knownOrganizations,selectedOrganization:x,onChange:e=>y(e)})}),Object(B.jsx)(u.a.Item,{label:"Enhet",name:["state","imei"],rules:[{required:!1,message:"V\xe4lj organisation!"}],children:Object(B.jsxs)(k.a,{allowClear:!0,showSearch:!0,disabled:(null===(j=e.record)||void 0===j||null===(h=j.state)||void 0===h?void 0:h.imei)||e.moveDevice||!e.isROOT,placeholder:"V\xe4lj enhet",filterOption:(e,t)=>{var n;return null===t||void 0===t||null===(n=t.children)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},children:[(null===(p=G)||void 0===p?void 0:p.filter((e=>null===_||void 0===_?void 0:_.includes(e.id))).length)>0&&Object(B.jsx)(Ql,{label:"Tidigare installerade enheter",children:null===_||void 0===_||null===(b=_.map(((e,t)=>{const n=G.find((t=>t.id===e));return n?Object(B.jsx)(k.a.Option,{value:n.id,children:t===_.length-1?"".concat(n.imei," (senaste)"):n.imei},n.id):null})))||void 0===b?void 0:b.reverse()}),(null===(O=G)||void 0===O?void 0:O.filter((e=>!(null!==_&&void 0!==_&&_.includes(e.id)))).length)>0&&Object(B.jsx)(Ql,{label:"Alla lediga enheter",children:null===(m=G)||void 0===m?void 0:m.filter((e=>!(null!==_&&void 0!==_&&_.includes(e.id)))).map((e=>Object(B.jsx)(k.a.Option,{value:e.id,children:e.imei},e.id)))})]})}),Object(B.jsx)(u.a.Item,{name:"displayName",label:"Alias",rules:[{required:!0,message:"Ange alias"}],children:Object(B.jsx)(C.a,{placeholder:"Ange alias"})}),Object(B.jsx)(u.a.Item,{label:"Beh\xf6riga anv\xe4ndare",name:"permittedDrivers",rules:[{required:!1,message:"V\xe4lj anv\xe4ndare!"}],children:N?Object(B.jsx)("p",{style:{marginTop:"0.5em",fontStyle:"italic"},children:"Poolbilar \xe4r till\xe5tna f\xf6r alla f\xf6rare."}):Object(B.jsxs)(k.a,{optionFilterProp:"children",allowClear:!0,showSearch:!0,autoComplete:!1,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.object))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},onSearch:()=>null,onChange:(e,t)=>T(t),mode:"multiple",style:{width:"100%"},placeholder:"V\xe4lj anv\xe4ndare",children:[Object(B.jsx)(Jl,{disabled:!0,value:"xxx",children:(null===S||void 0===S?void 0:S.length)>0?Object(B.jsx)("span",{onClick:()=>{D.setFieldsValue({permittedDrivers:[]}),T([])},style:{color:"#286FBE",cursor:"pointer"},children:"Avmarkera alla"}):Object(B.jsx)("span",{onClick:()=>{const e=null===U||void 0===U?void 0:U.map((e=>{let{userId:t}=e;return t}));D.setFieldsValue({permittedDrivers:e}),T(U)},style:{color:"#286FBE",cursor:"pointer"},children:"V\xe4lj alla"})}),null===U||void 0===U?void 0:U.map(((e,t)=>Object(B.jsx)(Jl,{value:e.userId,object:e,children:e.displayName})))]})}),Object(B.jsx)(u.a.Item,{label:"Ikon",children:Object(B.jsxs)(C.a.Group,{compact:!0,children:[Object(B.jsx)(u.a.Item,{name:["style","marker"],noStyle:!0,rules:[{required:!1,message:"Registration number is required"}],children:Object(B.jsx)(k.a,{placeholder:"V\xe4lj ikon",children:Zl})}),Object(B.jsx)(u.a.Item,{name:["style","color"],style:{margin:"auto"},rules:[{required:!1,message:"Street is required"}],children:Object(B.jsx)(Wl,{color:(null===(g=e.record)||void 0===g||null===(f=g.style)||void 0===f?void 0:f.color)||w,colorChange:e=>{L(e.hex)}})})]})})]})})},$l=n(181);$l.registerLocale(n(182));const{Text:er}=v.a,{Option:tr}=k.a,{TabPane:nr}=ze.a,ir=$l.getNames("sv",{select:"alias"}),ar=Object.entries(ir).map((e=>{let[t,n]=e;return{key:t,label:n}})).sort(((e,t)=>e.label.localeCompare(t.label))),lr=ar.filter((e=>"SE"===e.key||"FI"===e.key||"NO"===e.key||"DK"===e.key)),rr=ar.find((e=>"SE"===e.key)),or=lr.findIndex((e=>"SE"===e.key));lr.splice(or,1),lr.unshift(rr);const sr=()=>{const[e,t]=Object(i.useState)(),[n,l]=Object(i.useState)(),[r,o]=Object(i.useState)(!1),[s,d]=a.a.useState(""),u=Object(i.useContext)(c.h),j=Object(i.useContext)(c.x),p=Object(i.useContext)(c.c),b=Object(i.useContext)(c.n),O=null===b||void 0===b?void 0:b.filter((e=>!e.isArchived));return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(B.jsx)("div",{children:Object(B.jsx)(v.a.Title,{style:{marginBottom:0},children:"Superadmin - Utrustning"})}),Object(B.jsxs)("div",{style:{display:"flex",gap:15,flexWrap:"wrap"},children:[(null===u||void 0===u?void 0:u.length)<2?null:Object(B.jsx)(Z.a,{data:u,onChange:e=>{t(e)},selectedOrganization:e,isMultiple:!0}),Object(B.jsx)(C.a.Search,{type:"text",placeholder:"S\xf6k efter utrustning...",label:"Registreringsnummer",defaultValue:s,enterButton:!0,onChange:e=>{d(e.target.value.toLowerCase())},style:{width:300}}),Object(B.jsx)(h.a,{type:"primary",onClick:()=>o(!0),icon:Object(B.jsx)(ot.a,{}),children:"L\xe4gg till"})]})]}),Object(B.jsx)(dr,{permittedDrivers:O,devicesData:p,knownOrganizations:u,organizationId:e,setIsModalVisible:o,isModalVisible:r,benefitType:n,searchTerm:s,setSearchTerm:d,vehicles:j})]})},dr=e=>{var t,n;let{vehicles:a,permittedDrivers:r,changeOdometerValue:o,changeDefaultTripType:d,changeBenefitType:v,devicesData:j,searchTerm:h,setIsModalVisible:p,...b}=e;const[O]=u.a.useForm(),[m,g]=Object(i.useState)(),[f,x]=Object(i.useState)(!1),[y,E]=Object(i.useState)(),[I,S]=Object(i.useState)(),[T,k]=Object(i.useState)(!0),[C,_]=Object(i.useState)(""),[A,N]=Object(i.useState)(),[R,D]=Object(i.useState)(!1),[P,V]=Object(i.useState)(),[G,H]=Object(i.useState)(),[Y,W]=Object(i.useState)(null),[K,q]=Object(i.useState)(),J=Object(i.useContext)(c.z.context),{getTrackersReport:Q}=Object(i.useContext)(Qe),{updateVehicleFrequencyUpdate:Z}=Object(i.useContext)(Xe.a),ee=Object(i.useContext)(c.a),te=null===ee||void 0===ee||null===(t=ee.roles)||void 0===t?void 0:t.includes("ROOT"),{push:ne}=Object(l.g)();function ie(e){const t=[...G];if(Array.isArray(e))e.forEach((e=>{const n=t.findIndex((t=>e.id===t.id));n>-1?t.splice(n,1,{...t[n],...e}):t.push(e)}));else{const n=t.findIndex((t=>e.id===t.id));n>-1?t.splice(n,1,{...t[n],...e}):t.push(e)}g(t),H(t),p(!1),N(null)}Object(i.useEffect)((()=>{const e=null===a||void 0===a?void 0:a.filter((e=>e.isTracker));H(e),k(!1)}),[a]),Object(i.useEffect)((()=>{const e=null===m||void 0===m?void 0:m.sort(((e,t)=>{var n;return null===(n=e.displayName)||void 0===n?void 0:n.localeCompare(t.displayName)}));S(null===e||void 0===e?void 0:e.filter((e=>!e.isArchived))),E(null===e||void 0===e?void 0:e.filter((e=>e.isArchived)))}),[m]),Object(i.useEffect)((()=>{var e,t;let n=G;var i;(h.length>1&&(n=null===(e=n)||void 0===e?void 0:e.filter((e=>JSON.stringify(e).toLowerCase().includes(h)))),(null===b||void 0===b||null===(t=b.organizationId)||void 0===t?void 0:t.length)>0)&&(n=null===(i=n)||void 0===i?void 0:i.filter((e=>b.organizationId.includes(e.organizationId))));g(n)}),[h,G,b.organizationId,b.benefitType]);const ae=(e,t)=>{D(!0);const n={organizationId:t};F.a.patchChangeOrgVehicle(e.id,n).then((n=>{$.b.success("Tracker flyttades till en annan organisation.");const i=[...G],a=i.findIndex((t=>e.id===t.id)),l=i[a];let r=l;r={...l,organizationId:t,permittedDrivers:[],defaultDriver:null,currentDriver:null},i.splice(a,1,{...l,...r}),g(i),H(i),D(!1)})).catch((e=>{$.b.error("N\xe5got gick fel. F\xf6rs\xf6k igen."),console.error(e)}))};const le=[41465,41186,30714].includes(parseInt(localStorage.getItem(w.e)));const se=async e=>{var t,n;const i=null===Y||void 0===Y||null===(t=Y.displayName)||void 0===t||null===(n=t.split(" "))||void 0===n?void 0:n.join("_");await Q(e,i)||console.log("Export Successful")};const de=e=>{Ut.a.confirm({title:"Bekr\xe4fta borttagning av ".concat((null===e||void 0===e?void 0:e.registry)||e.displayName),icon:Object(B.jsx)(Sl.a,{}),okType:"danger",content:"\xc4r du s\xe4ker p\xe5 att du vill ta bort detta fordon?",onOk(){F.a.deleteVehicle(e.id).then((t=>{$.b.success((null===e||void 0===e?void 0:e.registry)||e.displayName+" har tagits bort"),function(e){const t=null===G||void 0===G?void 0:G.filter((t=>(null===t||void 0===t?void 0:t.id)!==(null===e||void 0===e?void 0:e.id)));H(t)}(e)}))},onCancel(){},okText:"Ta bort"})};function ce(e){var t,n;let i="\xc4ndra uppdateringsfrekvens (".concat((null===e||void 0===e?void 0:e.latestResponseFrequency)||"24h",")");const a=null===e||void 0===e||null===(t=e.state)||void 0===t?void 0:t.imei;return Object(B.jsxs)(X.a,{children:[Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(oe.a,{}),onClick:()=>function(e){N(e),p(!0)}(e),children:[U.f.BTN_CHANGE," "]}),Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(Ye.a,{}),onClick:()=>se(e.id),children:U.f.EXPORT_RAPPORT}),le?null:Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)($t.a,{}),onClick:()=>function(e,t,n){const i=null===e||void 0===e?void 0:e.id;let a;a=n?"&&showArchived=".concat(n):"",ne("".concat(s.c,"/").concat(t,"?vehicleId=").concat(i)+a)}(e,"map"),children:"Visa p\xe5 karta "}),Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(He.a,{}),onClick:()=>q(e),children:i}),(null===(n=b.knownOrganizations)||void 0===n?void 0:n.length)>1&&Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(_l.a,{}),onClick:()=>Object(re.c)(e,b.knownOrganizations,ae),children:"Flytta utrustning till annan organisation"}),Object(B.jsxs)(X.a.Item,{disabled:!a,icon:Object(B.jsx)(ti.a,{}),onClick:()=>(e=>{var t;const n=null===(t=e.state)||void 0===t?void 0:t.imei,i=null===j||void 0===j?void 0:j.find((e=>e.imei===n)),a=G.findIndex((t=>t.id===e.id));i&&Ut.a.confirm({title:"Bekr\xe4fta avinstallering f\xf6r ".concat((null===e||void 0===e?void 0:e.registry)||e.displayName),icon:Object(B.jsx)(Sl.a,{}),okType:"danger",content:"\xc4r du s\xe4ker p\xe5 att du vill avinstallera enhet?",onOk(){F.a.deleteAdminDevicesInstalled(i.id).then((e=>{if($.b.success("Enheten har avinstallerats"),D(!1),i.installedVehicle=null,i.retired=!1,-1!==a){const e=[...G];e[a].state=null,H(e)}}))},onCancel(){},okText:"Avinstallera"})})(e),children:[U.f.UNINSTALL_DEVICE," "]}),Object(B.jsxs)(X.a.Item,{danger:!0,icon:Object(B.jsx)(z.a,{}),onClick:()=>de(e),children:[U.f.REMOVE_VEHICLE," "]})]})}const ue=[{key:"style",dataIndex:"style",title:"Ikon",align:"center",width:80,render:e=>Object(re.p)(e)},{key:"displayName",dataIndex:"displayName",title:"Alias",fixed:"left"},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",editable:!1,hidden:J,render:e=>{var t;const n=null===(t=b.knownOrganizations)||void 0===t?void 0:t.find((t=>t.organizationId===e));return n?n.fullName:"-"}},{title:"Beh\xf6riga anv\xe4ndare",key:"dPermitted",dataIndex:"permittedDrivers",render:(e,t)=>{var n,i,a,l;e=null===(n=e)||void 0===n?void 0:n.filter((e=>null===r||void 0===r?void 0:r.find((t=>t.id===e.id))));let o;if("POOL"===(null===t||void 0===t?void 0:t.benefitType)&&(o="Till\xe5ts f\xf6r alla"),0===(null===(i=e)||void 0===i?void 0:i.length)&&(o="Anv\xe4ndare ej vald"),1===(null===(a=e)||void 0===a?void 0:a.length)){const t=null===r||void 0===r?void 0:r.find((t=>t.userId===e[0].id));o=null===t||void 0===t?void 0:t.displayName}if((null===(l=e)||void 0===l?void 0:l.length)>1){var s,d;const t=null===(s=e)||void 0===s?void 0:s.map((e=>e.id));let n=(null===(d=e)||void 0===d?void 0:d.length)+" anv\xe4ndare";return Object(Bt.a)(n,null,null,t,null,r,b.knownOrganizations)}return o}},{title:"Uppdateringsfrekvens",dataIndex:"latestResponseFrequency",key:"latestResponseFrequency",align:"center",render:(e,t)=>t.latestResponseFrequency!==t.selectedResponseFrequency&&t.selectedResponseFrequency?Object(B.jsxs)(L.a,{title:"V\xe4ntande \xe4ndring: "+t.selectedResponseFrequency,children:[t.latestResponseFrequency," ",Object(B.jsx)(st.a,{})]}):e},{title:"Batteri",dataIndex:"batteryPercentage",key:"batteryPercentage",align:"center",render:e=>e?e+"%":"-"},{title:"S\xe5gs senast",dataIndex:"lastSeen",key:"lastSeen",align:"center",render:(e,t)=>e?Object(B.jsx)(We.a,{value:e,typ:"map",isTracker:t.isTracker}):"-"},{key:"imei",dataIndex:"state",title:"Enhet",render:(e,t)=>{var n;if(null===e||void 0===e||!e.imei)return;let i=null===e||void 0===e||null===(n=e.imei)||void 0===n?void 0:n.toString();return Object(B.jsx)(L.a,{title:i,children:i})}},{title:"",dataIndex:"operation",width:80,fixed:"right",render:(e,t)=>Object(B.jsx)(re.a,{menu:()=>ce(t)})}].filter((e=>!e.hidden));let ve=P?" med imei "+(null===P||void 0===P||null===(n=P.state)||void 0===n?void 0:n.imei):"";return Object(B.jsxs)(u.a,{form:O,component:!1,children:[Object(B.jsx)(Xl,{onModalCancel:()=>{N(null),V(null),p(!1)},isModalVisible:b.isModalVisible,extraTitle:ve,knownOrganizations:b.knownOrganizations,organizationId:b.organizationId,permittedDrivers:r,setData:ie,knownDevices:j,record:A,moveDevice:P,imeiList:j,handleMoveDeviceToOtherVehicle:function(e,t,n){var i;D(!0),n=n||G;const a=null===(i=e.state)||void 0===i?void 0:i.imei,l=j.findIndex((e=>e.imei===a));if(-1===l)return D(!1),void $.b.error("Kunde inte hitta enheten.");const r=j[l];if(e.id!==t&&t)try{var o,s;F.a.patchDevices(r.id,t);const i=[...n],a=i.findIndex((t=>t.id===e.id)),l=i.findIndex((e=>e.id===t));let d;-1!==l&&(d={...i[l]},d.state={...r},d.odometer=e.odometer,i.splice(l,1,d));const c={...i[a]};c.state=null,c.odometer=null,i.splice(a,1,c),g(i),H(i),V(null),Ut.a.success({title:"Enheten flyttades",content:Object(B.jsxs)("div",{children:[Object(B.jsxs)("p",{children:["Enhet ",r.imei," flyttades till ",Object(B.jsx)("strong",{children:(null===(o=d)||void 0===o?void 0:o.registry)||(null===(s=d)||void 0===s?void 0:s.displayName)}),"."]}),Object(B.jsx)("p",{style:{fontWeight:"bold"},children:"Gl\xf6m inte att ta ut enheten."})]})})}catch(d){console.error(d),$.b.error("N\xe5got gick fel. F\xf6rs\xf6k igen.")}finally{D(!1)}else D(!1)},isROOT:te}),Object(B.jsx)(re.d,{record:Y,updateRecord:function(e){const t=[...G],n=null===t||void 0===t?void 0:t.findIndex((t=>(null===e||void 0===e?void 0:e.id)===t.id)),i=t[n];t.splice(n,1,{...i,...e}),H(t),W(null)},setRecord:W}),I?Object(B.jsxs)(oi.a,{spinning:""!==C&&R,children:[Object(B.jsx)(M.a,{dataSource:I,columns:Object(re.m)(ue),...re.n,scroll:{x:1e3},tableLayout:"fixed"}),Object(B.jsx)(re.e,{record:K,setRecordFrequencyInterval:q,handleUpdateFreq:async(e,t,n)=>{await Z(e,t).then((e=>{const i=t.replace("-","");ie({...n,selectedResponseFrequency:i})}))}})]}):Object(B.jsx)(sn.a,{})]})};var cr=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.o,c.y,c.d,c.i,Ze,Xe.b],children:Object(B.jsx)(sr,{})});const ur={medis:[59.315687697358946,18.070856701525805],taby:[59.444221552093595,18.06690916596459],tensta:[59.393962926448346,17.902708263155645],jakobsberg:[59.42354186348747,17.836801771749744],karolinska:[59.2214840656898,17.936377147304395],heron:[59.26682334953732,17.91156579920684],handen:[59.169079419829096,18.139629097077425],tyreso:[59.24434253853164,18.22917765543008],tcentralen:[59.33074233144711,18.059314762738563],kristineberg:[59.332873341662065,18.00294028011099],trangsund:[59.23223536469185,18.125718602191107],drottningholm:[59.32263688881373,17.887179357404417]},vr=a.a.createContext({map:null,maps:null}),jr=e=>{let{...t}=e;const[n,l]=Object(i.useState)({center:ur.medis,zoom:1,lastFittedBounds:null}),[r,o]=Object(i.useState)(),d={fitBoundsToLine:e=>{o(e)}};return a.a.useEffect((()=>{if(!n.maps||!n.map||!r)return void console.debug("UNABLE TO FIT BOUNDS YET!");const e=new n.maps.LatLngBounds;let t,i=90,a=180,o=-90,s=-180;r.forEach((e=>{t=!1,e.lat<i?i=e.lat:e.lng<a?a=e.lng:e.lat>o?o=e.lat:e.lng>s&&(s=e.lng)})),e.extend(new n.maps.LatLng(i,a)),e.extend(new n.maps.LatLng(o,s)),n.map.fitBounds(e,{top:10,right:10,left:10,bottom:10}),l({...n,lastFittedBounds:e})}),[n.map,n.maps,r]),Object(B.jsx)(vr.Provider,{value:{...d,...n,mapProps:{bootstrapURLKeys:{key:s.h},zoom:n.zoom,center:n.center,options:{disableDoubleClickZoom:!0},yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:e=>{let{map:t,maps:i}=e;if(!t||!i)throw new Error("Google API callback called, but no object received: Look for errors in GoogleMapReact");l({...n,center:null}),t.fitBounds(((e,t)=>{const n=new e.LatLngBounds;return t.forEach((t=>{n.extend(new e.LatLng(t[0],t[1]))})),n})(i,[ur.medis,ur.tensta,ur.tyreso])),l({...n,zoom:null,map:t,maps:i})}}},children:t.children})};var hr=n(126);const{DEBUG_ENDPOINT_URL:pr}=hr.a,{API_ENDPOINT_URL:br}=hr.a,Or=a.a.createContext({loaded:!1,payStations:[]}),mr=e=>{let{...t}=e;const[n,a]=Object(i.useState)({loading:!0,error:null,debug:!0,stations:[],references:[]}),l=n.debug?e=>e>=1e5:()=>!0,r=()=>hi("GET",pr+"/stations").then((e=>{let{response:t}=e;return JSON.parse(t)})).then((e=>e.map((e=>{let t=function(e,t,n){let i,a,l,r,o,s,d,c;switch(r=Math.floor(6*e),o=6*e-r,s=n*(1-t),d=n*(1-o*t),c=n*(1-(1-o)*t),r%6){case 0:i=n,a=c,l=s;break;case 1:i=d,a=n,l=s;break;case 2:i=s,a=n,l=c;break;case 3:i=s,a=d,l=n;break;case 4:i=c,a=s,l=n;break;case 5:i=n,a=s,l=d}return{r:Math.round(255*i),g:Math.round(255*a),b:Math.round(255*l)}}(parseFloat(e.number)/26,1,.8);((t.r<<16)+(t.g<<8)+t.b+(1<<17)).toString(16).substr(1);return{color:"rgb("+t.r+" "+t.g+" "+t.b+")",lat:e.geometry.coordinates[1],lng:e.geometry.coordinates[0],angleDeg:90-e.direction_deg,slug:e.number+":"+e.name,lineNumber:e._row,base:e}})))),o={reload:()=>{a({...n}),Promise.all([r(),hi("GET",pr+"/references").then((e=>{let{response:t}=e;return JSON.parse(t)})).then((e=>e.map((e=>({color:e.reference_back?"#ff0000":"#0000ff",longitude:e.geometry.coordinates[0],latitude:e.geometry.coordinates[1],cpId:e.cp_id,angleDeg:90-e.direction_deg,back:e.reference_back})))))]).then((e=>{let[t,i]=e;a({...n,loading:!1,stations:t,references:i})}))},putStationOverrides:(e,t)=>{const n=JSON.stringify(t);return console.debug("INCREMENT",n),hi("PUT",pr+"/station-override/"+e,!1,n)}};return Object(i.useEffect)((()=>{o.reload()}),[]),Object(B.jsx)(Or.Provider,{value:{debug:n.debug,loading:n.loading,error:n.error,stations:n.stations.filter((e=>l(e.base.cp_id))),references:n.references.filter((e=>l(e.cpId))),...o},children:t.children})},gr=a.a.createContext({}),fr=e=>{let{track:t=null,...n}=e;const[a,l]=Object(i.useState)({}),r=e=>hi("GET",pr+"/check-path/"+e).then((e=>{let{response:t}=e;return JSON.parse(t)}));Object(i.useEffect)((()=>{t&&o.updateCoords(t)}),[t]);const o={purgeTrip:e=>hi("POST",br+"/journal/"+e+"/reset-toll").then((()=>{l({...a,[e]:{loaded:!1,error:null,data:null}})})),updateCoords:e=>{var t;e?(t=e,console.log("getting trip coords for",t),hi("GET",pr+"/path-info/"+t).then((e=>{let{response:t}=e;return JSON.parse(t)}))).then((t=>(console.debug("Got trip coords",t),Promise.all([t,r(e)])))).then((t=>{let[{original_timestamps:n,road_interpolation:i,resampled_path:r,snap_source:o,original_path:s},d]=t;l({...a,[e]:{loaded:new Date,error:!1,data:{coords:s.coords,interpCoords:i.coords,resampledTrip:r.coords,snapSource:o,originalTimestamps:n,prices:d.prices,passages:d.passages.map(((e,t)=>({...e,price:d.prices[t]}))),hits:d.passages.filter((e=>e.hit)).map((e=>e.cp_id))}}})})):console.debug("No trip selected, ",e)}},s=t&&a[t]&&a[t].loaded&&a[t].data;return Object(B.jsx)(gr.Provider,{value:{byId:a,...o,tracked:s},children:n.children})};var xr=n(32),yr=n(388),Er=n.n(yr);n(885);var Ir=n(1003),Sr=n(1004),Tr=n(1005),kr=n(1006),Cr=n(1007);const{DEBUG_ENDPOINT_URL:_r}=hr.a,{API_ENDPOINT_URL:Ar}=hr.a,Nr=xr;Er.a.accessToken="pk.eyJ1IjoidHJhY2tzb24iLCJhIjoiY2t3YjM2OHF6MGJjcjJ2cWt1bDMwZjViMCJ9.nc3cCXyFi5hVSgwXIt6cZA";const Rr=e=>{let{recenter:t,payStationProps:n,payStationRef:l,mapOptions:r={},style:o={}}=e;const s=Object(i.useRef)(null),d=Object(i.useRef)(null),[c,u]=Object(i.useState)(!1);Object(i.useEffect)((()=>{if(console.debug("Checking center"),null===d||void 0===d||!d.current)return;const{lat:e,lng:n}=d.current.getCenter();if(console.debug("Recenter check: ",n,e,t),e!==t[1]||n!==t[0]){const e={center:t,speed:10,zoom:20,bearing:0,pitch:0};console.log("Recenter changed; Map flyTo = ",e,d.current.flyTo(e))}}),[t]);const v={width:8,height:40},j=a.a.useMemo((()=>(e=>{let{width:t,height:n,alpha:i=255}=e;const a=new Uint8Array(t*n*4);return Object(pt.e)(n).forEach((e=>{const n=e<20?[255,0,0,i]:[240,240,240,i];Object(pt.e)(t).forEach((i=>{const l=4*(e*t+i);Object(pt.e)(4).forEach((e=>{a[l+e]=n[e]}))}))})),a})({...v})),[]);Object(i.useEffect)((()=>{s.current&&(d.current||(d.current=new Er.a.Map({container:s.current,style:"mapbox://styles/mapbox/streets-v11",zoom:10,options:r}),d.current.on("load",(()=>(d.current.addImage("needle",{...v,data:j}),u(!0))))))}),[d,s]);const[h,p]=Object(i.useState)([]),[b,O]=Object(i.useState)([]);return Object(i.useEffect)((()=>{if(!n||null===d||void 0===d||!d.current||!c)return;const e=d.current,t=Object.values(n).map(((t,n)=>{const i="paystation-"+n,a={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[t.lng,t.lat]}}]};return h.includes(i)?e.getSource(i).setData(a):e.addSource(i,{type:"geojson",data:a}),i})),i=Object.values(n).map(((t,n)=>{const i="paystation-"+n,a=i+"-layer",l={id:a,type:"symbol",source:i,layout:{"icon-image":"needle","icon-rotate":t.angleDeg,"icon-allow-overlap":!0,"text-field":""+t.base.cp_id,"text-allow-overlap":!0,"text-ignore-placement":!0},minzoom:0,maxzoom:24};return b.includes(a)&&e.removeLayer(a),e.addLayer(l),a}));h.forEach((n=>{t.includes(n)||e.removeSource(n)})),b.forEach((t=>{i.includes(t)||e.removeLayer(t)})),O(i),p(t)}),[d.current,n,c]),Object(i.useEffect)((()=>{console.debug("MAP CONTAINER RELOAD?",s)}),[s]),Object(B.jsx)("div",{style:o,ref:s})},Dr=e=>{let{icon:t,action:n,value:i}=e;return Object(B.jsx)(h.a,{icon:t,type:"default",onClick:n})},wr=e=>{let{payStationProps:t,onStationClick:n}=e;const a=Object(i.useContext)(Or),l=(e,t)=>n=>i=>((e,t,n,i)=>{const l={[n]:(t.base[n]||0)+i*(e.shiftKey?5:1)*(e.ctrlKey?25:1)};return console.debug("INCREMENT",l),a.putStationOverrides(t.base.cp_id,l).then((()=>{a.reload()}))})(i,n,e,t),r={west:l("sweref99tm_e",-.1),south:l("sweref99tm_n",-.1),north:l("sweref99tm_n",.1),east:l("sweref99tm_e",.1),ccw:l("nudge_angle",1),cw:l("nudge_angle",-1)};return Object(B.jsxs)("table",{children:[Object(B.jsxs)("tr",{children:[Object(B.jsx)("th",{children:"ID"}),Object(B.jsx)("th",{children:"Nudge"}),Object(B.jsx)("th",{children:"info"})]}),t.map(((e,t)=>Object(B.jsxs)("tr",{children:[Object(B.jsx)("td",{children:Object(B.jsx)("a",{title:e.base.name,onClick:()=>n(e),children:e.base.cp_id%1e5})}),Object(B.jsxs)("td",{children:[Object(B.jsx)(Dr,{icon:Object(B.jsx)(Ir.a,{}),action:r.ccw(e)}),Object(B.jsx)(Dr,{icon:Object(B.jsx)(Sr.a,{}),action:r.west(e),value:e.base.sweref99tm_e}),Object(B.jsx)(Dr,{icon:Object(B.jsx)(ii.a,{}),action:r.south(e),value:e.base.sweref99tm_e}),Object(B.jsx)(Dr,{icon:Object(B.jsx)(Tr.a,{}),action:r.north(e),value:e.base.sweref99tm_e}),Object(B.jsx)(Dr,{icon:Object(B.jsx)(kr.a,{}),action:r.east(e),value:e.base.sweref99tm_e}),Object(B.jsx)(Dr,{icon:Object(B.jsx)(Cr.a,{}),action:r.cw(e)})]})]},t)))]})},Lr=()=>{const[e,t]=Object(i.useState)([11.96710577918244,57.706335051165645]),[n,a]=Object(i.useState)({bearingSnap:360,boxZoom:!1,antialias:!1,dragRotate:!1,dragPan:!1,fadeDuration:0,maxTileCacheSize:99999999999,optimizeForTerrain:!0,pitchWithRotate:!1}),l=Object(i.useContext)(Or);return console.debug("STATIONS",l.stations),Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(Nr.Row,{children:[Object(B.jsx)(Nr.Col,{span:6,children:Object(B.jsx)(wr,{onOverridePut:l.reload,payStationProps:l.stations,onStationClick:e=>{console.debug("Click station",e),t([e.lng,e.lat])}})}),Object(B.jsxs)(Nr.Col,{span:18,children:[Object(B.jsx)(Nr.Affix,{offsetTop:20,children:Object(B.jsx)(Rr,{style:{height:"75vh"},recenter:e,payStationProps:l.stations,payStationRef:l.references,mapOptions:n})}),Object(B.jsx)(h.a,{onClick:()=>l.reload(),children:"Refresh Meta"})]})]})})},Pr=e=>{const t="["+e.base.cp_id+"] "+e.base.number+": "+e.base.name;let n;switch(e.base.cp_id%4){case 0:n="-50%, -150%";break;case 1:n="-25%, -150%";break;case 2:n="-50%, -175%";break;case 3:n="-25%, -175%"}return Object(B.jsxs)("div",{style:{position:"absolute",transform:"translate(-50%, -50%)"},children:[Object(B.jsx)(Ur,{angleClock:e.angleDeg}),Object(B.jsx)(L.a,{title:t,children:Object(B.jsx)(ct.Icon,{icon:vt.mapMarker,style:{fontSize:12,color:e.color}})})]})},Vr=e=>{let{back:t,onClick:n,latitude:i,longitude:a,angleDeg:l,cpId:r,...o}=e;return Object(B.jsxs)("div",{style:{position:"absolute",transform:"translate(-50%, -50%)",opacity:"0.7"},children:[Object(B.jsx)(Ur,{angleClock:l,style:{opacity:.5}}),Object(B.jsx)(L.a,{title:""+r,onClick:n,children:Object(B.jsx)(ct.Icon,{icon:vt.mapMarker,style:{fontSize:4,color:t?"#f66":"#66f"}})})]})},Mr=e=>{let{display:t,key:n,style:i={},text:a=" ",...l}=e;return t?Object(B.jsx)("div",{style:{position:"absolute",transform:"translate(-50%, -50%)",height:"10px",borderColor:"#000",backgroundColor:"#fff",color:"#000",fontFamily:"monospace",padding:"1px",fontSize:"8px",...i},children:a}):null},Fr=e=>{let{coords:t,style:n={},display:a=!0,...l}=e;const{map:r,maps:o}=Object(i.useContext)(vr),s=Object(i.useRef)();return Object(i.useEffect)((()=>()=>{console.debug("Component is unmounting, clearing plot"),s.current?s.current.setMap(null):console.warn("There was no plot to remove")}),[]),Object(i.useEffect)((()=>{s&&s.current&&(console.log("Updating plot visibility",a,s),s.current.visible=a)}),[a,s]),Object(i.useEffect)((()=>{if(s.current&&s.current.setMap(null),!r||!o||!t)return;const e=new o.Polyline({path:t,geodesic:!1,strokeColor:"#0000ff",strokeOpacity:1,strokeWeight:4,visible:a,...n});e.setMap(r),console.debug("Plot has been mapped, assigning to state"),s.current=e}),[r,t]),null};function zr(e){let{displayState:t}=e;const n=Object(i.useContext)(vr),a=Object(i.useContext)(Or),l=Object(i.useContext)(gr).tracked;Object(i.useEffect)((()=>{l&&(n.fitBoundsToLine(l.interpCoords),console.debug("EXPECTED BOUNDS TO REFIT"))}),[l]);const[r,o]=Object(i.useState)({});return console.debug("Checking trip tax",l),!l||a.loading?null:Object(B.jsxs)(ae.a,{...n.mapProps,children:[l.passages.map(((e,t)=>{let n;switch(e.cp_id%4){case 0:n="-50%, -150%";break;case 1:n="-25%, -150%";break;case 2:n="-50%, -175%";break;case 3:n="-25%, -175%"}const i=e.isotime.replace(/^\d\d\d\d-\d\d-\d\dT(\d\d:\d\d).*$/,"$1"),a=e=>e.children;return Object(B.jsx)(a,{lat:e.intersection.lat,lng:e.intersection.lng,children:Object(B.jsx)(L.a,{title:"["+e.cp_id%1e4+"]",children:Object(B.jsxs)("div",{style:{display:e.hit?"block":"none",position:"absolute",transform:"translate("+n+")",color:"#000",fontSize:"1.2em",fontFamily:"Arial",opacity:1,border:"1px solid #990",backgroundColor:"#fff",zIndex:1e4},children:[i,e.price&&"\n"+e.price+"\xa0SEK"]})})},t)})),null,t.originalTrip&&Object(B.jsx)(Fr,{coords:l.coords,style:{strokeColor:"#333333"}}),t.resampledTrip&&l.resampledTrip&&l.resampledTrip.map(((e,n)=>Object(B.jsx)(Mr,{text:""+n,display:t.showAllCoords,lat:e.lat,lng:e.lng},n))),t.resampledTrip&&Object(B.jsx)(Fr,{coords:l.resampledTrip,style:{strokeColor:"#ff00ff"}}),t.interpTrip&&Object(B.jsx)(Fr,{coords:l.interpCoords,style:"google"===l.snapSource?{strokeColor:"#0000ff"}:{strokeColor:"#ff0000"}}),t.tolls&&Object.values(a.stations).map(((e,n)=>{const i={key:n,hit:l.hits.includes(e.base.cp_id),lat:e.lat,lng:e.lng,...e};return(i.hit||t.allStations)&&Object(B.jsx)(Pr,{...i})})).filter((e=>e))||null,t.references&&a.references.map(((e,t)=>Object(B.jsx)(Vr,{onClick:()=>(e=>{o({...r,[e.cpId]:!r[e.cpId]})})(e),lat:e.latitude,lng:e.longitude,...e},t)))||null]})}const Ur=e=>{let{angleClock:t,style:n}=e;return Object(B.jsx)("img",{src:"/img/fig.png",alt:"Missing 'alt' attribute",style:{position:"absolute",transform:"rotate("+t+"deg)",...n}})};console.debug("KNOWN LOCATIONS",ur);const Br=e=>{let{tripId:t}=e;const n=Object(i.useContext)(gr),[a,l]=Object(i.useState)(!1);return Object(B.jsx)(h.a,{enabled:!!t,loading:a,onClick:()=>n.purgeTrip(t),children:"Refresh"})};var Gr=e=>{let{debugMapBox:t=!1}=e;const n=()=>{const e=Object(i.useContext)(Or),t=Object(i.useRef)();let n=null;const a=localStorage.getItem("triptax-analyzer.displayState");try{if(n=JSON.parse(a),!n||n.__version__<2)throw new SyntaxError("Breaking cache")}catch{localStorage.removeItem("triptax-analyzer.displayState")}const[r,o]=Object(i.useReducer)(((e,t)=>t(e)),n||{tolls:!0,references:!0,resampledTrip:!0,interpTrip:!0,originalTrip:!0,allStations:!0},void 0);Object(i.useEffect)((()=>{localStorage.setItem("triptax-analyzer.displayState",JSON.stringify({...r,__version__:2}))}),[r]);const s=e=>{let{text:t,attr:n}=e;return Object(B.jsx)(Qt.a,{checked:r[n],onChange:()=>o((e=>({...e,[n]:!e[n]}))),children:t})},d=(e=>{const t=e.pathname.split("/"),n=t[t.length-1];let i=parseInt(n);return isNaN(i)&&(i=null),i})(Object(l.h)());return Object(B.jsx)("div",{children:Object(B.jsxs)("div",{style:{height:"75vh",width:"100%"},children:[Object(B.jsx)("input",{type:"checkbox",name:"show-coords",id:"show-coords",tabIndex:2,defaultChecked:r.showAllCoords,ref:t,onChange:e=>{(()=>{const e=r.showAllCoords;console.log(e),o((t=>({...t,showAllCoords:e})))})()}}),Object(B.jsx)("label",{htmlFor:"show-coords",children:"Show coords"}),Object(B.jsx)(Qt.a,{checked:r.tolls&&r.references,onChange:()=>o((e=>({...e,tolls:!e.tolls,references:!e.references}))),children:"Show/hide stations"}),Object(B.jsx)(s,{text:"Show/hide original path",attr:"originalTrip"}),Object(B.jsx)(s,{text:"Show/hide coordinate selection",attr:"resampledTrip"}),Object(B.jsx)(s,{text:"Show/hide smoothed path",attr:"interpTrip"}),Object(B.jsx)(s,{text:"Show/hide all stations",attr:"allStations"}),Object(B.jsxs)("form",{onSubmit:e=>(e.preventDefault(),(e=>{var t;console.log(e.target);const n=parseInt((null===(t=e.target.getElementsByClassName("tripId")[0])||void 0===t?void 0:t.value)||0);console.log("Picked new trip: ",n),n&&(window.location.href="/app/triptax-analyzer/"+n)})(e),!1),children:[Object(B.jsx)("input",{tabIndex:1,name:"tripId",className:"tripId"}),Object(B.jsx)("input",{tabIndex:3,type:"submit",value:"ok"})]}),Object(B.jsx)(h.a,{onClick:()=>e.reload(),children:"Refresh meta"}),Object(B.jsxs)(fr,{track:d,children:[Object(B.jsx)(Br,{tripId:d}),Object(B.jsx)(jr,{children:Object(B.jsx)(zr,{displayState:r})})]})]})})};return t?Object(B.jsx)(mr,{children:Object(B.jsx)(Lr,{})}):Object(B.jsx)(mr,{children:Object(B.jsx)(n,{})})};const{Title:Hr}=v.a,{Text:Yr}=v.a,{TextArea:Wr}=C.a,{Panel:Kr}=Pn.a,qr=()=>{const[e]=u.a.useForm();return Object(B.jsx)(j.a,{title:"Har du n\xe5gra fr\xe5gor eller funderingar?",bordered:!0,style:{minWidth:500},children:Object(B.jsxs)(u.a,{form:e,layout:"vertical",name:"form_in_modal",onFinish:t=>{F.b.postContactTrackson(t).then((t=>{$.b.success("Ditt meddelande har skickats!"),e.resetFields()})),console.log("Success:",t)},initialValues:{modifier:"public"},children:[Object(B.jsx)(u.a.Item,{label:U.f.TITLE,name:"subject",rules:[{required:!0,message:"F\xe4ltet \xe4r obligatoriskt"}],children:Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY_TITLE})}),Object(B.jsx)(u.a.Item,{label:"E-post",name:"addrFrom",rules:[{required:!0,message:"F\xe4ltet \xe4r obligatoriskt"}],children:Object(B.jsx)(C.a,{placeholder:H.k.exEmail})}),Object(B.jsx)(u.a.Item,{label:U.f.PHONE_NUMBER,name:"phone",rules:[{required:!0,message:"F\xe4ltet \xe4r obligatoriskt"}],children:Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY_A_NEW_ORG_PHONE})}),Object(B.jsx)(u.a.Item,{label:"Meddelande",name:"body",rules:[{required:!0,message:"F\xe4ltet \xe4r obligatoriskt"}],children:Object(B.jsx)(Wr,{placeholder:U.f.DESCRIBE_CASE,rows:13})}),Object(B.jsx)(h.a,{htmlType:"submit",type:"primary",children:"Skicka"})]})})};var Jr=()=>Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:[Object(B.jsx)(Hr,{children:"Kundtj\xe4nst"}),Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:"100%",width:"100%",justifyContent:"center",alignItems:"top",gap:"3em",flexWrap:"wrap"},children:[Object(B.jsxs)(j.a,{bordered:!0,style:{minWidth:300,whiteSpace:"normal",flexWrap:"wrap",display:"flex",gap:30,justifyContent:"center",alignItems:"center",textAlign:"center"},children:[Object(B.jsx)(Hr,{level:2,children:"Kontakta oss"}),Object(B.jsxs)(Yr,{style:{whiteSpace:"normal"},children:["Vill du veta mer eller har du fr\xe5gor?",Object(B.jsx)("br",{}),"Tveka inte att h\xf6ra av dig till oss!"]}),Object(B.jsx)("br",{}),Object(B.jsx)("br",{}),Object(B.jsx)("br",{}),Object(B.jsx)("a",{href:"tel: +460104240940",children:Object(B.jsxs)(h.a,{size:"large",type:"primary",style:{margin:"auto"},children:[Object(B.jsx)(Vn.a,{style:{marginBottom:"4.5em"}}),"010 - 424 09 40"]})}),Object(B.jsx)("div",{style:{marginTop:40},children:Object(B.jsx)(Yr,{style:{whiteSpace:"normal"},children:"Vi erbjuder ocks\xe5 fj\xe4rrsupport med"})}),Object(B.jsx)("div",{style:{position:"relative",minWidth:500,height:"37.5px",margin:"15px auto"},children:Object(B.jsx)("a",{href:"https://get.teamviewer.com/trackson",style:{textDecoration:"none"},children:Object(B.jsx)("img",{src:"https://static.teamviewer.com/resources/badges/teamviewer_badge_flat4.png",alt:"Fj\xe4rr\xe5tkomst och support med TeamViewer",title:"Fj\xe4rr\xe5tkomst och support med TeamViewer",style:{border:"0",width:"146.25px",height:"37.5px"}})})})]}),Object(B.jsx)(qr,{})]}),Object(B.jsx)("div",{})]});var Qr=()=>Object(B.jsx)(Ze,{children:Object(B.jsx)(Jr,{})}),Zr=n(214);const{Title:Xr}=v.a,$r={addItem:{width:"100%",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"20"}},eo=e=>{let{editing:t,dataIndex:n,title:i,inputType:a,record:l,index:r,children:o,...s}=e;const d=Object(B.jsx)(C.a,{});return Object(B.jsx)("td",{...s,children:t?Object(B.jsx)(u.a.Item,{name:n,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(i,"!")}],children:d}):o})},to=e=>{let{save:t}=e;return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Xr,{level:4,children:U.f.ADD_NEW_PURPOSE}),Object(B.jsxs)("div",{style:$r.addItem,children:[Object(B.jsx)(u.a.Item,{name:H.k.new_purposes,style:{marginRight:20,width:"70%"},rules:[{required:!1,message:U.b.PURPOSE}],children:Object(B.jsx)(C.a,{placeholder:U.f.SUPPLY_PURPOSE})}),Object(B.jsx)(h.a,{type:"primary",onClick:()=>t(-1),icon:Object(B.jsx)(le.a,{}),children:U.f.ADD})]})]})};var no=()=>{const[e]=u.a.useForm(),[t,n]=Object(i.useState)([]),[a,l]=Object(i.useState)(),[r,s]=Object(i.useState)(""),[d,c]=Object(i.useState)(!0),[v,j]=Object(i.useState)(),[p,b]=Object(i.useState)(),[O,m]=Object(i.useState)(),[g,f]=Object(i.useState)(),[x,y]=Object(i.useState)(!1);Object(i.useEffect)((()=>{F.b.getCurrentUser().then((e=>{var t;console.log("userId",e),l(e.userId),null!==(t=e.roles)&&void 0!==t&&t.includes("ROOT")&&y(!0)})),F.a.getOrganizationsSimple().then((e=>{j(e)})),F.a.getUsersSimple().then((e=>{b(e),f(e)}))}),[]),Object(i.useEffect)((()=>{a&&(c(!0),F.a.getUserById(a).then((e=>{let t=e[0],i=t.purposes,a=0;t=t[a];const l=null===i||void 0===i?void 0:i.map((e=>({key:a++,purposes:e})));n(l),console.log("daaaata",l),c(!1)})))}),[a]),Object(i.useEffect)((()=>{let e=p;var t;(null===p||void 0===p?void 0:p.length)>0&&(null===O||void 0===O?void 0:O.length)>0&&(e=null===(t=e)||void 0===t?void 0:t.filter((e=>(null===O||void 0===O?void 0:O.includes(e.organizationId))||e.id===a)));f(e)}),[O]);const E=e=>e.key===r,I=()=>{s("")};function S(e){const t=[];null===e||void 0===e||e.map((e=>{t.push(e.purposes)})),F.a.patchUser(a,{purposes:t}).then((e=>{$.b.success(U.f.UPDATE_PURPOSE)}))}const T=async i=>{try{let a=await e.validateFields();const l=[...t];console.log(l);const r=l.findIndex((e=>i===e.key));if(a={purposes:a.purposes||a.new_purposes},r>-1){const e=l[r];l.splice(r,1,{...e,...a}),n(l),s("")}else console.log(a),a={key:l.length,...a},l.push(a),n(l.sort(((e,t)=>e.purposes.localeCompare(t.purposes)))),s("");null===e||void 0===e||e.resetFields(),S(l)}catch(a){console.log("Validate Failed:",a)}},k=[{title:U.f.DESCRIPTION,dataIndex:H.k.purposes,editable:!0},{dataIndex:"operation",render:(i,a)=>E(a)?Object(B.jsxs)(Zr.a,{justifyContent:"end",children:[Object(B.jsx)(h.a,{type:Ke.a,onClick:()=>T(a.key),children:U.f.SAVE}),Object(B.jsx)(h.a,{type:Ke.a,onClick:()=>I(a.key),children:U.f.BTN_ABORT})]}):Object(B.jsx)(re.a,{menu:()=>function(i){return Object(B.jsxs)(X.a,{children:[Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(oe.a,{}),onClick:()=>(t=>{e.setFieldsValue({...t}),s(t.key)})(i),children:[U.f.BTN_CHANGE," "]}),Object(B.jsxs)(X.a.Item,{danger:!0,icon:Object(B.jsx)(z.a,{}),onClick:()=>(e=>{const i=null===t||void 0===t?void 0:t.filter((t=>t.key!==e));n(i),console.log(e),S(i)})(i.key),children:[U.f.DELETE," "]})]})}(a)})}];const C={body:{cell:eo}},_=k.map((e=>e.editable?{...e,onCell:t=>({record:t,inputType:"age"===e.dataIndex?"number":"text",dataIndex:e.dataIndex,title:e.title,editing:E(t)})}:e));return d?Object(B.jsx)(o.a,{}):Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(B.jsx)(Xr,{children:U.f.DESCRIPTIONS}),x?Object(B.jsxs)("div",{style:{display:"flex",marginBottom:20,gap:15,flexWrap:"wrap"},children:[(null===v||void 0===v?void 0:v.length)<2?null:Object(B.jsx)(Z.a,{data:v,onChange:e=>{m(e)},selectedOrganization:O,isMultiple:!0}),Object(B.jsx)(Oe,{data:g,value:a,onChange:e=>l(e)})]}):null]}),Object(B.jsx)(Fe.a,{}),Object(B.jsxs)(u.a,{form:e,component:!1,children:[Object(B.jsx)(to,{save:T}),Object(B.jsx)(Xr,{level:4,children:U.f.SAVED_PURPOSE}),Object(B.jsx)(M.a,{components:C,dataSource:t,columns:_,rowClassName:"editable-row",pagination:{onChange:I},...re.n})]})]})};var io=()=>Object(B.jsx)(Vt.a,{wrappers:[],children:Object(B.jsx)(no,{})});var ao={paragraph:{margin:0,fontSize:"18px"},interval:{display:"flex",gap:15,alignItems:"center",marginBottom:25}};var lo=function(){const[e,t]=Object(i.useState)([]),[n,a]=Object(i.useState)(!0),[l,r]=Object(i.useState)(!1),[s,d]=Object(i.useState)(),[c,u]=Object(i.useState)([]),[j,p]=Object(i.useState)(!1),[b,O]=Object(i.useState)(),[m,g]=Object(i.useState)(),[f,x]=Object(i.useState)();Object(i.useEffect)((()=>{F.a.getOrganizationsSimple().then((e=>{O(e)}))}),[]);const y=()=>{F.a.patchWeekdaySelection(s,e).then((e=>{$.b.destroy(),$.b.success("Dina \xe4ndringar har sparats")}))},E=e=>{F.a.getWeekdaySelection(e).then((e=>{var n;7===e.daysList.length?(t(e),p(null===(n=e.tripType)||void 0===n?void 0:n.startsWith("BUSINESS")),r(!1)):(t(ye),r(!0));a(!1)}))};return Object(i.useEffect)((()=>{F.b.getCurrentUser().then((e=>{d(e.userId),(e=>{F.a.getUsersSimple().then((t=>{g(t),x(t),E(e.userId)}))})(e)}))}),[]),Object(i.useEffect)((()=>{let e=m;var t;(null===m||void 0===m?void 0:m.length)>0&&c.length>0&&(e=null===(t=e)||void 0===t?void 0:t.filter((e=>c.includes(e.organizationId)||e.id===s)));x(e)}),[c]),n?Object(B.jsx)(o.a,{}):Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(B.jsx)(S.a,{children:Object(B.jsx)(v.a.Title,{children:"Arbetstidsschema"})}),Object(B.jsxs)("div",{style:{display:"flex",marginBottom:20,gap:15,flexWrap:"wrap"},children:[(null===b||void 0===b?void 0:b.length)<2?null:Object(B.jsx)(Z.a,{data:b,onChange:e=>{u(e)},selectedOrganization:c,isMultiple:!0}),Object(B.jsx)(Oe,{data:f,value:s,onChange:e=>(e=>{d(e),a(!0),E(e)})(e)})]})]}),Object(B.jsxs)("div",{style:ao.interval,children:[Object(B.jsx)("p",{style:ao.paragraph,children:U.f.SCHEDULE_PRESELECTION}),Object(B.jsx)("div",{children:Object(B.jsx)(R.a,{style:{minWidth:80,backgroundColor:j?H.b.SWITCH_BUSINESS:H.b.SWITCH_PRIVATE},checkedChildren:"Tj\xe4nst",unCheckedChildren:"Privat",checked:j,onChange:e=>{const t={tripType:e?"BUSINESS":"PRIVATE"};F.a.patchWeekdaySelection(s,t).then((e=>{p(!j)}))},disabled:l})})]}),Object(B.jsx)(ke,{ifDefaultSchedule:l,selectedTripType:j,schedule:e.daysList||e,changeScheduleParam:(n,i)=>{if(!l){({})[n-=1]=i;let a=e;a.daysList[n]={...a.daysList[n],...i},t(a),y()}}}),Object(B.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"15px"},children:l?Object(B.jsx)(h.a,{onClick:()=>{r(!1),F.a.postWeekdaySelection(s,e).then((e=>{$.b.success("Du har skapat ditt f\xf6rsta schema")}))},type:"primary",style:{backgroundColor:H.b.SWITCH_PRIVATE,borderColor:H.b.GREEN},children:"Aktivera schema"}):null})]})};var ro=()=>Object(B.jsx)(Vt.a,{wrappers:[],children:Object(B.jsx)(lo,{})}),oo=n(374),so=n(313);var co=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.o,c.y,c.d,c.i],children:Object(B.jsx)(so.a,{})});var uo=()=>Object(B.jsx)(Vt.a,{wrappers:[],children:Object(B.jsx)(fe,{})});const vo=n(181);vo.registerLocale(n(182));const{Text:jo}=v.a,{Option:ho}=k.a,{TabPane:po}=ze.a,bo=vo.getNames("sv",{select:"alias"}),Oo=Object.entries(bo).map((e=>{let[t,n]=e;return{key:t,label:n}})).sort(((e,t)=>e.label.localeCompare(t.label))),mo=Oo.filter((e=>"SE"===e.key||"FI"===e.key||"NO"===e.key||"DK"===e.key)),go=Oo.find((e=>"SE"===e.key)),fo=mo.findIndex((e=>"SE"===e.key));mo.splice(fo,1),mo.unshift(go);const xo=()=>{const[e,t]=Object(i.useState)(),[n,l]=Object(i.useState)(),[r,o]=Object(i.useState)(!1),[s,d]=a.a.useState(""),u=Object(i.useContext)(c.h),j=Object(i.useContext)(c.x),h=Object(i.useContext)(c.c),p=Object(i.useContext)(c.n),b=null===p||void 0===p?void 0:p.filter((e=>!e.isArchived));return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(B.jsx)("div",{children:Object(B.jsx)(v.a.Title,{style:{marginBottom:0},children:"Utrustning"})}),Object(B.jsxs)("div",{style:{display:"flex",gap:15,flexWrap:"wrap"},children:[(null===u||void 0===u?void 0:u.length)<2?null:Object(B.jsx)(Z.a,{data:u,onChange:e=>{t(e)},selectedOrganization:e,isMultiple:!0}),Object(B.jsx)(C.a.Search,{type:"text",placeholder:"S\xf6k efter utrustning...",label:"Registreringsnummer",defaultValue:s,enterButton:!0,onChange:e=>{d(e.target.value.toLowerCase())},style:{width:300}})]})]}),Object(B.jsx)(yo,{permittedDrivers:b,devicesData:h,knownOrganizations:u,organizationId:e,setIsModalVisible:o,isModalVisible:r,benefitType:n,searchTerm:s,setSearchTerm:d,vehicles:j})]})},yo=e=>{var t,n;let{vehicles:a,permittedDrivers:r,changeOdometerValue:o,changeDefaultTripType:d,changeBenefitType:v,devicesData:j,searchTerm:h,setIsModalVisible:p,...b}=e;const[O]=u.a.useForm(),[m,g]=Object(i.useState)(),[f,x]=Object(i.useState)(!1),[y,E]=Object(i.useState)(),[I,S]=Object(i.useState)(),[T,k]=Object(i.useState)(!0),[C,_]=Object(i.useState)(""),[A,N]=Object(i.useState)(),[R,D]=Object(i.useState)(!1),[P,V]=Object(i.useState)(),[z,G]=Object(i.useState)(),[H,Y]=Object(i.useState)(null),[W,K]=Object(i.useState)(),q=Object(i.useContext)(c.z.context),{getTrackersReport:J}=Object(i.useContext)(Qe),{updateVehicleFrequencyUpdate:Q}=Object(i.useContext)(Xe.a),Z=Object(i.useContext)(c.a),{push:ee}=(null===Z||void 0===Z||null===(t=Z.roles)||void 0===t||t.includes("ROOT"),Object(l.g)());function te(e){const t=[...z];if(Array.isArray(e))e.forEach((e=>{const n=t.findIndex((t=>e.id===t.id));n>-1?t.splice(n,1,{...t[n],...e}):t.push(e)}));else{const n=t.findIndex((t=>e.id===t.id));n>-1?t.splice(n,1,{...t[n],...e}):t.push(e)}g(t),G(t),p(!1),N(null)}Object(i.useEffect)((()=>{const e=null===a||void 0===a?void 0:a.filter((e=>e.isTracker));G(e),k(!1)}),[a]),Object(i.useEffect)((()=>{const e=null===m||void 0===m?void 0:m.sort(((e,t)=>{var n;return null===(n=e.displayName)||void 0===n?void 0:n.localeCompare(t.displayName)}));S(null===e||void 0===e?void 0:e.filter((e=>!e.isArchived))),E(null===e||void 0===e?void 0:e.filter((e=>e.isArchived)))}),[m]),Object(i.useEffect)((()=>{var e,t;let n=z;var i;(h.length>1&&(n=null===(e=n)||void 0===e?void 0:e.filter((e=>JSON.stringify(e).toLowerCase().includes(h)))),(null===b||void 0===b||null===(t=b.organizationId)||void 0===t?void 0:t.length)>0)&&(n=null===(i=n)||void 0===i?void 0:i.filter((e=>b.organizationId.includes(e.organizationId))));g(n)}),[h,z,b.organizationId,b.benefitType]);const ne=(e,t)=>{D(!0);const n={organizationId:t};F.a.patchChangeOrgVehicle(e.id,n).then((n=>{$.b.success("Tracker flyttades till en annan organisation.");const i=[...z],a=i.findIndex((t=>e.id===t.id)),l=i[a];let r=l;r={...l,organizationId:t,permittedDrivers:[],defaultDriver:null,currentDriver:null},i.splice(a,1,{...l,...r}),g(i),G(i),D(!1)})).catch((e=>{$.b.error("N\xe5got gick fel. F\xf6rs\xf6k igen."),console.error(e)}))};const ie=[41465,41186,30714].includes(parseInt(localStorage.getItem(w.e)));const ae=async e=>{var t,n;const i=null===H||void 0===H||null===(t=H.displayName)||void 0===t||null===(n=t.split(" "))||void 0===n?void 0:n.join("_");await J(e,i)||console.log("Export Successful")};function le(e){var t;let n="\xc4ndra uppdateringsfrekvens (".concat((null===e||void 0===e?void 0:e.latestResponseFrequency)||"24h",")");return Object(B.jsxs)(X.a,{children:[Object(B.jsxs)(X.a.Item,{icon:Object(B.jsx)(oe.a,{}),onClick:()=>function(e){N(e),p(!0)}(e),children:[U.f.BTN_CHANGE," "]}),Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(Ye.a,{}),onClick:()=>ae(e.id),children:U.f.EXPORT_RAPPORT}),ie?null:Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)($t.a,{}),onClick:()=>function(e,t,n){const i=null===e||void 0===e?void 0:e.id;let a;a=n?"&&showArchived=".concat(n):"",ee("".concat(s.c,"/").concat(t,"?vehicleId=").concat(i)+a)}(e,"map"),children:"Visa p\xe5 karta "}),Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(He.a,{}),onClick:()=>K(e),children:n}),(null===(t=b.knownOrganizations)||void 0===t?void 0:t.length)>1&&Object(B.jsx)(X.a.Item,{icon:Object(B.jsx)(_l.a,{}),onClick:()=>Object(re.c)(e,b.knownOrganizations,ne),children:"Flytta utrustning till annan organisation"})]})}const se=[{key:"style",dataIndex:"style",title:"Ikon",align:"center",width:80,render:e=>Object(re.p)(e)},{key:"displayName",dataIndex:"displayName",title:"Alias",fixed:"left"},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",editable:!1,hidden:q,render:e=>{var t;const n=null===(t=b.knownOrganizations)||void 0===t?void 0:t.find((t=>t.organizationId===e));return n?n.fullName:"-"}},{title:"Beh\xf6riga anv\xe4ndare",key:"dPermitted",dataIndex:"permittedDrivers",render:(e,t)=>{var n,i,a,l;e=null===(n=e)||void 0===n?void 0:n.filter((e=>null===r||void 0===r?void 0:r.find((t=>t.id===e.id))));let o;if("POOL"===(null===t||void 0===t?void 0:t.benefitType)&&(o="Till\xe5ts f\xf6r alla"),0===(null===(i=e)||void 0===i?void 0:i.length)&&(o="Anv\xe4ndare ej vald"),1===(null===(a=e)||void 0===a?void 0:a.length)){const t=null===r||void 0===r?void 0:r.find((t=>t.userId===e[0].id));o=null===t||void 0===t?void 0:t.displayName}if((null===(l=e)||void 0===l?void 0:l.length)>1){var s,d;const t=null===(s=e)||void 0===s?void 0:s.map((e=>e.id));let n=(null===(d=e)||void 0===d?void 0:d.length)+" anv\xe4ndare";return Object(Bt.a)(n,null,null,t,null,r,b.knownOrganizations)}return o}},{title:"Uppdateringsfrekvens",dataIndex:"latestResponseFrequency",key:"latestResponseFrequency",align:"center",render:(e,t)=>t.latestResponseFrequency!==t.selectedResponseFrequency&&t.selectedResponseFrequency?Object(B.jsxs)(L.a,{title:"V\xe4ntande \xe4ndring: "+t.selectedResponseFrequency,children:[t.latestResponseFrequency," ",Object(B.jsx)(st.a,{})]}):e},{title:"Batteri",dataIndex:"batteryPercentage",key:"batteryPercentage",align:"center",render:e=>e?e+"%":"-"},{title:"S\xe5gs senast",dataIndex:"lastSeen",key:"lastSeen",align:"center",render:(e,t)=>e?Object(B.jsx)(We.a,{value:e,typ:"map",isTracker:t.isTracker}):"-"},{title:"",dataIndex:"operation",width:80,fixed:"right",render:(e,t)=>Object(B.jsx)(re.a,{menu:()=>le(t)})}].filter((e=>!e.hidden));let de=P?" med imei "+(null===P||void 0===P||null===(n=P.state)||void 0===n?void 0:n.imei):"";return Object(B.jsxs)(u.a,{form:O,component:!1,children:[Object(B.jsx)(Xl,{onModalCancel:()=>{N(null),V(null),p(!1)},isModalVisible:b.isModalVisible,extraTitle:de,knownOrganizations:b.knownOrganizations,organizationId:b.organizationId,permittedDrivers:r,setData:te,knownDevices:j,record:A,moveDevice:P,imeiList:j,handleMoveDeviceToOtherVehicle:function(e,t,n){var i;D(!0),n=n||z;const a=null===(i=e.state)||void 0===i?void 0:i.imei,l=j.findIndex((e=>e.imei===a));if(-1===l)return D(!1),void $.b.error("Kunde inte hitta enheten.");const r=j[l];if(e.id!==t&&t)try{var o,s;F.a.patchDevices(r.id,t);const i=[...n],a=i.findIndex((t=>t.id===e.id)),l=i.findIndex((e=>e.id===t));let d;-1!==l&&(d={...i[l]},d.state={...r},d.odometer=e.odometer,i.splice(l,1,d));const c={...i[a]};c.state=null,c.odometer=null,i.splice(a,1,c),g(i),G(i),V(null),Ut.a.success({title:"Enheten flyttades",content:Object(B.jsxs)("div",{children:[Object(B.jsxs)("p",{children:["Enhet ",r.imei," flyttades till ",Object(B.jsx)("strong",{children:(null===(o=d)||void 0===o?void 0:o.registry)||(null===(s=d)||void 0===s?void 0:s.displayName)}),"."]}),Object(B.jsx)("p",{style:{fontWeight:"bold"},children:"Gl\xf6m inte att ta ut enheten."})]})})}catch(d){console.error(d),$.b.error("N\xe5got gick fel. F\xf6rs\xf6k igen.")}finally{D(!1)}else D(!1)}}),Object(B.jsx)(re.d,{record:H,updateRecord:function(e){const t=[...z],n=null===t||void 0===t?void 0:t.findIndex((t=>(null===e||void 0===e?void 0:e.id)===t.id)),i=t[n];t.splice(n,1,{...i,...e}),G(t),Y(null)},setRecord:Y}),I?Object(B.jsxs)(oi.a,{spinning:""!==C&&R,children:[Object(B.jsx)(M.a,{dataSource:I,columns:Object(re.m)(se),scroll:{x:1e3},...re.n,tableLayout:"fixed"}),Object(B.jsx)(re.e,{record:W,setRecordFrequencyInterval:K,handleUpdateFreq:async(e,t,n)=>{await Q(e,t).then((e=>{const i=t.replace("-","");te({...n,latestResponseFrequency:i})}))}})]}):Object(B.jsx)(sn.a,{})]})};var Eo=()=>Object(B.jsx)(Vt.a,{wrappers:[c.b,c.z.provider,c.o,c.y,c.d,c.i,Ze,Xe.b],children:Object(B.jsx)(xo,{})});const Io={},So={journey:Ni,map:Fi,alarmEditor:Mt,alarmsEvents:hn,alarmsFunctions:bn,alarmsQuality:mn,alarmsReport:zt,alarmsSafety:Kt,alarmsZones:In,devices:fa,ecoScore:wn,geoLarmDetails:Ln,guides:Yn,myVehicle:qi,purpose:io,salaryReports:Ka,schedule:ro,scheduling:wa,support:Qr,userroles:oo.a,vehicles:co,trackersList:Eo,zones:uo,organizations:yl,superdevices:el,superVehicles:Yl,superTrackersList:cr,"triptax-analyzer":Gr,account:$a,users:Il},To=[];Object.entries(Io).map((e=>{let[t,n]=e;return To.push(t)})),Object.entries(d.i).map((e=>{let[t,n]=e}));const ko=()=>Object(B.jsxs)(i.Suspense,{fallback:Object(B.jsx)(o.a,{cover:"content"}),children:[null,Object(B.jsxs)(l.d,{children:[To.map((e=>Object(B.jsx)(l.b,{path:"".concat(s.c,"/").concat(e),component:Object(i.lazy)((()=>n(919)("./".concat(e))))},e))),Object.entries(So).map((e=>{let[t,n]=e;return Object(B.jsx)(l.b,{path:"".concat(s.c,"/").concat(t),component:n},t)})),Object(B.jsx)(l.b,{path:"".concat(s.c,"/error-2"),component:Object(i.lazy)((()=>n.e(13).then(n.bind(null,1014))))}),Object(B.jsx)(l.a,{from:"".concat(s.c),to:"".concat(s.c,"/journey")})]})]});t.default=a.a.memo(ko)},258:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return v}));const i="Kundsupport",a="Batteri",l="Heartbeat",r="Power Voltage";o("Billy","Bilsson","billy.bilsson@example.com"),o("Bob","Bilsson","billy.bilsson@example.com"),o("Hedvig","Hedvigsson","hevdig.hedvigsson@example.com"),o("Henry","Fordsson","henryfordsson@example.com");function o(e,t,n){return{firstname:e,lastname:t,email:n}}function s(e,t,n,i,a,l,r,o,s,d){return{typeError:e,phoneNumber:t,imei:n,firmware:i,config:a,obd:l,battery:r,vehicle:o,driver:s,heartbeat:d}}function d(e,t,n,i,a,l){return{organisation:e,type:t,imei:n,vehicle:i,driver:a,connected:l}}function c(e,t,n,i,a,l,r,o,s){return{commissioningDate:e,organisation:t,type:n,imei:i,heartBeat:a,vehicle:l,mileAge:r,driver:o,travels:s}}s(i,j(),h(),"fm","cfg","obd",p(),"vehicle","driver",O()),s(a,j(),h(),"fm","cfg","obd",p(),"vehicle","driver",O()),s(l,j(),h(),"fm","cfg","obd",p(),"vehicle","driver",O()),s(r,j(),h(),"fm","cfg","obd",p(),"vehicle","driver",O()),d("org","type",h(),"vehicle","driver","connected"),d("org","type",h(),"vehicle","driver","connected"),c(b(),"org","type",h(),O(),"vehicle",m,"driver","travels"),c(b(),"org","type",h(),O(),"vehicle",m,"driver","travels");const u=[{date:"2021-05-06 08:33",from:"2021-01-01",to:"2021-03-16"},{date:"2021-03-17 08:34",from:"2021-03-17",to:"2021-06-17"},{date:"2021-03-17 08:34",from:"2021-03-17",to:"2021-06-17"},{date:"2021-03-17 08:34",from:"2021-03-17",to:"2021-06-17"},{date:"2021-03-17 08:34",from:"2021-03-17",to:"2021-06-17"},{date:"2021-03-17 08:34",from:"2021-03-17",to:"2021-06-17"},{date:"~",from:"~",to:"~"}],v=[{date_time:"2021-05-06 08:33",new_value:"New value 12345"},{date_time:"2021-05-08 08:33",new_value:"New value 46544"},{date_time:"2021-05-06 08:40",new_value:"New value 98465"},{date_time:"2021-05-07 09:33",new_value:"New value 23654"},{date_time:"2021-05-06 08:33",new_value:"New value 12345"},{date_time:"2021-05-08 08:33",new_value:"New value 46544"},{date_time:null,new_value:"New value 98465"},{date_time:"2021-05-07 09:33",new_value:null}];function j(){return"+46 ".concat(Math.floor(999999999*Math.random()))}function h(){return Math.floor(999999999999999*Math.random())}function p(){return Math.floor(100*Math.random())}function b(){const e=Math.floor(12*Math.random()),t=Math.floor(31*Math.random());return new Date("2021-".concat(e,"-").concat(t))}function O(){const e=Math.floor(31*Math.random());return new Date("2021-05-".concat(e))}function m(){const e=Math.floor(23232*Math.random());return"".concat(e," km")}},259:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var i=n(0),a=n(11),l=n(1);const r=Object(i.createContext)({}),o=e=>{let{children:t}=e;const[n,o]=Object(i.useState)([]),[s,d]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{(async()=>{a.a.getDevices().then((e=>{o(e),d(!0)})).catch((e=>console.error(e)))})()}),[]),Object(l.jsx)(r.Provider,{value:{devices:n,devicesLoaded:s},children:t})}},266:function(e,t,n){"use strict";n.d(t,"c",(function(){return K})),n.d(t,"b",(function(){return Z})),n.d(t,"a",(function(){return X}));var i=n(0),a=n(60),l=n(171),r=n(144),o=n(110),s=n(63),d=n(54),c=n(115),u=n(65),v=n(73),j=n(196),h=n(27),p=n(95),b=n(162),O=n(248),m=n(125),g=n(55),f=n(542),x=n(396),y=n(940),E=n(543),I=n(392),S=n(393),T=n(937),k=n(394),C=n(395),_=n(938),A=n(939),N=n(11),R=n(51),D=n(62),w=n(2),L=n(6),P=n(20),V=n(122),M=n(38),F=n(147),z=n(103),U=n(12),B=n(247),G=n(308),H=n(1);const{Option:Y}=a.a,{TabPane:W}=l.a,K=()=>{const[e,t]=Object(i.useState)(),[n,a]=Object(i.useState)(!1),[l,d]=Object(i.useState)(""),[c,u]=Object(i.useState)([]);Object(i.useEffect)((()=>{N.a.getOrganizationsSimple().then((e=>{u(e)}))}),[]);return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(H.jsx)(r.a.Title,{children:"Superadmin - Anv\xe4ndare"}),Object(H.jsxs)("div",{style:{display:"flex",gap:15,flexWrap:"wrap"},children:[Object(H.jsx)(R.a,{data:c,onChange:e=>{t(e)},selectedOrganization:e,isMultiple:!0}),Object(H.jsx)(o.a.Search,{type:"text",placeholder:"S\xf6k efter namn eller e-post",label:"Registreringsnummer",defaultValue:l,enterButton:!0,onChange:e=>{d(e.target.value.toLowerCase())},style:{width:300}}),Object(H.jsx)(s.a,{type:"primary",onClick:()=>a(!0),icon:Object(H.jsx)(E.a,{}),children:"L\xe4gg till"})]})]}),Object(H.jsx)(J,{knownOrganizations:c,searchTerm:l,setSearchTerm:d,isModalVisible:n,setIsModalVisible:a,organizationId:e})]})},q=[Object(H.jsx)(Y,{value:L.k.ADMIN,children:"F\xf6retagsadmin"}),Object(H.jsx)(Y,{value:L.k.DRIVER,children:"F\xf6rare"})],J=e=>{const[t]=d.a.useForm(),[n,a]=Object(i.useState)(!1),[l,r]=Object(i.useState)(null),[o,p]=Object(i.useState)(null),[b,O]=Object(i.useState)([]),[m,f]=Object(i.useState)([]),[y,E]=Object(i.useState)(""),[R,z]=Object(i.useState)(!0),[Y,K]=Object(i.useState)(!1),q=Object(i.useContext)(U.v),J=null===q||void 0===q?void 0:q.filter((e=>!e.isArchived)),Q=Object(i.useContext)(U.r),ee=Object(i.useContext)(U.z.context);Object(i.useEffect)((()=>{b&&J&&z(!1)}),[b,J]),Object(i.useEffect)((()=>{const e=null===b||void 0===b?void 0:b.sort(((e,t)=>{var n;return null===(n=e.displayName)||void 0===n?void 0:n.localeCompare(t.displayName)}));p(null===e||void 0===e?void 0:e.filter((e=>!e.isArchived))),r(null===e||void 0===e?void 0:e.filter((e=>e.isArchived)))}),[b]),Object(i.useEffect)((()=>{null===Q||void 0===Q||Q.map((e=>{var t;e.extraRoles=null===e||void 0===e||null===(t=e.roles)||void 0===t?void 0:t.map((e=>w.n[e]))})),f(Q)}),[Q]),Object(i.useEffect)((()=>{var t;let n=null===m||void 0===m?void 0:m.filter((t=>JSON.stringify(t).toLowerCase().includes(e.searchTerm)));var i;(null===e||void 0===e||null===(t=e.organizationId)||void 0===t?void 0:t.length)>0&&(n=null===(i=n)||void 0===i?void 0:i.filter((t=>e.organizationId.includes(t.organizationId))));O(n)}),[e.organizationId,m,e.searchTerm]);const te=(e,t)=>{const n={organizationId:t};N.a.patchChangeOrgUser(e.userId,n).then((n=>{c.b.success("Anv\xe4ndare flyttades till en annan organisation.");const i=[...m],a=i.findIndex((t=>e.userId===t.userId)),l=i[a];let r;r={...l,permittedVehicles:[],organizationId:t,organizations:[{organizationId:t}]},i.splice(a,1,{...l,...r}),O(i),f(i)}))},ne=e=>{const t=[...m],n=t.findIndex((t=>e.userId===t.userId)),i=t[n],a={email:e.displayEmail,fullName:e.displayName},l={inviteSentTsMs:Date.now()};N.a.postInviteUser(a).then((e=>{c.b.success("Inbjudan har skickats"),n>-1&&(t.splice(n,1,{...i,...l}),O(t),f(t))})).catch((e=>{console.error(e),c.b.error("N\xe5got har gott fel. F\xf6rsok igen")}))};function ie(t){E(t),e.setIsModalVisible(!0)}console.log(y);const ae=[{title:"Namn",dataIndex:"displayName",key:"displayName"},{title:"E-post",dataIndex:"displayEmail",key:"displayEmail"},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",render:t=>{var n;const i=null===(n=e.knownOrganizations)||void 0===n?void 0:n.find((e=>e.organizationId===t));return i?i.fullName:"-"}},{title:"Arkiverad",dataIndex:L.k.archivedTsMs,width:100,render:(e,t)=>e?Object(H.jsx)(D.a,{value:e,typ:"map",isTracker:t.isTracker,defaultText:!0}):"-"},{title:"",dataIndex:"operation",render:(e,t)=>Object(H.jsx)("div",{style:{float:"right"},children:Object(H.jsx)(s.a,{icon:Object(H.jsx)(I.a,{}),onClick:()=>Object(B.a)(t,m,f,ie),children:w.f.ACTIVE})})}];function le(t){return Object(H.jsxs)(u.a,{children:[Object(H.jsxs)(u.a.Item,{icon:Object(H.jsx)(S.a,{}),onClick:()=>ie(t),children:[w.f.BTN_CHANGE," "]}),Object(H.jsx)(u.a.Item,{icon:Object(H.jsx)(T.a,{}),onClick:()=>(e=>{E(e),K(!0)})(t),children:"\xc4ndra l\xf6senord"}),Object(H.jsxs)(u.a.Item,{icon:Object(H.jsx)(k.a,{}),onClick:()=>X(t,e.knownOrganizations,te),children:[w.f.MOVE_TO_ORG," "]}),Object(H.jsx)(u.a.Item,{icon:Object(H.jsx)(C.a,{}),onClick:()=>Object(B.b)(t,m,f),children:w.f.ARCHIVE})]})}const re=[{key:"sendMail",width:50,fixed:"left",render:(e,t)=>Object(H.jsx)(v.a,{title:"Skicka inbjudan till den anv\xe4ndaren",children:Object(H.jsx)("a",{onClick:()=>ne(t),children:Object(H.jsx)(x.a,{style:{fontSize:"18px"}})})})},{title:"Namn",dataIndex:"displayName",key:"displayName",fixed:"left"},{title:"E-post",dataIndex:"displayEmail",key:"displayEmail"},{title:"Mobilnummer",dataIndex:"phone",key:"phone",width:150},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",editable:!1,width:150,hidden:ee,render:t=>{var n;const i=null===(n=e.knownOrganizations)||void 0===n?void 0:n.find((e=>e.organizationId===t));return i?i.fullName:"-"}},{title:"Roll",dataIndex:"roles",key:"roles",width:150,render:e=>null===e||void 0===e?void 0:e.map((e=>w.n[e]+" "))},{title:"GDPR",dataIndex:"gdprApproved",key:"gdprApproved",width:80,render:(e,t)=>!0===t.gdprApproved?Object(H.jsx)(_.a,{}):Object(H.jsx)(A.a,{})},{title:"Senast aktiv",dataIndex:"lastSeenApp",key:"lastSeenApp",width:120,render:e=>e?Object(H.jsx)(D.a,{value:e,typ:"map",defaultText:!0}):"-"},{title:w.f.SENT_INVITE,dataIndex:"inviteSentTsMs",key:"inviteSentTsMs",width:150,render:e=>e?Object(H.jsx)(D.a,{defaultText:!0,value:e,typ:"map"}):"-"},{title:"Beh\xf6rig till",dataIndex:L.k.permittedVehicles,key:L.k.permittedVehicles,width:120,render:(t,n)=>Object(G.b)(n,t,J,null,e.knownOrganizations,!1)},{title:"",dataIndex:"operation",width:80,render:(e,t)=>Object(H.jsx)(P.a,{menu:()=>le(t)})}].filter((e=>!e.hidden));return R?Object(H.jsx)(g.a,{}):Object(H.jsxs)(d.a,{form:t,component:!1,children:[Object(H.jsx)(Z,{onModalCancel:()=>{E(null),e.setIsModalVisible(!1)},isModalVisible:e.isModalVisible,knownOrganizations:e.knownOrganizations,organizationId:e.organizationId,vehicles:J,setData:function(t,n){const i=[...m],a=i.findIndex((e=>t.id===e.id)),l=i[a];a>-1?i.splice(a,1,{...l,...t}):i.push(t),O(i),f(i),e.setIsModalVisible(!1),E(null)},sendInvitation:ne,isRoot:!0,record:y}),Object(H.jsx)($,{record:y,isModalOpen:Y,handleOk:function(e,t){N.b.patchNewPassword(e,t).then((e=>{K(!1),E("")}))},handleCancel:()=>{E(""),K(!1)}}),Object(H.jsx)(V.b,{setShowAlertArchived:a,showAlertArchived:n,content:Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)(W,{tab:Object(H.jsx)(M.f,{text:"Aktiva anv\xe4ndare",overflowCount:9999999,badgeColor:"#3f3f3f",count:null===o||void 0===o?void 0:o.length}),children:[n&&Object(H.jsx)(V.a,{message:w.f.messageArchivedAlert}),Object(H.jsx)(j.a,{dataSource:o,columns:Object(P.m)(re),scroll:{x:1500},rowClassName:"editable-row",...P.n,tableLayout:"fixed"})]},"1"),Object(H.jsxs)(W,{tab:Object(H.jsx)(M.f,{text:"Arkiverade anv\xe4ndare",overflowCount:9999999,badgeColor:"#3f3f3f",count:null===l||void 0===l?void 0:l.length}),children:[n&&Object(H.jsx)(V.a,{message:w.f.messageArchivedAlert}),Object(H.jsx)(h.b,{renderEmpty:()=>Object(F.a)("Du har inga arkiverade anv\xe4ndare"),children:Object(H.jsx)(j.a,{dataSource:l,columns:Object(P.m)(ae),scroll:{x:1e3},rowClassName:"editable-row",...P.n})})]},"2")]})})]})},Q={display:"grid",alignSelf:"center",textAlign:"right",backgroundColor:"red",justifyContent:"center",margin:"auto",labelCol:{span:8},wrapperCol:{span:20}},Z=e=>{var t,n,l,r,s;const[c,u]=Object(i.useState)(!1),[v]=d.a.useForm(),[j,h]=Object(i.useState)(null===(t=e.record)||void 0===t?void 0:t.organizationId),[g,E]=Object(i.useState)(),[I,S]=Object(i.useState)(null);Object(i.useEffect)((()=>{T()}),[e.isModalVisible]),Object(i.useEffect)((()=>{T()}),[j]),Object(i.useEffect)((()=>{var t;!0===e.isModalVisible&&h(null===(t=e.record)||void 0===t?void 0:t.organizationId),u(!1)}),[e.isModalVisible]);function T(){v.resetFields(),v.setFieldsValue({organizationId:j}),u(!1),S(null)}const k=t=>{let n=t.vehicles?t.vehicles.map((t=>{const n=e.vehicles.findIndex((e=>e.id===t)),i=e.vehicles[n];return{id:i.id,displayName:i.displayName,registry:i.registry}})):[];t={...t,permittedVehicles:n},e.record?function(t){let n=e.record.userId;e.record,N.a.patchUser(n,t).then((t=>{e.setData(t,n)})).catch((e=>{var t;let n=z.b[null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data];S(n),u(!1)}))}(t):function(t){const n={...t,gdprApproved:!1,organizationId:j,sendInvite:t.sendInvite,inviteSentTsMs:t.sendInvite?Date.now():null};N.a.postNewUser(n,j).then((t=>{e.setData(t,t.userId)})).then((()=>{})).catch((e=>{var t;let n=z.b[null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data];S(n),u(!1)}))}(t)},C=null===(n=e.vehicles)||void 0===n||null===(l=n.filter((e=>e.organizationId===j)))||void 0===l?void 0:l.filter((e=>e.benefitType!==L.a.POOL)),_=null===(r=e.vehicles)||void 0===r||null===(s=r.filter((t=>{var n,i;return null===(n=e.record)||void 0===n||null===(i=n.permittedVehicles)||void 0===i?void 0:i.some((e=>e.id===t.id))})))||void 0===s?void 0:s.filter((e=>e.benefitType!==L.a.POOL));return Object(H.jsx)(p.a,{centered:!0,title:"Anv\xe4ndare",onCancel:()=>{h(null),e.onModalCancel()},onOk:()=>v.submit(),visible:e.isModalVisible,okText:e.record?"Spara":"L\xe4gg till ny anv\xe4ndare",bodyStyle:{overflowY:"auto",maxHeight:"calc(100vh - 200px)"},children:Object(H.jsx)("div",{style:{justifyContent:"center"},children:Object(H.jsx)(b.a,{spinning:c,tip:"V\xe4nta...",children:Object(H.jsxs)(d.a,{...Q,form:v,name:"basic",initialValues:e.record,layout:"vertical",onFinish:e=>{u(!0),k(e)},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[I&&Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(O.a,{type:"error",message:I,showIcon:!0}),Object(H.jsx)("br",{})]}),Object(H.jsx)(d.a.Item,{label:"Organisation",name:"organizationId",rules:[{required:!0,message:"V\xe4lj organisation!"}],children:Object(H.jsx)(R.a,{disabled:e.record,data:e.knownOrganizations,selectedOrganization:j,onChange:e=>h(e)})}),Object(H.jsx)(d.a.Item,{label:"Namn",name:"displayName",rules:[{required:!0,message:"Ange namn!"}],children:Object(H.jsx)(o.a,{prefix:Object(H.jsx)(f.a,{style:{marginRight:3}}),placeholder:w.f.SUPPLY_A_FIRST_LAST_NAME})}),Object(H.jsx)(d.a.Item,{label:"E-post",name:"displayEmail",rules:[{type:"email",message:w.b.PERSON_WRONG_EMAIL},{required:!0,message:w.b.PERSON_WRONG_EMAIL}],children:Object(H.jsx)(o.a,{disabled:e.record&&!e.isRoot,prefix:Object(H.jsx)(x.a,{style:{marginRight:3}}),placeholder:w.f.SUPPLY_AN_EMAIL_ADDRESS})}),Object(H.jsx)(d.a.Item,{label:"Mobilnummer",name:"phone",rules:[{required:!1,message:w.b.PERSON_WRONG_PHONE}],children:Object(H.jsx)(o.a,{prefix:Object(H.jsx)(y.a,{style:{marginRight:3}}),placeholder:w.f.SUPPLY_A_NEW_ORG_PHONE})}),Object(H.jsx)(d.a.Item,{label:"Roll",name:"roles",rules:[{required:!0,message:"V\xe4lj roll!"}],initialValue:[L.k.DRIVER],children:Object(H.jsx)(a.a,{allowClear:!0,showSearch:!0,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.children))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},mode:"multiple",placeholder:"V\xe4lj roll",children:q})}),Object(H.jsx)(d.a.Item,{label:"Beh\xf6rig till",name:"vehicles",rules:[{required:!1,message:"V\xe4lj fordon!"}],initialValue:null===_||void 0===_?void 0:_.map((e=>e.id)),children:Object(H.jsxs)(a.a,{mode:"multiple",allowClear:!0,showSearch:!0,defaultValue:null===_||void 0===_?void 0:_.map((e=>e.id)),filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.object))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},style:{width:"100%"},placeholder:"V\xe4lj fordon",children:[Object(H.jsx)(Y,{disabled:!0,value:"xxx",children:(null===g||void 0===g?void 0:g.length)>0?Object(H.jsx)("span",{onClick:()=>{v.setFieldsValue({vehicles:[]}),E([])},style:{color:"#286FBE",cursor:"pointer"},children:"Avmarkera alla"}):Object(H.jsx)("span",{onClick:()=>{const e=null===C||void 0===C?void 0:C.map((e=>{let{id:t}=e;return t}));v.setFieldsValue({vehicles:e}),E(C)},style:{color:"#286FBE",cursor:"pointer"},children:"V\xe4lj alla"})}),null===C||void 0===C?void 0:C.map(((e,t)=>""!==e.registry&&e.registry||e.displayName?Object(H.jsxs)(Y,{value:e.id,object:e,children:[e.registry," ",e.displayName]}):Object(H.jsxs)(Y,{value:e.id,object:e,children:["Ok\xe4nd ",e.id]})))]})}),!e.record&&Object(H.jsx)(d.a.Item,{name:L.k.sendInvite,initialValue:!0,valuePropName:"checked",children:Object(H.jsx)(m.a,{children:"Skicka inbjudan via e-post"})})]})})})})},X=(e,t,n)=>{let i;p.a.confirm({style:{minWidth:500},title:"Flytta anv\xe4ndare ".concat(e.displayName," till en annan organisation"),content:Object(H.jsx)(R.a,{width:"100%",extra:{allowClear:!1},data:t,defaultValue:e.organizationId,onChange:e=>i=e}),onOk(){n(e,i)}})},$=e=>{let{record:t,isModalOpen:n,handleOk:i,handleCancel:a}=e;const[l]=d.a.useForm();let r="\xc4ndra anv\xe4ndarl\xf6senord f\xf6r "+(null===t||void 0===t?void 0:t.displayName)||!1;return Object(H.jsx)(p.a,{title:r,visible:n,onOk:()=>{l.validateFields().then((e=>{l.resetFields(),(e=>{const n=t.id,a={password:e.newPassword};i(n,a)})(e)})).catch((e=>{console.log("Validate Failed:",e)}))},onCancel:function(){l.resetFields(),a()},children:Object(H.jsxs)(d.a,{form:l,layout:"vertical",initialValues:{newPassword:"",confirmPassword:""},children:[Object(H.jsx)(d.a.Item,{name:"newPassword",label:"Nytt l\xf6senord",rules:[{required:!0,message:"V\xe4nligen ange det nya l\xf6senordet!"},{min:8,message:"L\xf6senordet m\xe5ste vara minst 8 tecken l\xe5ngt."}],children:Object(H.jsx)(o.a.Password,{})}),Object(H.jsx)(d.a.Item,{name:"confirmPassword",label:"Bekr\xe4fta l\xf6senord",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"V\xe4nligen bekr\xe4fta det nya l\xf6senordet!"},e=>{let{getFieldValue:t}=e;return{validator:(e,n)=>n&&t("newPassword")!==n?Promise.reject(new Error("De angivna l\xf6senorden matchar inte.")):Promise.resolve()}}],children:Object(H.jsx)(o.a.Password,{})})]})})}},308:function(e,t,n){"use strict";n.d(t,"a",(function(){return z})),n.d(t,"b",(function(){return B}));var i=n(0),a=n(171),l=n(144),r=n(110),o=n(63),s=n(54),d=n(115),c=n(65),u=n(73),v=n(196),j=n(27),h=n(55),p=n(543),b=n(391),O=n(392),m=n(393),g=n(394),f=n(395),x=n(396),y=n(11),E=n(266),I=n(51),S=n(62),T=(n(184),n(2)),k=n(6),C=n(38),_=n(147),A=n(20),N=n(122),R=n(12),D=n(247),w=n(100),L=(n(217),n(18)),P=n(98),V=n(1);const{TabPane:M}=a.a,{Text:F}=l.a,z=()=>{const e=Object(i.useContext)(R.f),[t,n]=Object(i.useState)(),[a,s]=Object(i.useState)(""),[d,c]=Object(i.useState)(!1);return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(V.jsx)(l.a.Title,{children:"Anv\xe4ndare"}),Object(V.jsxs)("div",{style:{display:"flex",gap:15,flexWrap:"wrap"},children:[(null===e||void 0===e?void 0:e.length)<2?null:Object(V.jsx)(I.a,{data:e,onChange:e=>{n(e)},selectedOrganization:t,isMultiple:!0}),Object(V.jsx)(r.a.Search,{type:"text",placeholder:"S\xf6k efter namn eller e-post",label:"Registreringsnummer",defaultValue:a,enterButton:!0,onChange:e=>{s(e.target.value.toLowerCase())},style:{width:300}}),Object(V.jsx)(o.a,{type:"primary",onClick:()=>{c(!0)},icon:Object(V.jsx)(p.a,{}),children:"L\xe4gg till"})]})]}),Object(V.jsx)(U,{knownOrganizations:e,organizationId:t,searchTerm:a,isModalVisible:d,setIsModalVisible:c})]})},U=e=>{const t=Object(i.useContext)(R.v),n=null===t||void 0===t?void 0:t.filter((e=>!e.isArchived)),a=Object(i.useContext)(R.r),l=Object(i.useContext)(R.z.context),[r]=s.a.useForm(),[p,I]=Object(i.useState)([]),[w,F]=Object(i.useState)([]),[z,U]=Object(i.useState)(null),[G,H]=Object(i.useState)(null),[Y,W]=Object(i.useState)(!1),[K,q]=Object(i.useState)(),[J,Q]=Object(i.useState)(!0),[Z,X]=Object(i.useState)(!1),{push:$}=Object(P.g)();Object(i.useEffect)((()=>{w&&n&&Q(!1)}),[w,n]),Object(i.useEffect)((()=>{const e=null===w||void 0===w?void 0:w.sort(((e,t)=>e.displayName.localeCompare(t.displayName)));H(null===e||void 0===e?void 0:e.filter((e=>!e.isArchived))),U(null===e||void 0===e?void 0:e.filter((e=>e.isArchived)))}),[w]),Object(i.useEffect)((()=>{null===a||void 0===a||a.map((e=>{var t;e.extraRoles=null===e||void 0===e||null===(t=e.roles)||void 0===t?void 0:t.map((e=>T.n[e]))})),I(a)}),[a]),Object(i.useEffect)((()=>{var t;let n=null===p||void 0===p?void 0:p.filter((t=>JSON.stringify(t).toLowerCase().includes(e.searchTerm)));var i;(null===e||void 0===e||null===(t=e.organizationId)||void 0===t?void 0:t.length)>0&&(n=null===(i=n)||void 0===i?void 0:i.filter((t=>e.organizationId.includes(t.organizationId))));F(n)}),[e.organizationId,p,e.searchTerm]);const ee=(e,t)=>{const n={organizationId:t};y.a.patchUser(e.userId,n).then((t=>{d.b.success("Anv\xe4ndare flyttades till en annan organisation.");const n=[...p],i=n.findIndex((t=>e.userId===t.userId)),a=n[i];n.splice(i,1,{...a,...t}),I(n)}))},te=e=>{const t=[...p],n=t.findIndex((t=>e.userId===t.userId)),i=t[n],a={email:e.displayEmail,fullName:e.displayName},l={inviteSentTsMs:Date.now()};y.a.postInviteUser(a).then((e=>{d.b.success("Inbjudan har skickats"),n>-1&&(t.splice(n,1,{...i,...l}),I(t))})).catch((e=>{console.error(e),d.b.error("N\xe5got har gott fel. F\xf6rsok igen")}))};function ne(t){q(t),e.setIsModalVisible(!0)}const ie=[{title:"Namn",dataIndex:"displayName",key:"displayName"},{title:"E-post",dataIndex:"displayEmail",key:"displayEmail"},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",render:t=>{var n;const i=null===(n=e.knownOrganizations)||void 0===n?void 0:n.find((e=>e.organizationId===t));return i?i.fullName:"-"}},{title:"Arkiverad",dataIndex:k.k.archivedTsMs,width:100,render:(e,t)=>e?Object(V.jsx)(S.a,{value:e,typ:"map",isTracker:t.isTracker,defaultText:!0}):"-"},{title:"",dataIndex:"operation",fixed:"right",render:(e,t)=>Object(V.jsxs)("div",{style:{float:"right"},children:[Object(V.jsx)(o.a,{icon:Object(V.jsx)(b.a,{}),onClick:()=>t.isTracker?null:function(e,t,n){const i=null===e||void 0===e?void 0:e.id;let a;a=n?"&&showArchived=".concat(n):"",$("".concat(L.c,"/").concat(t,"?userId=").concat(i)+a)}(t,"journey",!0),children:T.f.JOURNEY}),Object(V.jsx)(o.a,{icon:Object(V.jsx)(O.a,{}),onClick:()=>Object(D.a)(t,p,I,ne),children:T.f.ACTIVE})]})}];const ae=[{key:"sendMail",width:50,fixed:"left",render:(e,t)=>Object(V.jsx)(u.a,{title:"Skicka inbjudan till den anv\xe4ndaren",children:Object(V.jsx)("a",{onClick:()=>te(t),children:Object(V.jsx)(x.a,{style:{fontSize:"18px"}})})})},{title:"Namn",dataIndex:"displayName",key:"displayName",fixed:"left"},{title:"E-post",dataIndex:"displayEmail",key:"displayEmail"},{title:"Mobilnummer",dataIndex:"phone",key:"phone",width:150},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",editable:!1,width:150,hidden:l,render:t=>{var n;const i=null===(n=e.knownOrganizations)||void 0===n?void 0:n.find((e=>e.organizationId===t));return i?i.fullName:"-"}},{title:"Roll",dataIndex:"roles",key:"roles",width:150,render:e=>null===e||void 0===e?void 0:e.map((e=>T.n[e]+" "))},{title:"Senast aktiv",dataIndex:"lastSeenApp",key:"lastSeenApp",width:120,render:e=>e?Object(V.jsx)(S.a,{value:e,typ:"map",defaultText:!0}):"-"},{title:T.f.SENT_INVITE,dataIndex:"inviteSentTsMs",width:150,key:"inviteSentTsMs",render:e=>e?Object(V.jsx)(S.a,{defaultText:!0,value:e,typ:"map"}):"-"},{title:"Beh\xf6rig till",dataIndex:k.k.permittedVehicles,key:k.k.permittedVehicles,editable:!1,render:(t,i)=>B(i,t,n,null,e.knownOrganizations,!1,Z,X)},{title:"",dataIndex:"operation",width:80,render:(t,n)=>Object(V.jsx)(A.a,{menu:()=>function(t){return Object(V.jsxs)(c.a,{children:[Object(V.jsxs)(c.a.Item,{icon:Object(V.jsx)(m.a,{}),onClick:()=>ne(t),children:[T.f.BTN_CHANGE," "]}),Object(V.jsxs)(c.a.Item,{icon:Object(V.jsx)(g.a,{}),onClick:()=>Object(E.a)(t,e.knownOrganizations,ee),children:[T.f.MOVE_TO_ORG," "]}),Object(V.jsx)(c.a.Item,{icon:Object(V.jsx)(f.a,{}),onClick:()=>Object(D.b)(t,p,I),children:T.f.ARCHIVE})]})}(n)})}].filter((e=>!e.hidden));return J?Object(V.jsx)(h.a,{}):Object(V.jsxs)(s.a,{form:r,component:!1,children:[Object(V.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",margin:"15px"}}),Object(V.jsx)(E.b,{onModalCancel:()=>{q(null),e.setIsModalVisible(!1)},isModalVisible:e.isModalVisible,knownOrganizations:e.knownOrganizations,organizationId:e.organizationId,vehicles:n,setData:function(t,n){t.userId=n;const i=[...p],a=i.findIndex((e=>n===e.userId)),l=i.findIndex((e=>n===e.userId));a>-1?i.splice(a,1,{...l,...t}):i.push(t),I(i),e.setIsModalVisible(!1),q(null)},sendInvitation:te,record:K}),Object(V.jsx)(N.b,{setShowAlertArchived:W,showAlertArchived:Y,content:Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(M,{tab:Object(V.jsx)(C.f,{text:"Aktiva anv\xe4ndare",overflowCount:9999999,badgeColor:"#3f3f3f",count:null===G||void 0===G?void 0:G.length}),children:[Y&&Object(V.jsx)(N.a,{message:T.f.messageArchivedAlert}),Object(V.jsx)(v.a,{dataSource:G,columns:Object(A.m)(ae),scroll:{x:1500},rowClassName:"editable-row",...A.n,tableLayout:"fixed"})]},"1"),Object(V.jsxs)(M,{tab:Object(V.jsx)(C.f,{text:"Arkiverade anv\xe4ndare",overflowCount:9999999,badgeColor:"#3f3f3f",count:null===z||void 0===z?void 0:z.length}),children:[Y&&Object(V.jsx)(N.a,{message:T.f.messageArchivedAlert}),Object(V.jsx)(j.b,{renderEmpty:()=>Object(_.a)("Du har inga arkiverade anv\xe4ndare"),children:Object(V.jsx)(v.a,{dataSource:z,columns:Object(A.m)(ie),scroll:{x:1e3},rowClassName:"editable-row",...A.n})})]},"2")]})})]})},B=(e,t,n,i,a)=>{var l,r;if(1===(null===(l=t=t.filter((e=>null===n||void 0===n?void 0:n.find((t=>t.id===e.id)))))||void 0===l?void 0:l.length)){const e=null===n||void 0===n?void 0:n.find((e=>e.id===t[0].id));return Object(A.o)(e)}if(0===(null===(r=t)||void 0===r?void 0:r.length))return"-";{var o,s;const e=null===(o=t)||void 0===o?void 0:o.map((e=>e.id));let i=(null===(s=t)||void 0===s?void 0:s.length)+" "+T.f.VEHICLE;return Object(w.a)(i,e,null,null,n,null,a)}}},313:function(e,t,n){"use strict";n.d(t,"a",(function(){return ne})),n.d(t,"b",(function(){return ie}));var i=n(0),a=n.n(i),l=n(144),r=n(60),o=n(171),s=n(110),d=n(63),c=n(54),u=n(115),v=n(95),j=n(65),h=n(179),p=n(73),b=n(162),O=n(196),m=n(27),g=n(926),f=n(391),x=n(392),y=n(393),E=n(542),I=n(934),S=n(394),T=n(395),k=n(98),C=n(69),_=n(62),A=n(11),N=n(55),R=n(51),D=n(18),w=n(19),L=n(38),P=n(20),V=n(2),M=n(6),F=n(147),z=n(122),U=n(315),B=n(12),G=n(217),H=n(138),Y=n(100),W=n(1);const K=n(181);K.registerLocale(n(182));const{Text:q}=l.a,{Option:J}=r.a,{TabPane:Q}=o.a,Z=K.getNames("sv",{select:"alias"}),X=Object.entries(Z).map((e=>{let[t,n]=e;return{key:t,label:n}})).sort(((e,t)=>e.label.localeCompare(t.label))),$=X.filter((e=>"SE"===e.key||"FI"===e.key||"NO"===e.key||"DK"===e.key)),ee=X.find((e=>"SE"===e.key)),te=$.findIndex((e=>"SE"===e.key));$.splice(te,1),$.unshift(ee);const ne=()=>{const[e,t]=Object(i.useState)(),[n,r]=Object(i.useState)(),[o,c]=Object(i.useState)(!1),[u,v]=a.a.useState(""),j=Object(i.useContext)(B.h),h=Object(i.useContext)(B.x),p=Object(i.useContext)(B.c),b=Object(i.useContext)(B.n),O=null===b||void 0===b?void 0:b.filter((e=>!e.isArchived));return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap"},children:[Object(W.jsx)("div",{children:Object(W.jsx)(l.a.Title,{style:{marginBottom:0},children:"Fordon"})}),Object(W.jsxs)("div",{style:{display:"flex",gap:15,flexWrap:"wrap"},children:[(null===j||void 0===j?void 0:j.length)<2?null:Object(W.jsx)(R.a,{data:j,onChange:e=>{t(e)},selectedOrganization:e,isMultiple:!0}),Object(W.jsx)(s.a.Search,{type:"text",placeholder:"S\xf6k efter regnr, IMEI eller f\xf6rare",label:"Registreringsnummer",defaultValue:u,enterButton:!0,onChange:e=>{v(e.target.value.toLowerCase())},style:{width:300}}),Object(W.jsx)(d.a,{type:"primary",onClick:()=>c(!0),icon:Object(W.jsx)(g.a,{}),children:"L\xe4gg till"})]})]}),Object(W.jsx)(ae,{permittedDrivers:O,devicesData:p,knownOrganizations:j,organizationId:e,setIsModalVisible:c,isModalVisible:o,benefitType:n,searchTerm:u,setSearchTerm:v,vehicles:h})]})},ie=e=>{let{marker:t}=e;return Object(W.jsx)(C.Icon,{icon:t})},ae=e=>{var t;let{vehicles:n,permittedDrivers:a,changeOdometerValue:l,changeDefaultTripType:r,changeBenefitType:o,devicesData:s,searchTerm:g,setIsModalVisible:C,...R}=e;const[K]=c.a.useForm(),[J,Z]=Object(i.useState)(),[X,$]=Object(i.useState)(!1),[ee,te]=Object(i.useState)(),[ne,ie]=Object(i.useState)(),[ae,le]=Object(i.useState)(!0),[re,oe]=Object(i.useState)(""),[se,de]=Object(i.useState)(),[ce,ue]=Object(i.useState)(!1),[ve,je]=Object(i.useState)(),[he,pe]=Object(i.useState)(),[be,Oe]=Object(i.useState)(null),me=Object(i.useContext)(B.z.context),{push:ge}=Object(k.g)();function fe(e,t,n){var i;ue(!0),n=n||he;const a=null===(i=e.state)||void 0===i?void 0:i.imei,l=s.findIndex((e=>e.imei===a));if(-1===l)return ue(!1),void u.b.error("Kunde inte hitta enheten.");const r=s[l];if(e.id!==t&&t)try{var o,d;A.a.patchDevices(r.id,t);const i=[...n],a=i.findIndex((t=>t.id===e.id)),l=i.findIndex((e=>e.id===t));let s;-1!==l&&(s={...i[l]},s.state={...r},s.odometer=e.odometer,i.splice(l,1,s));const c={...i[a]};c.state=null,c.odometer=null,i.splice(a,1,c),Z(i),pe(i),je(null),v.a.success({title:"Enheten flyttades",content:Object(W.jsx)("div",{children:Object(W.jsxs)("p",{children:["Enhet ",r.imei," flyttades till ",Object(W.jsx)("strong",{children:(null===(o=s)||void 0===o?void 0:o.registry)||(null===(d=s)||void 0===d?void 0:d.displayName)}),"."]})})})}catch(c){console.error(c),u.b.error("N\xe5got gick fel. F\xf6rs\xf6k igen.")}finally{ue(!1)}else ue(!1)}Object(i.useEffect)((()=>{pe(n),Z(n),le(!1)}),[n]),Object(i.useEffect)((()=>{const e=null===J||void 0===J?void 0:J.sort(((e,t)=>{var n;return null===(n=e.registry)||void 0===n?void 0:n.localeCompare(t.registry)}));ie(null===e||void 0===e?void 0:e.filter((e=>!e.isArchived))),te(null===e||void 0===e?void 0:e.filter((e=>e.isArchived)))}),[J]),Object(i.useEffect)((()=>{var e,t,n;let i=he;var a;(g.length>1&&(i=null===(e=i)||void 0===e?void 0:e.filter((e=>JSON.stringify(e).toLowerCase().includes(g)))),(null===R||void 0===R||null===(t=R.organizationId)||void 0===t?void 0:t.length)>0)&&(i=null===(a=i)||void 0===a?void 0:a.filter((e=>R.organizationId.includes(e.organizationId))));i=null===(n=i)||void 0===n?void 0:n.filter((e=>!e.isTracker)),Z(i)}),[g,he,R.organizationId,R.benefitType]);const xe=(e,t)=>{ue(!0);const n={organizationId:t};A.a.patchChangeOrgVehicle(e.id,n).then((n=>{u.b.success("Fordon flyttades till en annan organisation.");const i=[...he],a=i.findIndex((t=>e.id===t.id)),l=i[a];let r=l;r={...l,organizationId:t,permittedDrivers:[],defaultDriver:null,currentDriver:null},i.splice(a,1,{...l,...r}),Z(i),pe(i),ue(!1)})).catch((e=>{u.b.error("N\xe5got gick fel. F\xf6rs\xf6k igen."),console.error(e)}))};function ye(e,t,n){const i=null===e||void 0===e?void 0:e.id;let a;a=n?"&&showArchived=".concat(n):"",ge("".concat(D.c,"/").concat(t,"?vehicleId=").concat(i)+a)}function Ee(e){je(e),C(!0)}const Ie=[41465,41186,30714].includes(parseInt(localStorage.getItem(w.e))),Se=[{key:"registry",dataIndex:"registry",title:"Regnr",fixed:"left",width:150,render:(e,t)=>Object(P.j)(t)},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",width:200,render:e=>{var t;const n=null===(t=R.knownOrganizations)||void 0===t?void 0:t.find((t=>t.organizationId===e));return n?n.fullName:"-"}},{title:"Arkiverad",dataIndex:M.k.archivedTsMs,key:"archived",render:(e,t)=>e?Object(W.jsx)(_.a,{value:e,typ:"map",isTracker:t.isTracker,defaultText:!0}):"-"},{title:"",dataIndex:"operation",render:(e,t)=>Object(W.jsxs)("div",{style:{float:"right"},children:[Object(W.jsx)(d.a,{icon:Object(W.jsx)(f.a,{}),onClick:()=>t.isTracker?null:ye(t,"journey",!0),children:V.f.JOURNEY}),Object(W.jsx)(d.a,{icon:Object(W.jsx)(x.a,{}),onClick:()=>Object(G.a)(t,he,pe,Te),children:V.f.ACTIVE})]})}].filter((e=>!e.hidden));function Te(e){de(e),C(!0)}const ke=[{key:"registry",dataIndex:"registry",title:"Regnr",fixed:"left",width:200,render:(e,t)=>Object(P.j)(t)},{key:"style",dataIndex:"style",title:"Ikon",align:"center",width:80,render:e=>Object(P.p)(e)},{key:"benefitType",dataIndex:"benefitType",title:"Typ",width:150,render:(e,t)=>{var n;return null===(n=Object.entries(M.c).find((t=>{let[n,i]=t;return(null===i||void 0===i?void 0:i.TYPE)===e}))[1])||void 0===n?void 0:n.TYPE_DISPLAY_TEXT}},{key:"organizationId",dataIndex:"organizationId",title:"Organisation",editable:!1,width:150,hidden:me,render:e=>{var t;const n=null===(t=R.knownOrganizations)||void 0===t?void 0:t.find((t=>t.organizationId===e));return n?n.fullName:"-"}},{key:"defDriver",dataIndex:"defaultDriver",title:"F\xf6rvald f\xf6rare",editable:!0,render:(e,t)=>Object(P.k)(t,e)},{key:"curDriver",dataIndex:"currentDriver",title:"Incheckad f\xf6rare",editable:!0,render:e=>(null===e||void 0===e?void 0:e.displayName)||"F\xf6rare ej vald"},{title:"Beh\xf6riga f\xf6rare",key:"dPermitted",dataIndex:"permittedDrivers",width:150,render:(e,t)=>{var n,i,l,r;e=null===(n=e)||void 0===n?void 0:n.filter((e=>null===a||void 0===a?void 0:a.find((t=>t.id===e.id))));let o;if("POOL"===(null===t||void 0===t?void 0:t.benefitType)&&(o="Till\xe5ts f\xf6r alla"),0===(null===(i=e)||void 0===i?void 0:i.length)&&(o="F\xf6rare ej vald"),1===(null===(l=e)||void 0===l?void 0:l.length)){const t=null===a||void 0===a?void 0:a.find((t=>t.userId===e[0].id));o=null===t||void 0===t?void 0:t.displayName}if((null===(r=e)||void 0===r?void 0:r.length)>1){var s,d;const t=null===(s=e)||void 0===s?void 0:s.map((e=>e.id));let n=(null===(d=e)||void 0===d?void 0:d.length)+" f\xf6rare";return Object(Y.a)(n,null,null,t,null,a,R.knownOrganizations)}return o}},{title:"S\xe5gs senast",dataIndex:"lastSeen",key:"lastSeen",align:"center",width:150,render:(e,t)=>e?Object(W.jsx)(_.a,{value:e,typ:"map",isTracker:t.isTracker}):"-"},{key:"vehicleType",dataIndex:"hybrid",title:"Br\xe4nsletyp",width:100,render:(e,t)=>{var n,i;return Object(W.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[t.fuel1?Object(W.jsx)(q,{children:null===(n=t.fuel1)||void 0===n?void 0:n.svName}):null,t.fuel2?Object(W.jsx)(q,{children:null===(i=t.fuel2)||void 0===i?void 0:i.svName}):null]})}},{key:"odom",dataIndex:"odometer",title:"M\xe4tarst\xe4llning",align:"right",width:150,render:(e,t)=>Object(H.a)(t)},{key:"co2_fuel",dataIndex:"co2_fuel",title:"CO2",align:"right",width:150,render:(e,t)=>{const n=null!==(null===t||void 0===t?void 0:t.co2GKm1)?"".concat(null===t||void 0===t?void 0:t.co2GKm1," g/km"):null,i=null!==(null===t||void 0===t?void 0:t.co2GKm2)?"".concat(null===t||void 0===t?void 0:t.co2GKm2," g/km"):null;return Object(W.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(W.jsx)(q,{children:n}),Object(W.jsx)(q,{children:i})]})}},{key:"consumption",dataIndex:"consumption",title:"F\xf6rbrukning",align:"right",width:120,render:(e,t)=>{const n=null!==t&&void 0!==t&&t.fuel1?(null===t||void 0===t?void 0:t.consumption1)+" "+(null===t||void 0===t?void 0:t.fuel1.consumptionUnit):null,i=null!==t&&void 0!==t&&t.fuel2?(null===t||void 0===t?void 0:t.consumption2)+" "+(null===t||void 0===t?void 0:t.fuel2.consumptionUnit):null;return Object(W.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(W.jsx)(q,{children:n}),Object(W.jsx)(q,{children:i})]})}},{key:"isoCountryCode",dataIndex:"isoCountryCode",title:"Landskod",width:100},{key:"defaultTripType",dataIndex:"defaultTripType",title:"F\xf6rval",width:80,render:(e,t)=>{const n=null===e||void 0===e?void 0:e.startsWith("PRIVATE"),i=Object.entries(M.d).filter((t=>{let[n,i]=t;return(null===i||void 0===i?void 0:i.TYPE)===e})).map((e=>{let[t,n]=e;return null===n||void 0===n?void 0:n.TYPE_DISPLAY_TEXT})),a=n?M.b.SWITCH_PRIVATE:M.b.SWITCH_BUSINESS;return Object(W.jsx)(h.a,{style:{color:a},children:i})}},{key:"imei",dataIndex:"state",title:"Enhet",width:150,render:(e,t)=>{var n;if(null===e||void 0===e||!e.imei)return;let i=null===e||void 0===e||null===(n=e.imei)||void 0===n?void 0:n.toString();const a=(null===i||void 0===i?void 0:i.slice(0,4))+"...."+(null===i||void 0===i?void 0:i.toString().slice(11,16));return Object(W.jsx)(p.a,{title:i,children:a})}},{title:"",dataIndex:"operation",width:80,render:(e,t)=>Object(W.jsx)(P.a,{menu:()=>function(e){var t,n;const i=null===e||void 0===e||null===(t=e.state)||void 0===t?void 0:t.imei;return Object(W.jsxs)(j.a,{children:[Object(W.jsxs)(j.a.Item,{icon:Object(W.jsx)(y.a,{}),onClick:()=>Te(e),children:[V.f.BTN_CHANGE," "]}),Object(W.jsxs)(j.a.Item,{icon:Object(W.jsx)(E.a,{}),onClick:()=>Oe(e),children:[V.f.CHECK_IN_DRIVER," "]}),Ie&&e.isTracker?null:Object(W.jsxs)(j.a.Item,{icon:Object(W.jsx)(f.a,{}),onClick:()=>e.isTracker?ye(e,"map"):ye(e,"journey"),children:[e.isTracker?"Visa p\xe5 karta":V.f.JOURNEY," "]}),Object(W.jsx)(j.a.Item,{icon:Object(W.jsx)(I.a,{}),disabled:!i,onClick:()=>Object(P.l)(e,he,fe,Ee),children:V.f.MOVE_DEVICE}),(null===(n=R.knownOrganizations)||void 0===n?void 0:n.length)>1&&Object(W.jsx)(j.a.Item,{icon:Object(W.jsx)(S.a,{}),onClick:()=>Object(P.c)(e,R.knownOrganizations,xe),children:V.f.MOVE_VEHICLE}),Object(W.jsx)(j.a.Item,{icon:Object(W.jsx)(T.a,{}),onClick:()=>Object(G.b)(e,he,pe,s,P.l,fe,Ee),children:V.f.ARCHIVE})]})}(t)})}].filter((e=>!e.hidden));let Ce=ve?" med imei "+(null===ve||void 0===ve||null===(t=ve.state)||void 0===t?void 0:t.imei):"";return Object(W.jsxs)(c.a,{form:K,component:!1,children:[Object(W.jsx)(U.a,{onModalCancel:()=>{de(null),je(null),C(!1)},isModalVisible:R.isModalVisible,extraTitle:Ce,knownOrganizations:R.knownOrganizations,organizationId:R.organizationId,permittedDrivers:a,setData:function(e){const t=[...he];if(Array.isArray(e))e.forEach((e=>{const n=t.findIndex((t=>e.id===t.id));n>-1?t.splice(n,1,{...t[n],...e}):t.push(e)}));else{const n=t.findIndex((t=>e.id===t.id));n>-1?t.splice(n,1,{...t[n],...e}):t.push(e)}Z(t),pe(t),C(!1),de(null)},knownDevices:s,record:se,moveDevice:ve,imeiList:s,handleMoveDeviceToOtherVehicle:fe}),Object(W.jsx)(P.d,{record:be,updateRecord:function(e){const t=[...he],n=null===t||void 0===t?void 0:t.findIndex((t=>(null===e||void 0===e?void 0:e.id)===t.id)),i=t[n];t.splice(n,1,{...i,...e}),pe(t),Oe(null)},setRecord:Oe}),ne?Object(W.jsx)(b.a,{spinning:""!==re&&ce,children:Object(W.jsx)(z.b,{setShowAlertArchived:$,showAlertArchived:X,content:Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(Q,{tab:Object(W.jsx)(L.f,{text:"Aktiva fordon",overflowCount:9999999,badgeColor:"#3f3f3f",count:null===ne||void 0===ne?void 0:ne.length}),children:[X&&Object(W.jsx)(z.a,{message:V.f.messageArchivedAlert}),Object(W.jsx)(O.a,{dataSource:ne,columns:Object(P.m)(ke),scroll:{x:2200},...P.n,tableLayout:"fixed"})]},"1"),Object(W.jsxs)(Q,{tab:Object(W.jsx)(L.f,{text:"Arkiverade fordon",overflowCount:9999999,badgeColor:"#3f3f3f",showTooltip:!1,count:null===ee||void 0===ee?void 0:ee.length}),children:[X&&Object(W.jsx)(z.a,{message:V.f.messageArchivedAlert}),Object(W.jsx)(m.b,{renderEmpty:()=>Object(F.a)("Du har inga arkiverade fordon"),children:Object(W.jsx)(O.a,{dataSource:ee,columns:Object(P.m)(Se),scroll:{x:1e3},rowClassName:"editable-row",...P.n})})]},"2")]})})}):Object(W.jsx)(N.a,{})]})}},315:function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var i=n(0),a=n(51),l=n(316),r=n(144),o=n(60),s=n(54),d=n(95),c=n(248),u=n(110),v=n(63),j=n(166),h=n(93),p=n(101),b=n(249),O=n(378),m=n(125),g=n(220),f=n(152),x=n(382),y=n(69),E=n(41),I=n.n(E),S=n(11),T=n(103),k=n(138),C=n(20),_=n(6),A=n(135),N=n(1);const{Text:R}=r.a,{Option:D,OptGroup:w}=o.a,L=n(181);L.registerLocale(n(182));const P=[];Object.entries(A.a).map((e=>{let[t,n]=e;P.push(Object(N.jsx)(D,{value:t,children:Object(N.jsx)(y.Icon,{icon:n})}))}));const V={BENEFIT:"F\xf6rm\xe5nsbil",PRIVATE:"Privat",WORK:"Arbetsfordon",POOL:"Poolbil",TRACKER:"Tracker"},M=L.getNames("sv",{select:"alias"}),F=Object.entries(M).map((e=>{let[t,n]=e;return{key:t,label:n}})).sort(((e,t)=>e.label.localeCompare(t.label))),z=F.filter((e=>"SE"===e.key||"FI"===e.key||"NO"===e.key||"DK"===e.key)),U=F.find((e=>"SE"===e.key)),B=z.findIndex((e=>"SE"===e.key));z.splice(B,1),z.unshift(U);const G=9e5,H=e=>{var t,n,r,y,E,A,L,M,U,B,H,Y,W,K,q,J,Q,Z,X,$,ee,te,ne,ie;const[ae,le]=Object(i.useState)(!1),[re,oe]=Object(i.useState)(!1),[se,de]=Object(i.useState)(null===(t=e.record)||void 0===t?void 0:t.organizationId),[ce,ue]=Object(i.useState)(null),[ve,je]=Object(i.useState)(),[he,pe]=Object(i.useState)(!0),[be,Oe]=Object(i.useState)(!0),[me,ge]=Object(i.useState)(),[fe,xe]=Object(i.useState)(!1),[ye]=s.a.useForm(),[Ee,Ie]=Object(i.useState)(),[Se,Te]=Object(i.useState)(null),ke=e.permittedDrivers,[Ce,_e]=Object(i.useState)(null),Ae={co2Default:null,co2Override:null,consumptionDefault:null,consumptionOverride:null},[Ne,Re]=Object(i.useState)(Ae),[De,we]=Object(i.useState)({}),[Le,Pe]=Object(i.useState)(null);Object(i.useEffect)((()=>{Ve()}),[e.isModalVisible]),Object(i.useEffect)((()=>{Ve()}),[se]),Object(i.useEffect)((()=>{var t,n;if((null===(t=e.record)||void 0===t||null===(n=t.state)||void 0===n||!n.imei)&&e.record&&!e.moveDevice){var i;const t=null===(i=e.record)||void 0===i?void 0:i.id;S.a.getVehicleDevice(t).then((e=>{const t=Array.from(new Set(null===e||void 0===e?void 0:e.map((e=>e.deviceId))));t.reverse(),ge(t)}))}}),[e.record,e.moveDevice]);Object(i.useEffect)((()=>{var t,n;if(e.isModalVisible)if((null===e||void 0===e||null===(t=e.knownOrganizations)||void 0===t?void 0:t.length)<2&&!e.record)de(null===e||void 0===e||null===(n=e.knownOrganizations[0])||void 0===n?void 0:n.organizationId);else if(e.moveDevice){var i;de(null===(i=e.moveDevice)||void 0===i?void 0:i.organizationId)}else{var a;de(null===(a=e.record)||void 0===a?void 0:a.organizationId)}}),[e.knownOrganizations,e.record,e.isModalVisible,e.moveDevice]),Object(i.useEffect)((()=>{!0===e.isModalVisible&&le(!1)}),[e.isModalVisible]);const Ve=()=>{var t,n,i,a,l,r,o;ye.resetFields(),ye.setFieldsValue({organizationId:se}),Ie((null===(t=e.record)||void 0===t||null===(n=t.style)||void 0===n?void 0:n.color)||Object(C.i)()),le(!1),Te(null),_e(null),Re(Ae),we({...e.record}),Pe(null===(i=e.record)||void 0===i?void 0:i.proportion1),pe(!0),Oe(!(null!==(a=e.record)&&void 0!==a&&null!==(l=a.state)&&void 0!==l&&l.imei)),je(null===(r=e.record)||void 0===r?void 0:r.permittedDrivers),xe((null===(o=e.record)||void 0===o?void 0:o.benefitType)===_.a.POOL),ue(null)},Me=e=>{d.a.confirm({title:"Bekr\xe4fta registreringsnummer  ",content:"Du har angivit ".concat(e.registry,". \xc4r detta korrekt? En g\xe5ng tilldelat registreringsnummer kan inte \xe4ndras."),okText:"Spara regnr",onOk(){Ue(e)},onCancel(){le(!1)}})},Fe=e=>{d.a.confirm({title:"Ingen enhet kopplad till fordon",content:"Du har inte valt n\xe5gon enhet. \xc4r detta korrekt? Fordon kommer inte att registrera resor.",okText:"Ingen enhet",onOk(){Ue(e)},onCancel(){le(!1)}})};function ze(e,t,n){const i=new Intl.NumberFormat("sv-SE",{style:"decimal",currency:"SEK"});d.a.confirm({title:"Ovanligt h\xf6g m\xe4tarst\xe4llning",content:"Hoppsan, du verkar ha angett en ovanligt h\xf6g m\xe4tarst\xe4llning.\n\xc4r du s\xe4ker att du vill kalibrera till "+i.format(e)+" kilometer?",onOk:()=>Object(k.b)(n,t),cancelText:"Avbryt",okText:"Kalibrera"})}const Ue=t=>{const n=ke.find((e=>{var n;return e.userId===(null===(n=t.defaultDriver)||void 0===n?void 0:n.id)})),i=ke.find((e=>{var n;return e.userId===(null===(n=t.currentDriver)||void 0===n?void 0:n.id)})),a="POOL"===t.benefitType;let l=t.permittedDrivers?t.permittedDrivers.map((e=>{var t,n;const i=ke.findIndex((t=>t.userId===e));return{id:null===(t=ke[i])||void 0===t?void 0:t.userId,displayName:null===(n=ke[i])||void 0===n?void 0:n.displayName}})):[];t={...t,permittedDrivers:a?[]:l,defaultDriver:n?{id:null===n||void 0===n?void 0:n.userId,...n}:e.record?{defaultDriver:null}:null,currentDriver:i?{id:null===i||void 0===i?void 0:i.userId,...i}:null,permitAnyDriver:a,defaultTripType:t.defaultTripType?_.a.PRIVATE:_.a.BUSINESS,style:{...t.style,color:Ee},fuel1:null===De||void 0===De?void 0:De.fuel1,fuel2:null===De||void 0===De?void 0:De.fuel2,consumption1:null===De||void 0===De?void 0:De.consumption1,consumption2:null===De||void 0===De?void 0:De.consumption2,proportion1:Le},Ne.co2Override!==Ne.co2Default&&(t.co2GKmOverride=Ne.co2Override),Ne.consumptionOverride!==Ne.consumptionDefault&&(t.fuelLKmOverride=Ne.consumptionOverride),e.record?function(t){var n;const i=null===(n=e.record)||void 0===n?void 0:n.id;let a;S.a.patchVehicle(i,t).then((n=>{var l,r,o;if(a=n,(null===(l=t.currentDriver)||void 0===l?void 0:l.userId)!==(null===(r=e.record)||void 0===r||null===(o=r.currentDriver)||void 0===o?void 0:o.id)){var s;const e={userId:null===(s=t.currentDriver)||void 0===s?void 0:s.userId};return S.a.putCheckCurrentDriver(i,e).then((()=>{var e,n;a.currentDriver={id:null===(e=t.currentDriver)||void 0===e?void 0:e.userId,displayName:null===(n=t.currentDriver)||void 0===n?void 0:n.displayName}}))}return Promise.resolve()})).then((()=>e.moveDevice?e.handleMoveDeviceToOtherVehicle(e.moveDevice,i,t):Promise.resolve())).then((()=>{var n,l,r;if(null===(n=t.state)||void 0===n||!n.imei||null!==(l=e.record)&&void 0!==l&&null!==(r=l.state)&&void 0!==r&&r.imei)return Promise.resolve();{const n=t.state.imei;return S.a.patchDevices(n,i).then((t=>{var l;a.state=t;const r=null===(l=e.knownDevices)||void 0===l?void 0:l.find((e=>(null===e||void 0===e?void 0:e.id)===n));r&&(r.installedVehicle=i)}))}})).then((()=>{var n;if(t.odometer.valueKm===(null===(n=e.record)||void 0===n?void 0:n.odometer.valueKm))return Promise.resolve();try{if(!(t.odometer.valueKm>G))return Object(k.b)(i,t.odometer);ze(t.odometer.valueKm,t.odometer,i)}catch(a){return console.log(a),Promise.resolve()}})).then((()=>{e.setData(a)})).catch((e=>{var t;let n=T.b[null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data];ue(n),le(!1)}))}(t):async function(t){try{var n,i,a,l,r,o,s,d,c,u;const O=await S.a.postSuperVehicle(t,se),g=O.id;let f=O;if(null!==(n=t.currentDriver)&&void 0!==n&&n.userId&&(null===(i=t.currentDriver)||void 0===i?void 0:i.userId)!==(null===(a=e.record)||void 0===a||null===(l=a.currentDriver)||void 0===l?void 0:l.userId)){var v,j,h;const n={userId:null===(v=t.currentDriver)||void 0===v?void 0:v.userId};await S.a.putCheckCurrentDriver(g,n),f.currentDriver={id:null===(j=t.currentDriver)||void 0===j?void 0:j.userId,displayName:null===(h=t.currentDriver)||void 0===h?void 0:h.displayName},await e.updateRecord(f)}var p;if(e.moveDevice)await e.handleMoveDeviceToOtherVehicle(e.moveDevice,g),f.state=null===(p=e.moveDevice)||void 0===p?void 0:p.state;else if(null!==(r=t.state)&&void 0!==r&&r.imei&&(null===(o=e.record)||void 0===o||null===(s=o.state)||void 0===s||!s.imei)){var b;const n=t.state.imei,i=await S.a.patchDevices(n,g);f.state=i;const a=null===(b=e.knownDevices)||void 0===b?void 0:b.find((e=>(null===e||void 0===e?void 0:e.id)===n));a&&(a.installedVehicle=g)}if((null===(d=t.odometer)||void 0===d?void 0:d.valueKm)!==(null===(c=e.record)||void 0===c||null===(u=c.odometer)||void 0===u?void 0:u.valueKm))try{t.odometer.valueKm>G?ze(t.odometer.valueKm,t.odometer,g):await Object(k.b)(g,t.odometer)}catch(m){console.log(m)}e.moveDevice?e.setData([f,{...e.moveDevice,state:null}]):e.setData(f)}catch(m){var O;let e=T.b[null===m||void 0===m||null===(O=m.response)||void 0===O?void 0:O.data];ue(e),le(!1)}}(t)},Be=null===(n=e.permittedDrivers)||void 0===n||null===(r=n.filter((t=>{var n,i;return null===(n=e.record)||void 0===n||null===(i=n.permittedDrivers)||void 0===i?void 0:i.some((e=>e.id===t.id))})))||void 0===r?void 0:r.map((e=>e.id)),Ge=null===(y=e.permittedDrivers)||void 0===y?void 0:y.filter((e=>e.organizationId===se));let He=null===(E=e.imeiList)||void 0===E?void 0:E.filter((e=>e.organizationId===se&&!e.installedVehicle&&!0!==e.retired));return He=null===(A=He)||void 0===A?void 0:A.filter((e=>!e.isTracker)),Object(N.jsx)(d.a,{centered:!0,title:"Fordon",onCancel:()=>{de(null),e.onModalCancel()},onOk:()=>ye.submit(),okText:e.record?"Spara":"L\xe4gg till nytt fordon",visible:e.isModalVisible,bodyStyle:{overflowY:"auto",maxHeight:"calc(100vh - 200px)"},children:Object(N.jsxs)(s.a,{form:ye,name:"basic",layout:"vertical",style:{margin:"auto",justifyContent:"center"},onFinish:t=>{var n,i,a;!t.registry||null!==(n=e.record)&&void 0!==n&&n.registry?t.state.imei||null!==(i=e.record)&&void 0!==i&&null!==(a=i.state)&&void 0!==a&&a.imei?Ue(t):Fe(t):Me(t)},onFinishFailed:()=>{we({})},autoComplete:"off",initialValues:{...e.record,defaultTripType:(null===(L=e.record)||void 0===L?void 0:L.defaultTripType)===_.a.PRIVATE,benefitType:(null===(M=e.record)||void 0===M?void 0:M.benefitType)||"BENEFIT",permittedDrivers:Be,odometer:{...null===(U=e.record)||void 0===U?void 0:U.odometer,recordedTimeMs:I()()},style:e.record?{...e.record.style}:{marker:"androidCar",color:Ee},state:{imei:(null===(B=e.moveDevice)||void 0===B||null===(H=B.state)||void 0===H?void 0:H.imei)||(null===(Y=e.record)||void 0===Y||null===(W=Y.state)||void 0===W?void 0:W.imei)}},children:[ce&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(c.a,{type:"error",message:ce,showIcon:!0}),Object(N.jsx)("br",{})]}),Object(N.jsx)(s.a.Item,{label:"Organisation",name:"organizationId",rules:[{required:!0,message:"V\xe4lj organisation!"}],children:Object(N.jsx)(a.a,{disabled:e.record||e.moveDevice,placeholder:"V\xe4lj organisation",data:e.knownOrganizations,selectedOrganization:se,onChange:e=>de(e)})}),Object(N.jsx)(s.a.Item,{label:"Enhet",name:["state","imei"],rules:[{required:!1,message:"V\xe4lj organisation!"}],children:Object(N.jsxs)(o.a,{allowClear:!0,showSearch:!0,onChange:e=>Oe(!e),disabled:(null===(K=e.record)||void 0===K||null===(q=K.state)||void 0===q?void 0:q.imei)||e.moveDevice,placeholder:"V\xe4lj enhet",filterOption:(e,t)=>{var n;return null===t||void 0===t||null===(n=t.children)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},children:[(null===(J=He)||void 0===J?void 0:J.filter((e=>null===me||void 0===me?void 0:me.includes(e.id))).length)>0&&Object(N.jsx)(w,{label:"Tidigare installerade enheter",children:null===me||void 0===me||null===(Q=me.map(((e,t)=>{const n=He.find((t=>t.id===e));return n?Object(N.jsx)(o.a.Option,{value:n.id,children:t===me.length-1?"".concat(n.imei," (senaste)"):n.imei},n.id):null})))||void 0===Q?void 0:Q.reverse()}),(null===(Z=He)||void 0===Z?void 0:Z.filter((e=>!(null!==me&&void 0!==me&&me.includes(e.id)))).length)>0&&Object(N.jsx)(w,{label:"Alla lediga enheter",children:null===(X=He)||void 0===X?void 0:X.filter((e=>!(null!==me&&void 0!==me&&me.includes(e.id)))).map((e=>Object(N.jsx)(o.a.Option,{value:e.id,children:e.imei},e.id)))})]})}),Object(N.jsx)(s.a.Item,{label:"Regnr",children:Object(N.jsxs)(u.a.Group,{compact:!0,children:[Object(N.jsx)(s.a.Item,{name:"registry",noStyle:!0,rules:[{required:!1,message:"Registration number is required"}],children:Object(N.jsx)(u.a,{disabled:(null===($=e.record)||void 0===$?void 0:$.registry)&&!e.isRoot,onInput:e=>e.target.value=e.target.value.toUpperCase(),style:{width:"50%"},placeholder:"Ange regnr",onChange:e=>{e.preventDefault(),_e(e.target.value)}})}),Object(N.jsx)(s.a.Item,{name:"displayName",noStyle:!0,rules:[{required:!1,message:"Street is required"}],children:Object(N.jsx)(u.a,{style:{width:"50%"},placeholder:"Ange alias"})})]})}),Object(N.jsx)(s.a.Item,{label:"Landskod",children:Object(N.jsx)(s.a.Item,{name:["isoCountryCode"],noStyle:!0,children:Object(N.jsxs)(o.a,{allowClear:!0,showSearch:!0,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.children))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},name:"isoCountryCode",onChange:e=>{Te(e)},style:{minWidth:150},placeholder:"Ange landskod",children:[Object(N.jsx)(w,{label:"Skandinavien",children:z.map((e=>Object(N.jsxs)(D,{value:e.key,children:[e.label," (",e.key,")"]})))}),Object(N.jsx)(w,{label:"\xd6vriga l\xe4nder",children:F.map((e=>Object(N.jsxs)(D,{value:e.key,children:[e.label," (",e.key,")"]})))})]})})}),Object(N.jsxs)(s.a.Item,{label:"Biluppgifter",children:["SE"===Se&&ye.getFieldValue("registry")?null:Object(N.jsx)("p",{style:{marginTop:"0.5em",fontStyle:"italic"},children:"Kontrollera att registreringsnummer \xe4r angivet ovan och f\xf6ljer Trafikverkets regler."}),"SE"!==ye.getFieldValue("isoCountryCode")||!ye.getFieldValue("registry")||null!==De&&void 0!==De&&De.consumption1?null:Object(N.jsx)(s.a.Item,{children:Object(N.jsx)(v.a,{loading:re,type:"secondary",onClick:()=>{oe(!0),S.a.getVehicleInfo(Ce).then((e=>{e&&e.hexaData&&e.hexaData[Ce.toUpperCase()]?(we(e.hexaData[Ce.toUpperCase()]),Pe(e.hexaData[Ce.toUpperCase()].proportion1)):(we({}),Pe(null)),oe(!1)})).catch((e=>{oe(!1),console.error(e)}))},children:"H\xe4mta info fr\xe5n biluppgifter"})}),"SE"===ye.getFieldValue("isoCountryCode")&&null!==De&&void 0!==De&&De.consumption1?Object(N.jsx)(s.a.Item,{children:Object(N.jsx)(v.a,{loading:re,type:"secondary",onClick:()=>{var t;S.a.postVehiclesResetFuelAndCO2(null===(t=e.record)||void 0===t?void 0:t.id).then((e=>{e&&we(e)})).catch((e=>console.log(e)))},children:"\xc5terst\xe4ll data fr\xe5n biluppgifter"})}):null]}),(e=>{if((null===(e=Object.keys(De))||void 0===e?void 0:e.length)>0){var t;if(j.a,null===(null===De||void 0===De?void 0:De.fuel2))return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(h.a,{gutter:16,children:[Object(N.jsxs)(p.a,{span:8,children:[Object(N.jsx)("h5",{children:"Br\xe4nsle"}),Object(N.jsx)(j.a,{style:{margin:"4px 0"}}),Object(N.jsx)("span",{style:{marginTop:8},children:Object(N.jsx)("span",{children:null===De||void 0===De||null===(t=De.fuel1)||void 0===t?void 0:t.svName})})]}),Object(N.jsxs)(p.a,{span:8,children:[Object(N.jsx)("h5",{children:"CO2 Utsl\xe4pp"}),Object(N.jsx)(j.a,{style:{margin:"4px 0"}}),null!==(null===De||void 0===De?void 0:De.co2GKm1)&&Object(N.jsxs)("span",{style:{marginTop:8},children:[null!==(null===De||void 0===De?void 0:De.co2GKm1)?null===De||void 0===De?void 0:De.co2GKm1:"","g/km"]})]}),Object(N.jsxs)(p.a,{span:8,children:[Object(N.jsx)("h5",{children:"F\xf6rbrukning"}),Object(N.jsx)(j.a,{style:{margin:"4px 0 12px 0"}}),Object(N.jsxs)(h.a,{justify:"flex-start",children:[Object(N.jsx)(s.a.Item,{noStyle:!0,children:Object(N.jsx)(b.a,{style:{width:"70px"},value:null===De||void 0===De?void 0:De.consumption1,onChange:e=>we({...De,consumption1:e})})}),Object(N.jsx)(R,{style:{display:"flex",flexDirection:"column",justifyContent:"center",padding:"3px",paddingLeft:"8px"},children:De.fuel1?De.fuel1.consumptionUnit:""})]})]})]})});if(null!==De.fuel2){var n,i,a,l;const e={0:null===(n=De.fuel1)||void 0===n?void 0:n.svName,100:null===(i=De.fuel2)||void 0===i?void 0:i.svName};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(h.a,{gutter:16,children:[Object(N.jsxs)(p.a,{span:8,children:[Object(N.jsx)("h5",{children:"Br\xe4nsle"}),Object(N.jsx)(j.a,{style:{margin:"4px 0"}}),Object(N.jsx)(h.a,{children:Object(N.jsx)("span",{style:{marginTop:8},children:Object(N.jsx)("span",{children:null===(a=De.fuel1)||void 0===a?void 0:a.svName})})}),Object(N.jsx)(h.a,{children:Object(N.jsx)("span",{style:{marginTop:16},children:Object(N.jsx)("span",{children:null===(l=De.fuel2)||void 0===l?void 0:l.svName})})})]}),Object(N.jsxs)(p.a,{span:8,children:[Object(N.jsx)("h5",{children:"CO2 Utsl\xe4pp"}),Object(N.jsx)(j.a,{style:{margin:"4px 0"}}),Object(N.jsx)(h.a,{children:null!==De.co2GKm1&&Object(N.jsxs)("span",{style:{marginTop:8},children:[null!==De.co2GKm1?De.co2GKm1:"","g/km"]})}),Object(N.jsx)(h.a,{children:null!==De.co2GKm2&&Object(N.jsxs)("span",{style:{marginTop:16},children:[null!==De.co2GKm2?De.co2GKm2:"","g/km"]})})]}),Object(N.jsxs)(p.a,{span:8,children:[Object(N.jsx)("h5",{children:"F\xf6rbrukning"}),Object(N.jsx)(j.a,{style:{margin:"4px 0 12px 0"}}),Object(N.jsxs)(h.a,{justify:"flex-start",children:[Object(N.jsx)(s.a.Item,{noStyle:!0,children:Object(N.jsx)(b.a,{style:{width:"70px"},value:null===De||void 0===De?void 0:De.consumption1,onChange:e=>we({...De,consumption1:e})})}),Object(N.jsx)(R,{style:{display:"flex",flexDirection:"column",justifyContent:"center",padding:"3px",paddingLeft:"8px"},children:De.fuel1?null===(r=De.fuel1)||void 0===r?void 0:r.consumptionUnit:""})]}),Object(N.jsx)(h.a,{justify:"flex-start",children:Object(N.jsxs)(s.a.Item,{noStyle:!0,children:[Object(N.jsx)(b.a,{style:{width:"70px"},value:null===De||void 0===De?void 0:De.consumption2,onChange:e=>we({...De,consumption2:e})}),Object(N.jsx)(R,{style:{display:"flex",flexDirection:"column",justifyContent:"center",padding:"3px",paddingLeft:"8px"},children:De.fuel2?De.fuel2.consumptionUnit:""})]})})]})]}),Object(N.jsxs)("div",{style:{padding:"8px 24px"},children:[Object(N.jsx)(O.a,{value:Le,onChange:e=>Pe(e),marks:e,tooltipVisible:!1,trackStyle:{background:"#3B4962"}}),Object(N.jsxs)(h.a,{justify:"space-between",children:[Object(N.jsx)(p.a,{children:Object(N.jsxs)("span",{children:[Le,"%"]})}),Object(N.jsx)(p.a,{children:Object(N.jsxs)("span",{children:[100-Le,"%"]})})]})]})]})}j.a}var r})(),Object(N.jsx)(s.a.Item,{name:["odometer","valueKm"],label:"M\xe4tarst\xe4llning",rules:[{required:!1,message:"V\xe4rdet m\xe5ste vara ett tal",pattern:new RegExp(/^[0-9]+$/)}],children:Object(N.jsx)(u.a,{disabled:be,min:0,max:15e5,suffix:"km"})}),Object(N.jsx)(s.a.Item,{name:["odometer","applyRetroactive"],valuePropName:"checked",style:{marginBottom:5},rules:[{required:!1}],children:Object(N.jsx)(m.a,{disabled:be,checked:!he,onChange:()=>pe(!he),children:"Kalibrera fr.o.m. tidpunkt"})}),Object(N.jsx)(s.a.Item,{name:["odometer","recordedTimeMs"],rules:[{required:!1}],children:Object(N.jsx)(g.a,{disabled:be||he,showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",defaultValue:I()(),placeholder:"V\xe4lj tidpunkt",style:{width:"50%"},allowClear:!1})}),Object(N.jsx)(s.a.Item,{label:"Typ av fordon",name:"benefitType",rules:[{required:!0,message:"V\xe4lj fordonstyp!"}],children:Object(N.jsx)(f.a.Group,{size:"small",defaultValue:(null===(ee=e.record)||void 0===ee?void 0:ee.benefitType)||"BENEFIT",onChange:e=>xe(e.target.value===_.a.POOL),children:Object.entries(V).map((e=>{let[t,n]=e;return Object(N.jsx)(f.a.Button,{value:t,children:n})}))})}),Object(N.jsx)(s.a.Item,{label:"F\xf6rval",name:"defaultTripType",valuePropName:(null===(te=e.record)||void 0===te?void 0:te.defaultTripType)===_.a.PRIVATE?"checked":null,rules:[{required:!0,message:"V\xe4lj f\xf6rval!"}],children:Object(N.jsx)(x.a,{className:"tripType",checkedChildren:"Privat",unCheckedChildren:"Tj\xe4nst"})}),Object(N.jsx)(s.a.Item,{label:"Beh\xf6riga f\xf6rare",name:"permittedDrivers",rules:[{required:!1,message:"V\xe4lj fordon!"}],children:fe?Object(N.jsx)("p",{style:{marginTop:"0.5em",fontStyle:"italic"},children:"Poolbilar \xe4r till\xe5tna f\xf6r alla f\xf6rare."}):Object(N.jsxs)(o.a,{optionFilterProp:"children",allowClear:!0,showSearch:!0,autoComplete:!1,filterOption:(e,t)=>{var n;return null===(n=JSON.stringify(null===t||void 0===t?void 0:t.object))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},onSearch:()=>null,onChange:(e,t)=>je(t),mode:"multiple",style:{width:"100%"},placeholder:"V\xe4lj f\xf6rare",children:[Object(N.jsx)(D,{disabled:!0,value:"xxx",children:(null===ve||void 0===ve?void 0:ve.length)>0?Object(N.jsx)("span",{onClick:()=>{ye.setFieldsValue({permittedDrivers:[]}),je([])},style:{color:"#286FBE",cursor:"pointer"},children:"Avmarkera alla"}):Object(N.jsx)("span",{onClick:()=>{const e=null===Ge||void 0===Ge?void 0:Ge.map((e=>{let{userId:t}=e;return t}));ye.setFieldsValue({permittedDrivers:e}),je(Ge)},style:{color:"#286FBE",cursor:"pointer"},children:"V\xe4lj alla"})}),null===Ge||void 0===Ge?void 0:Ge.map(((e,t)=>Object(N.jsx)(D,{value:e.userId,object:e,children:e.displayName})))]})}),Object(N.jsx)(s.a.Item,{label:"F\xf6rvald f\xf6rare",name:["defaultDriver",["id"]],rules:[{required:!1,message:"V\xe4lj f\xf6rvald f\xf6rare!"}],children:fe?Object(N.jsx)("p",{style:{marginTop:"0.5em",fontStyle:"italic"},children:"Poolbilar \xe4r till\xe5tna f\xf6r alla f\xf6rare."}):Object(N.jsx)(o.a,{allowClear:!0,showSearch:!0,autoComplete:!1,filterOption:(e,t)=>{var n;return null===(n=t.children)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},placeholder:"V\xe4lj f\xf6rare",children:null===ve||void 0===ve?void 0:ve.map((e=>Object(N.jsx)(D,{value:e.userId||e.id||e.value,children:e.displayName||e.children})))})}),Object(N.jsx)(s.a.Item,{label:"Incheckad f\xf6rare",name:["currentDriver","id"],rules:[{required:!1,message:"V\xe4lj incheckad f\xf6rare!"}],children:Object(N.jsx)(o.a,{allowClear:!0,showSearch:!0,autoComplete:!1,filterOption:(e,t)=>{var n;return null===(n=t.children)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},placeholder:"V\xe4lj f\xf6rare",children:fe?null===Ge||void 0===Ge?void 0:Ge.map(((e,t)=>Object(N.jsx)(D,{value:e.userId,object:e,children:e.displayName}))):null===ve||void 0===ve?void 0:ve.map((e=>Object(N.jsx)(D,{value:e.userId||e.id||e.value,children:e.displayName||e.children})))})}),Object(N.jsx)(s.a.Item,{label:"Ikon",children:Object(N.jsxs)(u.a.Group,{compact:!0,children:[Object(N.jsx)(s.a.Item,{name:["style","marker"],noStyle:!0,rules:[{required:!1,message:"Registration number is required"}],children:Object(N.jsx)(o.a,{placeholder:"V\xe4lj ikon",children:P})}),Object(N.jsx)(s.a.Item,{name:["style","color"],style:{margin:"auto"},rules:[{required:!1,message:"Street is required"}],children:Object(N.jsx)(l.a,{color:(null===(ne=e.record)||void 0===ne||null===(ie=ne.style)||void 0===ie?void 0:ie.color)||Ee,colorChange:e=>{Ie(e.hex)}})})]})})]})})}},316:function(e,t,n){"use strict";var i=n(0),a=n(538),l=n(1);t.a=e=>{const{colorChange:t,color:n=""}=e,[r,o]=Object(i.useState)(!1),[s,d]=Object(i.useState)(n),[c,u]=Object(i.useState)(n);Object(i.useEffect)((()=>{u(n),d(n)}),[n]);const v=()=>{o(!r)};return Object(l.jsxs)("div",{className:"color-picker",children:[Object(l.jsx)("div",{className:"color-picker-dropdown",children:Object(l.jsx)("div",{className:"color",style:{backgroundColor:c||"#ffffff"},onClick:v})}),r&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{className:"color-picker-backdrop",onClick:v}),Object(l.jsx)(a.a,{color:s,onChange:e=>{const{rgb:n}=e,i="rgb(".concat(n.r,", ").concat(n.g,", ").concat(n.b,", ").concat(n.a,")");u(i),d(n),t(e)}})]})]})}},325:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(45),a=n(210),l=n(1);const r=e=>{let{batteryLevel:t}=e;return Object(l.jsx)("div",{children:Object(l.jsx)(a.a,{type:"dashboard",percent:t,width:30,strokeColor:i.b.determineBatteryColor(t)})})}},328:function(e){e.exports=JSON.parse('{"ADD_NEW_ZONE":"Add new zone","home":"Home","health":"Health","din1":"DIN1","journeys":"Journeys","map":"Map","vehicle":"Vehicle","settings":"Settings","endpoint.imei":"IMEI","endpoint.num_din1":"Number of DIN1","endpoint.latest_activity":"Last seen speeding > 20 kph","sidenav.dashboard":"Dashboard","sidenav.dashboard.default":"Default","sidenav.dashboard.analytic":"Analytic","sidenav.dashboard.sales":"Sales","sidenav.apps":"Apps","sidenav.apps.mail":"Mail","sidenav.apps.chat":"Chat","sidenav.apps.calendar":"Calendar","sidenav.apps.project":"Project","sidenav.apps.project.list":"List","sidenav.apps.project.scrumboard":"Scrumboard","sidenav.apps.ecommerce":"E-Commerce","sidenav.apps.ecommerce.product":"Product","sidenav.apps.ecommerce.editProduct":"Edit Product","sidenav.apps.ecommerce.addProduct":"Add Product","sidenav.apps.ecommerce.productList":"Product List","sidenav.apps.ecommerce.orders":"Orders","sidenav.components":"Components","sidenav.components.general":"General","sidenav.components.general.button":"Button","sidenav.components.general.icon":"Icon","sidenav.components.general.typography":"Typography","sidenav.components.layout":"Layout","sidenav.components.layout.grid":"Grid","sidenav.components.layout.layout":"Layout","sidenav.components.navigation":"Navigation","sidenav.components.navigation.affix":"Affix","sidenav.components.navigation.breadcrumb":"Breadcrumb","sidenav.components.navigation.dropdown":"Dropdown","sidenav.components.navigation.menu":"Menu","sidenav.components.navigation.pagination":"Pagination","sidenav.components.navigation.pageHeader":"Page Header","sidenav.components.navigation.steps":"Steps","sidenav.components.dataEntry":"Data Entry","sidenav.components.dataEntry.autoComplete":"Auto Complete","sidenav.components.dataEntry.checkbox":"Checkbox","sidenav.components.dataEntry.cascader":"Cascader","sidenav.components.dataEntry.datePicker":"Date Picker","sidenav.components.dataEntry.form":"Form","sidenav.components.dataEntry.inputNumber":"Input Number","sidenav.components.dataEntry.input":"Input","sidenav.components.dataEntry.mentions":"Mentions","sidenav.components.dataEntry.rate":"Rate","sidenav.components.dataEntry.radio":"Radio","sidenav.components.dataEntry.switch":"Switch","sidenav.components.dataEntry.slider":"Slider","sidenav.components.dataEntry.select":"Select","sidenav.components.dataEntry.treeSelect":"Tree Select","sidenav.components.dataEntry.transfer":"Transfer","sidenav.components.dataEntry.timePicker":"Time Picker","sidenav.components.dataEntry.upload":"Upload","sidenav.components.dataDisplay":"Data Display","sidenav.components.dataDisplay.avatar":"Avatar","sidenav.components.dataDisplay.badge":"Badge","sidenav.components.dataDisplay.comment":"Comment","sidenav.components.dataDisplay.collapse":"Collapse","sidenav.components.dataDisplay.carousel":"Carousel","sidenav.components.dataDisplay.card":"Card","sidenav.components.dataDisplay.calendar":"Calendar","sidenav.components.dataDisplay.descriptions":"Descriptions","sidenav.components.dataDisplay.empty":"Empty","sidenav.components.dataDisplay.list":"List","sidenav.components.dataDisplay.popover":"Popover","sidenav.components.dataDisplay.statistic":"Statistic","sidenav.components.dataDisplay.tree":"Tree","sidenav.components.dataDisplay.tooltip":"Tooltip","sidenav.components.dataDisplay.timeline":"Timeline","sidenav.components.dataDisplay.tag":"Tag","sidenav.components.dataDisplay.tabs":"Tabs","sidenav.components.dataDisplay.table":"Table","sidenav.components.feedback":"Feedback","sidenav.components.feedback.alert":"Alert","sidenav.components.feedback.drawer":"Drawer","sidenav.components.feedback.modal":"Modal","sidenav.components.feedback.message":"Message","sidenav.components.feedback.notification":"Notification","sidenav.components.feedback.progress":"Progress","sidenav.components.feedback.popconfirm":"Popconfirm","sidenav.components.feedback.result":"Result","sidenav.components.feedback.spin":"Spin","sidenav.components.feedback.skeleton":"Skeleton","sidenav.components.other":"Other","sidenav.components.other.anchor":"Anchor","sidenav.components.other.backtop":"BackTop","sidenav.components.other.configProvider":"Config Provider","sidenav.components.other.divider":"Divider","sidenav.charts":"Charts","sidenav.charts.apex":"Apex Charts","sidenav.charts.chartjs":"ChartJs","sidenav.maps":"Maps","sidenav.maps.google":"Google Maps","sidenav.maps.simple":"Simple Maps","sidenav.pages":"Pages","sidenav.pages.profile":"Profile","sidenav.pages.invoice":"Invoice","sidenav.pages.pricing":"Pricing","sidenav.pages.faq":"FAQ","sidenav.pages.setting":"Setting","sidenav.pages.userlist":"User list","sidenav.authentication":"Authentication","sidenav.authentication.login.1":"Login 1","sidenav.authentication.login.2":"Login 2","sidenav.authentication.register.1":"Register 1","sidenav.authentication.register.2":"Register 2","sidenav.authentication.forgetPassword":"Forget Password","sidenav.errors":"Errors","sidenav.errors.error.1":"Error Page 1","sidenav.errors.error.2":"Error Page 2","sidenav.docs":"Docs","sidenav.docs.documentation":"Documentation","sidenav.docs.changelog":"Changelog"}')},329:function(e){e.exports=JSON.parse('{"Ekonomi":"Kalender","F\xf6rval":"F\xf6rval","Kalender":"Kalender","Organisation":"Organisation","Rapporter":"Rapporter","Superadmin":"Superadmin","Support":"Support","Trackson":"Trackson","Larm":"Larm","home":"Hem","health":"Health","din1":"DIN1","journeys":"K\xf6rjournal","map":"Karta","vehicle":"Mina Fordon","settings":"Inst\xe4llningar","ALIAS":"ddddd","BATTERY":"Batteri","BTN_ABORT":"dddd","BTN_ADD_UNIT":"L\xe4gg till enhet","BTN_AVL":"AVL","BTN_CALIBRATE":"Kalibrera","BTN_CLOSE":"St\xe4ng","BTN_CONNECT_TO_CUSTOMER":"Koppla","BTN_CONNECT":"Koppla","BTN_CPU_RESET":"CPU \xe5ters.","BTN_WEB_CONNECT":"Web-connect.","BTN_RESET":"\xc5terst\xe4ll","BTN_DISPLAY_UNIT":"Enhet","BTN_DISPLAY_VEHICLE":"Fordon","BTN_DOWNLOAD_SEL":"Ladda ner valda","BTN_FETCH_VEHICLE_INFO":"H\xe4mta uppgifter fr\xe5n biluppgifter.se","BTN_GET_INFO":"H\xe4mta\\ninfo","BTN_LOGG":"Logg","BTN_NEW_ORG":"Ny organisation","BTN_RETIRE":"Pensionera","BTN_SHOW":"Visa","BTN_SAVE":"Spara","BTN_TO_STORAGE":"Till lager","BTN_CHANGE_ORG":"\xc4ndra org.","BTN_CHANGE":"\xc4ndra","BTN_UPDATE":"Uppdatera","CAR_TYPE":"Biltyp","CHOOSE_A_DRIVER":"V\xe4lj en f\xf6rare","CHOOSE_DRIVERS":"V\xe4lj f\xf6rare","CHOOSE_A_VEHICLE":"V\xe4lj ett fordon","CHOOSE_VEHICLES":"V\xe4lj fordon","CHOOSE_AN_ORG":"V\xe4lj en organisation","CHOOSE_QUICK_COMMAND":"V\xe4lj kommando","CHOOSE":"V\xe4lj","CONFIG_SHORT":"CFG","CONFIG":"Config","CONNECTED":"Kopplad","CURRENT_DRIVER":"Incheckad f\xf6rare","DATA_BLOCK":"Datam\xe4ngd","DESCRIPTION":"Syfte","DISPLAY_UNIT":"Visa enhet","DISPLAY_VEHICLE":"Visa fordon","DRIVER":"F\xf6rare","DELETE":"Ta bort","EXISTING":"Befintlig","FIRMWARE_SHORT":"FW","FIRMWARE":"Firmware","FIRMWARE_AND_CONFIG":"FW & Config","FROM":"Fr\xe5n","GET_INFO":"H\xe4mta info","HARDWARE":"H\xe5rdvara","HEART_BEAT":"S\xe5gs senast","ICCID":"ICCID","IMEI":"IMEI","KNOWN":"K\xe4nd","LIST_DRIVERS":"Lista f\xf6rare","LIST_VEHICLES":"Lista fordon","LOG":"Kvitterade","MILE_AGE":"M\xe4tars.","MILEAGE_FULL":"M\xe4tarst\xe4llning","Model":"Modell","MOVE_TO_ANOTHER_VEHICLE":"Flytta till annat fordon","MOVE_DEVICE":"Flytta enhet","MOVE_VEHICLE":"Flytta fordon","NEW_DRIVER":"Ny f\xf6rare","NEW_ORG_SHORT":"Ny org.","NEW_VEHICLE":"Nytt fordon","NO":"Nej","NO_DRIVER":"Ingen f\xf6rare","OBD":"OBD","OPERATIONAL_AT":"Kopplad","ORG":"Organisation","OWNER":"\xc4gare","PHONE_NUMBER":"Telnr","START_OF_USE":"Enhet tas i bruk","PLACE_HOLDER_TEXT":"PLACE_HOLDER_TEXT","PLACE_HOLDER_TITLE":"PLACE_HOLDER_TITLE","PRIMARY_DRIVER":"Prim\xe4r f\xf6rare","PERMITTED_DRIVERS":"Beh\xf6riga f\xf6rare","REG_NUM_SHORT":"Regnr","REG_NUM":"Regnr","SAVE":"Spara","SEND_INVITE":"Skicka inbjudan","START":"Start","STOP":"Stop","SUPPLY":"Ange ","SUPPLY_A_FIRST_LAST_NAME":"Ange f\xf6rnamn & efternamn","SUPPLY_A_FIRST_NAME":"Ange ett f\xf6rnamn","SUPPLY_A_LAST_NAME":"Ange ett efternamn","SUPPLY_A_NEW_BUSINESS_NAME":"Ange nytt f\xf6retagsnamn","SUPPLY_A_NEW_PASSWORD":"Ange nytt l\xf6senord","SUPPLY_A_OLD_PASSWORD":"Ange ditt l\xf6senord","SUPPLY_A_NEW_ORG_COUNTRY":"Ange ett land","SUPPLY_A_NEW_ORG_COUNTY":"Ange ett l\xe4n","SUPPLY_A_NEW_ORG_EMAIL":"Ange en e-post","SUPPLY_A_NEW_ORG_PHONE":"Ange ett telefonnummer","SUPPLY_A_NEW_ORG_POSTAL_CODE":"Ange ett postnummer.","SUPPLY_A_NEW_ORG_STREET_ADDRESS":"Ange en gatuadress","SUPPLY_A_NEW_ORG_PASSWORD":"Ange ett l\xf6senord","SUPPLY_A_NEW_ORG":"Ange nytt organisationsnr.","SUPPLY_A_REG_NUM":"Ange ett regnr","SUPPLY_AN_ALIAS":"Ange ett alias","SUPPLY_A_BENEFIT_TYPE":"Ange f\xf6rm\xe5nstyp","SUPPLY_A_DEFAULT_TRIP_TYPE":"Ange restyp","SELECT_AN_EXISTING_ORGANISATION":"V\xe4lj en befintlig organisation","SELECT_AN_EXISTING_DRIVER":"V\xe4lj en befintlig f\xf6rare","SELECT_AN_EXISTING_VEHICLE":"V\xe4lj ett befintligt fordon","SUPPLY_AN_EMAIL_ADDRESS":"Ange en e-post","SUPPLY_PURPOSE":"Ange syfte...","SYNC_FROM_CAR_INFO":"Synka fr\xe5n biluppgifter","SYNC_NOW":"Synka nu","TO":"Till","TRAVELS":"Resor","TYPE_ERROR":"Typ/Fel","TYPE":"Typ","BENEFIT_TYPE":"Fordons-typ","UNKNOWN":"Ok\xe4nd","VEHICLE":"Fordon","VOLTAGE_RANGE":"Voltage range","WARN_WARN_WARN":"Varning varning varning","YEAR":"\xc5rtal","YES":"Ja","POP_CONFIRM_QUESTION_RETIRE_UNIT":"Vill du verkligen pensionera enheten?","POP_CONFIRM_QUESTION_CPU_RESET":"Vill du verkligen starta om enheten?","POP_CONFIRM_QUESTION_WEB_CONNECCT":"Vill du verkligen skicka web-connect?","BTN_UN_RETIRE":"Avpensionera","INPUT_SEARCH_IN_TABLE":"S\xf6ker efter IMEI, telnr, regnr, f\xf6rare","BTN_SEARCH":"S\xf6k","ICON":"Ikon","DEFAULT":"F\xf6rvald typ av resa","EDIT_DEVICE":"\xc4ndra","GO_TO_JOURNEY":"G\xe5 till K\xf6rjournalen","DBCLICK_ON_MAP_TO_CHOOSE_LOCATION":"Dubbelklicka f\xf6r att v\xe4lja en plats p\xe5 kartan","CURRENT_LOCATION_UPPDATED":"Nuvarande position uppdaterad","STYLE":"M\xe4rkning","BTN_SHOW_ON_THE_MAP":"Visa p\xe5 karta","SHOW_WHERE_ALARM_TRIGGERED":"Visa var larmet utl\xf6stes","LAST_SEEN":"S\xe5gs senast","SPEED":"Hastighet","NO_INFO":"Info saknas","PARKED":"Parkerad","IN_MOVING":"I r\xf6relse","UPDATE_LAST_POSITION":"Uppdatera aktuell position","DO_NOT_FOLLOW":"Sluta f\xf6lj","CAN_NOT_FOLLOW":"Fordonet kan inte sp\xe5ras","FOLLOW_ON_THE_MAP":"F\xf6lj fordonet","FILTER_BY_VEHICLE":"Filtrera efter fordon","YOUR_CHANGED_SAVED":"Dina \xe4ndringar har sparats","NEW_ORG_CREATED":"Ny organisation skapades","COMPANY_ADMIN":"F\xf6retags Admin","COMPANY_DELETED":"Organisation har tagits bort","ORG_NAME":"F\xf6retagsnamn","PARENT":"F\xf6r\xe4lder","MAIL":"E-post","ORG_NUM":"Organisationsnr","POSTAL_ADDRESS":"Postadress","DELETE_ORG":"Ta bort organisation?","SEARCH_ORG":"S\xf6k efter organisation","ADD_NEW_ORG":"L\xe4gg till ny organisation","ADD":"L\xe4gg till","SUPPLY_ADMINS_EMAIL":"F\xf6retagsadmins e-postadress (Fyll i om du vill skapa en ny anv\xe4ndare)","ADMINS_PASSWORD":"F\xf6retagsadmins l\xf6senord","INVOICE_ADDRESS":"Fakturaadress","USERS":"Anv\xe4ndare","DEVICES":"Enheter","ORGANIZATION":"Organisation","ORGANIZATIONS":"Organisationer","LAST_SEEN_DRIVING":"S\xe5gs senast k\xf6rning","CHECKED":"Incheckad","INSTALL":"Installed","RETIRED":"Pensionerad","STREET_ADDRESS":"Gatuadress","POSTAL_CODE":"Postnummer","CITY":"Postort","COUNTY":"L\xe4n","COUNTRY":"Land","SUPERADMIN":"Superadmin","ADD_NEW_ZONE":"L\xe4gg till ny plats","NAME":"Namn","INTERVAL":"Intervall","CURRENT_SCHEDULES":"Aktuella scheman","SCHEDULING":"Schemal\xe4ggning","CHOOSE_ALL":"V\xe4lj alla","THIS":"Den","EVERY_MONTH":"varje m\xe5nad","TIMEPOINT":"Tidpunkt","MONTHLY_REPORT":"M\xe5nadsrapport","REPORTS_TYPE":"Typ av rapport","CREATE_NEW_SCHEDULE":"Spara","SEND_REPORT":"Rapport skickas","MAIL_RECIPIENTS":"Mottagare","REPORT":"rapport","REPORT_SCHEDULING":"rapportschemal\xe4ggning","REMOVE_REPORT":"Ta bort scheman?","REPORT_DELETED":"Scheman har tagits bort","REPORT_CREATED":"Ett nytt schema skapades","EXPORT_AS":"Exportera filen som...","ALL_VEHICLES":"Alla fordon","ALL_ORG":"Alla organisationer","ALL_DRIVERS":"Alla f\xf6rare","LIGHT_MAP":"Ljus karta","LIGHT":"Ljus","DARK":"M\xf6rk","START_TYPING_TO_SEARCH":"B\xf6rja skriva f\xf6r att s\xf6ka","UPDATE":"Uppdatera","UPDATE_PURPOSE":"Syften uppdaterades","DO_YOU_WANT_TO_DOWNLOAD_REPORTS_FOR_ALL_VEHICLES":"Vill du ladda ner k\xf6rjournalrapport f\xf6r alla valda fordon?","DESCRIBE_CASE":"Beskriv ditt \xe4rende...","SUPPLY_TITLE":"Ange titel","TITLE":"Titel","SENT_INVITE":"Inbjudan skickad","BTN_CHANGE_ORG_FOR_VEHICLE":"Flytta fordonet till en annan organisation","MOVE_TO_ORG":"Flytta","JOURNEY":"K\xf6rjournalen","FOLLOW":"F\xf6lj","UPDATE_ODOMETER":"Uppdatera m\xe4tarst\xe4llning","CHOOSE_ORGS":"V\xe4lj organisation","FILTER_BY_ORG":"Filtrera efter organisation","FILTER_BY_BENEFIT_TYPE":"Filtrera efter typ","SCHEDULE_PRESELECTION":"F\xf6rval f\xf6r schema:","TOO_LARGE_DATA_LIMIT_PLEASE_SELECT_ORGANIZATION":"F\xf6r stort urval. V\xe4lj en organisation f\xf6r att kunna se k\xf6rjournalen.","REPORT_IS_CREATED":"Rapporten skapas...","ZONENAME":"titel","ADD_NEW_PURPOSE":"L\xe4gg till ett nytt resesyfte","SAVED_PURPOSE":"Dina sparade resesyften","DESCRIPTIONS":"Resesyften","SEARCH_DRIVER":"Filtrera efter f\xf6rare","ALARM_PLACES":"Geozon - larm","ALARM":"larm","PLACE":"Plats","ACKNOWLEDGED":"Kvitterat","SCHEDULE":"Schema","NEW_PLACE":"Ny plats","RADIUS":"Radie","ZONE_NAME":"Plats namn","NEW_ZONE":"Ny plats","RADIUS_MS":"Fr\xe5n","ZONES_DELETED":"Platsen har tagits bort","ADDRESS":"Adress","COORDINATE":"Koordinat","DESCRIPTION_GOAL":"Syfte","TRIP_TYPE":"Typ av resa","ENTRY_EXIT_TRIP":"Inresa/Utresa","DO_YOU_WANT_TO_DELETE_THIS_ZONE":"Ta bort platsen?","DATE_TO":"Till","ENTRY":"Inresa","EXIT":"Utresa","INSIDE":"Inom","OUTSIDE":"Utanf\xf6r","DISTORTION":"K\xe4nslighet","WHEN":"N\xe4r","WHERE":"Var","WHO":"Vem","WHICH":"Vilka","GEO_LARM_MESSAGE_INFO":"Dubbelklicka p\xe5 kartan, ange koordinater eller adress f\xf6r att v\xe4lja en punkt. Str\xe4ck sedan ut omr\xe5det f\xf6r att markera det.","CHOOSE_MIN_3":"Du beh\xf6ver v\xe4lja minst 3 punkter p\xe5 kartan","REPEAT_AFTER":"Upprepa larmet","NOTIFICATION":"Notiser","SHOW_LARM":"Visa larmets detaljer","ACTUALLY":"Ej kvitterade","ONGOING":"P\xe5g\xe5ende...","TAX":"Tr\xe4ngselskatt","DEVICE":"Enhet","EXPORT_RAPPORT":"Exportera rapport","ALARM_TYPE":"Typ","ALARM_NAME":"Namn","HIGH":"H\xf6g","LOW":"L\xe5g","TRIGGERED_LARM":"Utl\xf6sta larm","STATUS":"Status","RESTORED":"\xc5terst\xe4llt","ACTIVATE_ALARM_WHEN":"Aktivera larmet om fordon befinner sig ... valt omr\xe5de","GET_NOTIFICATION":"F\xe5 notifikation om fordon befinner sig","AREA":"area","ENDED":"Avslutad","SEARCH_VEHICLE":"S\xf6k efter fordon, f\xf6rare...","GEO_ZONE":"Geozon","endpoint.imei":"IMEI","endpoint.num_din1":"Antal DIN1 = 1","endpoint.have_din1":"Fungerande DIN1","endpoint.latest_activity":"Senast aktiv","sidenav.dashboard":"Dashboard","sidenav.dashboard.default":"Default","sidenav.dashboard.analytic":"Analytic","sidenav.dashboard.sales":"Sales","sidenav.apps":"Apps","sidenav.apps.mail":"Mail","sidenav.apps.chat":"Chat","sidenav.apps.calendar":"Calendar","sidenav.apps.project":"Project","sidenav.apps.project.list":"List","sidenav.apps.project.scrumboard":"Scrumboard","sidenav.apps.ecommerce":"E-Commerce","sidenav.apps.ecommerce.product":"Product","sidenav.apps.ecommerce.editProduct":"Edit Product","sidenav.apps.ecommerce.addProduct":"Add Product","sidenav.apps.ecommerce.productList":"Product List","sidenav.apps.ecommerce.orders":"Orders","sidenav.components":"Components","sidenav.components.general":"General","sidenav.components.general.button":"Button","sidenav.components.general.icon":"Icon","sidenav.components.general.typography":"Typography","sidenav.components.layout":"Layout","sidenav.components.layout.grid":"Grid","sidenav.components.layout.layout":"Layout","sidenav.components.navigation":"Navigation","sidenav.components.navigation.affix":"Affix","sidenav.components.navigation.breadcrumb":"Breadcrumb","sidenav.components.navigation.dropdown":"Dropdown","sidenav.components.navigation.menu":"Menu","sidenav.components.navigation.pagination":"Pagination","sidenav.components.navigation.pageHeader":"Page Header","sidenav.components.navigation.steps":"Steps","sidenav.components.dataEntry":"Data Entry","sidenav.components.dataEntry.autoComplete":"Auto Complete","sidenav.components.dataEntry.checkbox":"Checkbox","sidenav.components.dataEntry.cascader":"Cascader","sidenav.components.dataEntry.datePicker":"Date Picker","sidenav.components.dataEntry.form":"Form","sidenav.components.dataEntry.inputNumber":"Input Number","sidenav.components.dataEntry.input":"Input","sidenav.components.dataEntry.mentions":"Mentions","sidenav.components.dataEntry.rate":"Rate","sidenav.components.dataEntry.radio":"Radio","sidenav.components.dataEntry.switch":"Switch","sidenav.components.dataEntry.slider":"Slider","sidenav.components.dataEntry.select":"Select","sidenav.components.dataEntry.treeSelect":"Tree Select","sidenav.components.dataEntry.transfer":"Transfer","sidenav.components.dataEntry.timePicker":"Time Picker","sidenav.components.dataEntry.upload":"Upload","sidenav.components.dataDisplay":"Data Display","sidenav.components.dataDisplay.avatar":"Avatar","sidenav.components.dataDisplay.badge":"Badge","sidenav.components.dataDisplay.comment":"Comment","sidenav.components.dataDisplay.collapse":"Collapse","sidenav.components.dataDisplay.carousel":"Carousel","sidenav.components.dataDisplay.card":"Card","sidenav.components.dataDisplay.calendar":"Calendar","sidenav.components.dataDisplay.descriptions":"Descriptions","sidenav.components.dataDisplay.empty":"Empty","sidenav.components.dataDisplay.list":"List","sidenav.components.dataDisplay.popover":"Popover","sidenav.components.dataDisplay.statistic":"Statistic","sidenav.components.dataDisplay.tree":"Tree","sidenav.components.dataDisplay.tooltip":"Tooltip","sidenav.components.dataDisplay.timeline":"Timeline","sidenav.components.dataDisplay.tag":"Tag","sidenav.components.dataDisplay.tabs":"Tabs","sidenav.components.dataDisplay.table":"Table","sidenav.components.feedback":"Feedback","sidenav.components.feedback.alert":"Alert","sidenav.components.feedback.drawer":"Drawer","sidenav.components.feedback.modal":"Modal","sidenav.components.feedback.message":"Message","sidenav.components.feedback.notification":"Notification","sidenav.components.feedback.progress":"Progress","sidenav.components.feedback.popconfirm":"Popconfirm","sidenav.components.feedback.result":"Result","sidenav.components.feedback.spin":"Spin","sidenav.components.feedback.skeleton":"Skeleton","sidenav.components.other":"Other","sidenav.components.other.anchor":"Anchor","sidenav.components.other.backtop":"BackTop","sidenav.components.other.configProvider":"Config Provider","sidenav.components.other.divider":"Divider","sidenav.charts":"Charts","sidenav.charts.apex":"Apex Charts","sidenav.charts.chartjs":"ChartJs","sidenav.maps":"Maps","sidenav.maps.google":"Google Maps","sidenav.maps.simple":"Simple Maps","sidenav.pages":"Pages","sidenav.pages.profile":"Profile","sidenav.pages.invoice":"Invoice","sidenav.pages.pricing":"Pricing","sidenav.pages.faq":"FAQ","sidenav.pages.setting":"Setting","sidenav.pages.userlist":"User list","sidenav.authentication":"Authentication","sidenav.authentication.login.1":"Login 1","sidenav.authentication.login.2":"Login 2","sidenav.authentication.register.1":"Register 1","sidenav.authentication.register.2":"Register 2","sidenav.authentication.forgetPassword":"Forget Password","sidenav.errors":"Errors","sidenav.errors.error.1":"Error Page 1","sidenav.errors.error.2":"Error Page 2","sidenav.docs":"Docs","sidenav.docs.documentation":"Documentation","sidenav.docs.changelog":"Changelog"}')},339:function(e,t,n){"use strict";var i=n(85);const a={login:function(e,t){const n={url:"/auth",method:"post",headers:{"public-request":"true"},data:{username:e,password:t}};return console.log("login:",n),Object(i.a)(n)},logout:function(e){return Promise.resolve()},session:function(e){return Object(i.a)({url:"/session",method:"get",params:{}})},getControlState:function(){return Object(i.a)({url:"/api/control",method:"get"})},getDinState:function(e){return Object(i.a)({url:"/api/queries/din1-since/"+e,method:"get"})}};t.a=a},374:function(e,t,n){"use strict";var i=n(308),a=n(12),l=n(190),r=n(53),o=n(131),s=n(1);t.a=()=>Object(s.jsx)(r.a,{wrappers:[a.b,a.z.provider,a.g,a.s,a.w,o.b,l.b],children:Object(s.jsx)(i.a,{})})},38:function(e,t,n){"use strict";n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return E})),n.d(t,"j",(function(){return I})),n.d(t,"k",(function(){return S})),n.d(t,"i",(function(){return T})),n.d(t,"a",(function(){return k})),n.d(t,"f",(function(){return C})),n.d(t,"e",(function(){return _})),n.d(t,"b",(function(){return A})),n.d(t,"c",(function(){return N})),n.d(t,"d",(function(){return R}));var i=n(93),a=n(179),l=n(380),r=n(60),o=n(115),s=n(312),d=n(927),c=n(931),u=n(86),v=n.n(u),j=n(104),h=n.n(j),p=n(92),b=n(0),O=n.n(b),m=n(63),g=n(45),f=n(6),x=n(1);const y=e=>{let{level:t,title:n}=e;return Object(x.jsx)(i.a,{gutter:[0,5],justify:"left",children:Object(x.jsxs)(h.a,{level:t,children:[n," "]})})},E=e=>{let{span:t,level:n,title:i}=e;return Object(x.jsx)(p.a,{span:t,children:Object(x.jsxs)(h.a,{level:n,children:[i," "]})})},I=e=>{let{span:t,title:n,text:a}=e;return Object(x.jsxs)(p.a,{span:t,children:[Object(x.jsx)(i.a,{gutter:[0,0],justify:"left",children:Object(x.jsxs)(h.a,{level:4,children:[n," "]})}),Object(x.jsx)(i.a,{gutter:[0,0],justify:"left",children:Object(x.jsxs)(v.a,{children:[a," "]})})]})},S=e=>{let{span:t,title:n,text:a,textSize:l}=e;return Object(x.jsxs)(p.a,{span:t,children:[Object(x.jsx)(i.a,{gutter:[0,0],justify:"left",children:Object(x.jsxs)(h.a,{level:5,children:[n," "]})}),Object(x.jsx)(i.a,{gutter:[0,0],justify:"left",children:Object(x.jsxs)(v.a,{style:{fontSize:l||12},children:[a," "]})})]})},T=e=>{let{span:t,title:n,icon:a}=e;return Object(x.jsxs)(p.a,{span:t,children:[Object(x.jsx)(i.a,{gutter:[0,0],justify:"left",children:Object(x.jsxs)(h.a,{level:5,children:[n," "]})}),Object(x.jsx)(i.a,{gutter:[0,0],justify:"left",children:a})]})},k=e=>{let{text:t}=e;return Object(x.jsx)(a.a,{color:"#fff",style:{minWidth:80,width:"100%",height:"100%",minHeight:28,boxShadow:"inset 0px 0px 1px #000",textAlign:"center",marginBottom:8},children:Object(x.jsx)(v.a,{strong:!0,style:{color:"#000"},children:null===t||void 0===t?void 0:t.toUpperCase()})})},C=e=>{let{text:t,count:n,color:i,overflowCount:a,badgeColor:r}=e;return Object(x.jsxs)(O.a.Fragment,{children:[Object(x.jsx)(v.a,{style:{color:i,marginRight:10},children:t}),Object(x.jsx)(l.a,{count:n,overflowCount:a,showZero:!0,style:{backgroundColor:i||r}})]})},_=e=>{let{array:t,placeholder:n,onChangeFunc:i}=e;return Object(x.jsx)(r.a,{onChange:i,style:{width:"100%"},placeholder:n,children:t.map((e=>Object(x.jsx)(r.a.Option,{value:e,children:e},"opt_".concat(e))))})},A=e=>{let{obd:t}=e;return g.n.determineObdColorAndIcon(t)},N=e=>{let{title:t,onConfirmFunc:n,setOkText:i,setCancelText:a,buttonProps:l}=e;const r=l.type,c=l.icon,u=l.text;return Object(x.jsx)(O.a.Fragment,{children:Object(x.jsx)(s.a,{title:t,onConfirm:n,onCancel:function(e){console.log(e),o.b.info("Click on No")},okText:i,icon:Object(x.jsx)(d.a,{style:{color:f.b.RED}}),cancelText:a,children:Object(x.jsx)(m.a,{danger:!0,type:r,style:{width:"100%"},icon:c,children:u})})})},R=e=>{let{title:t,onConfirmFunc:n,setOkText:i,setCancelText:a,buttonProps:l}=e;const r=l.type,d=l.icon,u=l.text;return Object(x.jsx)(O.a.Fragment,{children:Object(x.jsx)(s.a,{title:t,onConfirm:n,onCancel:function(e){console.log(e),o.b.info("Click on No")},okText:i,icon:Object(x.jsx)(c.a,{style:{color:f.b.YELLOW}}),cancelText:a,children:Object(x.jsx)(m.a,{type:r,style:{width:"100%",color:f.b.YELLOW},icon:d,children:u})})})}},397:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(18);const a=new class{redirectToSystemUpdate(){window.location="".concat(i.d,"/error-1")}redirectToErrorSite(){window.location="error-2"}}},45:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return j})),n.d(t,"d",(function(){return h})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return b})),n.d(t,"m",(function(){return O})),n.d(t,"c",(function(){return m})),n.d(t,"l",(function(){return g})),n.d(t,"b",(function(){return f})),n.d(t,"n",(function(){return x})),n.d(t,"o",(function(){return y}));var i=n(929),a=n(930),l=n(19),r=(n(12),n(0),n(6)),o=n(1);function s(e,t,n){const i=null===t||void 0===t?void 0:t.toLowerCase();let a=e;var l,r;(null===n||void 0===n?void 0:n.length)>0&&(a=null===(l=a)||void 0===l?void 0:l.filter((e=>{var t;return n.includes(null===e||void 0===e||null===(t=e.organizationId)||void 0===t?void 0:t.organizationId)})));i.length>1&&(a=null===(r=a)||void 0===r?void 0:r.filter((e=>JSON.stringify(e).toLowerCase().includes(i))));return a}function d(e,t){let n=null===t||void 0===t?void 0:t.find((t=>t.organizationId===e));return n||null}function c(e,t){let n=null===t||void 0===t?void 0:t.find((t=>t.id===e));return n||null}function u(e){let t=e||[];return t||null}function v(e){let t=null===e||void 0===e?void 0:e.filter((e=>null===e.organizationId));return t||null}function j(e){let t=null===e||void 0===e?void 0:e.filter((e=>null!==e.organizationId&&null===e.status&&!e.retired));return t||null}function h(e){let t=null===e||void 0===e?void 0:e.filter((e=>null!==e.organizationId&&null!==e.status&&!e.retired));return t||null}function p(e){let t=null===e||void 0===e?void 0:e.filter((e=>e.retired));return t||null}function b(e,t){return e.filter((e=>{var n;return!(null!==(n=e.state)&&void 0!==n&&n.imei)&&e.organizationId===t}))}const O=(e,t,n)=>{var i,a,r,o,s,d;const c=[],u=localStorage.getItem(l.t);null===(i=e)||void 0===i||i.find((e=>(null===e||void 0===e?void 0:e.organizationId)===parseInt(u)));e=null===(a=e)||void 0===a?void 0:a.map((e=>({...e,title:e.fullName,key:e.organizationId,value:e.organizationId})));for(let l=0;l<15;l++){var v;e=null===(v=e)||void 0===v?void 0:v.map((t=>({...t,key:t.organizationId,children:e.filter((e=>e.parentOrganization===t.organizationId))})))}let j=null===(r=e)||void 0===r?void 0:r.filter((e=>null===(null===e||void 0===e?void 0:e.parentOrganization)));const h=null===(o=e)||void 0===o?void 0:o.filter((e=>null!==(null===e||void 0===e?void 0:e.parentOrganization)));let p=parseInt(localStorage.getItem(l.e));var b,O;p&&!n&&(j=null===(b=e)||void 0===b?void 0:b.filter((e=>e.organizationId===p)));(null===(s=j)||void 0===s?void 0:s.length)<1&&(j=null===(O=e)||void 0===O?void 0:O.filter((e=>e.organizationId===parseInt(u))));return null===(d=j)||void 0===d||d.forEach((t=>{var n;const i=null===(n=e)||void 0===n?void 0:n.filter((e=>e.parentOrganization===t.organizationId)),a=i.map((e=>({title:e.fullName,value:e.organizationId,key:e.organizationId,children:h.filter((t=>t.parentOrganization===e.organizationId))}))),l={title:t.fullName,value:t.organizationId,key:t.organizationId,children:a};c.push(l)})),c};const m={createNewOrgObject:function(e,t,n,i,a,l,r,o){return{fullName:e,adminUserEmail:t,adminUserPassword:n,organizationNumber:i,email:a,phone:l,invoiceAddress:r,postalAddress:o}},createExistingOrgObject:function(e){return{organizationId:e}},createNewVehicleObject:function(e,t,n,i,a,l,r,o,s,d,c){return{category:e,registry:t,displayName:n,style:i,permittedDrivers:a,defaultDriver:l,defaultTripType:r,benefitType:o,permitAnyDriver:s,organizationId:d,isoCountryCode:c}},createExistingVehicleObject:function(e){return{vehicleId:e}},createNewDriverObject:function(e,t,n,i,a){return{displayName:e,displayEmail:t,roles:n,sendInvite:i,organizationId:a}},createExistingDriverObject:function(e){return{userId:e}}},g={phoneNumber:function(e){return"".concat(e)},millisToDate:function(e){let t="";try{t=new Date(e).toISOString("se-SE").split("T")[0]}catch(n){console.log("Conversion error millis, ",n)}return t}},f={determineBatteryColor:function(e){var t=e;return t<20?r.b.RED:t>=20&&t<60?r.b.YELLOW:t>=60&&t<85?r.b.BLUE:t>=85?r.b.GREEN:null}},x={determineObdColorAndIcon:function(e){return!0===e?Object(o.jsx)("div",{children:Object(o.jsx)(i.a,{style:{color:r.b.GREEN}})}):Object(o.jsx)("div",{children:Object(o.jsx)(a.a,{style:{color:r.b.RED}})})}},y={isValidImei:function(e){const t=e===Number,n=t?"":"Endast siffror";return{valid:[t].every((e=>!0===e)),messages:[n]}},isValidPhone:function(e){const t=e.length>=13,n=t?"":"Minst 14 siffror kr\xe4vs!";return{valid:[t].every((e=>!0===e)),messages:[n]}},isValidIccid:function(e){const t=e.length>=18,n=t?"":"Minst 18 siffror kr\xe4vs!";return{valid:[t].every((e=>!0===e)),messages:[n]}}}},470:function(e,t,n){},49:function(e,t,n){"use strict";n(0);var i=n(1);const a=e=>{const{children:t,className:n,alignItems:a,justifyContent:l,mobileFlex:r,flexDirection:o,gap:s,style:d,wrap:c}=e;return Object(i.jsx)("div",{style:{gap:s,flexWrap:c,...d},className:"".concat(r?"d-flex":"d-md-flex"," ").concat(n," ").concat(o?"flex-"+o:""," ").concat(a?"align-items-"+a:""," ").concat(l?"justify-content-"+l:""),children:t})};a.defaultProps={mobileFlex:!0,flexDirection:"row",className:""},t.a=a},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(379),a=n(45),l=n(2),r=n(1);const o=e=>{let{data:t,selectedOrganization:n,onChange:o,defaultValue:s,isMultiple:d,width:c,thisIsSettingPanel:u,disabled:v,placeholder:j,extra:h}=e;const p=n||s,b=Object(a.m)(t,p,u);return Object(r.jsx)("div",{children:Object(r.jsx)(i.a,{multiple:d,maxTagCount:1,allowClear:!0,showSearch:!0,autoComplete:"off",autoClearSearchValue:!1,filterOption:(e,t)=>{var n;return null===t||void 0===t||null===(n=t.title)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},style:{minWidth:c||200},dropdownStyle:{minWidth:400},treeData:b,placeholder:j||l.f.FILTER_BY_ORG,treeDefaultExpandAll:!0,value:n,defaultValue:s,onChange:o,disabled:v,...h})})}},53:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return r}));var i=n(0),a=(n(66),n(6));const l=e=>{let{wrappers:t,...n}=e;const a=e=>{if(e.length>0){const t=e.pop();return Object(i.createElement)(t,null,a(e))}return n.children},l=[...t];return l.reverse(),a(l)},r=e=>({color:"PRIVATE"===e.purpose||"PRIVATE_AUTO"===e.purpose?a.b.SWITCH_PRIVATE:a.b.SWITCH_BUSINESS})},55:function(e,t,n){"use strict";n(0);var i=n(162),a=n(928),l=n(1);const r=Object(l.jsx)(a.a,{style:{fontSize:35},spin:!0}),o=e=>{const{align:t,cover:n}=e;return Object(l.jsx)("div",{className:"loading text-".concat(t," cover-").concat(n),children:Object(l.jsx)(i.a,{indicator:r})})};o.defaultProps={align:"center",cover:"inline"},t.a=o},6:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"k",(function(){return l})),n.d(t,"j",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return j})),n.d(t,"m",(function(){return h})),n.d(t,"a",(function(){return p})),n.d(t,"n",(function(){return b}));const i={RED:"#FF6B72",YELLOW:"#FFC542",BLUE:"#699DFF",GREEN:"#04D182",SWITCH_PRIVATE:"#21B573",SWITCH_BUSINESS:"#3e79f7",GRAY_LIGHTER:"#ededed",NOT_IMPLEMENTED_YET:"#3f3f3f"},a={AVL:"AVL",LOGG:"LOGG",DISPLAY_UNIT:"DISPLAY_UNIT",CONNECT:"CONNECT",ADD:"ADD",VEHICLE:"VEHICLE",C12SMS:"C12SMS",CHANGE_ORG:"CHANGE_ORG"},l={ADMIN:"ADMIN",CSV:"CSV",DARK:"DARK",DRIVER:"DRIVER",LIGHT:"LIGHT",PDF:"PDF",PURPOSE:"PURPOSE",ROOT:"ROOT",SALARY:"SALARY",SUMMARY:"SUMMARY",SUMMARY_ALL_VEHICLES:"SUMMARY_ALL_VEHICLES",SUMMARY_DRIVER:"SUMMARY_DRIVER",SUMMARY_VEHICLE:"SUMMARY_VEHICLE",TRACKER:"TRACKER",VEHICLE:"VEHICLE",acknowledged:"acknowledged",activeOn:"activeOn",activeOnEnter:"activeOnEnter",activeOnExit:"activeOnExit",address:"address",adminUserEmail:"adminUserEmail",adminUserPassword:"adminUserPassword",alarmName:"alarmName",alarmTarget:"alarmTarget",alarmType:"alarmType",archivedTsMs:"archivedTsMs",batery_percentage:"battery_percentage",btn_change_org:"openChangeOrg",btn_connect_customer:"openCustomerConnect",btn_display_unit:"openDisplayUnit",btn_display_vehicle:"openDisplayVehicle",btn_retire:"openRetire",btn_show:"openShow",btn_to_storage:"openToStorage",centerCoords:"centerCoords",city:"city",config:"configName",connected:"physicalInstallTimestamp",country:"country",currentDriver:"currentDriver",currentVehicle:"currentVehicle",deviceType:"deviceType",displayEmail:"displayEmail",displayName:"displayName",distortion:"distortion",driver:"driver",email:"email",emails:"emails",error:"error",exEmail:"min-epost@example.com",firmware:"firmware",fullname:"fullName",geoZone:"geoZone",geoZoneAlarmId:"geoZoneAlarmId",geoZoneAlarmName:"geoZoneAlarmName",heartbeat:"uplinkLoss",iccid:"iccid",imei:"imei",installedVehicle:"installedVehicle",invoiceAddress:"invoiceAddress",lastSeenApp:"lastSeenApp",lastSeenDriving:"lastSeenDriving",lastSeenMs:"last_seen_ms",latestBatteryLevel:"latestBatteryLevel",latest_response_frequency:"latestResponseFrequency",latitude:"latitude",longitude:"longitude",meta:"meta",mileAge:"mileAge",name:"name",new_purposes:"new_purposes",obd:"odb",odoRemindDay:"odoRemindDay",odometer:"odometer",operation:"operation",operationalAt:"physicalInstallTimestamp",org:"organizationId",organizationId:"organizationId",organizationNumber:"organizationNumber",parentOrganization:"parentOrganization",permittedVehicles:"permittedVehicles",phone:"phone",physicalInstallTimestamp:"physicalInstallTimestamp",place:"place",postadress:"Postadress",postalAddress:"postalAddress",purposes:"purposes",reg:"reg",registry:"registry",repeatAfterHours:"repeatAfterHours",reportTarget:"reportTarget",reportType:"reportType",retired:"retired",schedule:"schedule",selected:"choose",sendInvite:"sendInvite",show_on_the_map:"showOnTheMAp",speed:"speed_kph",state:"state",status:"status",streetAndNum:"streetAndNum",success:"success",targetOrganizationIds:"targetOrganizationIds",targetVehicleIds:"targetVehicleIds",timestampStartOfUse:"timestampStartOfUse",travels:"travels",type:"type",typeError:"typeError",update:"update",validating:"validating",vehicle:"vehicle",vehicleId:"vehicleId",warning:"warning",zip:"zip"},r=["FMM001","FMM230","FMB001","FMB010","FMC100","FMT100","TAT100","FMB920","FMM800","GL530MG"],o=[{text:"FMB001",value:"FMB001"},{text:"FMC100",value:"FMC100"},{text:"FMT100",value:"FMT100"},{text:"TAT100",value:"TAT100"},{text:"FMB920",value:"FMB920"},{text:"FMM001",value:"FMM001"},{text:"GL530MG",value:"GL530MG"}],s=[{TYPE:"PRIVATE",TYPE_DISPLAY_TEXT:"Privat"},{TYPE:"BENEFIT",TYPE_DISPLAY_TEXT:"F\xf6rm\xe5nsbil"},{TYPE:"WORK",TYPE_DISPLAY_TEXT:"Arbetsfordon"},{TYPE:"TRACKER",TYPE_DISPLAY_TEXT:"Tracker"},{TYPE:"POOL",TYPE_DISPLAY_TEXT:"Poolbil"}],d=[{TYPE:"PRIVATE",TYPE_DISPLAY_TEXT:"Privat"},{TYPE:"BUSINESS",TYPE_DISPLAY_TEXT:"Tj\xe4nst"}],c=["cpureset/","getrecord/","setparam","#:#/getparam","#:#/getinfo/getstatus"],u={DATE:"date",DATE_FROM:"tsFromMs",DATE_TO:"tsToMs",FIELD_ID:"fileId"},v={DATE_TIME:"date_time",NEW_VALUE:"new_value"},j={WARNINGS:i.RED,STOCK:i.YELLOW,ON_THE_WAY:i.BLUE,IN_DRIVE:i.GREEN,RETIRED:i.GRAY_LIGHTER},h={DATE:"Datum",ENTRY:"ENTRY",EXIT:"EXIT",BOTH:"BOTH",LATITUDE:"latitude",LONGITUDE:"longitude",RADIUS_MS:"radiusMs",COORDINATE:"coordinate",TRIP_TYPE:"tripType",APPLICATION:"application",DESCRIPTION:"description",OPERATION:"operation",ZONE_NAME:"zoneName",ADDRESS:"address"},p={BUSINESS:"BUSINESS",PRIVATE:"PRIVATE",BENEFIT:"BENEFIT",POOL:"POOL"},b={JOURNAL:"K\xf6rjournalrapport",SUMMARY_VEHICLE:"SUMMARY_VEHICLE",SUMMARY_DRIVER:"SUMMARY_DRIVER",SALARY:"SALARY",DISCREPANCY:"DISCREPANCY",PURPOSE:"PURPOSE"}},62:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));n(0);var i=n(144),a=n(73),l=n(66),r=n.n(l),o=n(1);const{Text:s}=i.a,d="#de4436",c="#fa8c16",u="#21B573",v=e=>{let{value:t,callback:n,typ:i,isTracker:l,defaultText:v}=e,j=function(e){let t,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0,v=r.a.utc(e),j=r.a.duration(r()().diff(v)).asMinutes();j=Math.ceil(j);let h=r.a.tz.guess();const p={redDate:"D MMM -YY",tooltipTitle:"YYYY-MM-DD HH:mm"};if(j>59){let e=j;t=Math.floor(e/60),n=e%60}r.a.isMoment(e)||(e=r.a.utc(e));let b=e.tz(h).format(p.tooltipTitle);if(l)return Object(o.jsx)(a.a,{title:b,children:Object(o.jsx)(s,{children:e.tz(h).format(p.redDate)})});if(i)return e.isSameOrAfter(r()().subtract(60,"m"),"minute")?Object(o.jsx)(a.a,{title:b,children:Object(o.jsx)(s,{style:{color:u},children:j?j+" min sen":null})}):e.isSameOrAfter(r()().subtract(1440,"m"),"minute")?Object(o.jsx)(a.a,{title:b,children:Object(o.jsxs)(s,{style:{color:u},children:[t?t+" h":null," ",n," min sen"]})}):e.isSameOrAfter(r()().subtract(1500,"m"),"minute")?Object(o.jsx)(a.a,{title:b,children:Object(o.jsxs)(s,{style:{color:c},children:[t?t+" h":null," ",n," min sen"]})}):e.isSame(r()(),"year")?Object(o.jsx)(a.a,{title:b,children:Object(o.jsx)(s,{style:{color:d},children:e.tz(h).format("D MMM")})}):Object(o.jsx)(a.a,{title:b,children:Object(o.jsx)(s,{style:{color:d},children:e.tz(h).format(p.redDate)})});if(e.isSame(r()(),"day")&&e.isSame(r()(),"month")&&e.isSame(r()(),"year")){if(e.isSameOrAfter(r()().subtract(60,"m"),"minute"))return Object(o.jsx)(a.a,{title:b,children:Object(o.jsxs)(s,{style:{color:u},children:[" ",j," min sen"]})});if(e.isSameOrAfter(r()().subtract(240,"m"),"minute"))return Object(o.jsx)(a.a,{title:b,children:Object(o.jsxs)(s,{style:{color:c},children:[" ",t," h ",n," min sen"]})})}else if(e.isSame(r()(),"year"))return Object(o.jsx)(a.a,{title:b,children:Object(o.jsx)(s,{style:{color:d},children:e.tz(h).format("D MMM")})});return Object(o.jsx)(a.a,{title:b,children:Object(o.jsx)(s,{style:{color:d},children:e.tz(h).format(p.redDate)})})}(t,l,v);return Object(o.jsx)("span",{children:j})}},82:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return d}));var i=n(66),a=n.n(i);n(865);const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=a.a.tz.guess();return n?a.a.unix(e).tz(i).format(t):a()(e).tz(i).format(t)},r=e=>Array.from(Array(e).keys()),o=(e,t)=>{let n=Math.abs(a()(t).diff(a()(e))),i=a.a.duration(n);const l=Math.floor(i.asHours()),r=i.minutes();return 0===l?"".concat(r," min"):"".concat(l," h ").concat(r," min")},s=e=>{let t=a.a.duration(e);const n=Math.floor(t.asHours()),i=t.minutes();return 0===n?"".concat(i," min"):"".concat(n," h ").concat(i," min")},d=e=>e.toString().split("").reverse().join("").match(/.{1,3}/g).reverse().map((e=>e.split("").reverse().join(""))).join(" ")},85:function(e,t,n){"use strict";var i=n(369),a=n.n(i),l=n(18),r=n(482).a(),o=n(19),s=n(290),d=n(103);const c=a.a.create({baseURL:l.a,timeout:6e4}),u="/auth/login",v="Authorization";c.interceptors.request.use((e=>{var t;const n=localStorage.getItem(o.b),i=localStorage.getItem(o.g);let a=localStorage.getItem(o.e);return"undefined"===(null===(t=a)||void 0===t?void 0:t.toString())&&(localStorage.removeItem(o.e),a=null),a&&n&&(e.headers["X-Trackson-Organization"]=a,e.headers[v]="JWT "+n),i&&(e.headers[o.g]=i),n&&(e.headers[v]="JWT "+n),n||e.headers["public-request"]||(r.push(u),window.location.reload()),e}),(e=>{s.a.error({message:"Error"}),Promise.reject(e)})),c.interceptors.response.use((e=>e.data),(e=>{var t;let n=d.b[null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data];console.log("Failed:",n),"undefined"!==n&&n||(n=d.b.SOMETHING_GONE_WRONG);let i={message:""};return e&&e.response&&(console.log(e.response.status,401),500!==e.response.status&&401!==e.response.status&&(i.message=n,s.a.error(i)),400===e.response.status&&(i.message="400",i.description="Request failed with status code 400",console.log("Error 400",e)),401===e.response.status&&(i.message="Autentisering misslyckades",i.description="Logga in igen",localStorage.removeItem(o.b),r.push(u)),403===e.response.status&&(i.message="Forbidden",i.description="Requires clearance"),404===e.response.status&&(i.message="Not Found"),415===e.response.status&&(i.message="415",i.description="Object is malformed"),500===e.response.status&&(i.message="Internal Server Error"),508===e.response.status&&(i.message="Time Out",s.a.error(i))),Promise.reject(e)}));t.a=c},878:function(e,t,n){},879:function(e,t,n){},882:function(e,t,n){},90:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));const i=250,a=80,l="SIDE_NAV_LIGHT",r="SIDE_NAV_DARK",o="SIDE",s="TOP"},919:function(e,t,n){var i={"./":[255],"./index":[255],"./index.js":[255],"./journey":[340,1],"./journey/":[340,1],"./journey/index":[340,1],"./journey/index.js":[340,1]};function a(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],a=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(a)}))}a.keys=function(){return Object.keys(i)},a.id=919,e.exports=a},922:function(e,t,n){},923:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),l=n(59),r=n.n(l),o=n(72),s=n(480),d=n(134),c=n(540),u=n(483),v=n(390),j=n(481),h=n.n(j),p=n(19);const b={loading:!1,message:"",showMessage:!1,redirect:"",token:localStorage.getItem(p.b)};var O=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.j:return console.log("reducing signin",t),{...e};case p.o:return console.log("Reducing signout"),{...e};case p.a:return{...e,loading:!1,redirect:"/",token:t.token};case p.h:return{...e,message:t.message,showMessage:!0,loading:!1};case p.c:return{...e,message:"",showMessage:!1};case p.p:return{...e,token:null,redirect:"/",loading:!1};case p.r:return{...e,loading:!1,token:t.token};case p.i:return{...e,loading:!0};case p.n:case p.l:return{...e,loading:!1,token:t.token};default:return e}};const m="TOGGLE_COLLAPSED_NAV",g="CHANGE_LOCALE",f="SIDE_NAV_STYLE_CHANGE",x="NAV_TYPE_CHANGE",y="TOP_NAV_COLOR_CHANGE",E="HEADER_NAV_COLOR_CHANGE",I="TOGGLE_MOBILE_NAV",S="SWITCH_THEME",T="TOGGLE_DARK_MAP";var k=n(18);const C={...k.i};var _=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return{...e,navCollapsed:t.navCollapsed};case f:return{...e,sideNavTheme:t.sideNavTheme};case g:return{...e,locale:t.locale};case x:return{...e,navType:t.navType};case y:return{...e,topNavColor:t.topNavColor};case E:return{...e,headerNavColor:t.headerNavColor};case I:return{...e,mobileNav:t.mobileNav};case S:return{...e,currentTheme:t.currentTheme};case T:return{...e,darkMapStyle:t.darkMapStyle};default:return e}},A=n(116),N=n(159),R=n(339);function*D(){yield Object(A.e)(p.j,(function(e){let{payload:t}=e;return function*(){const{username:e,password:n}=t;try{const t=yield Object(A.b)(R.a.login,e,n);t.message?yield Object(A.d)(Object(N.c)(t.message)):(localStorage.setItem(p.b,t.token),localStorage.removeItem(p.e),yield Object(A.d)(Object(N.a)(t.token)))}catch(i){yield Object(A.d)(Object(N.c)(i))}}()}))}function*w(){yield Object(A.e)(p.o,(function*(){try{const e=yield Object(A.b)(R.a.logout);void 0===e?(localStorage.removeItem(p.b),yield Object(A.d)({type:"RESET"}),yield Object(A.d)(Object(N.g)(e))):yield Object(A.d)(Object(N.c)(e.message))}catch(e){yield Object(A.d)(Object(N.c)(e))}}))}function*L(){yield Object(A.a)([Object(A.c)(D),Object(A.c)(w)])}const P=Object(d.c)({theme:_,auth:O}),V=(e,t)=>("RESET"===t.type&&(e=void 0),P(e,t)),M=Object(c.a)(),F=[M,u.a],z={key:"root",storage:h.a,whitelist:["din1"]};const U=function(e){const t=Object(v.a)(z,V),n=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||d.d,i=Object(d.e)(t,e,n(Object(d.a)(...F)));return M.run((function*(e){yield Object(A.a)([L()])})),i}();var B={store:U,persistor:Object(v.b)(U)},G=n(87),H=n(66),Y=n.n(H),W=n(98),K=n(465),q=n(90),J=n(299),Q=n(65),Z=n(227),X=n(85),$=n(1);const ee={auth:null,requestGetAuth:null},te=Object(i.createContext)(ee),ne=e=>{let{children:t}=e;const[n,a]=Object(i.useState)(),[l,r]=Object(i.useState)(!1);return Object($.jsx)(te.Provider,{value:{auth:n,requestGetAuth:()=>{l||(r(!0),Object(X.a)({url:"/auth"}).then((e=>{console.log("SessionContext loaded auth:",e),a(e),r(!1)})).catch((e=>{console.error(e),r(!1)})))}},children:t})};var ie=n(942),ae=n(300);var le=Object(ae.c)((e=>Object($.jsx)(ie.a,{...e})),{withRef:!1});class re extends i.Component{render(){const{type:e,className:t}=this.props;return Object($.jsx)($.Fragment,{children:a.a.createElement(e,{className:t})})}}var oe=re,se=n(944),de=n(945),ce=n(946),ue=n(947),ve=n(948),je=n(949),he=n(950),pe=n(951),be=n(952),Oe=n(953),me=n(954),ge=n(955),fe=n(926),xe=n(957),ye=n(958),Ee=n(927),Ie=n(959),Se=n(961),Te=n(962),ke=n(963),Ce=n(964),_e=n(956),Ae=n(960),Ne=n(265),Re=n(485),De=n(126);const we=e=>e.submenu&&0===e.submenu.length?e:e.submenu?{...e,submenu:e.submenu.map(we)}:{...e,submenu:[]};let Le=[{key:"homeentries",title:"Trackson",submenu:[{key:"journey",path:"".concat(k.c,"/journey"),title:"K\xf6rjournal",icon:se.a,breadcrumb:!1,submenu:[]},{key:"map",path:"".concat(k.c,"/map"),title:"Karta",icon:de.a,breadcrumb:!1,submenu:[]},{key:"ecoScore",icon:ce.a,path:"".concat(k.c,"/ecoScore"),title:"Ecoscore",breadcrumb:!1},{key:"vehicle",path:"".concat(k.c,"/myVehicle"),title:"Mina fordon",icon:fe.a,breadcrumb:!1,submenu:[]}]},{key:"defaultings",title:"Administration",submenu:[{key:"accounts",title:"Min organisation",limitVisibility:["ADMIN","ROOT","HEXA"],icon:ue.a,submenu:[{key:"userroles",title:"Anv\xe4ndare",path:"".concat(k.c,"/userroles")},{key:"vehicles",title:"Fordon",path:"".concat(k.c,"/vehicles")},{key:"trackersList",title:"Utrustning",icon:ve.a,path:"".concat(k.c,"/trackersList")},...De.a.SHOW_DEV&&[{key:"devices",title:"Enheter",path:"".concat(k.c,"/devices")}]||[],{key:"account",title:"Konto",path:"".concat(k.c,"/account")}]},{key:"schedule",title:"F\xf6rval",breadcrumb:!1,icon:je.a,submenu:[{key:"schedule",path:"".concat(k.c,"/schedule"),title:"Arbetstidsscheman",breadcrumb:!1},{key:"zones",path:"".concat(k.c,"/zones"),title:"Platser",breadcrumb:!1},{key:"purpose",path:"".concat(k.c,"/purpose"),title:"Resesyften",breadcrumb:!1}]},{key:"alarms",title:"Larm",limitVisibility:["ADMIN","ROOT","HEXA"],icon:he.a,submenu:[{key:"alarmZones",path:"".concat(k.c,"/alarmsZones"),title:"Geozon",breadcrumb:!1,disabled:!1},{key:"alarmFunctions",path:"".concat(k.c,"/alarmsFunctions"),title:"Funktionslarm",disabled:!1,breadcrumb:!1},{key:"alarmSafety",path:"".concat(k.c,"/alarmsSafety"),title:"S\xe4kerhetslarm",breadcrumb:!1},{key:"alarmsEvents",path:"".concat(k.c,"/alarmsEvents"),title:"P\xe5g\xe5ende larm",breadcrumb:!1}]},{key:"reports",title:"Rapporter",limitVisibility:["ADMIN","ROOT","HEXA"],icon:pe.a,submenu:[{key:"scheduling",path:"".concat(k.c,"/scheduling"),title:"Schemal\xe4ggning",breadcrumb:!1},{key:"salaryReports",path:"".concat(k.c,"/salaryReports"),title:"L\xf6nerapporter",breadcrumb:!1}]},{key:"customer-service",title:"Support",icon:be.a,submenu:[{key:"support",title:"Kundtj\xe4nst",path:"".concat(k.c,"/support")},{key:"alarmsReport",path:"".concat(k.c,"/alarmsReport"),title:"Felanm\xe4lan",breadcrumb:!1},{key:"guides",title:"Guider",path:"".concat(k.c,"/guides")}]}]},{key:"superadmin",title:"Superadmin",limitVisibility:["ROOT","HEXA"],submenu:[{key:"organizations",title:"Organisationer",icon:Oe.a,path:"".concat(k.c,"/organizations")},{key:"superdevices",title:"Enheter",icon:me.a,path:"".concat(k.c,"/superdevices")},{key:"users",title:"Anv\xe4ndare",icon:ge.a,path:"".concat(k.c,"/users")},{key:"superVehicles",title:"Fordon",icon:fe.a,path:"".concat(k.c,"/superVehicles")},{key:"triptax-analyser",title:"Betalstationer",iconExternal:Ne.mapO,path:"".concat(k.c,"/triptax-analyzer")}]}].map(we),Pe=[{key:"homeentries",title:"Trackson",submenu:[{key:"journey",path:"".concat(k.c,"/journey"),title:"K\xf6rjournal",icon:se.a,breadcrumb:!1,submenu:[]},{key:"map",path:"".concat(k.c,"/map"),title:"Karta",icon:de.a,breadcrumb:!1,submenu:[]},{key:"ecoScore",icon:ce.a,path:"".concat(k.c,"/ecoScore"),title:"Ecoscore",breadcrumb:!1},{key:"vehicle",path:"".concat(k.c,"/myVehicle"),title:"Mina fordon",icon:fe.a,breadcrumb:!1,submenu:[]}]},{key:"defaultings",title:"F\xf6rval",submenu:[{key:"schedule",icon:_e.a,path:"".concat(k.c,"/schedule"),title:"Arbetstidsscheman",breadcrumb:!1},{key:"zones",icon:xe.a,path:"".concat(k.c,"/zones"),title:"Platser",breadcrumb:!1},{key:"purpose",iconExternal:Re.edit,path:"".concat(k.c,"/purpose"),title:"Resesyften",breadcrumb:!1}]},{key:"alarms",title:"Larm",limitVisibility:["ADMIN","ROOT","HEXA"],submenu:[{key:"alarmZones",icon:ye.a,path:"".concat(k.c,"/alarmsZones"),title:"Geozon",breadcrumb:!1,disabled:!1},{key:"alarmFunctions",icon:Ee.a,path:"".concat(k.c,"/alarmsFunctions"),title:"Funktionslarm",disabled:!1,breadcrumb:!1},{key:"alarmSafety",icon:Ie.a,path:"".concat(k.c,"/alarmsSafety"),title:"S\xe4kerhetslarm",breadcrumb:!1},{key:"alarmsEvents",icon:Ae.a,path:"".concat(k.c,"/alarmsEvents"),title:"P\xe5g\xe5ende larm",breadcrumb:!1}]},{key:"reports",title:"Rapporter",limitVisibility:["ADMIN","ROOT","HEXA"],submenu:[{key:"scheduling",icon:Se.a,path:"".concat(k.c,"/scheduling"),title:"Schemal\xe4ggning",breadcrumb:!1},{key:"salaryReports",icon:pe.a,path:"".concat(k.c,"/salaryReports"),title:"L\xf6nerapporter",breadcrumb:!1}]},{key:"customer-service",title:"Support",submenu:[{key:"support",title:"Kundtj\xe4nst",icon:be.a,path:"".concat(k.c,"/support")},{key:"alarmsReport",icon:Te.a,path:"".concat(k.c,"/alarmsReport"),title:"Felanm\xe4lan",breadcrumb:!1},{key:"guides",title:"Guider",icon:ke.a,path:"".concat(k.c,"/guides")}]},{key:"accounts",title:"Organisation",limitVisibility:["ADMIN","ROOT","HEXA"],submenu:[{key:"userroles",title:"Anv\xe4ndare",icon:ge.a,path:"".concat(k.c,"/userroles")},{key:"vehicles",title:"Fordon",icon:fe.a,path:"".concat(k.c,"/vehicles")},{key:"trackersList",title:"Utrustning",icon:ve.a,path:"".concat(k.c,"/trackersList")},...De.a.SHOW_DEV&&[{key:"devices",title:"Enheter",icon:Ce.a,path:"".concat(k.c,"/devices")}]||[],{key:"account",title:"Konto",icon:ue.a,path:"".concat(k.c,"/account")}]},{key:"superadmin",title:"Superadmin",limitVisibility:["ROOT","HEXA"],submenu:[{key:"users",title:"Anv\xe4ndare",icon:ge.a,path:"".concat(k.c,"/users")},{key:"superVehicles",title:"Fordon",icon:fe.a,path:"".concat(k.c,"/superVehicles")},{key:"superTrackersList",title:"Utrustning",icon:ve.a,path:"".concat(k.c,"/superTrackersList")},{key:"superdevices",title:"Enheter",icon:Ce.a,path:"".concat(k.c,"/superdevices")},{key:"organizations",title:"Organisationer",icon:Oe.a,path:"".concat(k.c,"/organizations")},{key:"triptax-analyser",title:"Betalstationer",iconExternal:Ne.mapO,path:"".concat(k.c,"/triptax-analyzer")}]}].map(we);var Ve=[..."true"===localStorage.getItem("MENU_TYPE")?Le:Pe];var Me=class{static getNameInitial(e){let t=e.match(/\b\w/g)||[];return((t.shift()||"")+(t.pop()||"")).toUpperCase()}static getRouteInfo(e,t){if(e.path===t)return e;let n;for(let i in e)if(e.hasOwnProperty(i)&&"object"===typeof e[i]&&(n=this.getRouteInfo(e[i],t),n))return n;return n}static getColorContrast(e){if(!e)return"dark";const t=parseInt(a(e).substring(0,2),16);const n=function(e){return parseInt(a(e).substring(2,4),16)}(e),i=function(e){return parseInt(a(e).substring(4,6),16)}(e);function a(e){return"#"===e.charAt(0)?e.substring(1,7):e}return(299*t+587*n+114*i)/1e3>130?"dark":"light"}static shadeColor(e,t){let n=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),a=parseInt(e.substring(5,7),16);n=parseInt(n*(100+t)/100),i=parseInt(i*(100+t)/100),a=parseInt(a*(100+t)/100),n=n<255?n:255,i=i<255?i:255,a=a<255?a:255;const l=1===n.toString(16).length?"0".concat(n.toString(16)):n.toString(16),r=1===i.toString(16).length?"0".concat(i.toString(16)):i.toString(16),o=1===a.toString(16).length?"0".concat(a.toString(16)):a.toString(16);return"#".concat(l).concat(r).concat(o)}static rgbaToHex(e){const t=e=>e.replace(/^\s+|\s+$/gm,""),n=e.substring(e.indexOf("(")).split(","),i=parseInt(t(n[0].substring(1)),10),a=parseInt(t(n[1]),10),l=parseInt(t(n[2]),10),r=parseFloat(t(n[3].substring(0,n[3].length-1))).toFixed(2),o=[i.toString(16),a.toString(16),l.toString(16),Math.round(255*r).toString(16).substring(0,2)];return o.forEach((function(e,t){1===e.length&&(o[t]="0"+e)})),"#".concat(o.join(""))}static getSignNum(e,t,n){return e>0?t:e<0?n:null}static antdTableSorter(e,t,n){return"number"===typeof e[n]&&"number"===typeof t[n]?e[n]-t[n]:"string"===typeof e[n]&&"string"===typeof t[n]?(e=e[n].toLowerCase())>(t=t[n].toLowerCase())?-1:t>e?1:0:void 0}static filterArray(e,t,n){let i=e;return e&&(i=e.filter((e=>e[t]===n))),i}static deleteArrayRow(e,t,n){let i=e;return e&&(i=e.filter((e=>e[t]!==n))),i}static wildCardSearch(e,t){return e=e.filter((e=>(e=>{for(let n in e)if(null!=e[n]&&-1!==e[n].toString().toUpperCase().indexOf(t.toString().toUpperCase()))return!0})(e)))}static getBreakPoint(e){let t=[];for(const n in e)if(e.hasOwnProperty(n)){e[n]&&t.push(n)}return t}};function Fe(e){return{type:I,mobileNav:e}}var ze=n(69),Ue=(n(487),n(108)),Be=n(55),Ge=n(12);const{SubMenu:He}=Q.a,{useBreakpoint:Ye}=Z.a,We=(e,t)=>e?Object($.jsx)(le,{id:t}):t.toString(),Ke=e=>{let t=[],n="";if(e){const i=e.split("-");for(let e=0;e<i.length;e++){const a=i[e];n=0===e?a:"".concat(n,"-").concat(a),t.push(n)}}return t},qe=e=>{let{key:t,icon:n,iconExternal:i,path:a,title:l,linkProps:r,...o}=e;return Object($.jsxs)(Q.a.Item,{...o,children:[n?Object($.jsx)(oe,{type:n}):null,i?Object($.jsx)(ze.Icon,{className:"navbar-icon anticon",icon:i}):null,Object($.jsx)("span",{children:l}),a?Object($.jsx)(G.b,{to:a,...r}):null]},t)},Je=(e,t)=>{if(!e)return!t;for(let n of t)if(e.includes(n))return!0;return!1},Qe=e=>{const t=localStorage.getItem(p.e),{sideNavTheme:n,routeInfo:a,hideGroupTitle:l,localization:r,onMobileNavToggle:o}=e,s=!Me.getBreakPoint(Ye()).includes("lg"),d=[],c=Object(i.useContext)(te),u=Object(i.useContext)(Ge.j),v=()=>{s&&o(!1)};Object.entries(Ue.i).map((e=>{let[t,n]=e;return d.push(t)}));const j=!c.auth;Object(i.useEffect)((()=>{c.auth||c.requestGetAuth()}),[]);let h=parseInt(localStorage.getItem(p.e));null!==u&&void 0!==u&&u.includes(h)&&(Ve.find((e=>"homeentries"===e.key)).submenu=Ve.find((e=>"homeentries"===e.key)).submenu.filter((e=>"map"!==e.key)));return j?Object($.jsx)(Be.a,{}):Object($.jsx)(Q.a,{theme:n===q.e?"light":"dark",mode:"inline",style:{height:"100%",borderRight:0},defaultSelectedKeys:[null===a||void 0===a?void 0:a.key],defaultOpenKeys:Ke(null===a||void 0===a?void 0:a.key),className:l?"hide-group-title":"",children:Ve.map((e=>{var n;return e.limitVisibility&&!Je(c.auth.roles,e.limitVisibility)?null:(null===(n=e.submenu)||void 0===n?void 0:n.length)>0?Object($.jsx)(Q.a.ItemGroup,{title:We(r,e.title),children:e.submenu.map((e=>Je(e.key,d)||Je("ROOT",c.auth.roles)||!(e=>{if(c.auth){var n,i,a;const l=null===(n=c.auth)||void 0===n||null===(i=n.organizations)||void 0===i?void 0:i.filter((e=>e.organizationId===(parseInt(t)||c.auth.organizations[0].organizationId)))[0];if(l.modules&&!0===(null===(a=l.modules[e])||void 0===a?void 0:a.active))return!1}return!1})(e.key)?e.limitVisibility&&!Je(c.auth.roles,e.limitVisibility)?null:e.submenu.length>0?Object($.jsx)(He,{icon:e.icon?Object($.jsx)(oe,{type:null===e||void 0===e?void 0:e.icon}):null,title:We(r,e.title),children:e.submenu.map((e=>e.limitVisibility&&!Je(c.auth.roles,e.limitVisibility)?null:Object($.jsx)(qe,{linkProps:{onClick:()=>v()},...e})))},e.key):Object($.jsx)(qe,{linkProps:{onClick:()=>v()},...e}):null))},e.key):Object($.jsx)(qe,{linkProps:{onClick:()=>v()},...e})}))})},Ze=e=>{const{topNavColor:t,localization:n}=e;return Object($.jsx)(Q.a,{mode:"horizontal",style:{backgroundColor:t},children:Ve.map((e=>{var t,i;return(null===(t=e.submenu)||void 0===t?void 0:t.length)>0?Object($.jsx)(He,{popupClassName:"top-nav-menu",title:Object($.jsxs)("span",{children:[e.icon?Object($.jsx)(oe,{type:null===e||void 0===e?void 0:e.icon}):null,Object($.jsx)("span",{children:We(n,e.title)})]}),children:null===(i=e.submenu)||void 0===i?void 0:i.map((e=>e.submenu.length>0?Object($.jsx)(He,{icon:e.icon?Object($.jsx)(oe,{type:null===e||void 0===e?void 0:e.icon}):null,title:We(n,e.title),children:e.submenu.map((e=>Object($.jsxs)(Q.a.Item,{children:[Object($.jsx)("span",{children:We(n,e.title)}),Object($.jsx)(G.b,{to:e.path})]},e.key)))},e.key):Object($.jsxs)(Q.a.Item,{children:[e.icon?Object($.jsx)(oe,{type:null===e||void 0===e?void 0:e.icon}):null,Object($.jsx)("span",{children:We(n,e.title)}),Object($.jsx)(G.b,{to:e.path})]},e.key)))},e.key):Object($.jsxs)(Q.a.Item,{children:[e.icon?Object($.jsx)(oe,{type:null===e||void 0===e?void 0:e.icon}):null,Object($.jsx)("span",{children:We(n,null===e||void 0===e?void 0:e.title)}),e.path?Object($.jsx)(G.b,{to:e.path}):null]},e.key)}))})};var Xe=Object(o.b)((e=>{let{theme:t}=e;const{sideNavTheme:n,topNavColor:i}=t;return{sideNavTheme:n,topNavColor:i}}),{onMobileNavToggle:Fe})((e=>e.type===q.a?Object($.jsx)(Qe,{...e}):Object($.jsx)(Ze,{...e})));const{Sider:$e}=K.a;var et=Object(o.b)((e=>{let{theme:t}=e;const{navCollapsed:n,sideNavTheme:i}=t;return{navCollapsed:n,sideNavTheme:i}}))((e=>{let{navCollapsed:t,sideNavTheme:n,routeInfo:i,hideGroupTitle:a,localization:l=!0}=e;const r={sideNavTheme:n,routeInfo:i,hideGroupTitle:a,localization:l};return Object($.jsx)($e,{className:"side-nav ".concat(n===q.d?"side-nav-dark":""),width:q.f,collapsed:t,children:Object($.jsx)(Ge.k,{children:Object($.jsx)(J.Scrollbars,{autoHide:!0,children:Object($.jsx)(Xe,{type:q.a,...r})})})})}));var tt=Object(o.b)((e=>{let{theme:t}=e;const{topNavColor:n}=t;return{topNavColor:n}}))((e=>{let{topNavColor:t,localization:n=!0}=e;const i={topNavColor:t,localization:n};return Object($.jsx)("div",{className:"top-nav ".concat(Me.getColorContrast(t)),style:{backgroundColor:t},children:Object($.jsx)("div",{className:"top-nav-wrapper",children:Object($.jsx)(Ge.k,{children:Object($.jsx)(Xe,{type:q.b,...i})})})})})),nt=n(475);const{useBreakpoint:it}=Z.a,at=(e,t)=>{const{navCollapsed:n,navType:i}=e,a=i===q.b;return t&&!e.mobileLogo?0:a?"auto":"".concat(n?q.c:q.f,"px")},lt=e=>{const{navCollapsed:t,logoType:n}=e;return"light"===n?t?"/img/logo-sm-notext.png":"/img/logo-white.png":t?"/img/logo-sm.png":"/img/logo.png"},rt=(e,t)=>e&&!t?"d-none":"logo";var ot=Object(o.b)((e=>{let{theme:t}=e;const{navCollapsed:n,navType:i}=t;return{navCollapsed:n,navType:i}}))((e=>{const t=!Me.getBreakPoint(it()).includes("lg");return Object($.jsx)("div",{className:rt(t,e.mobileLogo),style:{width:"".concat(at(e,t))},children:Object($.jsx)("img",{src:lt(e),style:{maxWidth:"100%"},alt:"".concat(k.b," logo")})})})),st=n(49),dt=n(975);var ct=Object(o.b)((e=>{let{theme:t}=e;const{navCollapsed:n,sideNavTheme:i,mobileNav:a}=t;return{navCollapsed:n,sideNavTheme:i,mobileNav:a}}),{onMobileNavToggle:Fe})((e=>{let{sideNavTheme:t,mobileNav:n,onMobileNavToggle:i,routeInfo:a,hideGroupTitle:l,localization:r=!0}=e;const o={sideNavTheme:t,routeInfo:a,hideGroupTitle:l,localization:r},s=()=>{i(!1)};return Object($.jsx)(nt.a,{placement:"left",closable:!1,onClose:s,visible:n,bodyStyle:{padding:5},children:Object($.jsxs)(st.a,{flexDirection:"column",className:"h-100",children:[Object($.jsxs)(st.a,{justifyContent:"between",alignItems:"center",children:[Object($.jsx)(ot,{mobileLogo:!0}),Object($.jsx)("div",{className:"nav-close",onClick:()=>s(),children:Object($.jsx)(dt.a,{})})]}),Object($.jsx)("div",{className:"mobile-nav-menu",children:Object($.jsx)(Ge.k,{children:Object($.jsx)(J.Scrollbars,{autoHide:!0,children:Object($.jsx)(Xe,{type:q.a,...o})})})})]})})})),ut=n(248),vt=n(981),jt=n(982),ht=n(939),pt=n(391),bt=n(976),Ot=n(977),mt=n(978),gt=n(466),ft=n(110);const xt=function e(t,n){n=n||[];for(const i of t)0===i.submenu.length&&n.push(i),i.submenu.length>0&&e(i.submenu,n);return n}(Ve),yt=e=>{switch(e){case"dashboards":return Object($.jsx)(pt.a,{className:"text-success"});case"apps":return Object($.jsx)(me.a,{className:"text-danger"});case"components":return Object($.jsx)(bt.a,{className:"text-primary"});case"extra":return Object($.jsx)(Ot.a,{className:"text-warning"});default:return null}};var Et=e=>{const{active:t,close:n,isMobile:a,mode:l}=e,[r,o]=Object(i.useState)(""),[s,d]=Object(i.useState)([]),c=Object(i.useRef)(null);return t&&c.current.focus(),Object($.jsx)(gt.a,{ref:c,className:"nav-search-input ".concat(a?"is-mobile":""," ").concat("light"===l?"light":""),dropdownClassName:"nav-search-dropdown",options:s,onSelect:()=>{o(""),d([]),n&&n()},onSearch:e=>{o(e),d(e?xt.map((e=>{const t=e.key.split("-")[0];return{value:e.path,label:Object($.jsx)(G.b,{to:e.path,children:Object($.jsxs)("div",{className:"search-list-item",children:[Object($.jsx)("div",{className:"icon",children:yt(t)}),Object($.jsxs)("div",{children:[Object($.jsx)("div",{className:"font-weight-semibold",children:Object($.jsx)(le,{id:e.title})}),Object($.jsxs)("div",{className:"font-size-sm text-muted",children:[t," "]})]})]})})}})):[])},value:r,filterOption:(e,t)=>-1!==t.value.toUpperCase().indexOf(e.toUpperCase()),children:Object($.jsx)(ft.a,{placeholder:"Search...",prefix:Object($.jsx)(mt.a,{className:"mr-0"})})})};var It=Object(o.b)((e=>{let{theme:t}=e;const{headerNavColor:n}=t;return{headerNavColor:n}}),{})((e=>{const{active:t,close:n,headerNavColor:i}=e,a=Me.getColorContrast(i);return Object($.jsxs)("div",{className:"nav-search ".concat(t?"nav-search-active":""," ").concat(a),style:{backgroundColor:i},children:[Object($.jsx)("div",{className:"d-flex align-items-center w-100",children:Object($.jsx)(Et,{close:n,active:t})}),Object($.jsx)("div",{className:"nav-close",onClick:n,children:Object($.jsx)(ht.a,{})})]})})),St=(n(221),n(174),n(393)),Tt=n(933),kt=n(979);n(980);St.a,Tt.a,kt.a,ke.a;var Ct=n(937),_t=n(144),At=n(115),Nt=n(54),Rt=n(93),Dt=n(101),wt=n(166),Lt=n(382),Pt=n(152),Vt=n(63),Mt=n(11),Ft=n(51),zt=n(2),Ut=n(6),Bt=n(53);const{Title:Gt}=_t.a,{Text:Ht}=_t.a,Yt=e=>{let{...t}=e;const[n,a]=Object(i.useState)(!0),[l,r]=Object(i.useState)(!1),[s,d]=Object(i.useState)(null),[c,u]=Object(i.useState)(!1),[v,j]=Object(i.useState)(!1),h=Object(i.useContext)(Ge.t).raw,[b,O]=Object(i.useState)([]),m=localStorage.getItem(p.e);let g=!0;Object(o.c)();const[f,x]=Object(i.useState)(!1),y=()=>{x(!0)},E=()=>{h&&Mt.b.getCurrentUser().then((e=>{var t,n;const i=null===e||void 0===e||null===(t=e.organizations)||void 0===t?void 0:t.find((t=>{let{organizationId:n}=t;return n===e.organizationId}));e.orgDisplayName=null===i||void 0===i?void 0:i.fullName,e.permittedVehicles=null===e||void 0===e?void 0:e.permittedVehicles.map((e=>null===h||void 0===h?void 0:h.find((t=>t.id===e.id)))),d(e),localStorage.setItem(p.d,null===e||void 0===e?void 0:e.mapType),localStorage.setItem(p.s,null===e||void 0===e?void 0:e.userId),localStorage.setItem(p.t,null===e||void 0===e?void 0:e.organizationId),(null===(n=JSON.stringify(null===e||void 0===e?void 0:e.roles))||void 0===n?void 0:n.includes("ROOT"))||m||localStorage.setItem(p.e,null===e||void 0===e?void 0:e.organizationId)}))};Object(i.useEffect)((()=>{a(!1),!1===(null===s||void 0===s?void 0:s.hasApprovedGdpr)&&r(!0),Mt.a.getOrganizationsSimple().then((e=>{O(e)}))}),[s]),console.log(s),Object(i.useEffect)((()=>{h&&E()}),[h]),Object(i.useEffect)((()=>{j(JSON.parse(localStorage.getItem(p.g)||!1)||!1),n&&E()}),[]);const I={labelCol:{span:8},wrapperCol:{span:24}},S={wrapperCol:{offset:12,span:24}};function T(e){const t={mapType:e.target.value};Mt.a.patchUser(null===s||void 0===s?void 0:s.userId,t).then((t=>{localStorage.setItem(p.d,e.target.value),E()}))}const k=e=>{var t,a,l,r,o,d;let{getOrganizationFromLS:c}=e;const[u,O]=Object(i.useState)(),m=b.filter((e=>e.organization_id===(c?parseInt(c):b[b.length-1].organizationId)))[0],[f]=Nt.a.useForm();return!n&&m&&s?Object($.jsxs)(Nt.a,{...I,form:f,name:"change",initialValues:{remember:!1},layout:"vertical",onFinish:e=>{(e=>{let t=s;t.oldPassword=e.old_password,t.password=e.new_password,Mt.b.patchNewPassword(null===s||void 0===s?void 0:s.userId,t)})(e),f.resetFields()},onFinishFailed:e=>{f.resetFields()},children:[Object($.jsxs)(Rt.a,{gutter:[0,0],children:[Object($.jsx)(Dt.a,{children:Object($.jsxs)(Gt,{level:3,children:[s.displayName,c?Object($.jsxs)(Ht,{type:"secondary",children:[" (",null===m||void 0===m?void 0:m.full_name,")"]}):null]})}),Object($.jsx)(wt.a,{})]}),b.length<2?null:Object($.jsxs)(Rt.a,{gutter:[0,0],children:[Object($.jsxs)(Dt.a,{span:24,children:[Object($.jsx)(Gt,{level:3,children:"Organisation"}),Object($.jsx)(Ft.a,{thisIsSettingPanel:!0,width:300,data:b,defaultValue:c?parseInt(c):null,onChange:e=>{void 0===e?localStorage.removeItem(p.e):localStorage.setItem(p.e,e),window.location.reload()}})]}),Object($.jsx)(wt.a,{})]}),Object($.jsx)(Rt.a,{gutter:[0,0],children:Object($.jsx)(Dt.a,{children:Object($.jsx)(Gt,{level:3,children:"Mina fordon"})})}),Object($.jsx)(Rt.a,{gutter:[0,10],children:Object($.jsxs)(Dt.a,{span:24,children:[Object($.jsx)(Gt,{level:4,children:"F\xf6rvald f\xf6rare"}),(null===(t=s.defaultVehicles)||void 0===t?void 0:t.length)>0?null===(a=s.defaultVehicles)||void 0===a?void 0:a.map((e=>{var t;const n=null===h||void 0===h?void 0:h.find((t=>t.id===e));null===n||void 0===n||null===(t=n.currentDriver)||void 0===t||t.id,s.userId;return n?Object($.jsx)(st.a,{justifyContent:"between",alignItems:"center",children:Object($.jsxs)(st.a,{flexDirection:"column",justifyContent:"between",style:{flexBasis:"60%",padding:"8px 0px"},children:[Object($.jsx)(Ht,{children:(null===n||void 0===n?void 0:n.registry)||"-"}),null===n||void 0===n?void 0:n.displayName]})}):null})):"Du har inte valt n\xe5got fordon"]})}),Object($.jsxs)(Rt.a,{gutter:[0,0],children:[Object($.jsxs)(Dt.a,{span:24,children:[Object($.jsx)(Gt,{level:4,children:"Incheckad"}),(null===(l=s.permittedVehicles)||void 0===l?void 0:l.length)<1?"Du har inte valt n\xe5got fordon":null===(r=s.permittedVehicles)||void 0===r||null===(o=r.filter((e=>!(null!==e&&void 0!==e&&e.isArchived))))||void 0===o?void 0:o.map((e=>{var t;let n=null===s||void 0===s||null===(t=s.currentVehicle)||void 0===t?void 0:t.find((t=>t===(null===e||void 0===e?void 0:e.id)));return e?Object($.jsxs)(st.a,{justifyContent:"between",alignItems:"center",children:[Object($.jsxs)(st.a,{flexDirection:"column",justifyContent:"between",style:{flexBasis:"60%",padding:"8px 0px"},children:[Object($.jsx)(Ht,{children:(null===e||void 0===e?void 0:e.registry)||"-"}),null===e||void 0===e?void 0:e.displayName]}),Object($.jsx)(Lt.a,{checkedChildren:"Incheckad",unCheckedChildren:"Utcheckad",defaultChecked:n,onChange:t=>{((e,t)=>{const n={userId:e?null===s||void 0===s?void 0:s.userId:null};Mt.a.putCheckCurrentDriver(t,n).then((e=>{At.b.success("Du \xe4r incheckad"),g=!g,E()}))})(t,null===e||void 0===e?void 0:e.id),O(t),n=!n}})]}):null}))]}),Object($.jsx)(wt.a,{})]}),Object($.jsx)(Rt.a,{gutter:[0,0],children:Object($.jsxs)(Dt.a,{span:24,children:[Object($.jsx)(Gt,{level:3,children:"Anpassa"}),Object($.jsxs)(st.a,{justifyContent:"between",alignItems:"center",children:[Object($.jsxs)(st.a,{flexDirection:"column",justifyContent:"between",style:{flexBasis:"60%",padding:"12px 0px"},children:[Object($.jsx)(Gt,{level:4,children:"Karta"}),"Standardtyp av karta."]}),Object($.jsxs)(Pt.a.Group,{onChange:T,defaultValue:null===s||void 0===s?void 0:s.mapType,size:"small",children:[Object($.jsx)(Pt.a.Button,{value:Ut.k.LIGHT,children:zt.f.LIGHT}),Object($.jsx)(Pt.a.Button,{value:Ut.k.DARK,children:zt.f.DARK})]})]}),Object($.jsxs)(st.a,{justifyContent:"between",alignItems:"center",children:[Object($.jsxs)(st.a,{flexDirection:"column",justifyContent:"between",style:{flexBasis:"60%",padding:"12px 0px"},children:[Object($.jsx)(Gt,{level:4,children:"Arkiverade"}),zt.f.SHOW_ARCHIVED]}),Object($.jsx)(Lt.a,{defaultChecked:v,onChange:e=>{!function(e){console.log("localStorage.getItem(SHOW_ARCHIVED)",localStorage.getItem(p.g),e),j(e)}(e)}})]}),(null===(d=JSON.stringify(null===s||void 0===s?void 0:s.roles))||void 0===d?void 0:d.includes("ROOT"))&&Object($.jsxs)(st.a,{justifyContent:"between",alignItems:"center",children:[Object($.jsxs)(st.a,{flexDirection:"column",justifyContent:"between",style:{flexBasis:"60%",padding:"12px 0px"},children:[Object($.jsx)(Gt,{level:4,children:"Meny"}),"\xc4ndra mellan tv\xe5 menytyp. Detta \xe4r en test f\xf6r en ny meny."]}),Object($.jsx)(Lt.a,{defaultChecked:localStorage.getItem(!1),onChange:e=>localStorage.setItem("MENU_TYPE",e)})]}),Object($.jsx)(wt.a,{})]})}),Object($.jsxs)(Rt.a,{gutter:[0,0],children:[Object($.jsxs)(Dt.a,{span:24,children:[Object($.jsx)(Gt,{level:3,children:"\xc4ndra l\xf6senord"}),Object($.jsx)(Nt.a.Item,{label:"Nuvarande",name:"old_password",rules:[{required:!0,message:"Ange nuvarande l\xf6senord"}],children:Object($.jsx)(ft.a.Password,{prefix:Object($.jsx)(Ct.a,{style:{marginRight:3}}),placeholder:zt.f.SUPPLY_A_OLD_PASSWORD,autocomplete:"new-password"})}),Object($.jsx)(Nt.a.Item,{label:"Nytt",name:"new_password",rules:[{required:!0,message:"Ange nytt l\xf6senord"}],children:Object($.jsx)(ft.a.Password,{prefix:Object($.jsx)(Ct.a,{style:{marginRight:3}}),placeholder:zt.f.SUPPLY_A_NEW_PASSWORD,autocomplete:"off"})}),Object($.jsx)(Nt.a.Item,{...S,children:Object($.jsx)(Vt.a,{type:"primary",htmlType:"submit",children:"\xc4ndra l\xf6senord"})})]}),Object($.jsx)(wt.a,{})]})]}):Object($.jsx)(Be.a,{})};(e=>{const t=null===e||void 0===e?void 0:e.split(" ");null===t||void 0===t||t.map((e=>e[0])).join("").toUpperCase()})(null===s||void 0===s?void 0:s.displayName);return Object($.jsx)(Bt.a,{wrappers:[Ge.u],children:Object($.jsxs)($.Fragment,{children:[Object($.jsxs)(Q.a,{mode:"horizontal",children:[Object($.jsx)(Q.a.Item,{style:{lineHeight:1.5,height:"100%"},onClick:y,children:Object($.jsxs)(st.a,{style:{height:"100%",textAlign:"right"},flexDirection:"column",className:"pl-3",justifyContent:"center",children:[Object($.jsx)("h4",{className:"mb-0",children:null===s||void 0===s?void 0:s.displayName}),Object($.jsx)("span",{className:"text-muted",children:null===s||void 0===s?void 0:s.orgDisplayName})]})}),Object($.jsx)(Q.a.Item,{onClick:y,children:Object($.jsx)(Tt.a,{className:"nav-icon mr-0"})})]}),Object($.jsxs)(nt.a,{title:"Mitt konto",placement:"right",width:350,onClose:()=>{x(!1),localStorage.getItem(p.g)!==(null===v||void 0===v?void 0:v.toString())&&(localStorage.setItem(p.g,null===v||void 0===v?void 0:v.toString()),window.location.reload())},visible:f,children:[Object($.jsx)(k,{getOrganizationFromLS:m}),Object($.jsx)(Vt.a,{className:"mt-3",type:"secondary",block:!0,onClick:()=>{t.signOut()},children:Object($.jsx)("span",{children:"Logga ut"})})]})]})})},Wt=Object(i.forwardRef)(((e,t)=>Object($.jsx)(Bt.a,{wrappers:[Ge.u],children:Object($.jsx)(Yt,{ref:t,...e})})));var Kt=Object(o.b)((()=>({})),{signOut:N.f})(Wt);var qt=()=>Object($.jsx)(Bt.a,{wrappers:[],children:Object($.jsx)(Kt,{})});const{Header:Jt}=K.a;var Qt=Object(o.b)((e=>{let{theme:t}=e;const{navCollapsed:n,navType:i,headerNavColor:a,mobileNav:l,currentTheme:r}=t;return{navCollapsed:n,navType:i,headerNavColor:a,mobileNav:l,currentTheme:r}}),{toggleCollapsedNav:function(e){return{type:m,navCollapsed:e}},onMobileNavToggle:Fe})((e=>{const{navCollapsed:t,mobileNav:n,navType:a,headerNavColor:l,toggleCollapsedNav:r,onMobileNavToggle:o,isMobile:s,currentTheme:d}=e,[c,u]=Object(i.useState)(!1),v=()=>{u(!1)},j=a===q.b,h=l?Me.getColorContrast(l):Me.getColorContrast("dark"===d?"#00000":"#ffffff");Object(i.useEffect)((()=>{s||v()}));let p=!0===(null===De.a||void 0===De.a?void 0:De.a.SHOW_DEV);return Object($.jsx)(Jt,{className:"app-header ".concat(h),style:{backgroundColor:l},children:Object($.jsxs)("div",{className:"app-header-wrapper ".concat(j?"layout-top-nav":""),children:[Object($.jsx)(ot,{logoType:h}),Object($.jsxs)("div",{className:"nav",style:{width:"calc(100% - ".concat(j||s?"0px":"".concat(t?q.c:q.f,"px"),")")},children:[Object($.jsx)("div",{className:"nav-left",children:Object($.jsx)("ul",{className:"ant-menu ant-menu-root ant-menu-horizontal",children:j&&!s?null:Object($.jsx)("li",{className:"ant-menu-item ant-menu-item-only-child",onClick:()=>{s?o(!n):r(!t)},children:t||s?Object($.jsx)(vt.a,{className:"nav-icon"}):Object($.jsx)(jt.a,{className:"nav-icon"})})})}),p&&Object($.jsx)(ut.a,{style:{width:"60%"},message:"DEV",type:"success",banner:!0,showIcon:!1}),Object($.jsx)("div",{className:"nav-right",children:Object($.jsx)(qt,{})}),Object($.jsx)(It,{active:c,close:v})]})]})})})),Zt=n(289);let Xt={"/app":Object($.jsx)(le,{id:"home"})};Ve.forEach(((e,t)=>{const n=e=>Xt[e.path]=Object($.jsx)(le,{id:e.title});n(e),e.submenu&&e.submenu.forEach((e=>{n(e),e.submenu&&e.submenu.forEach((e=>{n(e)}))}))}));const $t=Object(W.i)((e=>{const{location:t}=e,n=t.pathname.split("/").filter((e=>e)),i=n.map(((e,t)=>{const i="/".concat(n.slice(0,t+1).join("/"));return Object($.jsx)(Zt.a.Item,{children:Object($.jsx)(G.b,{to:i,children:Xt[i]})},i)}));return Object($.jsx)(Zt.a,{children:i})}));class en extends i.Component{render(){return Object($.jsx)($t,{})}}var tn=en;var nn=e=>{let{title:t,display:n}=e;return n?Object($.jsxs)("div",{className:"app-page-header",children:[Object($.jsx)("h3",{className:"mb-0 mr-3 font-weight-semibold",children:Object($.jsx)(le,{id:t||"home"})}),Object($.jsx)(tn,{})]}):null};function an(){return Object($.jsx)("footer",{className:"footer",children:Object($.jsxs)("span",{children:["Copyright  \xa9  ","".concat((new Date).getFullYear())," ",Object($.jsx)("span",{className:"font-weight-semibold",children:"".concat(k.b)})," All rights reserved."]})})}var ln=n(255);n(920);const{Content:rn}=K.a,{useBreakpoint:on}=Z.a,sn=e=>{let{navCollapsed:t,navType:n,location:i}=e;const a=Me.getRouteInfo(Ve,i.pathname),l=!Me.getBreakPoint(on()).includes("lg"),r=n===q.a,o=n===q.b;return Object($.jsxs)(K.a,{children:[Object($.jsx)(Qt,{isMobile:l}),o&&!l?Object($.jsx)(tt,{routeInfo:a}):null,Object($.jsxs)(K.a,{className:"app-container",children:[r&&!l?Object($.jsx)(et,{routeInfo:a}):null,Object($.jsxs)(K.a,{className:"app-layout",style:{paddingLeft:o||l?0:t?q.c:q.f},children:[Object($.jsxs)("div",{className:"app-content ".concat(o?"layout-top-nav":""),children:[Object($.jsx)(nn,{display:null===a||void 0===a?void 0:a.breadcrumb,title:null===a||void 0===a?void 0:a.title}),Object($.jsx)(rn,{children:Object($.jsx)(ln.default,{})})]}),Object($.jsx)(an,{})]})]}),l&&Object($.jsx)(ct,{})]})};var dn=Object(o.b)((e=>{let{theme:t}=e;const{navCollapsed:n,navType:i,locale:a}=t;return{navCollapsed:n,navType:i,locale:a}}))(a.a.memo(sn));var cn=()=>Object($.jsx)(i.Suspense,{fallback:Object($.jsx)(Be.a,{cover:"page"}),children:Object($.jsxs)(W.d,{children:[Object($.jsx)(W.b,{path:"".concat(k.d,"/login"),component:Object(i.lazy)((()=>Promise.all([n.e(0),n.e(5)]).then(n.bind(null,1015))))}),Object($.jsx)(W.b,{path:"".concat(k.d,"/login-1"),component:Object(i.lazy)((()=>Promise.all([n.e(0),n.e(8)]).then(n.bind(null,1012))))}),Object($.jsx)(W.b,{path:"".concat(k.d,"/login-2"),component:Object(i.lazy)((()=>Promise.all([n.e(0),n.e(9)]).then(n.bind(null,1016))))}),Object($.jsx)(W.b,{path:"".concat(k.d,"/register-1"),component:Object(i.lazy)((()=>Promise.all([n.e(0),n.e(10)]).then(n.bind(null,1017))))}),Object($.jsx)(W.b,{path:"".concat(k.d,"/register-2"),component:Object(i.lazy)((()=>Promise.all([n.e(0),n.e(11)]).then(n.bind(null,1018))))}),Object($.jsx)(W.b,{path:"".concat(k.d,"/forgot-password"),component:Object(i.lazy)((()=>Promise.all([n.e(0),n.e(6)]).then(n.bind(null,1019))))}),Object($.jsx)(W.b,{path:"".concat(k.d,"/reset-password"),component:Object(i.lazy)((()=>Promise.all([n.e(0),n.e(7)]).then(n.bind(null,1020))))}),Object($.jsx)(W.b,{path:"".concat(k.d,"/error-1"),component:Object(i.lazy)((()=>n.e(12).then(n.bind(null,1021))))}),Object($.jsx)(W.a,{from:"".concat(k.d),to:"".concat(k.d,"/login")})]})});var un=()=>Object($.jsx)("div",{className:"auth-container",children:Object($.jsx)(W.d,{children:Object($.jsx)(W.b,{path:"",component:cn})})}),vn=n(943),jn=n(27),hn=n(397),pn=n(177),bn=n(328);var On={antd:pn.a,locale:"en-US",messages:{...bn}},mn=n(333),gn=n(329);var fn={antd:mn.a,locale:"sv-SE",messages:{...gn}},xn=n(389),yn=n(240);const En={en:On,sv:fn},In={en:{translation:bn,antd:pn.a},sv:{translation:{...gn},antd:mn.a}};xn.a.use(yn.a).init({resources:In,fallbackLng:k.i.locale,lng:k.i.locale,interpolation:{escapeValue:!1}});xn.a;function Sn(e){let{children:t,isAuthenticated:n,...i}=e;return Object($.jsx)(W.b,{...i,render:e=>{let{location:i}=e;return n?t:Object($.jsx)(W.a,{to:{pathname:k.d,state:{from:i}}})}})}var Tn=Object(W.i)(Object(o.b)((e=>{let{theme:t,auth:n}=e;const{locale:i}=t,{token:a}=n;return{locale:i,token:a}}))((e=>{const{locale:t,token:n,location:i}=e,a=En[t];return window.onerror=function(e,t,n,i,a){"Uncaught TypeError: Cannot read property 'map' of undefined"===e&&hn.a.redirectToErrorSite(),console.log("Error msg",e)},Object($.jsx)(ne,{children:Object($.jsx)(vn.a,{locale:a.locale,messages:a.messages,children:Object($.jsx)(jn.b,{locale:a.antd,children:Object($.jsxs)(W.d,{children:[Object($.jsx)(W.b,{exact:!0,path:"/",children:Object($.jsx)(W.a,{to:k.c})}),Object($.jsx)(W.b,{path:k.d,children:Object($.jsx)(un,{})}),Object($.jsx)(Sn,{path:k.c,isAuthenticated:n,children:Object($.jsx)(dn,{location:i})})]})})})})})));Y.a.tz.setDefault("Europe/Stockholm");var kn=function(){return Object($.jsx)("div",{className:"App",children:Object($.jsx)(o.a,{store:B.store,children:Object($.jsx)(s.a,{loading:null,persistor:B.persistor,children:Object($.jsx)(G.a,{children:Object($.jsx)(W.d,{children:Object($.jsx)(W.b,{path:"/",component:Tn},(e=>e))})})})})})};n(922);r.a.render(Object($.jsx)(kn,{}),document.getElementById("root"))},94:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var i=n(0),a=n(11),l=n(1);const r=Object(i.createContext)({}),o=e=>{let{children:t}=e;const[n,o]=Object(i.useState)([]);return Object(i.useEffect)((()=>{(async()=>{a.a.getOrganizationsSimple().then((e=>{o(e)})).catch((e=>{console.error(e)}))})()}),[]),Object(l.jsx)(r.Provider,{value:{organizations:n,getOrganizationById:async e=>await a.a.getOrganization(e).then((e=>e)).catch((e=>console.error(e))),patchOrganizationAccount:async(e,t)=>await a.a.patchOrganizationAccount(e,t).then((e=>!0)).catch((e=>console.error(e))),getAllOrganizationsForRoot:async()=>await a.a.getAllOrganizationsForSuperadmin().then((e=>e)).catch((e=>console.error(e)))},children:t})}}},[[923,3,4]]]);
//# sourceMappingURL=main.890721c6.chunk.js.map